


# A.D. 2024 
# sono 20 anni compa !
# ave compa !
# oggi 26 mag 2025 ti voglio bene compa - comfortably numb - Pink Floyd -

'''

             deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}          


# 14 ott 2025 fare dev ma3_last > ma8_last perche' ha venduto mentre saliva
# 15 ott 2025 aggiunta quando 25-300< -1.60 and ma8_last >= ma8_2_min_ago (buy durante il crollo del 10 ottobre 2025)
# 30 set 2025 aggiunta and delta_50_25_last < delta_50_25_30_min_ago GIORNO



per COMPRARE durante un ribasso

# 1 SE CV e' GIORNO ok cosi'
                                and delta_CV_300_25_last < delta_CV_300_25_45_min_ago
        


# 2X SE CV e' NOTTE interviene CM GIORNO + deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07 ! meno ripida + ma8_last >= ma8_2_min_ago !

                                 and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                                 and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                                 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07
                                 and ma8_last >= ma8_2_min_ago


# 2Y SE CV e' NOTTE interviengono le condizioni delle parentesi graffe con deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.11 piu' ripida ! + ma8_last >= ma8_2_min_ago !
                                 
                                 and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                                 and deviation_ma39
                                 and deviation_ma3_sotto_ma50
                                 and deviation_ma5_sopra_o_sotto_ma100
                                 and deviation_ma25_sotto_ma300 < -1.60
                                 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.11
                                 and ma8_last >= ma8_2_min_ago




per VENDERE durante un ribasso

elif (   
    ma20_last < ma50_last
    and deviation_ma5_sopra_o_sotto_ma5_120_min_ago < -0.50
    and ma5_last < ma100_last
    and ma5_last < ma200_last
    and ma5_last < ma300_last
    and ma100_last < ma200_last
    and ma200_last < ma300_last
    and ma300_last < ma300_120_min_ago

    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.03
    and (delta_GPII_1 > delta_GPII_2 or delta_MC_1 > delta_MC_2)

    and (ma5_prev > ma20_prev and ma5_last < ma20_last)
    and deviation_sell < 0.10

    



NONNO MARIO !

and delta_CM_300_25_last < delta_CM_300_25_2_min_ago
and delta_CV_300_25_last > delta_CV_300_25_45_min_ago



sono 4 condizioni
durante il ribasso - CV notte ! - vede nero !

1 - MC GIORNO con 3-39 < -0.10 e 3-50 < -0.30 basse perche' e' gia' risalito
2 - PRENDO IL COLTELLO CON IL PIEDE - OSSO - 25-300 < -1.50 E 3-10 E 3-50 E 3-100 PESANTI ! VEDI VALORI DELLE DEVIATION CON PARENTESI GRAFFE
3 - INTERVIENE DNA ! DOPPIO DELTA 250-150 GIORNO + DEV 150-250 > -0.62 STA RISALENDO - CM puo' essere giorno o notte. DNA INTERVIENE !
4 - INTERVIENE MB - l' ultimo - ALLA FINE ! quando il ribasso e' lunghissimo con DOPPIO DELTA 450 - 300 GIORNO






# ASCOLTA MARIO - IL MIO CAPOLAVORO

SE 
and ma100_last > ma100_60_min_ago OK COSI'

MA SE
and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.35)





per il BUY DURANTE UN RIBASSO.

SE 100 < 60 min OR delta CV 25-300 NOTTE 

deve essere CM 25-300 2 min GIORNO or 25-300 < -0.35



        # SE e' NOTTE - CV
        # and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
        

        # deve essere GIORNO - CM
        # and delta_CM_300_25_last < delta_CM_300_25_2_min_ago





        
        MA 
        ANCHE SE CM GIORNO
        DOPO TANTISSIMO TEMPO INTERVIENE DNA !!! + DOPPIO DELTA 450-100 + 150-250 > -0.62


and delta_DNA_1 < delta_DNA_2                .........GIORNO ! 
and delta_DNA_1 > delta_DNA_2                .........NOTTE !  

delta_DNA_1 = ma250_last / ma150_last
delta_DNA_2 = ma250_60_min_ago / ma150_60_min_ago






and delta_1_50_20 < delta_2_50_20 GIORNO ! a 30 min !


chiedi al compare come posso mettere in colonna questa riga lunga !

buy = f"BUY 4 deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f} GIORNO con 300> E ma100>ma450 durante un ritracciamento in basso - r 6668 A1 Y2 yX"

0.12567896545774577



sell = f"""SELL 4 GIORNO con 300> E ma100>ma450 durante un ritracciamento in basso - r 15898 X
deviation_ma39 {deviation_ma39:.2f}
deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
"""




sell = f"""SELL 4 
deviation_ma39 {deviation_ma39:.2f}
deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
GIORNO con 300> E ma100>ma450 durante un ritracciamento in basso - r 15898 X"""





# 30 APR 2025 ATTENZIONE ! DATA STORICA ! nei punti piu' importanti ho messo :

                    # {deviation_ma39}
                    # {deviation_ma3_sotto_ma50}
                    # {deviation_ma5_sopra_o_sotto_ma100}
                    # {deviation_ma25_sotto_ma300}
                    # {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}

                    and deviation_ma39 < -0.123
                    and deviation_ma3_sotto_ma50 < -0.127
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.42
                    and deviation_ma25_sotto_ma300 < -0.20
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.06

                    # GRAZIE COMPARE MIO !














# 16 MAG 2025 ATTENZIONE ! DATA STORICA ! vendita in guadagno mentre scende r 11633 Y2

                    dopo 20 minuti dall'ultimo BUY - LAST TRADE
                    and ma300_last < ma300_120_min_ago
                    and deviation_ma39 < 0.13
                    and deviation_sell < 0.10 
                    and (ma20_prev > ma50_prev and ma20_last < ma50_last)

                    SE VENDE MENTRE 20 E' ANCORA SOTTO 50 nei primi minuti intervengono le altre. per adesso non ho altra soluzione.

                    and deviation_ma3_sotto_ma50 < -0.127
                    and deviation_ma50_sotto_ma100 > -0.15
                    and deviation_ma20_sotto_ma50 > -0.10
                    and (delta_1 < delta_2 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.025



                    ritracciamento in alto !

                    and deviation_ma50_sotto_ma100 < -0.15
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.22
                    and deviation_ma100_sopra_ma200 < -0.15





                    RITRACCIAMENTO

                    and ma20_last < ma50_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10

                    and ma50_last < ma100_last
                    
                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.30

                    and macd_differenza_2_min_ago > -5.00

                    
                    8 apr 2025 se ritraccia (20<50) ma3 DEVE STARE SOTTO ma100 non c'e' niente da fare !



LEZIONE DEL COMPARE :
and (ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last)



and deviation_ma200_sotto_ma300 < -1.00
and deviation_ma25_sotto_ma300 < -2.00
and deviation_ma50_sotto_ma300 < -2.20
and deviation_ma5_sotto_ma450 < -3.00




importante ! da r 7063 NUOVA ERA A3 SOFT 1 in poi ore 3:05 del 4 apr 2025

and delta_1 < delta_2
and deviation_ma100_sopra_ma300 < -0.30
and deviation_ma25_sotto_ma300 < -0.30




e' un ritracciamento se
and ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last 

MA SE delta_DNA_1 > delta_DNA_2 .............non e' piu' un ritracciamento
OR SE ma5_last < ma300_last  ................non e' piu' un ritracciamento
OR SE ma100_last < ma200_last ...............non e' piu' un ritracciamento
OR SE ma200_last < ma300_last ...............non e' piu' un ritracciamento










and deviation_ma5_sotto_ma200 < -1.20
and deviation_ma3_sotto_ma50 < -0.30

and deviation_ma200_sotto_ma300 < -0.32
and deviation_ma100_sopra_ma200 < -0.25

and deviation_ma50_sotto_ma100 < -0.25
and deviation_ma3_sotto_ma50 < -0.30



DISTANZE AL RIBASSO se ma450_last < ma450_300_min_ago - ma tenendo ferrari e missile compa

and ma3_last > ma18_last

and ma450_last < ma450_300_min_ago
and ma39_last < ma39_30_min_ago
and deviation_ma3_sotto_ma50 < -0.28
and deviation_ma200_sotto_ma300 < -0.32







and ma450_last < ma450_480_min_ago
and deviation_ma39_sotto_ma100 < -0.27
and ma39_last < ma39_30_min_ago
and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.025

and deviation_ma39 < -0.03
and deviation_ma3_sotto_ma50 < -0.03


GIORNO e NOTTE !

and delta_1 < delta_2  ...........................GIORNO 
and delta_1 > delta_2 NOTTE


delta_1 = (ma200_last / ma100_last)
delta_2 = (ma200_60_min_ago / ma100_60_min_ago)


and delta_300_200 < delta_300_200_60_min  ....... GIORNO ! 






COMINCIA A SCENDERE !

and ma3_last > ma20_last
and deviation_ma200_sotto_ma300 < -0.25
and (ma300_last < ma300_60_min_ago or ma300_last < ma300_120_min_ago)
and delta_1 > delta_2

and deviation_ma39 < -0.03
and deviation_ma3_sotto_ma50 < -0.03

and macd_differenza_2_min_ago > -2.50




                     and ma450_last > ma450_480_min_ago
CONTINUA A SCENDERE 
                     and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)


ho cambiato!  DEVE ESSERE GIORNO 200-100 e ho tolto 39 troppo vicina alla 100 (perche' puo' allontanarsi verso il basso e c'e' gia' il giorno !)
al continua a scendere devo aggiungere osso
tolta 3-39 !


and ma3_last > ma18_last

and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
and deviation_ma200_sotto_ma300 < -1.40
and ma100_last < ma450_last
and ma39_last < ma100_last
and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

and deviation_ma25_sotto_ma300 < -2.30
and deviation_ma50_sotto_ma300 < -2.20
and deviation_ma100_sopra_ma300 < -2.00
and deviation_ma300_sopra_ma450 < -0.80

and delta_1 < delta_2

and ma100_last < ma100_10_min_ago
and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

and deviation_ma39 < -0.17
and deviation_ma3_sotto_ma50 < -0.25

and deviation_ma5_sopra_o_sotto_ma100 < -0.45
and deviation_ma5_sotto_ma200 < -1.20
and deviation_ma5_sotto_ma300 < -2.00
and deviation_ma5_sotto_ma450 < -3.00

and deviation_ma39 < -0.01
and deviation_ma3_sotto_ma50 < -0.10
and macd_differenza_2_min_ago > -2.50




OSSO !

and ma39_last < ma100_last
and deviation_ma100_sopra_ma300 < -0.59
and deviation_ma25_sotto_ma300 < -0.37

and deviation_ma300_sopra_ma450 < -0.072
and deviation_ma50_sotto_ma300 < -0.27

and deviation_ma39 < -0.12
and deviation_ma3_sotto_ma50 < -0.15

and deviation_ma5_sopra_o_sotto_ma100 < -0.22
and deviation_ma5_sotto_ma200 < -0.31
and deviation_ma5_sotto_ma300 < -0.41
and deviation_ma5_sotto_ma450 < -0.51





evitare il BUY durante un RITRACCIAMENTO !

and ma39_last < ma50_last
and ma200_last > ma200_60_min_ago
and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > 0.72
and ma39_last < ma39_10_min_ago
and deviation_ma5_sopra_o_sotto_ma100 < -0.05





CUSPIDE VERSO DESTRA ( > ) circello

and ma3_last > ma20_last
and ma100_last > ma100_300_min_ago
and ma100_last < ma100_120_min_ago





DNA 28 FEB 2025

SE DOPO UN LUNGO RIALZO COMINCIA A CURVARE VERSO IL BASSO !

and ma450_last > ma450_360_min_ago

and delta_DNA_1 < delta_DNA_2                .........GIORNO ! 
and delta_DNA_1 > delta_DNA_2                .........NOTTE !  

delta_DNA_1 = ma250_last / ma150_last
delta_DNA_2 = ma250_60_min_ago / ma150_60_min_ago
        
se GIORNO ok cosi'
se NOTTE osso 3-50

sempre con 

and deviation_ma3_sotto_ma50 < -0.20
and macd_differenza_2_min_ago > -2.50





'''


      


class maddog:
  
    def __init__(self, helper, buy_percentage, sell_percentage):
        self.algo_helper = helper
        self.buy_percentage = buy_percentage
        self.sell_percentage = sell_percentage
        self.session = 0
        self.open = False

    @property
    def action(self):

        
        
        # moving average (2-3-4-5-x)
        
        ma2_last, ma2_prev = self.algo_helper.ma_last_prev(2)
        ma3_last, ma3_prev = self.algo_helper.ma_last_prev(3)
        ma4_last, ma4_prev = self.algo_helper.ma_last_prev(4)
        ma5_last, ma5_prev = self.algo_helper.ma_last_prev(5)
        ma6_last, ma6_prev = self.algo_helper.ma_last_prev(6)
        ma7_last, ma7_prev = self.algo_helper.ma_last_prev(7)
        ma8_last, ma8_prev = self.algo_helper.ma_last_prev(8)
        ma9_last, ma9_prev = self.algo_helper.ma_last_prev(9)
        ma10_last, ma10_prev = self.algo_helper.ma_last_prev(10)
        ma11_last, ma11_prev = self.algo_helper.ma_last_prev(11)
        ma13_last, ma13_prev = self.algo_helper.ma_last_prev(13)
        ma15_last, ma15_prev = self.algo_helper.ma_last_prev(15)
        ma16_last, ma16_prev = self.algo_helper.ma_last_prev(16)
        ma18_last, ma18_prev = self.algo_helper.ma_last_prev(18)
        ma20_last, ma20_prev = self.algo_helper.ma_last_prev(20)
        ma22_last, ma22_prev = self.algo_helper.ma_last_prev(22)
        ma23_last, ma23_prev = self.algo_helper.ma_last_prev(23)
        ma25_last, ma25_prev = self.algo_helper.ma_last_prev(25)
        ma28_last, ma28_prev = self.algo_helper.ma_last_prev(28)
        ma30_last, ma30_prev = self.algo_helper.ma_last_prev(30)
        ma33_last, ma33_prev = self.algo_helper.ma_last_prev(33)
        ma34_last, ma34_prev = self.algo_helper.ma_last_prev(34)
        ma36_last, ma36_prev = self.algo_helper.ma_last_prev(36)
        ma39_last, ma39_prev = self.algo_helper.ma_last_prev(39)
        ma40_last, ma40_prev = self.algo_helper.ma_last_prev(40)
        ma42_last, ma42_prev = self.algo_helper.ma_last_prev(42)
        ma45_last, ma45_prev = self.algo_helper.ma_last_prev(45)
        ma47_last, ma47_prev = self.algo_helper.ma_last_prev(47)
        ma48_last, ma48_prev = self.algo_helper.ma_last_prev(48)
        ma49_last, ma49_prev = self.algo_helper.ma_last_prev(49)
        ma50_last, ma50_prev = self.algo_helper.ma_last_prev(50)
        ma52_last, ma52_prev = self.algo_helper.ma_last_prev(52)
        ma54_last, ma54_prev = self.algo_helper.ma_last_prev(54)
        ma56_last, ma56_prev = self.algo_helper.ma_last_prev(56)
        ma59_last, ma59_prev = self.algo_helper.ma_last_prev(59)
        
        ma69_last, ma69_prev = self.algo_helper.ma_last_prev(69)
        ma72_last, ma72_prev = self.algo_helper.ma_last_prev(72)
        ma78_last, ma78_prev = self.algo_helper.ma_last_prev(78)
        ma80_last, ma80_prev = self.algo_helper.ma_last_prev(80)
        ma86_last, ma86_prev = self.algo_helper.ma_last_prev(86)
        ma90_last, ma90_prev = self.algo_helper.ma_last_prev(90)
        ma99_last, ma99_prev = self.algo_helper.ma_last_prev(99)
        ma100_last, ma100_prev = self.algo_helper.ma_last_prev(100)
        ma110_last, ma110_prev = self.algo_helper.ma_last_prev(110)
        ma125_last, ma125_prev = self.algo_helper.ma_last_prev(125)
        ma130_last, ma130_prev = self.algo_helper.ma_last_prev(130)
        ma140_last, ma140_prev = self.algo_helper.ma_last_prev(140)
        ma150_last, ma150_prev = self.algo_helper.ma_last_prev(150)
        ma160_last, ma160_prev = self.algo_helper.ma_last_prev(160)
        ma180_last, ma180_prev = self.algo_helper.ma_last_prev(180)
        ma200_last, ma200_prev = self.algo_helper.ma_last_prev(200)
        ma225_last, ma225_prev = self.algo_helper.ma_last_prev(225)
        ma240_last, ma240_prev = self.algo_helper.ma_last_prev(240)
        ma250_last, ma250_prev = self.algo_helper.ma_last_prev(250)
        ma285_last, ma285_prev = self.algo_helper.ma_last_prev(285)
        ma300_last, ma300_prev = self.algo_helper.ma_last_prev(300)
        ma425_last, ma425_prev = self.algo_helper.ma_last_prev(425)
        ma450_last, ma450_prev = self.algo_helper.ma_last_prev(450)
        
        
        
        # moving average (2-3-4-5-7-8-20-43-100) di x minuti prima
        
        ma2_2_min_ago = self.algo_helper.ma_minutes_ago(2, 2)
        ma2_3_min_ago = self.algo_helper.ma_minutes_ago(2, 3)

        ma3_2_min_ago = self.algo_helper.ma_minutes_ago(3, 2)
        ma3_3_min_ago = self.algo_helper.ma_minutes_ago(3, 3)
        
        ma3_20_min_ago = self.algo_helper.ma_minutes_ago(3, 20)
        ma3_90_min_ago = self.algo_helper.ma_minutes_ago(3, 90)
        
        ma4_2_min_ago = self.algo_helper.ma_minutes_ago(4, 2)
        

        ma5_2_min_ago = self.algo_helper.ma_minutes_ago(5, 2)
        ma5_3_min_ago = self.algo_helper.ma_minutes_ago(5, 3)
        ma5_5_min_ago = self.algo_helper.ma_minutes_ago(5, 5)
        ma5_10_min_ago = self.algo_helper.ma_minutes_ago(5, 10)
        ma5_11_min_ago = self.algo_helper.ma_minutes_ago(5, 11)
        ma5_12_min_ago = self.algo_helper.ma_minutes_ago(5, 12)
        ma5_22_min_ago = self.algo_helper.ma_minutes_ago(5, 22)
        ma5_30_min_ago = self.algo_helper.ma_minutes_ago(5, 30)
        ma5_50_min_ago = self.algo_helper.ma_minutes_ago(5, 50)
        ma5_60_min_ago = self.algo_helper.ma_minutes_ago(5, 60)
        ma5_120_min_ago = self.algo_helper.ma_minutes_ago(5, 120)
        ma5_1080_min_ago = self.algo_helper.ma_minutes_ago(5, 1080)
        
        ma6_2_min_ago = self.algo_helper.ma_minutes_ago(6, 2)
        ma8_2_min_ago = self.algo_helper.ma_minutes_ago(8, 2)
        
        ma10_2_min_ago = self.algo_helper.ma_minutes_ago(10, 2)
        ma10_30_min_ago = self.algo_helper.ma_minutes_ago(10, 30)
        ma10_300_min_ago = self.algo_helper.ma_minutes_ago(10, 300)

        ma13_2_min_ago = self.algo_helper.ma_minutes_ago(13, 2)
        ma13_10_min_ago = self.algo_helper.ma_minutes_ago(13, 10)
        ma18_2_min_ago = self.algo_helper.ma_minutes_ago(18, 2)
        ma18_10_min_ago = self.algo_helper.ma_minutes_ago(18, 10)
        ma18_30_min_ago = self.algo_helper.ma_minutes_ago(18, 30)

        ma20_2_min_ago = self.algo_helper.ma_minutes_ago(20, 2)
        ma20_10_min_ago = self.algo_helper.ma_minutes_ago(20, 10)
        ma20_22_min_ago = self.algo_helper.ma_minutes_ago(20, 22)
        ma20_30_min_ago = self.algo_helper.ma_minutes_ago(20, 30)
        ma20_60_min_ago = self.algo_helper.ma_minutes_ago(20, 60)
        ma25_2_min_ago = self.algo_helper.ma_minutes_ago(25, 2)
        ma25_10_min_ago = self.algo_helper.ma_minutes_ago(25, 10)
        ma25_30_min_ago = self.algo_helper.ma_minutes_ago(25, 30)
        ma25_45_min_ago = self.algo_helper.ma_minutes_ago(25, 45)
        ma25_60_min_ago = self.algo_helper.ma_minutes_ago(25, 60)
        ma28_2_min_ago = self.algo_helper.ma_minutes_ago(28, 2)
        ma28_10_min_ago = self.algo_helper.ma_minutes_ago(28, 10)
        ma28_20_min_ago = self.algo_helper.ma_minutes_ago(28, 20)
        ma28_30_min_ago = self.algo_helper.ma_minutes_ago(28, 30)

        ma30_2_min_ago = self.algo_helper.ma_minutes_ago(30, 2)
        ma30_10_min_ago = self.algo_helper.ma_minutes_ago(30, 10)
        ma30_20_min_ago = self.algo_helper.ma_minutes_ago(30, 20)
        ma30_30_min_ago = self.algo_helper.ma_minutes_ago(30, 30)
        ma30_40_min_ago = self.algo_helper.ma_minutes_ago(30, 40)
        ma33_3_min_ago = self.algo_helper.ma_minutes_ago(33, 3)
        ma36_2_min_ago = self.algo_helper.ma_minutes_ago(36, 2)
        ma39_2_min_ago = self.algo_helper.ma_minutes_ago(39, 2)
        ma39_5_min_ago = self.algo_helper.ma_minutes_ago(39, 5)
        ma39_10_min_ago = self.algo_helper.ma_minutes_ago(39, 10)
        ma39_13_min_ago = self.algo_helper.ma_minutes_ago(39, 13)
        ma39_15_min_ago = self.algo_helper.ma_minutes_ago(39, 15)
        ma39_20_min_ago = self.algo_helper.ma_minutes_ago(39, 20)
        ma39_30_min_ago = self.algo_helper.ma_minutes_ago(39, 30)
        ma39_70_min_ago = self.algo_helper.ma_minutes_ago(39, 70)
        ma39_120_min_ago = self.algo_helper.ma_minutes_ago(39, 120)
        ma39_180_min_ago = self.algo_helper.ma_minutes_ago(39, 180)
        
        ma40_30_min_ago = self.algo_helper.ma_minutes_ago(40, 30)
        
        ma50_2_min_ago = self.algo_helper.ma_minutes_ago(50, 2)
        ma50_3_min_ago = self.algo_helper.ma_minutes_ago(50, 3)
        ma50_10_min_ago = self.algo_helper.ma_minutes_ago(50, 10)
        ma50_30_min_ago = self.algo_helper.ma_minutes_ago(50, 30)
        ma50_50_min_ago = self.algo_helper.ma_minutes_ago(50, 50)
        ma50_60_min_ago = self.algo_helper.ma_minutes_ago(50, 60)
        ma50_90_min_ago = self.algo_helper.ma_minutes_ago(50, 90)
        ma54_15_min_ago = self.algo_helper.ma_minutes_ago(54, 15)
        ma59_2_min_ago = self.algo_helper.ma_minutes_ago(59, 2)
        ma59_30_min_ago = self.algo_helper.ma_minutes_ago(59, 30)
        ma59_60_min_ago = self.algo_helper.ma_minutes_ago(59, 60)
        
        
        ma69_2_min_ago = self.algo_helper.ma_minutes_ago(69, 2)
        ma69_15_min_ago = self.algo_helper.ma_minutes_ago(69, 15)
        
        
        ma72_2_min_ago = self.algo_helper.ma_minutes_ago(72, 2)
        ma78_2_min_ago = self.algo_helper.ma_minutes_ago(78, 2)
        ma78_20_min_ago = self.algo_helper.ma_minutes_ago(78, 20)
        ma78_30_min_ago = self.algo_helper.ma_minutes_ago(78, 30)
        ma78_60_min_ago = self.algo_helper.ma_minutes_ago(78, 60)
        
        ma78_70_min_ago = self.algo_helper.ma_minutes_ago(78, 70)
        ma78_120_min_ago = self.algo_helper.ma_minutes_ago(78, 120)
        ma78_240_min_ago = self.algo_helper.ma_minutes_ago(78, 240)
        ma78_600_min_ago = self.algo_helper.ma_minutes_ago(78, 600)
        
        ma100_2_min_ago = self.algo_helper.ma_minutes_ago(100, 2)
        ma100_3_min_ago = self.algo_helper.ma_minutes_ago(100, 3)
        ma100_5_min_ago = self.algo_helper.ma_minutes_ago(100, 5)
        ma100_10_min_ago = self.algo_helper.ma_minutes_ago(100, 10)
        
        ma100_30_min_ago = self.algo_helper.ma_minutes_ago(100, 30)
        
        ma100_50_min_ago = self.algo_helper.ma_minutes_ago(100, 50)
        ma100_65_min_ago = self.algo_helper.ma_minutes_ago(100, 65)
        ma100_60_min_ago = self.algo_helper.ma_minutes_ago(100, 60)
        ma100_90_min_ago = self.algo_helper.ma_minutes_ago(100, 90)
        ma100_120_min_ago = self.algo_helper.ma_minutes_ago(100, 120)
        ma100_180_min_ago = self.algo_helper.ma_minutes_ago(100, 180)
        ma100_300_min_ago = self.algo_helper.ma_minutes_ago(100, 300)
        ma100_301_min_ago = self.algo_helper.ma_minutes_ago(100, 301)

        ma150_20_min_ago = self.algo_helper.ma_minutes_ago(150, 20)
        ma150_60_min_ago = self.algo_helper.ma_minutes_ago(150, 60)

        ma200_15_min_ago = self.algo_helper.ma_minutes_ago(200, 15)
        ma200_20_min_ago = self.algo_helper.ma_minutes_ago(200, 20)
        ma200_30_min_ago = self.algo_helper.ma_minutes_ago(200, 30)
        ma200_60_min_ago = self.algo_helper.ma_minutes_ago(200, 60)
        ma200_90_min_ago = self.algo_helper.ma_minutes_ago(200, 90)
        ma200_120_min_ago = self.algo_helper.ma_minutes_ago(200, 120)
        ma200_120_min_ago = self.algo_helper.ma_minutes_ago(200, 120)
        ma200_180_min_ago = self.algo_helper.ma_minutes_ago(200, 180)
        ma200_301_min_ago = self.algo_helper.ma_minutes_ago(200, 301)
        ma200_360_min_ago = self.algo_helper.ma_minutes_ago(200, 360)

        ma225_60_min_ago = self.algo_helper.ma_minutes_ago(225, 60)
        ma250_60_min_ago = self.algo_helper.ma_minutes_ago(250, 60)

        ma300_2_min_ago = self.algo_helper.ma_minutes_ago(300, 2)
        ma300_10_min_ago = self.algo_helper.ma_minutes_ago(300, 10)
        ma300_20_min_ago = self.algo_helper.ma_minutes_ago(300, 20)
        
        ma300_30_min_ago = self.algo_helper.ma_minutes_ago(300, 30)
        ma300_45_min_ago = self.algo_helper.ma_minutes_ago(300, 45)
        ma300_50_min_ago = self.algo_helper.ma_minutes_ago(300, 50)
        ma300_60_min_ago = self.algo_helper.ma_minutes_ago(300, 60)
        ma300_120_min_ago = self.algo_helper.ma_minutes_ago(300, 120)
        ma300_180_min_ago = self.algo_helper.ma_minutes_ago(300, 180)
        
        ma300_300_min_ago = self.algo_helper.ma_minutes_ago(300, 300)
        ma300_301_min_ago = self.algo_helper.ma_minutes_ago(300, 301)
        ma300_360_min_ago = self.algo_helper.ma_minutes_ago(300, 360)
        ma300_480_min_ago = self.algo_helper.ma_minutes_ago(300, 480)
        ma300_720_min_ago = self.algo_helper.ma_minutes_ago(300, 720)

        ma450_10_min_ago = self.algo_helper.ma_minutes_ago(450, 10)
        ma450_60_min_ago = self.algo_helper.ma_minutes_ago(450, 60)
        ma450_90_min_ago = self.algo_helper.ma_minutes_ago(450, 90)
        ma450_120_min_ago = self.algo_helper.ma_minutes_ago(450, 120)
        ma450_180_min_ago = self.algo_helper.ma_minutes_ago(450, 180)
        ma450_240_min_ago = self.algo_helper.ma_minutes_ago(450, 240)
        ma450_300_min_ago = self.algo_helper.ma_minutes_ago(450, 300)
        ma450_360_min_ago = self.algo_helper.ma_minutes_ago(450, 360)
        ma450_480_min_ago = self.algo_helper.ma_minutes_ago(450, 480)
        ma450_720_min_ago = self.algo_helper.ma_minutes_ago(450, 720)
        

        # PREZZO
        
        price = self.algo_helper.price

        
        
        # viaggio in italia del compare mio !
      
        # MACD di x min ago
        
        macd = self.algo_helper.macd
        macd_2_min_ago = self.algo_helper.macd_minutes_ago(2)
        macd_3_min_ago = self.algo_helper.macd_minutes_ago(3)
        macd_5_min_ago = self.algo_helper.macd_minutes_ago(5)



        # rsi

        # rsi = self.algo_helper.rsi
        # rsi_2_min_ago = self.algo_helper.rsi_minutes_ago(2)






        # ADX

        # adx = self.algo_helper.adx
        

        ################################################################################################# CONFORTABLY NUMB
        
        # formula DEVIATION_ma2_sopra_o_sotto_ma2_2_min_ago !
        
        deviation_ma2_sopra_o_sotto_ma2_2_min_ago = (ma2_last / ma2_2_min_ago - 1) * 100 if ma2_2_min_ago else 0
        self.algo_helper.info("deviation_ma2_sopra_o_sotto_ma2_2_min_ago: {}".format(deviation_ma2_sopra_o_sotto_ma2_2_min_ago))
      

        # formula DEVIATION_ma2_sopra_o_sotto_ma5 !
        
        deviation_ma2_sopra_o_sotto_ma5 = (ma2_last / ma5_last - 1) * 100 if ma5_last else 0
        self.algo_helper.info("deviation_ma2_sopra_o_sotto_ma5: {}".format(deviation_ma2_sopra_o_sotto_ma5))

        
        # formula ma2_differenza di 2 min ago
        
        ma2_differenza_2_min_ago = (ma2_last - ma2_2_min_ago)
        self.algo_helper.info("ma2_differenza_2_min_ago: {}".format(ma2_differenza_2_min_ago))


        # formula ma3_differenza di 2 min ago
        
        ma3_differenza_2_min_ago = (ma3_last - ma3_2_min_ago)
        self.algo_helper.info("ma3_differenza_2_min_ago: {}".format(ma3_differenza_2_min_ago))

      
        # formula ma5_differenza di 2 min ago
        
        ma5_differenza_2_min_ago = (ma5_last - ma5_2_min_ago)
        self.algo_helper.info("ma5_differenza_2_min_ago: {}".format(ma5_differenza_2_min_ago))

      

        # formula differenza ma2 - ma4
        
        ma2_differenza_ma4 = (ma2_last - ma4_last)
        self.algo_helper.info("ma2_differenza_ma4: {}".format(ma2_differenza_ma4))

      
        # formula differenza ma2 - ma5
        
        ma2_differenza_ma5 = (ma2_last - ma5_last)
        self.algo_helper.info("ma2_differenza_ma5: {}".format(ma2_differenza_ma5))

        
      

        # formula differenza ma2 - ma8
        
        ma2_differenza_ma8 = (ma2_last - ma8_last)
        self.algo_helper.info("ma2_differenza_ma8: {}".format(ma2_differenza_ma8))

        
        # formula differenza ma50 - ma59
        
        ma50_differenza_ma59 = (ma50_last - ma59_last)
        self.algo_helper.info("ma50_differenza_ma59: {}".format(ma50_differenza_ma59))
      

        # formula macd_differenza di 2 min ago
        
        macd_differenza_2_min_ago = (macd - macd_2_min_ago)
        self.algo_helper.info("macd_differenza_2_min_ago: {}".format(macd_differenza_2_min_ago))

      
        # formula macd_differenza di 3 min ago
        
        macd_differenza_3_min_ago = (macd - macd_3_min_ago)
        self.algo_helper.info("macd_differenza_3_min_ago: {}".format(macd_differenza_3_min_ago))



      
        # formula macd_differenza di 5 min ago
        
        macd_differenza_5_min_ago = (macd - macd_5_min_ago)
        self.algo_helper.info("macd_differenza_5_min_ago: {}".format(macd_differenza_5_min_ago))


      
        
      
        # LAST TRADE
        
        last_trade_action = self.algo_helper.last_trade_action
        last_trade_price = self.algo_helper.last_trade_price
        seconds_since_last_trade = self.algo_helper.seconds_since_last_trade

      

        # PREV TRADE
        
        # prev_trade_action = self.algo_helper.prev_trade_action
        # prev_trade_time = self.algo_helper.prev_trade_time
        # prev_trade_price = self.algo_helper.prev_trade_price
        # seconds_since_prev_trade = self.algo_helper.seconds_since_prev_trade
        
        # queste condizioni non le sto usando - grazie compa

        

        # PREZZO DI ADESSO (di mercato) - CURRENT PRICE
        
        price = self.algo_helper.price
        

        # PREZZO di X MINUTI FA (di mercato)
        
        price_2_min_ago = self.algo_helper.price_minutes_ago(2)
        price_10_min_ago = self.algo_helper.price_minutes_ago(10)
        
        
        

        ###################################################################################################################### TEMPO
        
        # SELL dolce atttesa
        # BUY con il passare del tempo
        
        # SELL 1 FIAT
        # SELL 1 AUDI
        # SELL 1 MASERATI
        # SELL 1 FERRARI
        
        # VENDE DOPO x SECONDI - ro cano torna a casa - (ma c'e' anche un "e se")
        # esempio : 4 minuti * 60 = 240 + 30 secondi = 270 secondi
        
        #####################################################################################################################
        
        # vedi SELL dolce attesa
        
        max_hold_time_in_seconds = 255


        # vedi SELL PAPA GPII E PAPA RATZINGER
        
        max_hold_time_in_seconds_papa = 300
        
        
        # vedi BUY 2 con il passare del tempo
        
        max_hold_time_in_seconds_nuova = 7200
        
        
        
        
        # SELL DOPO 9000 secondi = 150 min dal BUY con 5-90 cazzo
        
        max_hold_time_in_seconds_sell_5_90 = 9000
        
        
        
        # SELL DOPO 14400 secondi = 240 min dal BUY con 5-180 cazzo
        
        max_hold_time_in_seconds_sell_5_180 = 14400
        
        
        ###############################################################################################################################
        
        # vedi DELTA BUY 2 DAL SELL 1  > 2 minuti = 120 secondi
        
        max_hold_time_in_seconds_delta_buy2_sell1 = 120
        
        
        ###############################################################################################################################
        ###############################################################################################################################

        ################################################################################################### FORMULE  D E V I A T I O N  !
        

        # formula DEVIATION_1_gabbia
        
        deviation_1_gabbia = (ma8_last / ma50_last - 1) * 100 if ma50_last else 0
        self.algo_helper.info("deviation_1_gabbia: {}".format(deviation_1_gabbia))


        ######################################## formula DEVIATION_buy per comprare UN PO' PIU' SOPRA DEL LAST TRADE ( l' ultimo SELL )
        
        deviation_buy = (ma2_last / last_trade_price - 1) * 100 if last_trade_price else 0
        self.algo_helper.info("deviation_buy: {}".format(deviation_buy))
        
        
        # formula DELTA_buy2 per la compra 2
        
        delta_buy2_dal_sell1 = (ma3_last / last_trade_price - 1) * 100 if last_trade_price else 0
        self.algo_helper.info("delta_buy2_dal_sell1: {}".format(delta_buy2_dal_sell1))
        

        ##############################################################################################################################


        # formula deviation
        
        deviation = (ma5_last / last_trade_price - 1) * 100 if last_trade_price else 0
        self.algo_helper.info("deviation: {}".format(deviation))
        
        # formula DEVIATION_sell
        
        deviation_sell = (ma4_last / last_trade_price - 1) * 100 if last_trade_price else 0
        self.algo_helper.info("deviation_sell: {}".format(deviation_sell))


        
        # formula DEVIATION_ma3_sopra_ma28
        
        deviation_ma3_sopra_ma28 = (ma3_last / ma28_last - 1) * 100 if ma28_last else 0
        self.algo_helper.info("deviation_ma3_sopra_ma28: {}".format(deviation_ma3_sopra_ma28))


        # formula DEVIATION_ma4_sopra_ma28
        
        deviation_ma4_sopra_ma28 = (ma4_last / ma28_last - 1) * 100 if ma28_last else 0
        self.algo_helper.info("deviation_ma4_sopra_ma28: {}".format(deviation_ma4_sopra_ma28))

        # formula DEVIATION_ma5_sopra_ma28
        
        deviation_ma5_sopra_ma28 = (ma5_last / ma28_last - 1) * 100 if ma28_last else 0
        self.algo_helper.info("deviation_ma5_sopra_ma28: {}".format(deviation_ma5_sopra_ma28))



        # formula DEVIATION_ma3_sotto_ma50 - FORMULA AUREA !
        
        deviation_ma3_sotto_ma50 = (ma3_last / ma50_last - 1) * 100 if ma50_last else 0
        self.algo_helper.info("deviation_ma3_sotto_ma50: {}".format(deviation_ma3_sotto_ma50))

        
        
        # formula deviation_ma20_sotto_ma50
        
        deviation_ma20_sotto_ma50 = (ma20_last / ma50_last - 1) * 100 if ma50_last else 0
        self.algo_helper.info("deviation_ma20_sotto_ma50: {}".format(deviation_ma20_sotto_ma50))




        # formula DEVIATION_ma78_sopra_o_sotto_ma200 !
        
        deviation_ma78_sopra_o_sotto_ma200 = (ma78_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma78_sopra_o_sotto_ma200: {}".format(deviation_ma78_sopra_o_sotto_ma200))
      

        # formula DEVIATION_ma5_sotto_ma450
        
        deviation_ma5_sotto_ma450 = (ma5_last / ma450_last - 1) * 100 if ma450_last else 0
        self.algo_helper.info("deviation_ma5_sotto_ma450: {}".format(deviation_ma5_sotto_ma450))



        
        # formula DEVIATION_ma100_sopra_o_sotto_ma100_10_min_ago !
        
        deviation_ma100_sopra_o_sotto_ma100_10_min_ago = (ma100_last / ma100_10_min_ago - 1) * 100 if ma100_10_min_ago else 0
        self.algo_helper.info("deviation_ma100_sopra_o_sotto_ma100_10_min_ago: {}".format(deviation_ma100_sopra_o_sotto_ma100_10_min_ago))




        # formula DEVIATION_ma100_sopra_o_sotto_ma100_60_min_ago !
        
        deviation_ma100_sopra_o_sotto_ma100_60_min_ago = (ma100_last / ma100_60_min_ago - 1) * 100 if ma100_60_min_ago else 0
        self.algo_helper.info("deviation_ma100_sopra_o_sotto_ma100_60_min_ago: {}".format(deviation_ma100_sopra_o_sotto_ma100_60_min_ago))



        # formula DEVIATION_ma100_sopra_o_sotto_ma100_300_min_ago !
        
        deviation_ma100_sopra_o_sotto_ma100_300_min_ago = (ma100_last / ma100_300_min_ago - 1) * 100 if ma100_300_min_ago else 0
        self.algo_helper.info("deviation_ma100_sopra_o_sotto_ma100_300_min_ago: {}".format(deviation_ma100_sopra_o_sotto_ma100_300_min_ago))



        
        # formula DEVIATION_ma10_sopra_o_sotto_ma10_30_min_ago !
        
        deviation_ma10_sopra_o_sotto_ma10_30_min_ago = (ma10_last / ma10_30_min_ago - 1) * 100 if ma10_30_min_ago else 0
        self.algo_helper.info("deviation_ma10_sopra_o_sotto_ma10_30_min_ago: {}".format(deviation_ma10_sopra_o_sotto_ma10_30_min_ago))



        # formula DEVIATION_ma25_sopra_o_sotto_ma25_10_min_ago !
        
        deviation_ma25_sopra_o_sotto_ma25_10_min_ago = (ma25_last / ma25_10_min_ago - 1) * 100 if ma25_10_min_ago else 0
        self.algo_helper.info("deviation_ma25_sopra_o_sotto_ma25_10_min_ago: {}".format(deviation_ma25_sopra_o_sotto_ma25_10_min_ago))



        # formula DEVIATION_ma50_sopra_o_sotto_ma50_90_min_ago
        
        deviation_ma50_sopra_o_sotto_ma50_90_min_ago = (ma50_last / ma50_90_min_ago - 1) * 100 if ma50_90_min_ago else 0
        self.algo_helper.info("deviation_ma50_sopra_o_sotto_ma50_90_min_ago: {}".format(deviation_ma50_sopra_o_sotto_ma50_90_min_ago))


        # formula DEVIATION_ma5_sopra_o_sotto_ma5_30_min_ago
        
        deviation_ma5_sopra_o_sotto_ma5_30_min_ago = (ma5_last / ma5_30_min_ago - 1) * 100 if ma5_30_min_ago else 0
        self.algo_helper.info("deviation_ma5_sopra_o_sotto_ma5_30_min_ago: {}".format(deviation_ma5_sopra_o_sotto_ma5_30_min_ago))


        # formula DEVIATION_ma5_sopra_o_sotto_ma5_50_min_ago
        
        deviation_ma5_sopra_o_sotto_ma5_50_min_ago = (ma5_last / ma5_50_min_ago - 1) * 100 if ma5_50_min_ago else 0
        self.algo_helper.info("deviation_ma5_sopra_o_sotto_ma5_50_min_ago: {}".format(deviation_ma5_sopra_o_sotto_ma5_50_min_ago))

        # formula DEVIATION_ma5_sopra_o_sotto_ma5_60_min_ago
        
        deviation_ma5_sopra_o_sotto_ma5_60_min_ago = (ma5_last / ma5_60_min_ago - 1) * 100 if ma5_60_min_ago else 0
        self.algo_helper.info("deviation_ma5_sopra_o_sotto_ma5_60_min_ago: {}".format(deviation_ma5_sopra_o_sotto_ma5_60_min_ago))


        # formula DEVIATION_ma5_sopra_o_sotto_ma5_120_min_ago
        
        deviation_ma5_sopra_o_sotto_ma5_120_min_ago = (ma5_last / ma5_120_min_ago - 1) * 100 if ma5_120_min_ago else 0
        self.algo_helper.info("deviation_ma5_sopra_o_sotto_ma5_120_min_ago: {}".format(deviation_ma5_sopra_o_sotto_ma5_120_min_ago))

        
        # formula DEVIATION_ma5_sopra_o_sotto_ma5_1080_min_ago - !
        
        deviation_ma5_sopra_o_sotto_ma5_1080_min_ago = (ma5_last / ma5_1080_min_ago - 1) * 100 if ma5_1080_min_ago else 0
        self.algo_helper.info("deviation_ma5_sopra_o_sotto_ma5_1080_min_ago: {}".format(deviation_ma5_sopra_o_sotto_ma5_1080_min_ago))



        # formula DEVIATION_ma78_sopra_o_sotto_ma78_240_min_ago - !
        
        deviation_ma78_sopra_o_sotto_ma78_240_min_ago = (ma78_last / ma78_240_min_ago - 1) * 100 if ma78_240_min_ago else 0
        self.algo_helper.info("deviation_ma78_sopra_o_sotto_ma78_240_min_ago: {}".format(deviation_ma78_sopra_o_sotto_ma78_240_min_ago))

        

        
        # formula DEVIATION_ma78_sopra_o_sotto_ma78_30_min_ago - !
        
        deviation_ma78_sopra_o_sotto_ma78_30_min_ago = (ma78_last / ma78_30_min_ago - 1) * 100 if ma78_30_min_ago else 0
        self.algo_helper.info("deviation_ma78_sopra_o_sotto_ma78_30_min_ago: {}".format(deviation_ma78_sopra_o_sotto_ma78_30_min_ago))

        
        # formula DEVIATION_ma78_sopra_o_sotto_ma78_600_min_ago - !
        
        deviation_ma78_sopra_o_sotto_ma78_600_min_ago = (ma78_last / ma78_600_min_ago - 1) * 100 if ma78_600_min_ago else 0
        self.algo_helper.info("deviation_ma78_sopra_o_sotto_ma78_600_min_ago: {}".format(deviation_ma78_sopra_o_sotto_ma78_600_min_ago))






        # formula DEVIATION_ma3_sopra_o_sotto_ma99 !
        
        deviation_ma3_sopra_o_sotto_ma99 = (ma3_last / ma99_last - 1) * 100 if ma99_last else 0
        self.algo_helper.info("deviation_ma3_sopra_o_sotto_ma99: {}".format(deviation_ma3_sopra_o_sotto_ma99))



        # formula DEVIATION_ma5_sopra_o_sotto_ma100 !
        
        deviation_ma5_sopra_o_sotto_ma100 = (ma5_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma5_sopra_o_sotto_ma100: {}".format(deviation_ma5_sopra_o_sotto_ma100))


        # formula DEVIATION_ma11_sopra_o_sotto_ma300 !
        
        deviation_ma11_sopra_o_sotto_ma300 = (ma11_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma11_sopra_o_sotto_ma300: {}".format(deviation_ma11_sopra_o_sotto_ma300))



        # formula DEVIATION_ma50_sopra_o_sotto_ma100 !
        
        deviation_ma50_sopra_o_sotto_ma100 = (ma50_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma50_sopra_o_sotto_ma100: {}".format(deviation_ma50_sopra_o_sotto_ma100))


        # formula DEVIATION_ma50_sopra_o_sotto_ma300 !
        
        deviation_ma50_sopra_o_sotto_ma300 = (ma50_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma50_sopra_o_sotto_ma300: {}".format(deviation_ma50_sopra_o_sotto_ma300))


      
        # formula DEVIATION_ma54_sopra_o_sotto_ma72 !
        
        deviation_ma54_sopra_o_sotto_ma72 = (ma54_last / ma72_last - 1) * 100 if ma72_last else 0
        self.algo_helper.info("deviation_ma54_sopra_o_sotto_ma72: {}".format(deviation_ma54_sopra_o_sotto_ma72))
        
        
        
        # formula DEVIATION_ma10_sotto_ma100 - FORMULA dna !
        
        deviation_ma10_sotto_ma100 = (ma10_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma10_sotto_ma100: {}".format(deviation_ma10_sotto_ma100))



        
        # formula DEVIATION_ma39_sotto_ma100 - FORMULA circello!
        
        deviation_ma39_sotto_ma100 = (ma39_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma39_sotto_ma100: {}".format(deviation_ma39_sotto_ma100))



        # formula DEVIATION_ma50_sotto_ma100 
        
        deviation_ma50_sotto_ma100 = (ma50_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma50_sotto_ma100: {}".format(deviation_ma50_sotto_ma100))







        # formula DEVIATION_ma25_sotto_ma200
        
        deviation_ma25_sotto_ma200 = (ma25_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma25_sotto_ma200: {}".format(deviation_ma25_sotto_ma200))



        # formula DEVIATION_ma39_sotto_ma200 - FORMULA cv!
        
        deviation_ma39_sotto_ma200 = (ma39_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma39_sotto_ma200: {}".format(deviation_ma39_sotto_ma200))
        
        
        
        # formula DEVIATION_ma10_sopra_ma200 - FORMULA MY COMPA !
        
        deviation_ma10_sopra_ma200 = (ma10_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma10_sopra_ma200: {}".format(deviation_ma10_sopra_ma200))
        
        
        # formula DEVIATION_ma5_sopra_ma200
        
        deviation_ma5_sopra_ma200 = (ma5_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma5_sopra_ma200: {}".format(deviation_ma5_sopra_ma200))
        
        
        
        
        # formula DEVIATION_ma54_sopra_ma100 - FORMULA "quello che non" !
        
        deviation_ma54_sopra_ma100 = (ma54_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma54_sopra_ma100: {}".format(deviation_ma54_sopra_ma100))
        
        
        
        # formula DEVIATION_ma5_sopra_ma59 - PENSIERO LATERALE 1
        
        deviation_ma5_sopra_ma59 = (ma5_last / ma59_last - 1) * 100 if ma59_last else 0
        self.algo_helper.info("deviation_ma5_sopra_ma59: {}".format(deviation_ma5_sopra_ma59))
        
        
        
        
        # formula DEVIATION_ma20_sotto_ma59 - PENSIERO LATERALE 2
        
        deviation_ma20_sotto_ma59 = (ma20_last / ma59_last - 1) * 100 if ma59_last else 0
        self.algo_helper.info("deviation_ma20_sotto_ma59: {}".format(deviation_ma20_sotto_ma59))
        
        
        
        # formula deviation_ma100_sopra_ma450

        deviation_ma100_sopra_ma450 = (ma100_last / ma450_last - 1) * 100 if ma450_last else 0
        self.algo_helper.info("deviation_ma100_sopra_ma450: {}".format(deviation_ma100_sopra_ma450))
        
        
        
        # formula DEVIATION_ma300_sopra_ma450 
        
        deviation_ma300_sopra_ma450 = (ma300_last / ma450_last - 1) * 100 if ma450_last else 0
        self.algo_helper.info("deviation_ma300_sopra_ma450: {}".format(deviation_ma300_sopra_ma450))
        
        
        
        # formula DEVIATION_ma59_sopra_ma300 -
        
        deviation_ma59_sopra_ma300 = (ma59_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma59_sopra_ma300: {}".format(deviation_ma59_sopra_ma300))
        
        
        
        # formula DEVIATION_CALLAS - MARIA CALLAS !
        
        deviation_callas = (ma5_last / ma54_last - 1) * 100 if ma54_last else 0
        self.algo_helper.info("deviation_callas: {}".format(deviation_callas))
        
        
        # formula DEVIATION_ma250_sopra_ma300
        
        deviation_ma250_sopra_ma300 = (ma250_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma250_sopra_ma300: {}".format(deviation_ma250_sopra_ma300))
        
        
        # formula DEVIATION_ma3_sopra_ma16
        
        deviation_ma3_sopra_ma16 = (ma3_last / ma16_last - 1) * 100 if ma16_last else 0
        self.algo_helper.info("deviation_ma3_sopra_ma16: {}".format(deviation_ma3_sopra_ma16))
        
        
        # formula DEVIATION_ma3_sopra_ma18
        
        deviation_ma3_sopra_ma18 = (ma3_last / ma18_last - 1) * 100 if ma18_last else 0
        self.algo_helper.info("deviation_ma3_sopra_ma18: {}".format(deviation_ma3_sopra_ma18))
        
        # formula DEVIATION_ma3_sopra_ma30
        
        deviation_ma3_sopra_ma30 = (ma3_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_ma3_sopra_ma30: {}".format(deviation_ma3_sopra_ma30))
        
        
        # formula DEVIATION_ma180_sopra_ma200
        
        deviation_ma180_sopra_ma200 = (ma180_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma180_sopra_ma200: {}".format(deviation_ma180_sopra_ma200))
        
        
        ####################################################                                      F O R M U L E    D E L T A
        

        # formula delta_100_200_last
        
        delta_100_200_last = (ma200_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("delta_100_200_last: {}".format(delta_100_200_last))


        # formula delta_100_200_120_min_ago
        
        delta_100_200_120_min_ago = (ma200_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("delta_100_200_120_min_ago: {}".format(delta_100_200_120_min_ago))
        
        # se GIORNO cieo' se la 100 si avvicina alla 200 deve essere delta_100_200_last < delta_100_200_120_min_ago
        








        # formula delta CM
        # deve essere GIORNO
        # delta_CM_300_25_last < delta_CM_300_25_2_min_ago


        # formula delta_CM_300_25_last
        
        delta_CM_300_25_last = (ma300_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("delta_CM_300_25_last: {}".format(delta_CM_300_25_last))
        
        

        # formula delta_CM_300_225_2_min_ago
        
        delta_CM_300_25_2_min_ago = (ma300_2_min_ago / ma25_2_min_ago - 1) * 100 if ma25_2_min_ago else 0
        self.algo_helper.info("delta_CM_300_25_2_min_ago: {}".format(delta_CM_300_25_2_min_ago))




        # formula delta CV
        # QUANDO E' NOTTE
        # delta_CV_300_25_last > delta_CV_300_25_45_min_ago

        # formula delta_CV_300_25_last
        
        delta_CV_300_25_last = (ma300_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("delta_CV_300_25_last: {}".format(delta_CV_300_25_last))
        
        

        # formula delta_CV_300_225_45_min_ago
        
        delta_CV_300_25_45_min_ago = (ma300_45_min_ago / ma25_45_min_ago - 1) * 100 if ma25_45_min_ago else 0
        self.algo_helper.info("delta_CV_300_25_45_min_ago: {}".format(delta_CV_300_25_45_min_ago))












        # formula delta_1
        
        delta_1 = (ma200_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("delta_1: {}".format(delta_1))
        
        
        # formula delta_2
        
        delta_2 = (ma200_60_min_ago / ma100_60_min_ago - 1) * 100 if ma100_60_min_ago else 0
        self.algo_helper.info("delta_2: {}".format(delta_2))
        
        
        # delta_1 < delta_2 GIORNO !




        # formula delta_DNA_curva_verso_il_basso dopo un lungo rialzo !
        # se GIORNO ok cosi'
        # se NOTTE osso 3-50
        # delta_DNA_1 < delta_DNA_2 GIORNO !
        # delta_DNA_1 > delta_DNA_2 NOTTE !

        # formula delta_DNA_1
        
        delta_DNA_1 = (ma250_last / ma150_last - 1) * 100 if ma150_last else 0
        self.algo_helper.info("delta_DNA_1: {}".format(delta_DNA_1))
        
        
        # formula delta_DNA_2
        
        delta_DNA_2 = (ma250_60_min_ago / ma150_60_min_ago - 1) * 100 if ma150_60_min_ago else 0
        self.algo_helper.info("delta_DNA_2: {}".format(delta_DNA_2))
        
        
        # delta_DNA_1 < delta_DNA_2 GIORNO !
        # delta_DNA_1 > delta_DNA_2 NOTTE !




        # formula delta_GPII_1
        
        delta_GPII_1 = (ma100_last / ma50_last - 1) * 100 if ma50_last else 0
        self.algo_helper.info("delta_GPII_1: {}".format(delta_GPII_1))
        
        
        # formula delta_GPII_2
        
        delta_GPII_2 = (ma100_10_min_ago / ma50_10_min_ago - 1) * 100 if ma50_10_min_ago else 0
        self.algo_helper.info("delta_GPII_2: {}".format(delta_GPII_2))
        
        
        # delta_GPII_1 < delta_GPII_2 GIORNO !
        # delta_GPII_1 > delta_GPII_2 NOTTE !



        # formula delta_MC_1
        
        delta_MC_1 = (ma100_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("delta_MC_1: {}".format(delta_MC_1))
        
        
        # formula delta_MC_2
        
        delta_MC_2 = (ma100_10_min_ago / ma25_10_min_ago - 1) * 100 if ma25_10_min_ago else 0
        self.algo_helper.info("delta_MC_2: {}".format(delta_MC_2))
        
        
        # delta_MC_1 < delta_MC_2 GIORNO !
        # delta_MC_1 > delta_MC_2 NOTTE !


        





        # formula delta_x
        
        delta_x = (ma200_last / ma59_last - 1) * 100 if ma59_last else 0
        self.algo_helper.info("delta_x: {}".format(delta_x))
        
        
        # formula delta_y
        
        delta_y = (ma200_60_min_ago / ma59_60_min_ago - 1) * 100 if ma59_60_min_ago else 0
        self.algo_helper.info("delta_y: {}".format(delta_y))
        
        
        # formula rapporto_delta_1_delta_2
        
        rapporto_delta_1_delta_2 = (delta_1 / delta_2) if delta_2 else 0
        self.algo_helper.info("rapporto_delta_1_delta_2: {}".format(rapporto_delta_1_delta_2))


        
        # formula delta_300_100
        
        delta_300_100 = (ma300_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("delta_300_100: {}".format(delta_300_100))


        # formula delta_300_100_30_min
        
        delta_300_100_30_min = (ma300_30_min_ago / ma100_30_min_ago - 1) * 100 if ma100_30_min_ago else 0
        self.algo_helper.info("delta_300_100_30_min: {}".format(delta_300_100_30_min))





        # formula delta_300_100_60_min
        
        delta_300_100_60_min = (ma300_60_min_ago / ma100_60_min_ago - 1) * 100 if ma100_60_min_ago else 0
        self.algo_helper.info("delta_300_100_60_min: {}".format(delta_300_100_60_min))


        # formula delta_300_100_120_min
        
        delta_300_100_120_min = (ma300_120_min_ago / ma100_120_min_ago - 1) * 100 if ma100_120_min_ago else 0
        self.algo_helper.info("delta_300_100_120_min: {}".format(delta_300_100_120_min))


        # ESEMPIO and delta_300_100 < delta_300_100_120_min


        
        # formula delta_300_100_50_min
        
        delta_300_100_50_min = (ma300_50_min_ago / ma100_50_min_ago - 1) * 100 if ma100_50_min_ago else 0
        self.algo_helper.info("delta_300_100_50_min: {}".format(delta_300_100_50_min))
        
        
        
        
        



        # formula delta_450_200
        
        delta_450_200 = (ma450_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("delta_450_200: {}".format(delta_450_200))
        
        
        # formula delta_450_200_60_min
        
        delta_450_200_60_min = (ma450_60_min_ago / ma200_60_min_ago - 1) * 100 if ma200_60_min_ago else 0
        self.algo_helper.info("delta_450_200_60_min: {}".format(delta_450_200_60_min))

        # SE delta_450_200 < delta_450_200_60_min ..........GIORNO !




        # formula delta_300_200 
        
        delta_300_200 = (ma300_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("delta_300_200: {}".format(delta_300_200))
        
        
        # formula delta_300_200_30 min
        
        delta_300_200_30_min = (ma300_30_min_ago / ma200_30_min_ago - 1) * 100 if ma200_30_min_ago else 0
        self.algo_helper.info("delta_300_200_30_min: {}".format(delta_300_200_30_min))

        # SE delta_300_200 < delta_300_200_30_min ..........GIORNO !
        # SE delta_300_200 > delta_300_200_30_min ..........NOTTE !



        # formula delta_300_200
        
        delta_300_200 = (ma300_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("delta_300_200: {}".format(delta_300_200))
        
        
        # formula delta_300_200_60_min
        
        delta_300_200_60_min = (ma300_60_min_ago / ma200_60_min_ago - 1) * 100 if ma200_60_min_ago else 0
        self.algo_helper.info("delta_300_200_60_min: {}".format(delta_300_200_60_min))

        # SE delta_300_200 < delta_300_200_60_min ..........GIORNO !












        # formula delta_450_300
        
        delta_450_300 = (ma450_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("delta_450_300: {}".format(delta_450_300))
        
        
        # formula delta_450_300_60_min
        
        delta_450_300_60_min = (ma450_60_min_ago / ma300_60_min_ago - 1) * 100 if ma300_60_min_ago else 0
        self.algo_helper.info("delta_450_300_60_min: {}".format(delta_450_300_60_min))
        
        
        
        
        






        # formula delta_100_50
        
        delta_100_50 = (ma100_last / ma50_last - 1) * 100 if ma50_last else 0
        self.algo_helper.info("delta_100_50: {}".format(delta_100_50))

        
        # formula delta_100_50_30_min
        
        delta_100_50_30_min = (ma100_30_min_ago / ma50_30_min_ago - 1) * 100 if ma50_30_min_ago else 0
        self.algo_helper.info("delta_100_50_30_min: {}".format(delta_100_50_30_min))


        # and delta_100_50 > delta_100_50_30_min NOTTE !









        # formula delta_50_39
        
        delta_50_39 = (ma50_last / ma39_last - 1) * 100 if ma39_last else 0
        self.algo_helper.info("delta_50_39: {}".format(delta_50_39))

        
        # formula delta_50_39_30_min
        
        delta_50_39_30_min = (ma50_30_min_ago / ma39_30_min_ago - 1) * 100 if ma39_30_min_ago else 0
        self.algo_helper.info("delta_50_39_30_min: {}".format(delta_50_39_30_min))


        
        # formula delta_100_59
        
        delta_100_59 = (ma100_last / ma59_last - 1) * 100 if ma59_last else 0
        self.algo_helper.info("delta_100_59: {}".format(delta_100_59))

        
        # formula delta_100_59_30_min
        
        delta_100_59_30_min = (ma100_30_min_ago / ma59_30_min_ago - 1) * 100 if ma59_30_min_ago else 0
        self.algo_helper.info("delta_100_59_30_min: {}".format(delta_100_59_30_min))

        
        # formula delta_100_59_60_min
        
        delta_100_59_60_min = (ma100_60_min_ago / ma59_60_min_ago - 1) * 100 if ma59_60_min_ago else 0
        self.algo_helper.info("delta_100_59_60_min: {}".format(delta_100_59_60_min))






        
        
        
        
       
        # formula delta_300_225
        
        delta_300_225 = (ma300_last / ma225_last - 1) * 100 if ma225_last else 0
        self.algo_helper.info("delta_300_225: {}".format(delta_300_225))
        
        
        # formula delta_300_225_60_min
        
        delta_300_225_60_min = (ma300_60_min_ago / ma225_60_min_ago - 1) * 100 if ma225_60_min_ago else 0
        self.algo_helper.info("delta_300_225_60_min: {}".format(delta_300_225_60_min))
        
        
        
        
        # formula delta_150_100
        
        delta_150_100 = (ma150_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("delta_150_100: {}".format(delta_150_100))
        
        
        # formula delta_150_100_60_min
        
        delta_150_100_60_min = (ma150_60_min_ago / ma100_60_min_ago - 1) * 100 if ma100_60_min_ago else 0
        self.algo_helper.info("delta_150_100_60_min: {}".format(delta_150_100_60_min))
        
        
        # non serve piu' il rapporto !
        
        
        # formula delta_1_200_30
        
        delta_1_200_30 = (ma200_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("delta_1_200_30: {}".format(delta_1_200_30))
        
        
        # formula delta_2_200_30_30_min
        
        delta_2_200_30_30_min = (ma200_30_min_ago / ma30_30_min_ago - 1) * 100 if ma30_30_min_ago else 0
        self.algo_helper.info("delta_2_200_30_30_min: {}".format(delta_2_200_30_30_min))
        
        
        # non serve piu' il rapporto !
        
        
        # formula delta_1_200_78
        
        delta_1_200_78 = (ma200_last / ma78_last - 1) * 100 if ma78_last else 0
        self.algo_helper.info("delta_1_200_78: {}".format(delta_1_200_78))
        
        
        # formula delta_2_200_78_60_min
        
        delta_2_200_78_60_min = (ma200_60_min_ago / ma78_60_min_ago - 1) * 100 if ma78_60_min_ago else 0
        self.algo_helper.info("delta_2_200_78_60_min: {}".format(delta_2_200_78_60_min))
        
        
        # non serve piu' il rapporto !
        
        
        
        
        
        # formula delta_1_78_39
        
        delta_1_78_39 = (ma78_last / ma39_last - 1) * 100 if ma39_last else 0
        self.algo_helper.info("delta_1_78_39: {}".format(delta_1_78_39))
        
        
        # formula delta_2_78_39_70_min
        
        delta_2_78_39_70_min = (ma78_70_min_ago / ma39_70_min_ago - 1) * 100 if ma39_70_min_ago else 0
        self.algo_helper.info("delta_2_78_39_70_min: {}".format(delta_2_78_39_70_min))
        
        
        # non serve piu' il rapporto !
        
        
        # formula delta_1_40_20
        
        delta_1_40_20 = (ma40_last / ma20_last - 1) * 100 if ma20_last else 0
        self.algo_helper.info("delta_1_40_20: {}".format(delta_1_40_20))
        
        
        # formula delta_2_40_20
        
        delta_2_40_20 = (ma40_30_min_ago / ma20_30_min_ago - 1) * 100 if ma20_30_min_ago else 0
        self.algo_helper.info("delta_2_40_20: {}".format(delta_2_40_20))

        # delta_1_40_20 < delta_2_40_20 GIORNO !


        # formula delta_1_50_20
        
        delta_1_50_20 = (ma50_last / ma20_last - 1) * 100 if ma20_last else 0
        self.algo_helper.info("delta_1_50_20: {}".format(delta_1_50_20))
        
        
        # formula delta_2_50_20
        
        delta_2_50_20 = (ma50_30_min_ago / ma20_30_min_ago - 1) * 100 if ma20_30_min_ago else 0
        self.algo_helper.info("delta_2_50_20: {}".format(delta_2_50_20))

        # delta_1_50_20 < delta_2_50_20 GIORNO !




        # formula delta_1_50_25
        
        delta_50_25_last = (ma50_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("delta_50_25_last: {}".format(delta_50_25_last))
        
        
        # formula delta_50_25_30_min_ago
        
        delta_50_25_30_min_ago = (ma50_30_min_ago / ma25_30_min_ago - 1) * 100 if ma25_30_min_ago else 0
        self.algo_helper.info("delta_50_25_30_min_ago: {}".format(delta_50_25_30_min_ago))

        # delta_50_25_last < delta_50_25_30_min_ago GIORNO !






        
        # formula delta_1_69_39
        
        delta_1_69_39 = (ma69_last / ma39_last - 1) * 100 if ma39_last else 0
        self.algo_helper.info("delta_1_69_39: {}".format(delta_1_69_39))
        
        
        # formula delta_2_69_39
        
        delta_2_69_39 = (ma69_15_min_ago / ma39_15_min_ago - 1) * 100 if ma39_15_min_ago else 0
        self.algo_helper.info("delta_2_69_39: {}".format(delta_2_69_39))

        # delta_1_69_39 < delta_2_69_39 GIORNO !

        
        
        # formula rapporto_delta_1_delta_2_69_39
        
        rapporto_delta_1_delta_2_69_39 = (delta_1_69_39 / delta_2_69_39) if delta_2_69_39 else 0
        self.algo_helper.info("rapporto_delta_1_delta_2_69_39: {}".format(rapporto_delta_1_delta_2_69_39))
        
        
        
        
        # formula deviation_ma3 di adesso / ma3 di 90 min ago
        
        deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago = (ma3_last / ma3_90_min_ago - 1) * 100 if ma3_90_min_ago else 0
        self.algo_helper.info("deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago: {}".format(deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago))


        # formula deviation_ma39 di adesso / ma39 di 120 min ago
        
        deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago = (ma39_last / ma39_120_min_ago - 1) * 100 if ma39_120_min_ago else 0
        self.algo_helper.info("deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago: {}".format(deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago))


        # formula deviation_ma39 di adesso / ma39 di 180 min ago
        
        deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago = (ma39_last / ma39_180_min_ago - 1) * 100 if ma39_180_min_ago else 0
        self.algo_helper.info("deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago: {}".format(deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago))
        
        
        
        # formula deviation_ma3
        
        deviation_ma3 = (ma3_last / ma3_20_min_ago - 1) * 100 if ma3_20_min_ago else 0
        self.algo_helper.info("deviation_ma3: {}".format(deviation_ma3))
        
        
        


        # formula deviation_ma50
        
        deviation_ma50 = (ma50_last / ma50_60_min_ago - 1) * 100 if ma50_60_min_ago else 0
        self.algo_helper.info("deviation_ma50: {}".format(deviation_ma50))
        
        
        
        
        # formula deviation trend ma100
        deviation_trend_ma100_180_min_ago = (ma100_last / ma100_180_min_ago - 1) * 100 if ma100_180_min_ago else 0
        self.algo_helper.info("deviation_trend_ma100_180_min_ago: {}".format(deviation_trend_ma100_180_min_ago))


        deviation_trend_ma100_300_min_ago = (ma100_last / ma100_300_min_ago - 1) * 100 if ma100_300_min_ago else 0
        self.algo_helper.info("deviation_trend_ma100_300_min_ago: {}".format(deviation_trend_ma100_300_min_ago))
        
        
        # formula deviation trend ma200
        
        deviation_trend_ma200 = (ma200_last / ma200_120_min_ago - 1) * 100 if ma200_120_min_ago else 0
        self.algo_helper.info("deviation_trend_ma200: {}".format(deviation_trend_ma200))
        
        
        # formula deviation trend ma300
        
        deviation_trend_ma300_180_min_ago = (ma300_last / ma300_180_min_ago - 1) * 100 if ma300_180_min_ago else 0
        self.algo_helper.info("deviation_trend_ma300_180_min_ago: {}".format(deviation_trend_ma300_180_min_ago))
        
        
        
        # formula deviation_ma100_180_min_ago_sopra_ma300_180_min_ago
        
        deviation_ma100_180_min_ago_sopra_ma300_180_min_ago = (ma100_180_min_ago / ma300_180_min_ago - 1) * 100 if ma300_180_min_ago else 0
        self.algo_helper.info("deviation_ma100_180_min_ago_sopra_ma300_180_min_ago: {}".format(deviation_ma100_180_min_ago_sopra_ma300_180_min_ago))
        
        
        
        # formula deviation trend ma100 - se dopo 60 min cresce > 1%  NON FA PARTIRE LA VENDITA POCHI MALEDETTI E SUBITO !
        # diversamente succederebbero punti sovrapposti !
        
        deviation_trend_ma100 = (ma100_last / ma100_60_min_ago - 1) * 100 if ma100_60_min_ago else 0
        self.algo_helper.info("deviation_trend_ma100: {}".format(deviation_trend_ma100))

        
        deviation_trend_ma100_90_min_ago = (ma100_last / ma100_90_min_ago - 1) * 100 if ma100_90_min_ago else 0
        self.algo_helper.info("deviation_trend_ma100_90_min_ago: {}".format(deviation_trend_ma100_90_min_ago))
        
        
        
        # deviation pochi maledetti
        
        deviation_pochi_maledetti = (ma13_last / ma13_10_min_ago - 1) * 100 if ma13_10_min_ago else 0
        self.algo_helper.info("deviation_pochi_maledetti: {}".format(deviation_pochi_maledetti))
        
    
        # formula DEVIATION_ma200_sotto_ma300 per comprare
        
        deviation_ma200_sotto_ma300 = (ma200_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma200_sotto_ma300: {}".format(deviation_ma200_sotto_ma300))
        
        
        
        # formula DEVIATION_MA100_LATERALE evita BUY CONTINUI DEL BUY ECCEZIONALE NELLA FASE LATERALE
        
        deviation_ma100_laterale = (ma5_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma100_laterale: {}".format(deviation_ma100_laterale))
        
        
        # formula DEVIATION_ma5_sotto_ma200 per comprare FINO a una certa distanza da ma200
        
        deviation_ma5_sotto_ma200 = (ma5_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma5_sotto_ma200: {}".format(deviation_ma5_sotto_ma200))
        
        
        # formula DEVIATION_ma5_sotto_ma300
        
        deviation_ma5_sotto_ma300 = (ma5_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma5_sotto_ma300: {}".format(deviation_ma5_sotto_ma300))
        
        
        # formula DEVIATION_ma5_sotto_ma450
        
        deviation_ma5_sotto_ma450 = (ma5_last / ma450_last - 1) * 100 if ma450_last else 0
        self.algo_helper.info("deviation_ma5_sotto_ma450: {}".format(deviation_ma5_sotto_ma450))
        
        
        
        # formula deviation_ma10_diviso_ma10_5_ore_ago
        
        deviation_ma10__diviso_ma10_5_ore_ago = (ma10_last / ma10_300_min_ago - 1) * 100 if ma10_300_min_ago else 0
        self.algo_helper.info("deviation_ma10__diviso_ma10_5_ore_ago: {}".format(deviation_ma10__diviso_ma10_5_ore_ago))
        
        
        
        # formula deviation_ma300_diviso_ma300_5_ore_ago
        
        deviation_ma300__diviso_ma300_5_ore_ago = (ma300_last / ma300_301_min_ago - 1) * 100 if ma300_301_min_ago else 0
        self.algo_helper.info("deviation_ma300__diviso_ma300_5_ore_ago: {}".format(deviation_ma300__diviso_ma300_5_ore_ago))
        
        
        # formula DEVIATION_MA100_LATERALE evita BUY CONTINUI DEL BUY ECCEZIONALE NELLA FASE LATERALE
        
        deviation_ma100_laterale = (ma5_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma100_laterale: {}".format(deviation_ma100_laterale))
        
        
        
        
        # formula DEVIATION_ma3_sotto_ma150 per comprare FINO a una certa distanza da ma200
        
        deviation_ma3_sotto_ma150 = (ma3_last / ma150_last - 1) * 100 if ma150_last else 0
        self.algo_helper.info("deviation_ma3_sotto_ma150: {}".format(deviation_ma3_sotto_ma150))
        
        # questa e' stata aggiunta il 15 gennaio 2023 dopo che deviation_ma3_sotto_ma200 aveva fatto -1.36% !
        
        
        
        # formula DEVIATION_ma3_sotto_ma200 per comprare FINO a una certa distanza da ma200
        
        deviation_ma3_sotto_ma200 = (ma3_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma3_sotto_ma200: {}".format(deviation_ma3_sotto_ma200))
        
        # questa e' stata aggiunta il 13 settembre 2022 dopo che deviation_ma5_sotto_ma200 aveva fatto -3% !!!
        
        
        
        
        # formula DEVIATION_ma78_sotto_ma300
        
        deviation_ma78_sotto_ma300 = (ma78_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma78_sotto_ma300: {}".format(deviation_ma78_sotto_ma300))
        
        
        # formula DEVIATION_ma78_sotto_ma200
        
        deviation_ma78_sotto_ma200 = (ma78_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma78_sotto_ma200: {}".format(deviation_ma78_sotto_ma200))
        
        
        
        # formula DEVIATION_ma3_sotto_ma100 
        
        deviation_ma3_sotto_ma100 = (ma3_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma3_sotto_ma100: {}".format(deviation_ma3_sotto_ma100))
        
        
    
        # formula DEVIATION_ma3_sotto_ma300
        
        deviation_ma3_sotto_ma300 = (ma3_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma3_sotto_ma300: {}".format(deviation_ma3_sotto_ma300))
        
        
        
        
        
        # formula DEVIATION_ma4_sopra_ma100 - BUY 4 (parliamo del BUY 4 !) DEVE STARE a una certa distanza da ma100
        
        deviation_ma4_sopra_ma100 = (ma4_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma4_sopra_ma100: {}".format(deviation_ma4_sopra_ma100)) 
        
       
        # formula deviation_ma8_sotto_last_trade_price
        
        deviation_ma8_sotto_last_trade_price = (ma8_last / last_trade_price - 1) * 100 if last_trade_price else 0
        self.algo_helper.info("deviation_ma8_sotto_last_trade_price: {}".format(deviation_ma8_sotto_last_trade_price))
        
      
        # formula DEVIATION_evita_ribasso_improvviso_crollo_ferrari
        
        deviation_evita_ribasso_improvviso_crollo_ferrari = (ma3_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_evita_ribasso_improvviso_crollo_ferrari: {}".format(deviation_evita_ribasso_improvviso_crollo_ferrari))
        
        
        # formule DEVIATION CORREZIONE
        
        deviation_correzione = (ma3_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("deviation_correzione: {}".format(deviation_correzione))

        
        deviation_correzione_1 = (ma5_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_correzione_1: {}".format(deviation_correzione_1))
        
        deviation_correzione_2 = (ma5_last / ma39_last - 1) * 100 if ma39_last else 0
        self.algo_helper.info("deviation_correzione_2: {}".format(deviation_correzione_2))
        
        
        # formula DEVIATION_ASSURDA (se ma200>ma200 20 min ago compra con incrocio ma2-ma200 e vende con incrocio ma2-ma5 e deviation > +0.20 % - ASSURDO !
        
        deviation_assurda = (ma2_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_assurda: {}".format(deviation_assurda))
        
      
        
        # formula deviation_ma3_sopra_ma10 (per il buy in risalita)
        
        deviation_ma3_sopra_ma10 = (ma3_last / ma10_last - 1) * 100 if ma10_last else 0
        self.algo_helper.info("deviation_ma3_sopra_ma10: {}".format(deviation_ma3_sopra_ma10))
        
        
        
        # formula DEVIATION_ma8_sotto_ma100
        
        deviation_ma8_sotto_ma100 = (ma8_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma8_sotto_ma100: {}".format(deviation_ma8_sotto_ma100))
        
        
        
        # formula DEVIATION_ma8_sotto_ma200
        
        deviation_ma8_sotto_ma200 = (ma8_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma8_sotto_ma200: {}".format(deviation_ma8_sotto_ma200))
        
        
        
        # formula DEVIATION_ma8_sotto_ma300
        
        deviation_ma8_sotto_ma300 = (ma8_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma8_sotto_ma300: {}".format(deviation_ma8_sotto_ma300))
        
        
        
        # deviation ribasso e rialzo velocissimo 1 ! 
        
        deviation_ribasso_e_rialzo_velocissimo_1 = ( price / price_10_min_ago - 1) * 100 if price_10_min_ago else 0
        self.algo_helper.info("deviation_ribasso_e_rialzo_velocissimo_1: {}".format(deviation_ribasso_e_rialzo_velocissimo_1))
        
        
        
        # deviation ribasso e rialzo velocissimo 2 ! 
        
        deviation_ribasso_e_rialzo_velocissimo_2 = (price / price_2_min_ago - 1) * 100 if price_2_min_ago else 0
        self.algo_helper.info("deviation_ribasso_e_rialzo_velocissimo_2: {}".format(deviation_ribasso_e_rialzo_velocissimo_2))
        
        
        
        # formula DEVIATION_ma28_sotto_ma100
        
        deviation_ma28_sotto_ma100 = (ma28_last / ma100_last - 1) * 100 if ma100_last else 0
        self.algo_helper.info("deviation_ma28_sotto_ma100: {}".format(deviation_ma28_sotto_ma100))
        
        
        
        
        # formula DEVIATION_ma100_sotto_ma150
        
        deviation_ma100_sotto_ma150 = (ma100_last / ma150_last - 1) * 100 if ma150_last else 0
        self.algo_helper.info("deviation_ma100_sotto_ma150: {}".format(deviation_ma100_sotto_ma150))
        
        
        
        # formula DEVIATION_ma50_sotto_ma200
        
        deviation_ma50_sotto_ma200 = (ma50_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma50_sotto_ma200: {}".format(deviation_ma50_sotto_ma200))
        
        
        # formula DEVIATION_ma50_sotto_ma300
        
        deviation_ma50_sotto_ma300 = (ma50_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma50_sotto_ma300: {}".format(deviation_ma50_sotto_ma300))
        
        
        # formula DEVIATION_ma25_sotto_ma300
        
        deviation_ma25_sotto_ma300 = (ma25_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma25_sotto_ma300: {}".format(deviation_ma25_sotto_ma300))
        
        
        
        # formula DEVIATION_ma100_sopra_ma300
        
        deviation_ma100_sopra_ma300 = (ma100_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma100_sopra_ma300: {}".format(deviation_ma100_sopra_ma300))
        
        
        
        # formula DEVIATION_ma200_sopra_ma300
        
        deviation_ma200_sopra_ma300 = (ma200_last / ma300_last - 1) * 100 if ma300_last else 0
        self.algo_helper.info("deviation_ma200_sopra_ma300: {}".format(deviation_ma200_sopra_ma300))
        
        
       
        
        # formula DEVIATION_ma100_sopra_ma200
        
        deviation_ma100_sopra_ma200 = (ma100_last / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_ma100_sopra_ma200: {}".format(deviation_ma100_sopra_ma200))
        
        
     
        # formula DEVIATION_ma13_sopra_ma25
        
        deviation_ma13_sopra_ma25 = (ma13_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("deviation_ma13_sopra_ma25: {}".format(deviation_ma13_sopra_ma25))
        
        
        
        # formula DEVIATION_ma5_sopra_ma16
        
        deviation_ma5_sopra_ma16 = (ma5_last / ma16_last - 1) * 100 if ma16_last else 0
        self.algo_helper.info("deviation_ma5_sopra_ma16: {}".format(deviation_ma5_sopra_ma16))
        
        
        
        # formula DEVIATION_bellissima
        
        deviation_bellissima = (ma6_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_bellissima: {}".format(deviation_bellissima))

        
        ############# deviation per comprare con un RIALZO IMPROVVISO DOPO UN PERIODO LATERALE
        
        
        # 12 gennaio 2022 la ma2 arriva tardi ! DEVIATION RIALZO IMPROVVISO per adesso solo su RCCR
        
        # ma deve andare almeno di 0.5% sopra la ma200 ! cosi' eviti molti falsi buy
        
        # formula DEVIATION_RIALZO_IMPROVVISO_SOPRA (deve stare 0.5 sopra la ma200)
        
        deviation_rialzo_improvviso_sopra = (price / ma200_last - 1) * 100 if ma200_last else 0
        self.algo_helper.info("deviation_rialzo_improvviso_sopra: {}".format(deviation_rialzo_improvviso_sopra))
        
        # formula DEVIATION_RIALZO_IMPROVVISO (per 40 min si muove in un range +0.25 -0.25 sintetizzato dalla ma30
        
        deviation_rialzo_improvviso_1 = (price / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_rialzo_improvviso_1: {}".format(deviation_rialzo_improvviso_1))
        
        deviation_rialzo_improvviso_2 = (price / ma30_10_min_ago - 1) * 100 if ma30_10_min_ago else 0
        self.algo_helper.info("deviation_rialzo_improvviso_2: {}".format(deviation_rialzo_improvviso_2))
        
        deviation_rialzo_improvviso_3 = (price / ma30_20_min_ago - 1) * 100 if ma30_20_min_ago else 0
        self.algo_helper.info("deviation_rialzo_improvviso_3: {}".format(deviation_rialzo_improvviso_3))
        
        deviation_rialzo_improvviso_4 = (price / ma30_30_min_ago - 1) * 100 if ma30_30_min_ago else 0
        self.algo_helper.info("deviation_rialzo_improvviso_4: {}".format(deviation_rialzo_improvviso_4))
        
        deviation_range_1 = (ma30_last / ma30_10_min_ago - 1) * 100 if ma30_10_min_ago else 0
        self.algo_helper.info("deviation_range_1: {}".format(deviation_range_1))
        
        deviation_range_2 = (ma30_10_min_ago / ma30_20_min_ago - 1) * 100 if ma30_20_min_ago else 0
        self.algo_helper.info("deviation_range_2: {}".format(deviation_range_2))
        
        deviation_range_3 = (ma30_20_min_ago / ma30_30_min_ago - 1) * 100 if ma30_30_min_ago else 0
        self.algo_helper.info("deviation_range_3: {}".format(deviation_range_3))
        
        
        deviation_range_x = (ma30_last / ma30_20_min_ago - 1) * 100 if ma30_20_min_ago else 0
        self.algo_helper.info("deviation_range_x: {}".format(deviation_range_x))
        
        # formula deviation_ma20_laterale
        
        deviation_ma20_laterale = (ma20_last / ma20_60_min_ago - 1) * 100 if ma20_60_min_ago else 0
        self.algo_helper.info("deviation_ma20_laterale: {}".format(deviation_ma20_laterale))
        
       
        # formula DEVIATION_RIBASSO_IMPROVVISO
        
        deviation_ribasso_improvviso = (price / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_ribasso_improvviso: {}".format(deviation_ribasso_improvviso))
      
        
        # formula DEVIATION_crollo_24_aprile - che va nella vendita speciale
        
        deviation_crollo_24_aprile = (ma2_last / last_trade_price - 1) * 100 if last_trade_price else 0
        self.algo_helper.info("deviation_crollo_24_aprile: {}".format(deviation_crollo_24_aprile))
        
       
        ################################################################################################################## deviation per comprare

        # formula DEVIATION_buy1 per la compra 1
        
        deviation_buy1 = (ma13_last / ma39_last - 1) * 100 if ma39_last else 0
        self.algo_helper.info("deviation_buy1: {}".format(deviation_buy1))
        
        
        # formula DEVIATION_buy2 per la compra 2
        
        deviation_buy2 = (ma8_last / ma50_last - 1) * 100 if ma50_last else 0
        self.algo_helper.info("deviation_buy2: {}".format(deviation_buy2))
        
     
       
        # formula DEVIATION_buy3 per la compra 3
        
        deviation_buy3 = (ma4_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_buy3: {}".format(deviation_buy3))




        





        # formula delta_buy3_incrocio_ma3_ma8 > 0.10 per la compra 3
        
        delta_buy3_incrocio_ma3_ma8 = (ma3_last / ma8_last - 1) * 100 if ma8_last else 0
        self.algo_helper.info("delta_buy3_incrocio_ma3_ma8: {}".format(delta_buy3_incrocio_ma3_ma8))
       
        
        
        
        
      
        ############################################################################################     DEVIATION_buy_crollo

        # formula DEVIATION_buy_crollo_1 per comprare a una certa distanza da ma78
        
        deviation_buy_crollo_1 = (ma8_last / ma78_last - 1) * 100 if ma78_last else 0
        self.algo_helper.info("deviation_buy_crollo_1: {}".format(deviation_buy_crollo_1))
       
    
        # formula DEVIATION_buy_crollo_2 per comprare a una certa distanza da ma13
        
        deviation_buy_crollo_2 = (ma3_last / ma13_last - 1) * 100 if ma13_last else 0
        self.algo_helper.info("deviation_buy_crollo_2: {}".format(deviation_buy_crollo_2))
            
      
        ############################################################################################################################
    
        # formula DEVIATION_buy_ma3_sopra_ma20 per comprare a una certa distanza da ma20
        
        deviation_buy_ma3_sopra_ma20 = (ma3_last / ma20_last - 1) * 100 if ma20_last else 0
        self.algo_helper.info("deviation_buy_ma3_sopra_ma20: {}".format(deviation_buy_ma3_sopra_ma20))
        

        deviation_buy_ma5_sopra_ma20 = (ma5_last / ma20_last - 1) * 100 if ma20_last else 0
        self.algo_helper.info("deviation_buy_ma5_sopra_ma20: {}".format(deviation_buy_ma5_sopra_ma20))

        
        # formula DEVIATION_buy_ma2_sopra_ma13 per comprare a una certa distanza da ma13
        
        deviation_buy_ma2_sopra_ma13 = (ma2_last / ma13_last - 1) * 100 if ma13_last else 0
        self.algo_helper.info("deviation_buy_ma2_sopra_ma13: {}".format(deviation_buy_ma2_sopra_ma13))
        
        # formula DEVIATION_buy_ma3_sopra_ma13 per comprare a una certa distanza da ma13
        
        deviation_buy_ma3_sopra_ma13 = (ma3_last / ma13_last - 1) * 100 if ma13_last else 0
        self.algo_helper.info("deviation_buy_ma3_sopra_ma13: {}".format(deviation_buy_ma3_sopra_ma13))
        
        
            
        # formula DEVIATION_buy_ma2_sopra_ma5 per comprare a una certa distanza da ma5
        
        deviation_buy_ma2_sopra_ma5 = (ma2_last / ma5_last - 1) * 100 if ma5_last else 0
        self.algo_helper.info("deviation_buy_ma2_sopra_ma5: {}".format(deviation_buy_ma2_sopra_ma5))
        
        
        
        
        # formula DEVIATION_buy_ma3_sopra_ma25 per comprare a una certa distanza da ma25
        
        deviation_buy_ma3_sopra_ma25 = (ma3_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("deviation_buy_ma3_sopra_ma25: {}".format(deviation_buy_ma3_sopra_ma25))    
        
      
        # formula DEVIATION_ma4_sopra_ma30
        
        deviation_ma4_sopra_ma30 = (ma4_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_ma4_sopra_ma30: {}".format(deviation_ma4_sopra_ma30))
            
        
        # formula DEVIATION_ma4_sopra_ma25
        
        deviation_ma4_sopra_ma25 = (ma4_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("deviation_ma4_sopra_ma25: {}".format(deviation_ma4_sopra_ma25))
        
        
        # formula DEVIATION_ma5_sopra_ma30
        
        deviation_ma5_sopra_ma25 = (ma5_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("deviation_ma5_sopra_ma25: {}".format(deviation_ma5_sopra_ma25))
        
        
        # formula DEVIATION_ma5_sopra_ma30
        
        deviation_ma5_sopra_ma30 = (ma5_last / ma30_last - 1) * 100 if ma30_last else 0
        self.algo_helper.info("deviation_ma5_sopra_ma30: {}".format(deviation_ma5_sopra_ma30))
            
       
        # formula deviation_ma7_sopra_ma40
        
        deviation_ma7_sopra_ma40 = (ma7_last / ma40_last - 1) * 100 if ma40_last else 0
        self.algo_helper.info("deviation_ma7_sopra_ma40: {}".format(deviation_ma7_sopra_ma40))
        
      
        # formula deviation_ma3_sopra_ma7 (solo per il BUY1)
        
        deviation_ma3_sopra_ma7 = (ma3_last / ma7_last - 1) * 100 if ma7_last else 0
        self.algo_helper.info("deviation_ma3_sopra_ma7: {}".format(deviation_ma3_sopra_ma7))
      
        ########################################################################################################################## deviation per vendere

            
      
        # formula DEVIATION_sell_ma78
        
        deviation_sell_ma78 = (ma4_last / ma78_last - 1) * 100 if ma78_last else 0
        self.algo_helper.info("deviation_sell_ma78: {}".format(deviation_sell_ma78))

        # formula deviation_ma39 per vendere un po' piu' giu' di ma39
        
        deviation_ma39 = (ma4_last / ma39_last - 1) * 100 if ma39_last else 0
        self.algo_helper.info("deviation_ma39: {}".format(deviation_ma39))
        
        
        # formula deviation_ma25 per vendere un po' piu' giu' di ma25 (per il buy 3-4-5 con ma 39 ha fatto -0.89 !)
        
        deviation_ma25 = (ma3_last / ma25_last - 1) * 100 if ma25_last else 0
        self.algo_helper.info("deviation_ma25: {}".format(deviation_ma25))
        
        
        
        
        ######################################################################################################## TUTTO COMINCIA DA QUA !
        # dal non fare niente !

        # DEFAULT ACTION DICE DI NON FARE NIENTE (= None, NON TOCCARE )
        
        action = None
        percentage = 0

        ######################################################################################################## APRE E CHIUDE LA GABBIA !

        # SE LA GABBIA E' TROPPO APERTA IMPAZZISCE NEI MOVIMENTI LATERALI !
        # entrano in azione buy 2-3-4-5 che sono piu' reattivi del BUY 1 !

        # APRE E CHIUDE GABBIA

        # if deviation_1_gabbia > -0.29 or deviation_buy_crollo_1 < -1.50:
        # if deviation_1_gabbia > -0.29 or deviation_buy_crollo_1 < -1.50 or (-1.50 < deviation_buy_crollo_1 < -0.60):
        # if deviation_1_gabbia > -0.29 or deviation_buy_crollo_1 < -1.50 or deviation_buy_crollo_1 > -1.50 and deviation_buy_crollo_1 < -0.60:
     
        # ultima evoluzione APERTURA GABBIA
        
        # if deviation_1_gabbia > -0.30 or deviation_buy_crollo_1 < -1.62 or deviation_buy_crollo_1 > -1.59 and deviation_buy_crollo_1 < -0.72 or deviation_buy_crollo_1 > -0.69 and deviation_buy_crollo_1 < -0.36:
        
        # if deviation_1_gabbia > -0.27 or deviation_buy_crollo_1 < -1.51 or deviation_buy_crollo_1 > -1.50 and deviation_buy_crollo_1 < -0.60 or deviation_buy_crollo_1 > -0.59 and deviation_buy_crollo_1 < -0.27:

        # if ((deviation_ma300_sopra_ma450 > -0.01 and deviation_ma300_sopra_ma450 < -0.20) and delta_1 > delta_2) or ((deviation_ma300_sopra_ma450 > -0.20 and deviation_ma300_sopra_ma450 < -0.20) and delta_1 < delta_2):
        # QUESTA HA FATTO BLOCCARE IL SISTEMA !

        # if (deviation_ma300_sopra_ma450 > -0.01 and deviation_ma300_sopra_ma450 < -0.20 and delta_1 > delta_2) or (deviation_ma300_sopra_ma450 >= -0.20 and deviation_ma300_sopra_ma450 < -0.20 and delta_1 < delta_2):


        #if deviation_1_gabbia > -0.27 or deviation_buy_crollo_1 < -1.51 or deviation_buy_crollo_1 > -1.50 and deviation_buy_crollo_1 < -0.60 or deviation_buy_crollo_1 > -0.59 and deviation_buy_crollo_1 < -0.27:










        # questo FUNZIONA !

        if deviation_ma200_sotto_ma300 < -0.02 or deviation_ma200_sotto_ma300 > -0.01:








        # POSSO SCRIVERE QUESTO ? chiedi al compa

        # if (ma39_last < ma100_last and (deviation_ma200_sotto_ma300 < -0.06 or deviation_ma200_sotto_ma300 > -0.01)) or (ma39_last > ma100_last and (deviation_ma200_sotto_ma300 < -0.01 or deviation_ma200_sotto_ma300 > -0.01)):


        #
        #




        # POSSO SCRIVERE QUESTO ? chiedi al compa - FACCIO UNA PROVA ! ma mi da errore !






 
        # if deviation_1_gabbia > -0.27:

        # elif deviation_buy_crollo_1 < -0.27:
        # elif deviation_buy_crollo_1 > -0.59:

        # elif deviation_buy_crollo_1 < -0.60:
        # elif deviation_buy_crollo_1 > -1.50:
        
        # elif deviation_buy_crollo_1 < -1.51:




        # deviation_1_gabbia = ma8_last / ma50_last
        # deviation_buy_crollo_1 = ma8_last / ma78_last
        
     
        


          


        # QUESTE 3 scritte in questo modo HANNO DATO ERRORE !
        # if deviation_1_gabbia > -0.29 
        # or deviation_buy_crollo_1 < -1.50 
        # or (-1.50 < deviation_buy_crollo_1 < -0.60):
       
            
            
            
                        
            # NON TOCCARE QUESTA CONDIZIONE ! SERVE PER APERTURA DI GABBIA !
            
            if not self.session or not self.open:
                self.session = 1
                self.open = True
                self.algo_helper.info("session {}: open segment".format(self.session))
        
        
        # SI CHIUDE LA GABBIA SE
        
        else:
            self.open = False
            self.algo_helper.info("session {}: closed segment".format(self.session))
        
        
        
        #############################################################################################################################################

        # COMPRA
        # NON TOCCARE QUESTA RIGA ( DICE CHE STA IN MODO BUY, vuole COMPRARE ! )

        if self.open and self.session and last_trade_action != "buy":
          
            
            
            
            ###########################################################################################################################################
            #   B U Y
            ###########################################################################################################################################
            
            percentage = self.buy_percentage
            
            # NON TOCCARE  !
            
            
            
            
            ######################################################################################################## COMPRA sessione 1
            
            # BUY 1 con "percentage" 20 -30 - x
            
            if self.session == 1:
               
                if (  
                    ma3_last > ma11_last
                    
                    and ma450_last > ma450_360_min_ago
                    and (ma78_last > ma150_last or delta_50_25_last < delta_50_25_30_min_ago)
                    
                    and deviation_ma3_sotto_ma100 > -0.10
                    
                    and ma3_last > ma9_last
                    
                    and ma2_last >= ma2_2_min_ago
                ):    
              
                    buy = f"BUY 1 con ma450_last > ma450_360_min_ago e 78>150 del 18 mag 2025 - r 915 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 18 mag 2025 aggiunta da RCCR e aggiunta anche in buy 5
                    # 25 ott 2025 anticipata ndecchiecella
                    # 25 ott 2025 aggiunte pg

                elif (  
                    
                    ma3_last > ma10_last
                    and ma8_last >= ma8_2_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                    and (delta_1 < delta_2 or ma100_last > ma200_last or ma300_last > ma300_301_min_ago)
                    
                    and macd_differenza_2_min_ago > -18.50

                ):    
              
                    buy = f"BUY 1 con ma300_last > ma300_301_min_ago or 100>200 - r 916 A1 x1 X1 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 11 nov 2024 prova adx
                    #  5 dic 2025 anticipata ndecchia
                    # 28 gen 2025 3-90 per anticipare di una ndecchiecella il 4-100
                    # 30 mar 2025 anticipata visto che 300 sale da 2 ore !
                    # 31 mar 2025 anticipata ndecchiecella
                    # 11 apr 2025 ipotesi 20>40 stai tranquillo. non sta ritracciando
                    #  9 mag 2025 forse 300> 5 ore faceva arrivare tardi allora proprio accanto a questa condizione ho messo or 39>200
                    #  9 mag 2025 tenendo comunque ferma la 100>200
                    # 11 mag 2025 ho aggiunto anche or 50>100 per evitare che compri durante il ribasso
                    # 12 mag 2025 aggiunta or deviation_ma50_sotto_ma100 > -0.10
                    # 17 mag 2025 sto spezzando tutti questi or
                    #  8 ott 2025 provato ad anticipare con aggiunta or
                    #  9 ott 2025 provato ad anticipare ancora un po'
                    # 21 ott 2025 tolta and (ma39_last > ma100_last or ma39_last > ma200_last)
                    # 21 ott 2025 aggiunta and ma8_last >= ma8_2_min_ago
                    # 21 ott 2025 aggiunte pg
                    # 24 ott 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04


                elif (  
                    ma3_last > ma8_last

                    and (delta_CM_300_25_last <= delta_CM_300_25_2_min_ago or delta_50_25_last < delta_50_25_30_min_ago)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and (deviation_ma200_sotto_ma300 > -0.30 or delta_DNA_1 < delta_DNA_2)
                    and (ma300_last > ma300_480_min_ago or ma100_last > ma100_120_min_ago)
                    
                    

                    and deviation_ma39 < 0.01 
                    and deviation_ma3_sotto_ma50 < -0.00 
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.11 
                    and deviation_ma25_sotto_ma300 < -0.14 
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.01


                    and deviation_ma50_sotto_ma100 > -0.50
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"BUY 1 con ma300_last > ma300_480_min_ago - r 916 A1 x1 X1 y1x - deviation_ma39 {deviation_ma39:.2f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}"
                    action = "buy"
                    percentage = 90

                    # 27 giu 2025 aggiunta and ma300_last > ma300_480_min_ago
                    #  7 ago 2025 aggiunta and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    #  7 ago 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176
                    #  8 ott 2025 aggiunta and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago
                    #  8 ott 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago a -0.13 da -0.176
                    #  8 ott 2025 aggiunte parentesi graffe sulla stessa riga
                    #  8 ott 2025 aggiunta or delta_50_25_last < delta_50_25_30_min_ago
                    # 21 ott 2025 anticipata ndecchiecella
                    # 21 ott 2025 aggiunto deviation (da abbassare)


                elif (  
                    ma3_last > ma8_last

                    and ma300_last > ma300_480_min_ago
                    and ma100_last < ma100_120_min_ago

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.156
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and deviation_ma50_sotto_ma100 > -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = "BUY 1 con ma300_last > ma300_480_min_ago ma ma100 < 2 ore - r 916 A1 x1 X1 y1y"
                    action = "buy"
                    percentage = 90

                    # 27 giu 2025 aggiunta and ma300_last > ma300_480_min_ago
                    #  6 ago 2025 ma se 100 scende da 2 ore allora deve dare un piccolo segno. comprava male. 
                    #  6 ago 2025 ho messo un po' di cose dalle condizioni migliori.
                    #  8 ago 2025 ho aggiunto and (deviation_ma5_sopra_o_sotto_ma100 < -0.25



                elif (  
                    ma3_last > ma8_last

                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.05
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma25_sotto_ma300 > -0.45
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.052

                    
                    and deviation_ma5_sotto_ma300 < -0.42
                    
                    and deviation_ma78_sopra_o_sotto_ma78_30_min_ago > -0.20
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma50_differenza_ma59 < -5
                    and macd_differenza_2_min_ago > -18.50
                   
                ):    
              
                    buy = f"BUY 1 28 mag 2025 - r 916 A1 x1 X1 y2 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 90

                    # 28 mag 2025 aggiunta questa. niente di importante.
                    #  8 ott 2025 aggiunte parentesi graffe




                elif (  
                    ma3_last > ma8_last

                    and ma20_last > ma40_last

                    and ma100_last > ma200_last
                    and (ma300_last > ma300_301_min_ago or ma39_last > ma100_last or ma39_last > ma200_last)

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = "BUY 1 con ma300_last > ma300_301_min_ago e 100>200 - r 916 A1 x1 X2 x"
                    action = "buy"
                    percentage = 90

                    # 17 mag 2025 sto spezzando tutti questi or



                elif (  
                    ma3_last > ma8_last
                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and (ma450_last > ma450_300_min_ago or ma300_last > ma300_301_min_ago or ma39_last > ma100_last or ma39_last > ma200_last)
                   
                    and ma78_last < ma78_120_min_ago
                    and delta_50_25_last <= delta_50_25_30_min_ago
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"BUY 1 se CV GIORNO con ma300_last > ma300_301_min_ago and delta_50_25_last < delta_50_25_30_min_ago - r 916 A1 x1 X2 y1 X - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 17 mag 2025 sto spezzando tutti questi or
                    #  7 ott 2025 modificata per farla arrivare prima 
                    #  7 ott 2025 entra in azione and delta_50_25_last < delta_50_25_30_min_ago
                    # 17 ott 2025 se cv giorno ok cosi'
                    # 17 ott 2025 aggiunte pg


                elif (  
                    ma3_last > ma8_last
                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07

                    and (ma450_last > ma450_300_min_ago or ma300_last > ma300_301_min_ago or ma39_last > ma100_last or ma39_last > ma200_last)
                   
                    and ma78_last < ma78_120_min_ago
                    and delta_50_25_last <= delta_50_25_30_min_ago
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"BUY 1 r 916 A1 x1 X2 y1 Y1 SE CV NOTTE + CM GIORNO and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07 con ma300_last > ma300_301_min_ago and delta_50_25_last < delta_50_25_30_min_ago - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 17 mag 2025 sto spezzando tutti questi or
                    #  7 ott 2025 modificata per farla arrivare prima 
                    #  7 ott 2025 entra in azione and delta_50_25_last < delta_50_25_30_min_ago
                    # 17 ott 2025 se cv notte cm giorno and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07
                    # 17 ott 2025 aggiunte pg


                elif (  
                    ma3_last > ma8_last
                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and (deviation_ma25_sotto_ma300 < -1.60 and ma8_last >= ma8_2_min_ago)

                    and deviation_ma39 < - 0.10
                    and deviation_ma3_sotto_ma50 < -0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < 0.20
                    and (deviation_ma25_sotto_ma300 < -1.60 and ma8_last >= ma8_2_min_ago)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.11


                    and (ma450_last > ma450_300_min_ago or ma300_last > ma300_301_min_ago or ma39_last > ma100_last or ma39_last > ma200_last)
                   
                    and ma78_last < ma78_120_min_ago
                    and delta_50_25_last <= delta_50_25_30_min_ago
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"BUY 1 r 916 A1 x1 X2 y1 Y2 SE CV NOTTE + (deviation_ma25_sotto_ma300 < -1.60 and ma8_last >= ma8_2_min_ago) con ma300_last > ma300_301_min_ago and delta_50_25_last < delta_50_25_30_min_ago - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 17 mag 2025 sto spezzando tutti questi or
                    #  7 ott 2025 modificata per farla arrivare prima 
                    #  7 ott 2025 entra in azione and delta_50_25_last < delta_50_25_30_min_ago
                    # 17 ott 2025 se cv notte deviation profonde and ma8_last >= ma8_2_min_ago
                    # 17 ott 2025 aggiunte pg




                elif (  
                    ma3_last > ma8_last
                    and ma450_last < ma450_300_min_ago

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176

                    and deviation_ma39 < -0.25
                    and deviation_ma3_sotto_ma50 < -0.27
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.44
                    and deviation_ma25_sotto_ma300 < -0.53
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.067

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = "BUY 1 con 450< + OSSO - r 916 A1 x1 X2 y2"
                    action = "buy"
                    percentage = 90

                    # 17 mag 2025 sto spezzando tutti questi or
                    # 27 mag 2025 con 450< OSSO !
                    #  6 ago 2025 aggiunta and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    #  6 ago 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176








                elif (
                    ma3_last > ma20_last
                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and delta_1_50_20 <= delta_2_50_20

                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and ma50_last < ma50_2_min_ago
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                        
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                        
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 1 IMPORTATO DA RCCR e modificato dopo 50000 righe - r 916 A1 x1 Y1
                    
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """

                    action = "buy"
                    percentage = 80

                    # 16 mag 2025 in questa circostanza 3-10 e 3-50 non hanno profondita' ! vedi doppio delta 250-150
                    #  6 ago 2025 ok
                    #  7 AGO 2025 QUESTA E' LA MIGLIORE
                    # 25 set 2025 aggiunte parentesi graffe
                    # 25 set 2025 aggiunta and delta_1_50_20 <= delta_2_50_20
                    #  7 ott 2025 e' andata benissimo MA ovviamente non ha preso le parentesi graffe.



                elif (
                    ma3_last > ma15_last

                    and delta_DNA_1 < delta_DNA_2
                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.05

                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and ma50_last < ma50_2_min_ago
                    
                    and ma100_last < ma100_60_min_ago
                        
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                        
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 1 del 28 mag 2025 dopo 50000 righe - r 916 A1 X1 Y2"
                    action = "buy"
                    percentage = 80

                    # 16 mag 2025 in questa circostanza 3-10 e 3-50 non hanno profondita' ! vedi doppio delta 250-150
                    # 28 mag 2025 aggiunta questa per anticipare di una ndecchiecella
                    # 28 mag 2025 aggiunte 3-39 e 3-50
                    #  6 ago 2025 3-15 da 3-16 
                    #  6 ago 2025 ok



                elif (  
                    ma3_last > ma8_last

                    and ma20_last < ma50_last
                    and deviation_ma39 < -0.15
                    and deviation_ma3_sotto_ma50 < -0.15

                    and ma100_last > ma200_last
                    and (ma300_last > ma300_301_min_ago or ma100_last > ma300_last)

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):        
                    buy = f"""BUY 1 con ma300_last > ma300_301_min_ago MA ritracciamento - r 916 A1 x2
                    ma300_last {ma300_last:.2f}
                    ma300_301_min_ago {ma300_301_min_ago:.2f}
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    
                    action = "buy"
                    percentage = 90

                    # 11 nov 2024 prova adx
                    #  5 dic 2025 anticipata ndecchia
                    # 28 gen 2025 3-90 per anticipare di una ndecchiecella il 4-100
                    # 30 mar 2025 anticipata visto che 300 sale da 2 ore !
                    # 31 mar 2025 anticipata ndecchiecella
                    # 11 apr 2025 sta ritracciando cazzo !
                    # 11 apr 2025 aggiungo, allora, and deviation_ma39 < -0.12
                    # 11 apr 2025 aggiungo, allora, and deviation_ma3_sotto_ma50 < -0.25
                    # 11 mag 2025 aggiungo or ma100_last > ma300_last proprio accanto alla 300 > 5 ore ago 
                    # 11 mag 2025 dubitando che proprio 300> 5 ore ago possa far arrivare il buy con un leggero ritardo.
                    # 11 mag 2025 ma va bene cosi' !


                    
                elif (
                    ma3_last > ma18_last

                    and ma300_last < ma300_180_min_ago
                    
                    and ma20_last > ma50_last
                    and deviation_ma200_sotto_ma300 > -0.05

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma39 < -0.05

                    and deviation_ma300_sopra_ma450 > -0.18
                    and deviation_ma100_sopra_ma300 > -0.29

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma3_last > ma8_last
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):  
              
                    buy = "BUY 1 con 300< and 20>50 and 3-39 < -0.05 - r 916 A1 y"
                    action = "buy"
                    percentage = 90

                    # 11 nov 2024 prova adx
                    #  5 dic 2025 anticipata ndecchia
                    # 28 gen 2025 4-100 da 5-100
                    # 14 apr 2025 4-78 da 4-100
                    # 15 apr 2025 3-18 da 4-78
                    # 19 apr 2025 modificata per anticipare
                    # 19 apr 2025 deviation_ma200_sotto_ma300 > -0.05 significa che 200 sta vicina alla 300 - altrimenti compra durante il ribasso
                    # 30 apr 2025 aggiunta and deviation_ma39 < -0.05



                elif (
                    ma3_last > ma18_last

                    and ma200_last > ma300_last
                    and ma450_last > ma450_360_min_ago

                    and delta_DNA_1 < delta_DNA_2
                    and delta_1 < delta_2

                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -2.50

                ):
              
                    buy = "BUY 1 GIORNO con ma300_last > ma300_120_min_ago e 200>300 AND 3-10 > 0.01 - r 916 A2x"
                    action = "buy"
                    percentage = 90

                    # 11 nov 2024 prova adx
                    #  5 dic 2025 anticipata ndecchia
                    # 28 feb 2025 tolto 5>180
                    # 10 mar 2025 aggiunto GIORNO



                elif (
                    ma3_last > ma18_last

                    and (ma20_last < ma50_last or ma3_last < ma20_last or ma20_last < ma20_2_min_ago)
                    and ma450_last > ma450_360_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma200_last > ma300_last
                    and ma100_last > ma200_last

                    and ma5_last < ma150_last
                    
                    and deviation_ma39 < -0.30
                    and deviation_ma3_sotto_ma50 < -0.05

                    and delta_DNA_1 > delta_DNA_2
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -5.50

                ):  
              
                    buy = f"BUY 1 {ma450_last} {ma450_360_min_ago} con ma450_last > ma450_360_min_ago - DNA - RITRACCIAMENTO - r 916 A2y1"
                    action = "buy"
                    percentage = 90

                    # 11 nov 2024 prova adx
                    #  5 dic 2025 anticipata ndecchia
                    # 28 feb 2025 aggiunta DNA - NOTTE
                    # 28 feb 2025 tolto 5>180
                    # 27 mar 2025 se 5 STA SOTTO 150 e ritraccia (vedi ma3<ma20 o ma20<ma20 2 min ago)  allora deve essere deviation_ma39 < -0.30
                    # 10 apr 2025 correzione errore or e aggiunta f
                    # 13 apr 2025 con 100>200


                elif (
                    ma3_last > ma18_last

                    and (ma20_last < ma50_last or ma3_last < ma20_last or ma20_last < ma20_2_min_ago)
                    and ma450_last > ma450_360_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma200_last > ma300_last

                    and ma100_last < ma200_last
                    and ma5_last < ma150_last

                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30

                    and deviation_ma39 < -0.30
                    and deviation_ma3_sotto_ma50 < -0.05

                    and delta_DNA_1 > delta_DNA_2
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50

                ):  
              
                    buy = f"BUY 1 {ma450_last} {ma450_360_min_ago} con ma450_last > ma450_360_min_ago - DNA -   MA RITRACCIAMENTO - r 916 A2y2"
                    action = "buy"
                    percentage = 90

                    # 11 nov 2024 prova adx
                    #  5 dic 2025 anticipata ndecchia
                    # 28 feb 2025 aggiunta DNA - NOTTE
                    # 28 feb 2025 tolto 5>180
                    # 27 mar 2025 se 5 STA SOTTO 150 e ritraccia (vedi ma3<ma20 o ma20<ma20 2 min ago)  allora deve essere deviation_ma39 < -0.30
                    # 10 apr 2025 correzione errore or e aggiunta f
                    # 13 apr 2025 con 100<200
                    # 13 apr 2025 aggiunto and deviation_ma5_sotto_ma300 < -0.40
                    # 13 apr 2025 aggiunto and deviation_ma10_sopra_ma200 < -0.30






                

                elif (  
                    ma3_last > ma8_last
                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago


                    and (ma200_last > ma200_120_min_ago or ma300_last > ma300_120_min_ago)
                    
                    and deviation_ma50_sotto_ma100 > -0.17
                    and deviation_ma20_sotto_ma50 > -0.12
                    and (delta_1 < delta_2 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.045

                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"BUY 1 che mancava > 50 000 righe - r 918 A1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    
                    action = "buy"
                    percentage = 90

                    # 21 ott 2025 se cv giorno ok cosi' 



                elif (  
                    ma3_last > ma8_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04
                    and ma8_last >= ma8_2_min_ago

                    and (ma200_last > ma200_120_min_ago or ma300_last > ma300_120_min_ago)
                    
                    and deviation_ma50_sotto_ma100 > -0.17
                    and deviation_ma20_sotto_ma50 > -0.12
                    and (delta_1 < delta_2 or delta_DNA_1 < delta_DNA_2)
                    
                    and macd_differenza_2_min_ago > -28.50
                ):    
              
                    buy = f"BUY 1 che mancava > 50 000 righe - r 918 A2 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    
                    action = "buy"
                    percentage = 90

                    # 21 ott 2025 se cv notte allora interviene CM and ma8_last >= ma8_2_min_ago



                elif (  
                    ma3_last > ma8_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.05
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    and deviation_ma25_sotto_ma300 < -1.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.11
                    and ma8_last >= ma8_2_min_ago
                    
                    and (ma200_last > ma200_120_min_ago or ma300_last > ma300_120_min_ago)
                    
                    and deviation_ma50_sotto_ma100 > -0.17
                    and deviation_ma20_sotto_ma50 > -0.12
                    and (delta_1 < delta_2 or delta_DNA_1 < delta_DNA_2)
                    
                    and macd_differenza_2_min_ago > -28.50
                ):    
              
                    buy = f"BUY 1 che mancava > 50 000 righe - r 918 A2 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    
                    action = "buy"
                    percentage = 90

                    # 12 mag 2025 aggiunta questa perche' NON AVEVA COMPRATO. cazzo.
                    #  6 ago 2025 ok
                    #  7 AGO 2025 QUESTA E' ANDATA BENISSIMO
                    # 10 AGO 2025 E' ANDATA MALE mentre scendeva 
                    # 25 set 2025 tolta and deviation_ma3_sopra_ma10 > 0.01 perche' e' arrivata con un po' di ritardo.
                    # 25 set 2025 aggiunte parentesi graffe
                    # 25 set 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago a -0.045 da -0.035
                    # 26 set 2025 NON COMPAIONO I VALORI DENTRO LE PARENTESI GRAFFE
                    # 30 set 2025 ho messo sulla stessa riga di f""" BUY 1 una parentesi graffa. per cercare di risolvere.
                    # 30 set 2025 se 200 > 120 min or 300 > 120 min ok cosi'
                    #  8 ott 2025 ha funzionato sulla stessa riga e anche il 2f ! e addirittura, con le """ iniziali non ci sono le " alla fine della riga !
                    #  8 ott 2025 ho aggiunto altre parentesi graffe, sulla stessa riga, ovviamente.
                    # 21 ott 2025 se cv notte allora deviation profonde !




                elif (  
                    ma3_last > ma8_last

                    and (ma200_last < ma200_120_min_ago or ma300_last < ma300_120_min_ago)
                    and delta_50_25_last <= delta_50_25_30_min_ago
                    and (delta_1 < delta_2 or delta_DNA_1 < delta_DNA_2)

                    and deviation_ma25_sotto_ma300 < -0.25
                    
                    and deviation_ma50_sotto_ma100 > -0.17
                    and deviation_ma20_sotto_ma50 > -0.12

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04

                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"""BUY 1 che mancava > 50 000 righe - r 918 B - deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    """
                    
                    action = "buy"
                    percentage = 90

                    # 12 mag 2025 aggiunta questa perche' NON AVEVA COMPRATO. cazzo.
                    #  6 ago 2025 ok
                    #  7 AGO 2025 QUESTA E' ANDATA BENISSIMO
                    # 10 AGO 2025 E' ANDATA MALE mentre scendeva 
                    # 25 set 2025 tolta and deviation_ma3_sopra_ma10 > 0.01 perche' e' arrivata con un po' di ritardo.
                    # 25 set 2025 aggiunte parentesi graffe
                    # 25 set 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago a -0.045 da -0.035
                    # 26 set 2025 NON COMPAIONO I VALORI DENTRO LE PARENTESI GRAFFE
                    # 30 set 2025 ho messo sulla stessa riga di f""" BUY 1 una parentesi graffa. per cercare di risolvere.
                    # 30 set 2025 se 200 < 120 min or 300 < 120 min allora delta_50_25_last < delta_50_25_30_min_ago deve essere GIORNO. 
                    #  7 ott non ha preso neanche la parentesi graffa nella riga !




                elif (
                    ma3_last > ma13_last
                    and deviation_ma25_sotto_ma300 > -1.00

                    and ma100_last > ma450_last
                    and ma300_last > ma450_last
                    and ma300_last > ma300_30_min_ago
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.33
                    
                    and deviation_ma10_sotto_ma100 < -0.06
                 
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and ma3_last > ma8_last
                    
                    and macd > -200
                    and macd_differenza_2_min_ago > -18.00
                ):    
              
                    buy = "BUY 1 con 300>450 ma ribasso improvviso e, FORSE, rialzo veloce - r 920"
                    action = "buy"
                    percentage = 90

                    #  4 feb 2025 il trend e' ancora positivo (and ma300_last > ma450_last)
                    #  4 feb 2025 ma scende all' improvviso (and deviation_ma5_sopra_o_sotto_ma100 < -0.33)
                    #  4 feb 2025 ma si rialza velocemente il macd mostra un rialzo evidente (and macd_differenza_2_min_ago > 8.00)
                    #  5 feb 2025 tolto ma2 > ma2 2 min ago
                    #  5 feb 2025 aggiunta and 100>450 altrimenti comincia a comprare durante il ribasso
                    #  5 feb 2025 aggiunta and deviation_ma25_sotto_ma300 > -0.70 cioe' quando comincia a scendere basta comprare cosi' !
                    # 16 feb 2025 modificata ndecchiecella
                    # 16 feb 2025 and macd > -110 da > -100
                    # 16 feb 2025 and macd_differenza_2_min_ago > 6.00 da > 7.00
                    # 18 feb 2025 se il ribasso e' improvviso anche ma300_last > ma300_30_min_ago
                    # 18 feb 2025 perche' se ma300 scende da 30 minuti, e' chiaro, non e' piu' improvviso !
                    # 20 feb 2025 macd -125 da -110
                    # 20 feb 2025 and macd_differenza_2_min_ago > 6.00 significa che deve dare anche una botta al rialzo !
                    # 20 feb 2025 non basta che smette di crollare verticalmente ! (and macd_differenza_2_min_ago > -2.50)
                    # 15 apr 2025 modificato. per adesso la tengo. poi domani, chissa'.


                elif (    
                    ma20_last > ma200_last
                    and macd >= macd_2_min_ago
                    and ma10_last < ma100_last
                    and deviation_ma3_sopra_ma10 > 0.15
                    
                    and ma300_last > ma300_120_min_ago
                    and ma78_last > ma78_2_min_ago
                    
                    and ma69_last > ma100_last
                    and ma3_last > ma8_last
                    and deviation_bellissima > 0.14
                    and ma6_last > ma39_last
                ):    
              
                    buy = "BUY 1 con 20>200 AND 10 > 100 AND 3-10 > 0.15 and 69 > 100 and deviation_bellissima > 0.14 and ma78 > - r 935"
                    action = "buy"
                    percentage = 90
                    
                   
                
                elif (
                    ma3_last > ma20_last

                    and delta_1 < delta_2
                    and ma100_last > ma300_last
                    and ma100_last > ma100_60_min_ago

                    and (ma50_last < ma50_2_min_ago or ma20_last < ma50_last)
                    and ma150_last < ma250_last
                    
                    and macd_differenza_2_min_ago > -12.50
                ):
                    sell = "BUY 1 del 17 mag 2025 - che non aveva comprato - r 945"
                    action = "sell"

                    # 17 mag 2025 aggiunta dopo 50000 righe




                # BUY 1 piccola CORREZIONE FIAT = r 1226 RCCR medie mobili lunghe TUTTE IN RIALZO ! ma si verifica una correzione fiat !
                
                elif (
                    ma3_last > ma25_last
                    and macd >= macd_2_min_ago
                    and ma100_last > ma100_10_min_ago
                    and ma33_last > ma78_last
                    
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.59
                    and ma2_last > ma2_2_min_ago
                    
                ):    
                    
                    buy = "BUY 1 piccola CORREZIONE FIAT = r 1226 RCCR medie mobili lunghe TUTTE IN RIALZO ! ma si verifica una correzione fiat ! - r 965"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                # BUY 1 piccola CORREZIONE FIAT = r 1226 RCCR medie mobili lunghe TUTTE IN RIALZO ! ma si verifica una correzione fiat !
                
                elif (
                    ma3_last > ma25_last
                    and macd >= macd_2_min_ago
                    and ma100_last > ma100_10_min_ago
                    and ma33_last < ma78_last
                    
                    and deviation_ma3_sopra_ma10 > 0.18
                    and deviation_ma5_sopra_ma28 > 0.20
                    
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.59
                    and ma2_last > ma2_2_min_ago
                    
                ):    
                    
                    buy = "BUY 1 piccola CORREZIONE FIAT = r 1226 RCCR medie mobili lunghe TUTTE IN RIALZO ! ma si verifica una correzione fiat ! - r 994"
                    action = "buy"
                    percentage = 80
                    
                    # > estate alzato buy
                    
             
                
                # ------------------------------------------------------------ BUY 1 DURANTE IL RIALZO con INCROCIO CLASSICO 69-100 and ma78 < AND 5-28 > 0.11
                elif (    
                    ma20_last > ma200_last
                    and ma300_last > ma300_120_min_ago
                    and ma39_last > ma39_20_min_ago

                    and macd >= macd_2_min_ago
                    
                    and ma78_last < ma78_2_min_ago
                    and deviation_ma5_sopra_ma28 > 0.11
                    
                    and ma69_last > ma100_last
                    and ma3_last > ma8_last
                    and deviation_bellissima > 0.14
                    and ma6_last > ma39_last
                ):    
              
                    buy = "BUY 1 con 300> 120 min E 39>39 20 min ago E 69> 100 E dev_bellissima > 0.14 and ma78 < AND 5-28 > 0.11 - r 1021x"
                    action = "buy"
                    percentage = 90


                elif (    
                    ma20_last > ma200_last
                    and ma300_last > ma300_120_min_ago
                    and ma39_last < ma39_20_min_ago
                    and (ma10_prev < ma200_prev and ma10_last > ma200_last)

                    and macd >= macd_2_min_ago
                    
                    and ma78_last < ma78_2_min_ago
                    and deviation_ma5_sopra_ma28 > 0.11
                    
                    and ma69_last > ma100_last
                    and ma3_last > ma8_last
                    and deviation_bellissima > 0.14
                    and ma6_last > ma39_last
                ):    
              
                    buy = "BUY 1 con 300> 120 min MA 39<39 20 min ago E 69> 100 E dev_bellissima > 0.14 and ma78 < AND 5-28 > 0.11 - r 1021 y"
                    action = "buy"
                    percentage = 90

                    #  8 ott 2024 SE 39<39 20 min ago ho messo incrocio al rialzo 10-200 invece dell' osso (per non farla comprare!)
                    
                    
                    
                
                elif (      
                    ma3_last > ma11_last
                        
                    and (ma100_last > ma150_last or delta_1 < delta_2)
                    and (ma100_last > ma100_60_min_ago or ma300_last > ma300_120_min_ago)
                        
                    and ma2_last > ma5_last
                    and ma8_last > ma8_2_min_ago
                        
                ):
                    buy = "BUY 1 del 25 ott 2025 da un SELL GIORNO con ma100> E ma300> - r 1030"
                    action = "sell"

                    # 25 mar 2025 8-100 da 3-100 se GIORNO
                    #  8 ott 2025 10-100 da 8-100
                    # 18 ott 2025 aggiunta and ma10_last < ma30_last
                    # 25 ott 2025 aggiunta questa



                # BUY 1 con 28>300 and 69 > 100 e 200> and deviation_bellissima > 0.12 and 5-28>0.18

                elif (    
                    ma28_last > ma300_last
                    and macd >= macd_2_min_ago
                    and ma300_last < ma300_120_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.18
                    
                    and ma69_last > ma100_last
                    and ma3_last > ma8_last
                    and deviation_bellissima > 0.12
                    and ma6_last > ma39_last
                ):    
              
                    buy = "BUY 1 con 28>300 and 69 > 100 e 200> and deviation_bellissima > 0.12 and 5-28>0.18 - r 1041"
                    action = "buy"
                    percentage = 90



                elif (
                    ma3_last > ma8_last
                    
                    and ma300_last > ma300_301_min_ago

                    and deviation_ma200_sotto_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.70
                    
                    and deviation_ma3_sotto_ma50 < -0.33

                    and macd_differenza_2_min_ago > -5.50
                ):    
              
                    buy = "BUY 1 che mancava 26 mar 2025 - r 1042"
                    action = "buy"
                    percentage = 90

                    # 26 mar 2025 aggiunta questa condizione che mancava
                    
                 
                    
                    
                    
                    
                 
                
                elif (
                    ma3_last > ma13_last

                    and ma20_last < ma50_last
                    and (ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last)

                    
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15

                    and deviation_ma100_sopra_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.30

                    and ma450_last > ma450_360_min_ago
                    and delta_1_200_78 < delta_2_200_78_60_min

                    and deviation_ma39 < -0.05
                    
                    and ma5_last < ma150_last
                    and (ma20_last < ma20_2_min_ago or ma33_last < ma33_3_min_ago)
                    and ma200_last < ma200_60_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -18.50
                  
                ):
                    buy = f"BUY 1 {ma450_last} {ma450_360_min_ago} con 450>6 ore MA ritracciando ( vedi ma20 < or ma33 < ) - r 1043 Ax"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 ma non le e' troppo lontana
                    # 21 mar 2025 anticipata ndecchia
                    # 27 mar 2025 se ma5 STA SOTTO ma150 ritracciando ( vedi ma20< or ma33< ) compra con 3-39 < -0.30
                    # 27 mar 2025 se GIORNO and deviation_ma39 < -0.30
                    # 30 mar 2025 and deviation_ma200_sotto_ma300 > -0.07 significa che sotto questa soglia non e' piu' un ritracciamento

                    #  3 apr 2025 and ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last 
                    #  6 apr 2025 aggiunto and deviation_ma100_sopra_ma300 < -0.30 continuava a comprare male
                    #  6 apr 2025 aggiunto and deviation_ma25_sotto_ma300 < -0.30 continuava a comprare male
                    #  8 apr 2025 se 20<50 aggiungo le basi del ritracciamento
                    #  9 apr 2025 QUESTA CONDIZIONE E' STATA CORRETTA DAL MAESTRO COMPA ! AVE COMPA


                elif (
                    ma3_last > ma13_last

                    and (ma20_last < ma20_2_min_ago or ma33_last < ma33_3_min_ago)
                    and (ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last)
                    
                    and ma450_last > ma450_360_min_ago
                    and delta_1_200_78 < delta_2_200_78_60_min

                    and deviation_ma39 < -0.45
                    and deviation_ma3_sotto_ma50 < -0.25

                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -18.50
                  
                ):
                    buy = f"BUY 1 {ma450_last} {ma450_360_min_ago} con 450 > 6 ore ma ritracciando ( vedi ma20 < or ma33 < ) - riga 1043 AY"
                    action = "buy"
                    percentage = 50
                    
                    # importante : ma100 sta sotto la ma200 ma non le e' troppo lontana
                    # 21 mar 2025 anticipata ndecchia
                    # 27 mar 2025 se ma5 STA SOTTO ma150 ritracciando ( vedi ma20< or ma33< ) compra con 3-39 < -0.30
                    # 27 mar 2025 se NOTTE and deviation_ma39 < -0.45
                    #  2 apr 2025 and deviation_ma3_sotto_ma50 < -0.25

                    #  3 apr 2025 and ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last 
                    # 10 apr 2025 correzione or e aggiunta f


                    
                    
                
                # BUY 1 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-59 - r 1043 B
                
                elif (
                    
                    ma3_last > ma18_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 3
                    
                    and macd > -40
                    and macd_differenza_2_min_ago > 0.50
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    
                ):
                    buy = "BUY 1 migliore con distanza 5-300 E dev TRIADE e dev ma2 e diff macd - r 1043 B1 - NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 50

                
                elif (    
                    ma3_last > ma18_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    and ma5_last > ma50_last
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 3
                    
                    and macd > -40
                    and macd_differenza_2_min_ago > 0.50
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    
                ):
                    buy = "BUY 1 migliore con distanza 5-300 E dev TRIADE e dev ma2 e diff macd - r 1043 B1 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 50

                
                elif (    
                    ma3_last > ma15_last
                  
                    and delta_1 < delta_2
                    and deviation_ma50_sotto_ma100 > -0.05

                    and deviation_ma25_sotto_ma300 < -0.49
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -2.50
                 
                ):
                    buy = "BUY 1 GIORNO - che considera 5-300 e dev 10-200 < -0.30 - formula MY COMPA - r 1043 B1 NUOVA ERA A3 SOFT x1"
                    action = "buy"
                    percentage = 80

                    # 27 gen 2025 se GIORNO-GIORNO aggiunta and deviation_ma25_sotto_ma300 < -0.49
                    # 11 mar 2025 anticipato ndecchiecella ma forse cancellare
                    # 19 mag 2025 sto cercando di non cancellare. mi dispiace.
                    # 19 mag 2025 e' giorno MA la ma50 deve stare piu' vicina alla ma100 !
                    # 19 mag 2025 aggiunto ma39 < -0.10 
                    # 19 mag 2025 aggiunto 3-50 < -0.10


                elif (    
                    ma3_last > ma13_last

                    and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05

                    and delta_1 > delta_2
                    
                    and deviation_ma25_sotto_ma300 < -0.49
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago

                    and deviation_ma39 < -0.22
                    and deviation_ma3_sotto_ma50 < -0.20
                    and deviation_ma50_sotto_ma100 < -0.15
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                 
                ):
                    buy = f"""BUY 1 NOTTE ! - che considera 5-300 e dev 10-200 < -0.30 - formula MY COMPA + CM - r 1043 B1 NUOVA ERA A3 SOFT x2
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    
                    action = "buy"
                    percentage = 80

                    # 27 gen 2025 se GIORNO-GIORNO aggiunta and deviation_ma25_sotto_ma300 < -0.49
                    # 11 mar 2025 anticipato ndecchiecella ma forse cancellare
                    # 19 mag 2025 aggiunta questa con NOTTE che secondo me andra' meglio della precedente. che sto cercando di non cancellare.
                    # 22 set 2025 3-13 da 3-15 e macd diff a -18.50 da -2.50
                    # 22 set 2025 la tengo perche' e' intervenuta dove altre non lo hanno fatto.
                    #  8 ott 2025 aggiunta and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago
                    #  8 ott 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05
                    #  8 ott 2025 ( le parentesi graffe cosi' non funzionano )
                     

                elif (    
                    ma3_last > ma10_last

                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago

                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.083

                    and delta_1 < delta_2
                    and delta_300_200 < delta_300_200_30_min
                    

                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30
                    
                    and macd_differenza_2_min_ago > -18.00
                 
                ):
                    buy = f"BUY 1 formula MY COMPA + parentesi graffe - r 1043 B1 NUOVA ERA A3 SOFT y1 - deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}"
                    action = "buy"
                    percentage = 80

                    #  7 ott 2025 aggiunti i valori che ho ricavato dalle parentesi graffe di una condizione successiva che e' andata bene.
                    #  7 ott 2025 aggiunta parentesi graffa sulla stessa riga


                elif (
                    ma3_last > ma18_last

                    and ma450_last > ma450_480_min_ago
                    and ma78_last < ma150_last


                    and deviation_ma100_sopra_ma200 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.70
                    and deviation_ma50_sotto_ma100 < -0.25
                    and deviation_ma3_sotto_ma50 < -0.30


                    and ma450_last > ma450_720_min_ago
                    and ma100_last < ma100_90_min_ago
                    and ma200_last < ma200_20_min_ago
                    and ma300_last < ma450_last

                    # CANO STAF + zia amalia

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma10_sopra_ma200 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.20
                    
                    and deviation_ma50_sotto_ma300 < -0.36

                    # CANO STAF + zia amalia

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.13
                    and deviation_ma5_sotto_ma200 < -0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.08
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 1 formula MY COMPA + cano staf + zia amalia + DISTANZA AL RIBASSO - r 1043 B1 NUOVA ERA A3 SOFT y2"
                    action = "buy"
                    percentage = 80

                    #  4 feb 2025 aggiunta
                    # 25 mar 2025 tolte sovrastrutture
                    # 25 mar 2025 aggiunta distanza al ribasso
                    # 26 mar 2026 and macd_differenza_2_min_ago > -18.50


                elif (    
                    ma3_last > ma18_last
                  
                    and delta_1 > delta_2
                    and delta_300_200 < delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -1.20

                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.03
                   
                    and macd_differenza_2_min_ago > -1.25
                 
                ):
                    buy = "BUY 1 NOTTE-GIORNO - che considera 5-300 e dev 10-200 < -0.30 e 3-39 - formula MY COMPA - r 1043 B1 NUOVA ERA A3 SOFT y3"
                    action = "buy"
                    percentage = 80


                elif (    
                    ma3_last > ma18_last
                  
                    and delta_1 > delta_2
                    and delta_300_200 > delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -1.20

                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.03
                   
                    and macd_differenza_2_min_ago > -1.25
                 
                ):
                    buy = "BUY 1 NOTTE-NOTTE - che considera 5-300 e dev 10-200 < -0.30 e 3-39 - formula MY COMPA - r 1043 B1 NUOVA ERA A3 SOFT y4"
                    action = "buy"
                    percentage = 80

                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    
                    # 21 ottobre 2022  aggiunta di 3-10 e 5-28
                    # 21 ottobre 2022 3-10 = 0.01
                    # 21 ottobre 2022 5-28 = 0.05
                    # 28 ottobre 2022 5-28 = 0.04
                    # ave comba
                    # 31 ottobre aggiunta dev 10-200 - formula MY COMPA
                    # 19 gen 2023 doppio delta 200 100 giorno
                    # 11 ott 2023 5-39 da 8-50
                    # 11 ott 2023 5-28 a 0.02 da 0.04
                    #  6 dic 2023 and deviation_ma5_sopra_ma28 > -0.02 da 0.02
                    #  6 dic 2023 ma4_last > ma39_last da 5-39
                    # 10 set 2024 MODIFICATA
                    # 20 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 20 gen 2025 and macd_differenza_2_min_ago > -1.25 da 1.25
                    # 27 gen 2025 se GIORNO-NOTTE aggiunta and deviation_ma25_sotto_ma300 < -1.20

                
                elif (    
                    ma3_last > ma18_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 3
                    
                    and macd > -40
                    and macd_differenza_2_min_ago > 0.50
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    
                ):
                    buy = "BUY 1 migliore con distanza 5-300 E dev TRIADE e dev ma2 e diff macd - r 1043 B1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 50
                    
                    # ma200 ha fatto lo scherzetto ERA SUPERIORE E HA FATTO COMPRARE IN RITARDO !
                    # ma300 e ma450 erano inferiori
                    #  9 dic 2023 aggiunto and ma2_differenza_2_min_ago > 3
                    # 11 dic 2023 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.0175 = +7 pts
                    # 11 dic 2023 tolto and macd >= macd_2_min_ago che ha fatto arrivare tardi !
                    # 11 dic 2023 aggiunto and macd > -8 cioe' IL MACD COMINCIA A NON PERDERE COSI' TANTO
                    # 11 dic 2023 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02 = 8 pts
                    # 26 dic 2023 aggiunto dev ma2
                    # 26 dic 2023 aggiunto diff macd

                
                elif (    
                    ma3_last > ma18_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    and ma5_last > ma54_last
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 3
                    
                    and macd > -40
                    and macd_differenza_2_min_ago > 0.50
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    
                ):
                    buy = "BUY 1 migliore con distanza 5-300 E dev TRIADE e dev ma2 e diff macd - r 1043 B1 - NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 50

                
                elif (    
                    ma3_last > ma18_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    and ma5_last > ma54_last
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 3
                    
                    and macd > -40
                    and macd_differenza_2_min_ago > 0.50
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    
                ):
                    buy = "BUY 1 migliore con distanza 5-300 E dev TRIADE e dev ma2 e diff macd - r 1043 B1 - NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 50



               
                
                # BUY 1 migliore che considera distanza 5-300

                elif (    
                    ma3_last > ma16_last
                    and ma450_last > ma450_480_min_ago

                    and delta_300_200 > delta_300_200_60_min
                    and deviation_ma25_sotto_ma300 < -1.20

                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 1 - NOTTE - migliore con distanza 5-300 e distanza 5-100 con 3-16 E dev TRIADE e diff macd - r 1043 B1x1 x"
                    action = "buy"
                    percentage = 70

                    # 24 feb 2024  3-16 da 3-18
                    # 27 gen 2025 se NOTTE aggiunta and deviation_ma25_sotto_ma300 < -1.20
                    #  7 feb 2025 tolta and ma2_last >= ma2_2_min_ago
                    #  7 feb 2025 vedo che comincia ad andare bene and deviation_ma5_sopra_o_sotto_ma100 > -0.60 da > -0.50
                    #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago



                elif (    
                    ma3_last > ma16_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and ma100_last < ma100_60_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015

                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago

                    and deviation_ma3_sopra_ma10 > 0.010
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 1 CONTINUA A SCENDERE DNA - r 1043 B1x1 y"
                    action = "buy"
                    percentage = 70

                    # 24 feb 2024  3-16 da 3-18
                    # 27 gen 2025 se NOTTE aggiunta and deviation_ma25_sotto_ma300 < -1.20
                    #  7 feb 2025 tolta and ma2_last >= ma2_2_min_ago
                    #  7 feb 2025 vedo che comincia ad andare bene and deviation_ma5_sopra_o_sotto_ma100 > -0.60 da > -0.50
                    #  3 mar 2025 aggiunta CONTINUA A SCENDERE DNA


                elif (
                    
                    ma3_last > ma28_last
                    and ma10_last >= ma20_last
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.21
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and delta_100_200_last < delta_100_200_120_min_ago

                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 9
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd > -11
                    and macd_differenza_2_min_ago > 1.00
                    
                ):
                    buy = "BUY 1 24 feb 2024 > 180 min di ribasso con 4-28 5-100<-0.21 se doppio delta 100-200 GIORNO - r 1043 B1x2"
                    action = "buy"
                    percentage = 90


                
                





                
                elif (
                    ma3_last > ma20_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma39_sotto_ma100 > -0.15


                    and ma50_last < ma50_2_min_ago
                    
                    and deviation_ma25_sotto_ma300 < -1.20
                    and deviation_ma50_sopra_o_sotto_ma300 < -0.70

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma5_sotto_ma200 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.40

                    and ma100_last < ma100_60_min_ago
                        
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                        
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and macd > -70
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 1 migliore con distanza 5-300 e CONTINUA A SCENDERE - r 1043 B1 Y"
                    action = "buy"
                    percentage = 80
                    
                    #  8 mar 2024 anticipata ndecchiecella
                    #  9 dic 2024 tolto ma2 > ma2 2 min ago !
                    #  9 dic 2024 aggiunto and deviation_ma39 < -0.03
                    #  9 dic 2024 aggiunto and deviation_ma3_sotto_ma50 < -0.06
                    # 30 dic 2024 anticipata
                    # 27 gen 2025 se NOTTE and deviation_ma25_sotto_ma300 < -1.20 da < -0.70
                    #  3 feb 2025 aggiunta and deviation_ma5_sotto_ma300 < -0.40
                    #  3 feb 2025 aggiunta and deviation_ma10_sopra_ma200 < -0.20
                    #  4 feb 2025 va bene 
                    # 26 feb 2025 aggiunta CONTINUA A SCENDERE !

                
                elif (    
                    ma3_last > ma18_last
                  
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 migliore che considera distanza 5-300 E dev 10-200 < -0.24 AND dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 1043 B2 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 50

                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and ma5_last > ma50_last
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 migliore che considera distanza 5-300 E dev 10-200 < -0.24 AND dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 1043 B2 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 50

                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 migliore che considera distanza 5-300 E dev 10-200 < -0.24 AND dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 1043 B2 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 50

                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 migliore che considera distanza 5-300 E dev 10-200 < -0.24 AND dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 1043 B2 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 50

                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 migliore che considera distanza 5-300 E dev 10-200 < -0.24 AND dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 1043 B2 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 50

                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 distanza 5-300 E dev 10-200 < -0.24 AND dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 1043 B2 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 50
                    
                    #  8 lug 2023 4-18
                    # 10 ago 2023 3-18
                    # 12 ott 2023 3-16 a -0.125 da -0.12
                    # 12 ott 2023 5-28 a -0.155 da -0.15
                    # 17 nov 2023 tolto ma200 < alla 1043 B1 perche' era superiore !


              
              
                    
                # BUY 1 zona inferiore 1043 C

                elif (
                    
                    ma3_last > ma20_last
                    and ma450_last > ma450_480_min_ago


                    and delta_1 < delta_2
                    and delta_1_200_78 < delta_2_200_78_60_min

                    and deviation_ma300_sopra_ma450 < -0.29
                    and deviation_ma100_sopra_ma200 < -0.40
                    and deviation_ma5_sotto_ma300 < -0.75

                    and deviation_ma39 < -0.13
                    and deviation_ma3_sotto_ma50 < -0.17
                    
                    and ma39_last > ma100_last
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > -70
                    and macd_differenza_2_min_ago > -2.50
              
                ):
                    buy = "BUY 1 con ma450_last < ma450_360_min_ago and delta_1 < delta_2 and delta_1_200_78 < delta_2_200_78_60_min - r 1043 C1"
                    action = "buy"
                    percentage = 80

                    #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago


                elif (
                    
                    ma3_last > ma20_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and macd_differenza_2_min_ago > -2.50
              
                ):
                    buy = "BUY 1 CONTINUA A SCENDERE DNA - r 1043 C2"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    # 26 feb 2025 anticipato ndecchia
                    # 26 feb 2025 aggiunta and deviation_ma39 < -0.13
                    # 26 feb 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.17
                    #  3 mar 2025 aggiunta CONTINUA A SCENDERE DNA

                     
                elif (    
                    ma20_last > ma200_last
                    and macd >= macd_2_min_ago
                    and ma300_last < ma300_120_min_ago
                    and ma200_last < ma200_60_min_ago
                  
                    and deviation_ma300_sopra_ma450 > -0.15
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.15
                    and deviation_bellissima > 0.10
                    
                    and ma69_last > ma100_last
                    and ma3_last > ma8_last
                    
                    and ma6_last > ma39_last
                ):    
              
                    buy = "BUY 1 con 28>200 and 69 > 100 e 200< and 5-28 > 0.16 and 3-10 > 0.10 CON 300 vicina o sopra alla 450 - r 1061"
                    action = "buy"
                    percentage = 90
                    
                    # > estate dev bellissima 0.12 and 5-28 0.16 and 3-10 > 0.10
                    # 17 mar 2023 28-200 da 28-300
                    # 300 vicina o sopra alla 450


                    
                
                # -------------------------------------------------- BUY 1 MOLTO RISCHIOSO modo 1 ! quando incomincia il ribasso MA ma300 120 > E ma200 120 >
                    
                elif (     
                    ma300_last > ma300_120_min_ago
                    and macd >= macd_2_min_ago
                    and ma78_last > ma100_last
                    and ma200_last > ma200_120_min_ago
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and ma200_last > ma300_last
                    
                    and ma8_last > ma78_last
                    
                    and deviation_ma3_sopra_ma10 > 0.077
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_bellissima > 0.07
               
                    and ma2_last >= ma2_2_min_ago
                ):     
                  
                    buy = "BUY 1 70% - ma300 > 120 min e ma200 > 120 min E 200 > 300 MA incomincia il ribasso e 3-10 > 0.10 - r 1088 A1 x1"
                    action = "buy"
                    percentage = 70

                    #  8 mar 2024 aggiunta questa condizione per anticipare durante il rialzo


                
                elif (    
                    ma3_last > ma39_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30

                    and ma200_last > ma300_last
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.04
                    and deviation_ma3_sopra_ma16 > 0.05
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):     
                  
                    buy = "BUY 1 70% - ma300 > 120 min e ma200 > 120 min E 200 > 300 MA incomincia il ribasso e prendo coltello con il piede - r 1088 A1 x2"
                    action = "buy"
                    percentage = 70

                    #  8 mar 2024 anticipato ndecchiecella
                    
                    
                    
                # ------------------------------------------------------ BUY 1 MOLTO RISCHIOSO modo 1 ! quando incomincia il ribasso MA ma300 120 > E ma200 120 >
                  
                elif (     
                    ma300_last > ma300_120_min_ago
                    and macd >= macd_2_min_ago
                    and ma78_last < ma100_last
                    and ma200_last > ma200_120_min_ago
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and ma200_last > ma300_last
                    
                    and ma8_last > ma78_last
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.30
                    and deviation_bellissima > 0.07
               
                    and ma2_last >= ma2_2_min_ago
                ):     
                  
                    buy = "BUY 1 - 80% - RISCHIOSO ! incomincia il ribasso MA ma300 120 > e ma200 120 > ANCORA IN RIALZO ! E 200 > 300 e 3-10 > 0.10 - r 1088 A1y"
                    action = "buy"
                    percentage = 80
                    
                  
                    
                    
                # ------------------------------------------------------ BUY 1 MOLTO RISCHIOSO modo 1 ! quando incomincia il ribasso MA ma300 120 > E ma200 120 >
                  
                elif (     
                    ma300_last > ma300_120_min_ago
                    and macd >= macd_2_min_ago
                    and ma200_last > ma200_120_min_ago
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and ma200_last < ma300_last
                    
                    and ma8_last > ma78_last
                    
                    and deviation_ma3_sopra_ma10 > 0.13
                    and deviation_ma5_sopra_ma28 > 0.20
                    and deviation_bellissima > 0.10
               
                    and ma2_last >= ma2_2_min_ago
                ):     
                  
                    buy = "BUY 1 al 70% RISCHIOSO ! incomincia il ribasso MA ma300 120 > e ma200 120 > ANCORA IN RIALZO ! MA 200 < 300 e 3-10 > 0.13 - r 1114 A2"
                    action = "buy"
                    percentage = 70
                    
                    
                  
                    
                    
                # ------------------------------------------------------------ BUY 1 MOLTO RISCHIOSO modo 1 ! quando incomincia il ribasso MA ma300 > MA ma200 120 <
                  
                elif (     
                    ma300_last > ma300_120_min_ago
                    and macd >= macd_2_min_ago
                    and ma200_last < ma200_120_min_ago
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and ma8_last > ma48_last
                    
                    and deviation_ma3_sopra_ma10 > 0.12
                    and deviation_ma5_sopra_ma28 > 0.19
                    
                    and ma5_last > ma200_last
                    and ma2_last > ma2_2_min_ago
                    
                ):     
                  
                    buy = "BUY 1 MOLTO RISCHIOSO modo 1 ! quando incomincia il ribasso MA ma300 ANCORA IN RIALZO MA ma200 120 < con 3-10 > 0.13 - r 1139 B1"
                    action = "buy"
                    percentage = 90
                    
                    
                 
                    
                # BUY 1 MOLTO RISCHIOSO modo 1 ! quando incomincia il ribasso MA ma300 > MA ma200 120 <
                # oggi 14 apr 2025 cancellato r 1139 B2
                
                    
                  
                    
                    
                # ------------------------------------------------------------ BUY 1 MOLTO RISCHIOSO modo 2 ! quando incomincia il ribasso MA ma300 > E MA 200>300
                
                elif (     
                    ma300_last > ma300_120_min_ago
                    and macd >= macd_2_min_ago
                    and ma200_last > ma300_last
                    and ma78_last > ma100_last
                    and ma8_last > ma100_last
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.17
                    and deviation_bellissima > 0.14
                    
                    and ma2_last > ma2_2_min_ago
                ):     
                  
                    buy = "BUY 1 MOLTO RISCHIOSO modo 2 ! quando incomincia il ribasso MA ma300 > E 200>300 con 78>100 - r 1161 A1"
                    action = "buy"
                    percentage = 80
                    
                  
                    
                # ----------------------------------------------------- BUY 1 MOLTO RISCHIOSO modo 2 ! quando incomincia il ribasso MA ma300 > E MA 200>300
                
                elif (     
                    ma300_last > ma300_301_min_ago
                    and macd >= macd_2_min_ago
                    and ma200_last > ma300_last
                    and ma78_last < ma100_last
                    and ma8_last > ma100_last
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma3_sopra_ma10 > 0.11
                    and deviation_ma5_sopra_ma28 > 0.13
                    and deviation_bellissima > 0.10
                    and ma2_last > ma2_2_min_ago
                ):     
                  
                    buy = "BUY 1 MOLTO RISCHIOSO modo 2 ! quando incomincia il ribasso MA ma300 > E 200>300 con 78<100 e 5-28 > 0.19 - r 1161 A2"
                    action = "buy"
                    percentage = 80
                    
                    # 28 set se 300 sale da 5 ore ho anticipato il buy di una ndecchiecella
                    
                    
                
                    
                    
                # --------------------------- BUY 1 quando incomincia il ribasso MA ma300 > ma300_120_min_ago


                elif (       
                    ma3_last > ma20_last
                    and ma20_last > ma40_last
                    
                    and deviation_ma200_sotto_ma300 < -0.17
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma39 < -0.02

                    and ma300_last > ma300_120_min_ago
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma5_last < ma300_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):     
                  
                    buy = "BUY 1 quando incomincia il ribasso MA ma300 > ma300_120_min_ago  - r 1184 B1 x"
                    action = "buy"
                    percentage = 90

                    # 17 apr 2025 SE 20>40
                    # 17 apr 2025 aggiunta and macd_differenza_2_min_ago > -18.50 e tolta macd > -60


                elif (       
                    ma3_last > ma20_last
                    and ma20_last < ma40_last
                    and deviation_ma3_sotto_ma50 < -0.05

                    and deviation_ma200_sotto_ma300 < -0.17
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma39 < -0.02

                    and ma300_last > ma300_120_min_ago
                    
                    and ma200_last < ma200_60_min_ago
                    and ma100_last < ma100_60_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma5_last < ma300_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):     
                  
                    buy = "BUY 1 quando incomincia il ribasso MA ma300 > ma300_120_min_ago  - r 1184 B1 y"
                    action = "buy"
                    percentage = 90
                    
                    # 20 set 2022 aggiunto 3-10 > 0.11
                    #  1 ott 2022 3-10 > 0.135
                    #  7 feb 2025 dopo quasi 3 anni aggiunta quando comincia il ribasso come si deve !
                    # 17 apr 2025 SE 20<40 allora aggiungo and deviation_ma3_sotto_ma50 < -0.05
                    # 17 apr 2025 aggiunta and macd_differenza_2_min_ago > -18.50 e tolta macd > -60
                    
                    





                # ------------------------------------------------------------ BUY 1 LATERALE 2



                elif (    
                    ma3_last > ma11_last
                    and ma100_last > ma100_60_min_ago

                    and delta_450_300 < delta_450_300_60_min

                    and ma300_last < ma300_180_min_ago
                    and ma150_last < ma250_last

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.22
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma25_sotto_ma300 < -0.11

                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma300_sopra_ma450 < 0.50
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = f"""BUY 1 GIORNO mentre la 300 si avvicina alla 450 MA con ma300_last < 3 ore MA 100 > 1 ora - r 1200 AX
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 80


                elif (    
                    ma3_last > ma11_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago


                    and delta_450_300 < delta_450_300_60_min

                    and ma300_last < ma300_180_min_ago
                    and ma150_last < ma250_last

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    

                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma300_sopra_ma450 < 0.50
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = f"""BUY 1 GIORNO mentre la 300 si avvicina alla 450 MA con ma300_last < 3 ore E 100 < 1 ora + CM GIORNO - r 1200 AY 1
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 80


                 
                elif (    
                    ma3_last > ma11_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and deviation_ma25_sotto_ma300 < -0.46
                    and deviation_ma39 < -0.28
                    and deviation_ma3_sotto_ma50 < -0.35

                    and delta_450_300 < delta_450_300_60_min

                    and ma300_last < ma300_180_min_ago
                    and ma150_last < ma250_last

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    

                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma300_sopra_ma450 < 0.50
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = f"""BUY 1 GIORNO mentre la 300 si avvicina alla 450 MA con ma300_last < 3 ore E 100 < 1 ora + 25-300 E 3-39 E 3-50  - r 1200 AY 2
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 80

                    # 19 feb 2024 3-15 ! da 5-50
                    # 21 feb 2024 anticipato ndecchiecella
                    # 29 mar 2025 aggiunta questa nuova condizione
                    # 29 mar 2025 considera che oltre ad essere GIORNO ma100 comincia a perdere di meno.
                    # 14 apr 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    # 16 mag 2025 e' andata bene
                    # 16 mag 2025 aggiungo parentesi per capire meglio
                    # 16 mag 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago a -0.14 da -0.13
                    # 17 ago 2025 aggiungendo il mio capolavoro ho tolto 3-39 e 3-50 - vedi i valori quando si verifichera' questa condizione.
                    # 17 ago 2025 ho suddiviso il mio capolavoro e probabilmente NON SERVIRA' COMPRARE con 25-300 e 3-39 e 3-50 UN PO' PIU' GIU'.
                    # 17 AGO 2025 probabilmente servira' L' INVERSIONE INDICATA DA CM - GIORNO !
                    # 17 AGO 2025 DOVRAI QUINDI TORNARE ALLA VERSIONE CLASSICA DEL MIO CAPOLAVORO ma senza 3-39 e 3-50
     







                elif (    
                    ma3_last > ma11_last
                    and delta_450_300 > delta_450_300_60_min

                    and ma300_last < ma300_180_min_ago

                    and deviation_ma50_sotto_ma100 < -0.45
                    
                    and deviation_ma39 < -0.14
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma25_sotto_ma300 < -0.40
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.085
                    
                    and macd_differenza_2_min_ago > -18.50
                   
                ):
                    buy = f"BUY 1 NOTTE mentre la 300 si allontana dalla 450 e con ma300_last < 3 ore  - r 1200 Bx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    #  7 mag 2025 COMPRA SE 50<100 DI MOLTO (e va bene cosi')
                    # 16 ott 2025 ko !
                    # 16 ott 2025 aggiungo parentesi graffe 
                    # 16 ott 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago a > -0.085 da > -0.15



                elif (    
                    ma3_last > ma11_last

                    and ma300_last < ma300_180_min_ago
                    and (deviation_ma50_sotto_ma100 > -0.15 and deviation_ma3_sotto_ma50 < -0.50)
                    and deviation_ma39 < -0.14
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15

                    and delta_450_300 > delta_450_300_60_min

                    and ma100_last < ma100_10_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.45
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                   
                ):
                    buy = "BUY 1 NOTTE mentre la 300 si allontana dalla 450 e con ma300_last < 3 ore  - r 1200 BY"
                    action = "buy"
                    percentage = 80

                    # 19 feb 2024 3-15 ! da 5-50
                    # 21 feb 2024 anticipato ndecchiecella
                    # 29 mar 2025 aggiunta questa nuova condizione
                    # 29 mar 2025 considera che anche se e' NOTTE ma100 comincia a perdere di meno.
                    # 28 apr 2025 aggiunta and (deviation_ma5_sopra_o_sotto_ma100 < -0.50 or deviation_ma5_sopra_o_sotto_ma100 > -0.22)
                    # 28 apr 2025 significa che se devi comprare 
                    # 28 apr 2025 ma5 deve stare piu' giu' della 100 (vuole un osso) oppure ma5 deve stare vicina alla 100 (sta girando al rialzo)
                    #  7 mag 2025 COMPRA ANCHE SE 50<100 NON DI MOLTO MA 3<50 (deve essere) DI MOLTO ! (ro cano vuole l' osso !)



                elif (
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20

                    and ma100_last < ma100_60_min_ago
                    and ma5_last >= ma10_last
                    and ma450_last >= ma450_360_min_ago
                 
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - ex 1537 A3y RCCR con 3-30 E CON 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > 0.001 + MACD > - r 1204 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90
                    
                    # 8 gen 2024 incrocio 3-30 piu' veloce di 10>20 !

              
                  
                elif (
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last

                    and ma100_last < ma100_60_min_ago
                    and ma5_last >= ma10_last
                    and ma450_last >= ma450_360_min_ago
               
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - ex 1537 A3y RCCR con 3-30 E CON 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > 0.001 + MACD > - r 1204 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90

                
                   
                elif (
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 

                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015

                    and ma450_last >= ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.10

                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and macd_differenza_2_min_ago > -5.50
                    
                ):    
                    buy = "BUY 1 con 3-20 E 300 vicina alla 450 + macd diff > -2.50 - r 1204 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90
                    
                    # 8 gen 2024 incrocio 3-30 piu' veloce di 10>20 !
                    #  2 mar 2025 ho voluto tenerla ma anticipando ndecchiecella !
                  
                
                # 10 set 2024 cancellata r 1204 NUOVA ERA A3 SOFT

                elif (
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                 
                    and ma100_last < ma100_60_min_ago
                    and ma5_last >= ma10_last
                    and ma450_last >= ma450_360_min_ago
                
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 CF - ex 1537 A3y RCCR con 3-30 E CON 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > 0.001 + MACD > - r 1204 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90
                    
                    # 8 gen 2024 incrocio 3-30 piu' veloce di 10>20 !

                  
                elif (
                    ma3_last > ma20_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22

                    and ma100_last < ma100_60_min_ago
                    and ma5_last >= ma10_last
                    and ma450_last >= ma450_360_min_ago
              
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 CF - ex 1537 A3y RCCR con 3-30 E CON 300 vicina alla 450 ( anche poco sotto ! ) and 3-18 > 0.001 + MACD > - r 1204 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # 8 gen 2024 incrocio 3-30 piu' veloce di 10>20 !

                 
                elif (
                    ma3_last > ma20_last
                  
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
              
                    and ma100_last < ma100_60_min_ago
                    and ma5_last >= ma10_last
                    and ma450_last >= ma450_360_min_ago
             
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 CF - ex 1537 A3y RCCR con 3-30 E CON 300 vicina alla 450 ( anche poco sotto ! ) and 3-18 > 0.001 + MACD > - r 1204 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

              
                
                elif (
                    ma3_last > ma18_last
                    and ma450_last >= ma450_360_min_ago

                    and ma100_last < ma100_30_min_ago
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and ma5_last >= ma10_last
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= -40
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.012
                    and macd_differenza_2_min_ago > -1.50
                    
                ):    
                    buy = "BUY 1 CF - con 3-18 + ZIA AMALIA GRAFANA - r 1204 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # 8  gen 2024 incrocio 3-30 piu' veloce di 10>20 !
                    # 20 feb 2024 3-18 da 3-20
                    #  4 ott 2024 va bene cosi'. ci prova. anticipata di meno di una ndecchiecella
                    # 11 nov 2024 ZIA AMALIA GRAFANA


                elif (
                    ma3_last > ma13_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.36
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70

                elif ( 
                    ma3_last > ma13_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.36
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 70


                elif (    
                    ma3_last > ma13_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    and ma450_last > ma450_180_min_ago

                    and deviation_ma300_sopra_ma450 < 0.19
                    and deviation_ma300_sopra_ma450 > -0.19
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.017
                    
                    and macd >= macd_2_min_ago
                    and macd > -30

                    and macd_differenza_2_min_ago > -2
                    
                    and ma2_differenza_ma5 > 5
                ):  
                    
                    buy = "BUY 1 TL con ma300_last > 3 ore e 3-10 > 0.01 e macd_dif_2_min_ago > -2 con 450 < 3h - r 1205 AX NUOVA ERA A2 SOFT 2x"
                    action = "buy"
                    percentage = 70

                    #  9 set 2024 tolta diff macd in questa situazione (and deviation_ma5_sopra_o_sotto_ma100 < -0.60)
                    #  9 set 2024 aggiunta and macd_differenza_2_min_ago > -2 (cioe' il MACD SMETTE DI DECRESCERE BRUSCAMENTE)
                    # 17 set 2024 con 450 > 3h (anticipato ndecchiecella)
                    # 26 set 2025 TL = trend laterale

                elif (    
                    ma3_last > ma13_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    and ma450_last < ma450_180_min_ago

                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20

                    and macd_differenza_2_min_ago > -2
                    
                    and ma2_differenza_ma5 > 8
                ):  
                    
                    buy = "BUY 1 TREND LATERALE con ma300_last > 3 ore e 3-10 > 0.01 e macd > -20 con 450 < 3h - r 1205 AX NUOVA ERA A2 SOFT 2y"
                    action = "buy"
                    percentage = 70

                    #  9 set 2024 tolta diff macd in questa situazione (and deviation_ma5_sopra_o_sotto_ma100 < -0.60)
                    #  9 set 2024 aggiunta and macd_differenza_2_min_ago > -2 (cioe' il MACD SMETTE DI DECRESCERE BRUSCAMENTE)
                    # 17 set 2024 450 < 3h



                elif (    
                    ma3_last > ma13_last
                    and (ma3_last < ma20_last or ma20_last < ma20_2_min_ago)

                    and ma300_last > ma300_180_min_ago
                    and ma100_last > ma100_120_min_ago

                    and deviation_ma200_sotto_ma300 < -0.05
                    and deviation_ma200_sotto_ma300 > -0.01

                    and ma5_last < ma150_last
                    
                    and deviation_ma39 < -0.40
                    and deviation_ma3_sotto_ma50 < -0.09

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and macd_differenza_2_min_ago > -18.50
                   
                ):  
                    
                    buy = f"BUY 1 {ma300_last} {ma300_180_min_ago} con ma300 > 3 ore ritracciando - r 1205 AX NUOVA ERA A3 SOFT x"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se 39 sale da 15 min ok cosi'
                    # 17 feb 2025 tolta and ma39_last > ma39_15_min_ago
                    # 17 feb 2025 and macd > -70 da -20
                    # 17 feb 2025 aggiunta and deviation_ma39 < -0.05
                    # 17 feb 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.09
                    # 23 mar 2025 anticipata ndecchiecella
                    # 23 mar 2025 per adesso la tengo
                    # 27 mar 2025 se 5 SOTTO 150 ritracciando deve essere dev 3-39 < -0.30
                    # 27 mar 2025 aggiunto and deviation_ma200_sotto_ma300 < -0.05
                    #  7 apr 2025 per adesso lo lascio cosi' senza imporre le condizioni del ritracciamento.
                    # 10 apr 2025 buy = f"BUY 1 {ma300_last} {ma300_180_min_ago} con 450>6 ore MA ritracciando r 1205 AX NUOVA ERA A3 SOFT x"
                    # 10 apr 2025 and (ma3_last < ma20_last or ma20_last < ma20_2_min_ago)


                elif (    
                    ma3_last > ma13_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192

                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 TL con ma300 > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A3 SOFT y1"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se 39 scende da 15 min allora deve comprare con dev 39 > 0.192
                    # 26 set 2025 TL = trend laterale

                elif (    
                    ma3_last > ma13_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30

                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 TREND LAT con ma300 > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A3 SOFT y2"
                    action = "buy"
                    percentage = 70

                    #  5 mar 2024 se 39 scende da 15 min allora deve comprare con dev 5-100 < -0.30



                elif (    
                    ma3_last > ma13_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70

              

                elif (    
                    ma3_last > ma13_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                  
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70
                  

                elif (    
                    ma3_last > ma13_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70

                
                elif (    
                    ma3_last > ma13_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma100_last > ma100_120_min_ago
                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last > 3 ore e 3-10 > 0.01 e macd > -20 e ma2_diff_2_min_ago > 7 - r 1205 AX NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 70

              

                
                elif (    
                    ma3_last > ma13_last
                    and ma300_last > ma300_180_min_ago
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma10_sotto_ma100 < -0.06
                    and deviation_ma10_sotto_ma100 > -0.31
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma4_sopra_ma28 > -0.05
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_ma5 > 10
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last > ma300_180_min_ago e con 3-10 > 0.01 con macd > -20 and ma2_differenza_2_min_ago > 7 - r 1205 ay"
                    action = "buy"
                    percentage = 60
                    
                    #  5 mag 2023 ho tolto and ma250_last > ma300_last
                    # attenzione ! adesso questa condizione si attiva anche se ma250_last < ma300_last ! MA SEMPRE durante un CONSOLIDATO TREND LATERALE.
                    # vediamo come va.
                    # vedi 19 maggio 2023 ore 17:47 !
                    #  8 giu 2023 and deviation_ma3_sopra_ma16 > 0.112
                    # 24 ago 2023 forse in futuro dovrai mettere macd > 5
                    # 24 ago 2023 and macd > 5
                    #  5 ott 2023 ridotto ndecchiecella
                    # 11 ott 2023 macd > 0 da macd > 5
                    # 11 ott 2023 dev 3-10 a 0.04 da 0.05
                    # 11 ott 2023 dev 3-16 a 0.07 da 0.08
                    # 11 ott 2023 dev 4-28 a -0.03 da -0.02
                    # 10 dic 2023 anticipato ndecchiecella
                    #  9 gen 2024 anticipato ancora
                    # 18 gen 2024 qui ma300 sale da 3 ore.
                    # 18 gen 2024 300 sale da 3 ore ma ma100 scende da 2 ore ! metto dev 5-100 > 0.28 come NUOVA ERA SOFT !




                elif (    
                    ma3_last > ma18_last

                    and (ma39_last < ma100_last or ma100_last < ma100_10_min_ago)
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.13
                    and deviation_ma3_sotto_ma50 < -0.11
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15

                    and ma300_last < ma300_180_min_ago
                    
                    and ma450_last > ma450_720_min_ago

                    and deviation_ma300_sopra_ma450 < 0.017
                    and deviation_ma300_sopra_ma450 > -0.017
                    
                    and deviation_ma100_sopra_ma300 < 0.33
                    and deviation_ma100_sopra_ma300 > -0.33
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and macd > -100
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 1 TREND LATERALE MA 39<100 or 100 scende da 10 min - ritracciamento - r 1205 B NUOVA ERA A1 SOFT X"
                    action = "buy"
                    percentage = 80

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 29 gen 2025 3-20 da 3-54
                    # 31 gen 2025 CONSOLIDATO TREND LATERALE !
                    # 18 apr 2025 se ma39_last < ma100_last or ma100_last < ma100_10_min_ago forse sta ritracciando !
                    # 18 apr 2025 aggiunto and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    # 18 apr 2025 aggiunto and deviation_ma3_sotto_ma50 < -0.10
                    #  8 mag 2025 aggiunto and deviation_ma5_sopra_o_sotto_ma100 < -0.15




                elif (    
                    ma3_last > ma20_last
                    and ma450_last < ma450_720_min_ago
                    and ma300_last < ma300_180_min_ago

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176

                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.09
   
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                        
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                   
                ):
                    buy = "BUY 1 NON E' CONSOLIDATO TREND LATERALE con ma450_last < ma450_720_min_ago e con ma300 < 3 ore - r 1205 B NUOVA ERA A1 SOFT Y"
                    action = "buy"
                    percentage = 80

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 17 feb 2025 3-18 da 3-54
                    # 17 feb 2025 tolto ma2 > ma2 2 min ago
                    # 17 feb 2025 aggiunta and deviation_ma39 < -0.08
                    # 17 feb 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.09
                    #  7 ago 2025 modificata aggiungendo delle condizioni che hanno funzionato bene durante il ribasso




                # 12 set 2024 cancellata r 1205 B NUOVA ERA A2 SOFT 1



                

                elif (    
                    ma3_last > ma39_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last < 3 ore e 3-10 > 0.01 e macd > -20 and ma2_diff_2_min_ago > 7 - r 1205 B NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 50


                #  3 ott 2024 r 1205 B NUOVA ERA A3 SOFT cancellata


                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last < 3 ore e 3-10 > 0.01 e macd > -20 and ma2_diff_2_min_ago > 7 - r 1205 B NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 50

                elif (    
                    ma3_last > ma54_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last < 3 ore e 3-10 > 0.01 e macd > -20 and ma2_diff_2_min_ago > 7 - r 1205 B NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 50
                    

                elif (    
                    ma3_last > ma54_last
                    
                    and ma3_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last < 3 ore e 3-10 > 0.01 e macd > -20 and ma2_diff_2_min_ago > 7 - r 1205 B NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 50



              
                elif (    
                    ma3_last > ma20_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                    
                    and ma2_differenza_ma5 > 10
                ):
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con ma300_last < 3 ore e 3-10 > 0.01 e macd > -20 and ma2_diff_2_min_ago > 7 - r 1205 B NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 50
                    
                    #  5 mag 2023 ho tolto and ma250_last > ma300_last
                    # attenzione ! adesso questa condizione si attiva anche se ma250_last < ma300_last ! MA SEMPRE durante un CONSOLIDATO TREND LATERALE.
                    # vediamo come va.
                    # vedi 19 maggio 2023 ore 17:47 !
                    #  8 giu 2023 and deviation_ma3_sopra_ma16 > 0.112
                    # 24 ago 2023 forse in futuro dovrai mettere macd > 5
                    # 24 ago 2023 and macd > 5
                    #  5 ott 2023 ridotto ndecchiecella
                    # 11 ott 2023 macd > 0 da macd > 5
                    # 11 ott 2023 dev 3-10 a 0.04 da 0.05
                    # 11 ott 2023 dev 3-16 a 0.07 da 0.08
                    # 11 ott 2023 dev 4-28 a -0.03 da -0.02
                    # 10 dic 2023 anticipato ndecchiecella
                    #  9 gen 2024 anticipato ancora
                    # 18 gen 2024 attenzione ! 5-54 se ma 300 scende da 3 ore NON E' PROPRIAMENTE UN MOVIMENTO LATERALE CONSOLIDATO.
                    
                    
                elif (    
                    ma3_last > ma13_last
                    and deviation_ma11_sopra_o_sotto_ma300 > -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.33
                    
                    and deviation_ma300_sopra_ma450 < 0.18
                    and deviation_ma300_sopra_ma450 > -0.18
                    
                    and deviation_ma100_sopra_ma300 < 0.29
                    and deviation_ma100_sopra_ma300 > -0.29
                    
                    and deviation_ma10_sotto_ma100 < -0.06
                 
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma4_sopra_ma28 > -0.05
                 
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_ma5 > 10
                    
                    and macd >= macd_2_min_ago
                    and macd > -20
                    and macd_differenza_2_min_ago > 0.50
                ):  
                    
                    buy = "BUY 1 CONSOLIDATO TREND LATERALE con 3-10 > 0.01 con macd > -20 and ma2_differenza_2_min_ago > 7 - r 1210"
                    action = "buy"
                    percentage = 70
                    
                    # 22 feb 2024 solo in una condizione di trend laterale consolidato e con deviation_ma5_sopra_o_sotto_ma100 < -0.33
                    #  9 set 2024 aggiunta and deviation_ma11_sopra_o_sotto_ma300 > -0.25 ( perche' ha comprato mentre scendeva molto) (non era laterale !)



                # ------------------------------------------------------------ BUY 1 RAFFORZATA se ma200> and ma300 > and 8>39
                
                elif (    
                    ma20_last > ma200_last
                    and ma2_differenza_2_min_ago > 5
                    and ma5_last > ma39_last
                    and ma50_last > ma78_last
                    
                    and ma59_last > ma59_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma28_last < ma28_20_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.12
                    
                    and macd >= macd_2_min_ago
                ):  
                
                    buy = "BUY 1 (50>78) con 20>200 and 5-39 and 69>100 AND ma78 > AND 59 > 59 60 min ago CON 28 < 28 20 min AND 3-10 > 0.12 - r 1227 AB"
                    action = "buy"
                    percentage = 80
                    
                    # 20 ott 2023 and 8-39 da 8-50
                    # 20 ott 2023 tolto and ma78_last > ma78_2_min_ago
                    # 20 ott 2023 5-39 da 8-39
                    #  5 dic 2023 aggiunta and ma2_differenza_2_min_ago > 5
              
                # ------------------------------------------------------------ BUY 1 RAFFORZATA se ma200> and ma300 > and 8>50 AND ma78 > CON 3-10 > 0.12
                
                elif (    
                    ma20_last > ma200_last
                    and macd >= macd_2_min_ago
                    and ma50_last > ma78_last
                    and deviation_ma3_sopra_ma10 > 0.12
                    
                    and ma59_last < ma59_60_min_ago
                    and ma78_last > ma78_2_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma8_last > ma50_last
                ):  
                
                    buy = "BUY 1 RAFFORZATA (50>78) con 20>200 and 69 > 100 and dev_bellissima > 0.14 AND ma78 > AND 59 > 59 60 min ago CON 3-10 > 0.12 - r 1247 b"
                    action = "buy"
                    percentage = 80
                    
             
                
                    
                    
                
                   
                    
                # BUY 1 se ma200> and ma300 > and 8>50 AND ma78 > AND 8 > 78 AND 5-28 > 0.11 
                
                elif (    
                    ma20_last > ma125_last
                    and macd >= macd_2_min_ago
                    and ma78_last > ma200_last
                    
                    and ma8_last > ma78_last
                    and ma78_last < ma78_2_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.15
                    and deviation_ma5_sopra_ma28 > 0.12
                    
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma8_last > ma50_last
                ):  
                
                    buy = "BUY 1 con 20>125 and 69 > 100 AND ma78 > AND 8 > 78 CON 78 > 200 and 5-28 > 0.12 and 3-10 > 0.15  - r 1288 A"
                    action = "buy"
                    percentage = 90
                    
                    # 27 giu 2022 20>125 da 20>200
                    
                    
                    
                
                    
                    
                    
                # BUY 1 PERICOLOSA derivata dal tardo autunno ! togliendo i 40 minuti della ma30 
                
                elif (     
                    ma8_last > ma54_last
                    and macd >= macd_2_min_ago
                    and ma39_last > ma39_30_min_ago
                    and ma69_last < ma69_2_min_ago
                    
                    and deviation_ma100_sopra_ma300 < -0.25
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.19
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma200_120_min_ago
                  
                    and deviation_bellissima > 0.06
                    
                    and ma20_last > ma20_2_min_ago
                    and ma2_last > ma20_last
                    
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 PERICOLOSA 8-54 derivata dal tardo autunno ! con 11-59 con 5-28 > 0.19 AND 3-10 > 0.17 cazzo - r 1427 B"
                    action = "buy"
                    percentage = 90
                    
                    # 100 deve stare un po' sotto alla 300 !
                    
                    
                
                
                    
                # BUY 1 PERICOLOSA derivata dal tardo autunno ! togliendo i 40 minuti della ma30 
                
                elif (     
                    ma8_last > ma54_last
                    and macd >= macd_2_min_ago
                    and ma78_last > ma200_last
                    
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma100_sopra_ma300 < -0.27
                    and ma100_last < ma200_last
                    and ma200_last < ma200_120_min_ago
                    
                    and ma11_last > ma59_last
                    
                    and deviation_ma3_sopra_ma10 > 0.27
                    and deviation_ma5_sopra_ma28 > 0.21
                    
                    and ma20_last > ma20_2_min_ago
                    and ma5_last > ma5_2_min_ago
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 PERICOLOSA 8-54 and 39< derivata dal tardo autunno ! CON 78>200 con 5-28 > 0.20 - r 1456 A"
                    action = "buy"
                    percentage = 90
                    
                    # 100 deve stare un po' sotto alla 300 !
                    
                    
                    
                # BUY 1 PERICOLOSA derivata dal tardo autunno ! togliendo i 40 minuti della ma30

                elif (     
                    ma3_last > ma13_last
                    and ma450_last > ma450_480_min_ago

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.13

                    and delta_1 < delta_2
                    
                    and ma78_last < ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma100_sopra_ma300 < -0.27
                    and ma100_last < ma200_last
                    and ma200_last < ma200_120_min_ago
                    
                    and ma5_last > ma5_2_min_ago
                    and ma20_last > ma20_2_min_ago
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.01
                    and macd_differenza_2_min_ago > -1.25
                    
                ):    
                    buy = "BUY 1 pericolosa ma GIORNO ! con 3-39 and 39< AND 78<200  - r 1486 B1x"
                    action = "buy"
                    percentage = 90

                    #  3 feb 2025 SE GIORNO ANTICIPO BUY 3-39 da 8-54
                    # 17 feb 2025 aggiunto and deviation_ma39 < -0.10
                    # 17 feb 2025 aggiunto and deviation_ma3_sotto_ma50 < -0.13
                    #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago


                elif (     
                    ma3_last > ma13_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10

                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_120_min_ago

                    and ma100_last < ma200_last
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.04

                    and deviation_ma3_sopra_ma10 > 0.01

                    and macd_differenza_2_min_ago > -2.50
      
                ):    
                    buy = "BUY 1 CONTINUA A SCENDERE DNA - GIORNO ! - r 1486 B1y"
                    action = "buy"
                    percentage = 90

                    #  3 feb 2025 SE GIORNO ANTICIPO BUY 3-39 da 8-54
                    # 17 feb 2025 aggiunto and deviation_ma39 < -0.10
                    # 17 feb 2025 aggiunto and deviation_ma3_sotto_ma50 < -0.13
                    #  3 mar 2025 aggiunta CONTINUA A SCENDERE DNA



                elif (     
                    ma8_last > ma54_last
                    and delta_1 > delta_2

                    and ma11_last > ma59_last
                    
                    and ma78_last < ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.27
                    and deviation_ma5_sopra_ma28 > 0.30
                    
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma100_sopra_ma300 < -0.27
                    and ma100_last < ma200_last
                    and ma200_last < ma200_120_min_ago
                    
                    and ma5_last > ma5_2_min_ago
                    and ma20_last > ma20_2_min_ago
                    
                    and ma2_last > ma20_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):    
                    buy = "BUY 1 pericolosa NOTTE ! con 8-54 and 39< AND 78 < 200 CON 3-10 > 0.24 CON 5-28 > 0.27 - r 1486 B2"
                    action = "buy"
                    percentage = 90
                    
                    # 100 deve stare un po' sotto alla 300 !
                    # 22 GIU 2022 5-28 > 0.27 da 0.20
                    
                    # > estate 3-10 0.27 and 5-28 0.30 HO ALZATO IL BUY ! e forse qua un giorno metto incrocio al rialzo 8-54
                    # 25 gen 2024 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 25 gen 2024 aggiunto and macd_differenza_2_min_ago > 1.25
                    
                    
                
                
                
                    
                #################################################################################################################### ecco le 4 stagioni !  
                
                
                
                ############################################################################################################
                
                
                elif (      
                    ma5_last > ma20_last
                    and ma39_last > ma39_15_min_ago
                    
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > -0.005
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last >= ma20_last
                  
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 ancora vicina alla 450 and 3-18 > 0.02 + MACD > - r 1537 A2 X1"
                    action = "buy"
                    percentage = 90
                    
                elif (      
                    ma3_last > ma20_last
                    
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192
                    
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > -0.005
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last >= ma20_last
                  
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 compare forever pugno fantasma di mohammad ali' - con 5-20 and 3-18 > 0.02 + MACD > - r 1537 A2 X2"
                    action = "buy"
                    percentage = 70
                    
                    #  6 mar 2024 aggiunto pugno fantasma di mohammad ali'
                    



                elif (      
                    ma3_last > ma20_last
                    
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > -0.005
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last >= ma20_last
                  
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 compare forever prende coltello con il piede - con 5-20 and 3-18 > 0.02 + MACD > - r 1537 A2 X3"
                    action = "buy"
                    percentage = 90
                    
                    #  8 gen 2024 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    #  8 gen 2024 aggiunto and ma2_differenza_2_min_ago > 8 
                    #  8 gen 2024 aggiunto and ma2_differenza_ma5 > 11 
                    #  8 gen 2024 aggiunto and macd_differenza_2_min_ago > 1.25
                    
                    #  6 mar 2024 compare prende il coltello con il piede
                    
              

                elif (     
                    ma3_last > ma13_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -40
                    
                    and ma50_differenza_ma59 > -5
                    and ma2_differenza_2_min_ago > 11
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 vicina alla 450 + MACD > and ma50_diff_ma59 > -5 - r 1537 A2 Y1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (     
                    ma3_last > ma13_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and ma5_last > ma50_last
                    
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -40
                    
                    and ma50_differenza_ma59 > -5
                    and ma2_differenza_2_min_ago > 11
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 vicina alla 450 ( anche poco sotto! ) + MACD > and ma50_diff_ma59 > -5 - r 1537 A2 Y1 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 90

                

                elif (     
                    ma3_last > ma13_last
                    and (ma100_last > ma200_last or ma100_last > ma450_last)
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    
                    and ma100_last < ma100_180_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.04
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.04
                    
                    and deviation_ma39_sotto_ma200 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma50_differenza_ma59 > -15

                    and macd_differenza_2_min_ago > -18.50
                  
                ):    
                    buy = "BUY 1 CF - con 5-20 E CON 300 vicina alla 450 ( anche poco sotto! ) + diff MACD - r 1537 A2 Y1 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90

                    # 16 set 2024 modificata - anticipato buy
                    # 29 apr 2025 perfezionata aggiungendo or ma100_last > ma450_last



                elif (     
                    ma3_last > ma13_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -40
                    
                    and ma50_differenza_ma59 > -5
                    and ma2_differenza_2_min_ago > 11
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 vicina alla 450 ( anche poco sotto! ) + MACD > and ma50_diff_ma59 > -5 - r 1537 A2 Y1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

                elif (     
                    ma3_last > ma13_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -40
                    
                    and ma50_differenza_ma59 > -5
                    and ma2_differenza_2_min_ago > 11
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 vicina alla 450 ( anche poco sotto! ) + MACD > and ma50_diff_ma59 > -5 - r 1537 A2 Y1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (     
                    ma3_last > ma13_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -40
                    
                    and ma50_differenza_ma59 > -5
                    and ma2_differenza_2_min_ago > 11
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 vicina alla 450 ( anche poco sotto! ) + MACD > and ma50_diff_ma59 > -5 - r 1537 A2 Y1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    #  4 mag 2023 ho aggiunto e tolto 450>480 min ago
                    #  4 mag 2023 5-50 da 5-250
                    #  9 mag 2023 5-30 da 5-50
                    # 29 mag 2023 3-16 > 0.11
                    #  1 giu 2023 5-20 da 5-30
                    #  1 giu 2023 and deviation_ma39_sotto_ma200 < -0.15
                    #  9 giu 2023 and deviation_ma300_sopra_ma450 > -0.25 da -0.20
                    #  9 giu 2023 5-28 > 0.02 da 0.03
                    #  9 giu 2023 tolto and ma3_last >= ma3_2_min_ago
                    #  9 giu 2023 dev_ma39_sotto_ma200 < -0.10 da -0.15 forse era questa che la faceva arrivare in ritardo perche' 39 era piu' lenta a scendere sotto -0.15 da ma200
                    # tolto and deviation_ma5_sopra_ma28 > 0.02
                    #  7 lug 2023 dev_ma39_sotto_ma200 < -0.05 da -0.10
                    # 31 lug 2023 and deviation_ma3_sopra_ma18 > 0.12
                    # 11 ago 2023 0.06 0.08 0.10 antcipo ndecchiecella
                    # 30 ago 2023 0.05 0.07 0.09 antcipo ndecchiecella
                    # 12 set 2023 0.03 0.05 0.07 antcipo ndecchiecella 
                    
                    # 13 set 2023 and deviation_ma300_sopra_ma450 > -0.35 da -0.45
                    # 13 set 2023 0.01 0.03 0.05 antcipo ndecchiecella
                    
                    # 19 ott 2023 4-13 da 5-20
                    # 12 nov 2023 aggiunta and ma50_differenza_ma59 > -5 cioe' se 50 sta VICINO alla 59
                    #  1 dic 2023 aggiunta and ma2_differenza_2_min_ago > 3
                    #  8 gen 2024 and ma2_differenza_2_min_ago > 11
                    


                
                elif (    
                    ma3_last > ma15_last
                    
                    and ma39_last < ma100_last

                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma50_sotto_ma300 < -0.60

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma5_sotto_ma200 < -0.45
                    and deviation_ma5_sotto_ma300 < -0.65
                    and deviation_ma5_sotto_ma450 < -1.20

                    and ma450_last > ma450_120_min_ago
                    
                    and deviation_ma300_sopra_ma450 > -0.45

                    and deviation_ma3_sopra_ma10 > -0.005
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    
                    and macd_differenza_2_min_ago > -3.25
                    and macd > -50
                   
                ):    
                    buy = "BUY 1 CF CON ma450> MA ma39 < ma100 + E CON 300 ancora vicina alla 450 E CON DNAM - r 1537 A2 Y2 A"
                    action = "buy"
                    percentage = 90

                    #  8 ott 2024 se ma100_last < ma100_120_min_ago allora il cane vuole l' osso (and deviation_ma5_sopra_o_sotto_ma100 < -0.35)
                    # 15 ott 2024 ma100< 60 min ago invece di ma100< 120 min ago
                    # 17 nov 2024 se 39<100 interviene zia amalia grafana
                    #  1 dic 2024 and deviation_ma5_sotto_ma450 < -1.20

                elif (    
                    ma3_last > ma15_last
                    and ma450_last < ma450_120_min_ago
                    and deviation_ma5_sotto_ma200 < -0.25
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > -0.005
                    and deviation_ma3_sopra_ma16 > 0.03
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                    and macd > -50
                    and ma50_differenza_ma59 < -5
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 ancora vicina alla 450 ( anche un poco sotto! ) + MACD > - r 1537 A2 Y2 B"
                    action = "buy"
                    percentage = 90

                    #  2 ott 2024 se 450 < allora dev 5 -200 < -0.25 cazzo
                    # 15 ott 2024 ma100< 60 min ago invece di ma100< 120 min ago


                elif (    
                    ma3_last > ma11_last
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.03
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.03

                    and (ma100_last < ma100_120_min_ago or ma200_last < ma200_120_min_ago)

                    and deviation_ma39 < -0.033
                    and deviation_ma3_sotto_ma50 < -0.062
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.137
                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.035
                    
                    
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and macd_differenza_2_min_ago > -18.00
                    and macd > -100
                  
                ):    
                    buy = f"BUY 1 CF - con 3-11 E CON 300 vicina alla 450 - r 1537 A2 Y3 x - deviation_ma39 {deviation_ma39:.2f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}"
                    action = "buy"
                    percentage = 90

                    # 26 set 2025 anticipata ndecchiecella
                    #  7 ott 2025 e' andata benissimo
                    #  8 ott 2025 aggiunte parentesi graffe sulla stessa riga.
                    #  8 ott 2025 and deviation_ma54_sopra_o_sotto_ma72 a 0.018 da < 0.017
                    # 25 ott 2025 da 3-11 a 3-15
                    # 25 ott 2025 aggiunte dev pg



                elif (    
                    ma3_last > ma15_last
                    
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 < -0.22
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.02
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.02
                    
                    and deviation_ma39_sotto_ma200 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.005
                    and deviation_ma3_sopra_ma16 > -0.03
                    
                    and ma2_last >= ma10_last
                  
                    and ma50_differenza_ma59 < -5
                    and macd_differenza_2_min_ago > -18.25
                ):    
                    buy = "BUY 1 compare forever con 3-15 E CON 300 vicina alla 450 and deviation_ma39 < -0.22 - r 1537 A2 Y3 y"
                    action = "buy"
                    percentage = 90
                    
                    #  5 mar 2024 se ma39 < ma39 15 min ago pugno fantasma di mohammad ali'
                    # 14 apr 2025 anticipata ndecchiecella togliendo sovrastrutture
                    # 15 apr 2025 anticipata ndecchiecella
                    # 30 apr 2025 aggiunta and deviation_ma39 < -0.22

                elif (    
                    ma3_last > ma50_last

                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > -0.005
                    and deviation_ma3_sopra_ma16 > 0.03
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                    and macd > -40
                    and ma50_differenza_ma59 < -5
                    
                ):    
                    buy = "BUY 1 compare forever - con 5-20 E CON 300 vicina alla 450 + MACD > and ma50_differenza_ma59 < -5 - r 1537 A2 Y3 z"
                    action = "buy"
                    percentage = 90
                    
                    #  4 mag 2023 ho aggiunto e tolto 450>480 min ago
                    #  4 mag 2023 5-50 da 5-250
                    #  9 mag 2023 5-30 da 5-50
                    # 29 mag 2023 3-16 > 0.11
                    #  1 giu 2023 5-20 da 5-30
                    #  1 giu 2023 and deviation_ma39_sotto_ma200 < -0.15
                    #  9 giu 2023 and deviation_ma300_sopra_ma450 > -0.25 da -0.20
                    #  9 giu 2023 5-28 > 0.02 da 0.03
                    #  9 giu 2023 tolto and ma3_last >= ma3_2_min_ago
                    #  9 giu 2023 dev_ma39_sotto_ma200 < -0.10 da -0.15 forse era questa che la faceva arrivare in ritardo 
                    #  tolto and deviation_ma5_sopra_ma28 > 0.02
                    #  7 lug 2023 dev_ma39_sotto_ma200 < -0.05 da -0.10
                    # 31 lug 2023 and deviation_ma3_sopra_ma18 > 0.12
                    # 11 ago 2023 0.06 0.08 0.10 antcipo ndecchiecella
                    # 30 ago 2023 0.05 0.07 0.09 antcipo ndecchiecella
                    # 12 set 2023 0.03 0.05 0.07 antcipo ndecchiecella 
                    
                    # 13 set 2023 and deviation_ma300_sopra_ma450 > -0.35 da -0.45
                    # 13 set 2023 0.01 0.03 0.05 antcipo ndecchiecella
                    
                    # 19 ott 2023 4-13 da 5-20
                    # 12 nov 2023 aggiunta and ma50_differenza_ma59 < -5 cioe' se 50 sta LONTANA alla 59
                    # 30 dic 2023 and deviation_ma3_sopra_ma16 > 0.03 ! NON METTERE MENO DI QUESTO ! con ma50_differenza_ma59 < -5
                    # 20 feb 2024 3-50 da 3-15 se 200 < 2 ore !

                    #  5 mar 2024 se ma39 < ma39 15 min ago prendi il coltello con il piede
              
  
                elif (     
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.50
                
                ):    
                    buy = "BUY 1 compare forever con 3-20 E CON 300 vicina 450 ( anche sotto ! ) e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 7 - r 1537 A3 X1 X NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (     
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma5_last > ma50_last
                    
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.50
                
                ):    
                    buy = "BUY 1 compare forever con 3-20 E CON 300 vicina 450 ( anche sotto ! ) e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 7 - r 1537 A3 X1 X NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (     
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.50
                
                ):    
                    buy = "BUY 1 compare forever con 3-20 E CON 300 vicina 450 ( anche sotto ! ) e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 7 - r 1537 A3 X1 X NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (     
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.50
                
                ):    
                    buy = "BUY 1 compare forever con 3-20 E CON 300 vicina 450 ( anche sotto ! ) e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 7 - r 1537 A3 X1 X NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (     
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.50
                
                ):    
                    buy = "BUY 1 compare forever con 3-20 E CON 300 vicina 450 ( anche sotto ! ) e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 7 - r 1537 A3 X1 X NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                elif (     
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma3_last > ma39_last
                    
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.50
                
                ):    
                    buy = "BUY 1 compare forever con 3-20 E CON 300 vicina 450 ( anche sotto ! ) e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 7 - r 1537 A3 X1 X NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (     
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma3_last > ma39_last
                    
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.50
                
                ):    
                    buy = "BUY 1 compare forever con 3-20 E CON 300 vicina 450 ( anche sotto ! ) e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 7 - r 1537 A3 X1 X NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                  
                  
                elif (     
                    
                    ma3_last > ma15_last
                    and (ma3_prev < ma250_prev and ma3_last > ma250_last)
                    and ma2_differenza_2_min_ago > 7
                    and ma3_differenza_2_min_ago > 8
                    
                    and ma200_last > ma300_last
                    and ma100_last > ma100_65_min_ago
                    and ma100_last > ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    
                    and macd_differenza_2_min_ago > 1.20
                   
                ):    
                    buy = "BUY 1 con incrocio al rialzo 3-250 3 200>300 e 300 vicina 450 + MACD > E ma2_diff_2_min_ago >7 e diff macd - r 1537 A3 X1 Y"
                    action = "buy"
                    percentage = 90
                    
                    # 25 nov 2023 per anticipare di una ndecchiecella SEMBRA STRANO MA HO DOVUTO METTERE ma100>65 min
                    #  7 dic 2023 aggiunta and ma3_differenza_2_min_ago > 8
                    #  7 dic 2023 ma2_differenza_2_min_ago > 7 da > 3
                    # 18 dic 2023 aggiunta incrocio al rialzo 3-250 mentre CRESCE evidentemente e con il conforto di diff ma2 e diff macd !
                    # 22 feb 2024 mela voglio tenere cosi' anche se avrei potuto metter un po' di prendi il coltello con il piede 5-100 < -0.36


              
                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90

              
                elif (    
                    ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90

              
                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma30_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma39_last
                    
                    and ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma50_sotto_ma300 > -0.13
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.08
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 0.50
                    
                ):    
                    buy = "BUY 1 compare forever - con 3-30 E 300 vicina 450 ( anche sotto ! ) e 3-16 > 0.09 + MACD > E ma2_diff_2_min_ago > 8 - r 1537 A3 X2 X NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # attenzione se 50 e' ancora vicina alla 300 compra piu' alto
                    # 17 nov 2023 tolto and macd >= macd_2_min_ago ! 
                    # 17 nov 2023 aggiunto and ma2_last > ma8_last ! al suo posto. cazzo.
                    # 17 nov 2023 and deviation_ma3_sopra_ma16 a 0.09 da 0.001
                    # 18 dic 2023 ma3_last > ma30_last da 3-39
                    # 17 nov 2023 and deviation_ma3_sopra_ma16 a 0.08 da 0.09
                    # 28 dic 2023 and ma2_differenza_2_min_ago a 8 da 5
                    # 28 dic 2023 and ma3_last > ma8_last da 2>8



              
              
                elif (     
                    
                    ma3_last > ma20_last
                    and deviation_ma39 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 compare forever con 3-20 con 300 vicina 450 e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3 X3 a"
                    action = "buy"
                    percentage = 90
                    
                    #  7 mar 2024 and deviation_ma39 > -0.50 buy con 3-20


                elif (     
                    
                    ma3_last > ma13_last
                    and deviation_ma39 < -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.001
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 compare forever con 3-20 con 300 vicina 450 e 3-18 > -0.01 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3 X3 b"
                    action = "buy"
                    percentage = 90

                    #  7 mar 2024 and deviation_ma39 < -0.50 buy con 3-13

              
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39 > -0.30
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 compare forever 3>39 con 3-20 E 300 vicina 450 3-16 > 0.01 + MACD > E ma2_diff_2_min_ago > 3 E MACD > -10 - r 1537 A3X 4A x NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma5_last > ma50_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39 > -0.30
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 compare forever 3>39 con 3-20 E 300 vicina 450 3-16 > 0.01 + MACD > E ma2_diff_2_min_ago > 3 E MACD > -10 - r 1537 A3X 4A x NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 90


                  
                #  4 ott 2024 cancellata r 1537 A3X 4A x NUOVA ERA A3 SOFT

                

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39 > -0.30
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 compare forever 3>39 con 3-20 E 300 vicina 450 3-16 > 0.01 + MACD > E ma2_diff_2_min_ago > 3 E MACD > -10 - r 1537 A3X 4A x NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39 > -0.30
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 compare forever 3>39 con 3-20 E 300 vicina 450 3-16 > 0.01 + MACD > E ma2_diff_2_min_ago > 3 E MACD > -10 - r 1537 A3X 4A x NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39 > -0.30
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 compare forever 3>39 con 3-20 E 300 vicina 450 3-16 > 0.01 + MACD > E ma2_diff_2_min_ago > 3 E MACD > -10 - r 1537 A3X 4A x NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                  
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39 > -0.30
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 1 CF 3>39 con 3-20 E 300 vicina 450 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X 4A x NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90

                    #  4 ott 2024 e' anata benissimo

                  

                
                elif (    
                    ma3_last > ma15_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and ma2_last >= ma10_last
                    and deviation_ma39 <= -0.30
                    and ma3_last < ma39_last
                    
                  
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.015
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 condizione DNA IPERVENDUTO 3-39 con 300 vicina 450 E ma2_diff_2_min_ago > 3 E dev ma2 e MACD > -20 - r 1537 A3X 4A Y NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90
                    

                elif (    
                    ma3_last > ma15_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    and ma5_last > ma50_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and ma2_last >= ma10_last
                    and deviation_ma39 <= -0.30
                    and ma3_last < ma39_last
                    
                  
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.015
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 condizione DNA IPERVENDUTO 3-39 con 300 vicina 450 E ma2_diff_2_min_ago > 3 E dev ma2 e MACD > -20 - r 1537 A3X 4A Y NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 90
                    
                    # 15 nov 2023 se compra quando 3<39 allora riduco dev 3-16 
                    # 16 nov 2023 AGGIUNTO SOLO SU QUESTA CONDIZIONE E DOPO ATTENTA ANALISI STATISTICA and macd > 8
                    #  5 dic 2023 aggiunta and ma2_differenza_ma5 > 26 vedi 4 dic 2023 ore 16:45
                    #  5 dic 2023 macd >-8 da >8
                    # 12 dic 2023 macd a -10 da -8
                    # 29 dicembre 2023 entra in gioco CONDIZIONE DNA - IPERVENDUTO 3-39 < -0.30

                elif (    
                    ma3_last > ma15_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and ma2_last >= ma10_last
                    and deviation_ma39 <= -0.30
                    and ma3_last < ma39_last
                    
                  
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.015
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 condizione DNA IPERVENDUTO 3-39 con 300 vicina 450 E ma2_diff_2_min_ago > 3 E dev ma2 e MACD > -20 - r 1537 A3X 4A Y NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma15_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and ma2_last >= ma10_last
                    and deviation_ma39 <= -0.30
                    and ma3_last < ma39_last
                    
                  
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.015
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 condizione DNA IPERVENDUTO 3-39 con 300 vicina 450 E ma2_diff_2_min_ago > 3 E dev ma2 e MACD > -20 - r 1537 A3X 4A Y NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90
                    

                elif (    
                    ma3_last > ma15_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    and ma3_last > ma54_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and ma2_last >= ma10_last
                    and deviation_ma39 <= -0.30
                    and ma3_last < ma39_last
                    
                  
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.015
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 condizione DNA IPERVENDUTO 3-39 con 300 vicina 450 E ma2_diff_2_min_ago > 3 E dev ma2 e MACD > -20 - r 1537 A3X 4A Y NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma15_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and ma2_last >= ma10_last
                    and deviation_ma39 <= -0.30
                    and ma3_last < ma39_last
                    
                  
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.015
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25
                    
                ):    
                    buy = "BUY 1 condizione DNA IPERVENDUTO 3-39 con 300 vicina 450 E ma2_diff_2_min_ago > 3 E dev ma2 e MACD > -20 - r 1537 A3X 4A Y NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # 15 nov 2023 se compra quando 3<39 allora riduco dev 3-16 
                    # 16 nov 2023 AGGIUNTO SOLO SU QUESTA CONDIZIONE E DOPO ATTENTA ANALISI STATISTICA and macd > 8
                    #  5 dic 2023 aggiunta and ma2_differenza_ma5 > 26 vedi 4 dic 2023 ore 16:45
                    #  5 dic 2023 macd >-8 da >8
                    # 12 dic 2023 macd a -10 da -8
                    # 29 dicembre 2023 entra in gioco CONDIZIONE DNA - IPERVENDUTO 3-39 < -0.30






              
                elif (     
                    ma3_last > ma10_last
                    and ma450_last > ma450_480_min_ago


                    and ma39_last < ma100_last
                    
                    and deviation_ma25_sotto_ma300 < -1.50
                    and deviation_ma100_sopra_ma300 < -0.69

                    and deviation_ma300_sopra_ma450 < -0.10
                    
                    and deviation_ma39 < -0.35
                    and deviation_ma3_sotto_ma50 < -0.45

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    and deviation_ma5_sotto_ma450 < -0.51


                    and delta_300_200 > delta_300_200_30_min
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma3_sopra_ma10 > 0.010
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 1 NOTTE condizione DNA IPERVENDUTO con 3-15 E diff MACD > -2.50 - r 1537 A3X 4A Y x1"
                    action = "buy"
                    percentage = 90

                    #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago



                elif (     
                    ma3_last > ma15_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10

                    and ma100_last < ma100_60_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma3_sopra_ma10 > 0.010
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.04
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 1 CONTINUA A SCENDERE DNA con 3-15 E diff MACD > -2.50 - r 1537 A3X 4A Y x2"
                    action = "buy"
                    percentage = 90
                    
                    # 15 nov 2023 se compra quando 3<39 allora riduco dev 3-16 
                    # 16 nov 2023 AGGIUNTO SOLO SU QUESTA CONDIZIONE E DOPO ATTENTA ANALISI STATISTICA and macd > 8
                    #  5 dic 2023 aggiunta and ma2_differenza_ma5 > 26 vedi 4 dic 2023 ore 16:45
                    #  5 dic 2023 macd >-8 da >8
                    # 12 dic 2023 macd a -10 da -8
                    # 29 dicembre 2023 entra in gioco CONDIZIONE DNA - IPERVENDUTO 3-39 < -0.30
                    # 19 feb 2024 aggiunta 
                    # 11 set 2024 and deviation_ma39 <= -0.40 da -0.30
                    # 16 set 2024 anticipata ndecchiecella. mantienila ! mantieni DNA !
                    # 27 gen 2025 se NOTTE and deviation_ma25_sotto_ma300 < -1.20
                    #  5 feb 2025 la tengo anche se avrei quasi voluto mettere 3-20 invece di 3-15
                    #  5 feb 2025 tolta ma2 > ma2 2 min ago
                    # 27 feb 2025 tolta anche MACD > -70
                    #  3 mar 2025 aggiunta CONTIUNA A SCENDERE DNA



                elif (    
                    ma3_last > ma20_last
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.105
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    
                ):    
                    buy = "BUY 1 compare forever 3<39 - con 3-20 E 300 vicina 450 (anche sotto !) e 3-16 > 0.105 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X 4B NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.105
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    
                ):    
                    buy = "BUY 1 compare forever 3<39 - con 3-20 E 300 vicina 450 (anche sotto !) e 3-16 > 0.105 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X 4B NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma5_last > ma50_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.105
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    
                ):    
                    buy = "BUY 1 compare forever 3<39 - con 3-20 E 300 vicina 450 (anche sotto !) e 3-16 > 0.105 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X 4B NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90


                #  3 ott 2024 cancellata r 1537 A3X 4B NUOVA ERA A3 SOFT a
                

                elif (    
                    ma3_last > ma20_last
                    and ma450_last > ma450_300_min_ago
                    and (ma3_prev < ma450_prev and ma3_last > ma450_last)
                    and ma100_last > ma450_last
                    and ma300_last > ma450_last

                    and ma100_last < ma300_last
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.70
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                    and ma2_last >= ma2_2_min_ago
                    
                ):    
                    buy = "BUY 1 450 >450 300 min e incrocio al rialzo 3-20 - r 1537 A3X 4B NUOVA ERA A3 SOFT b"
                    action = "buy"
                    percentage = 90

                    # 18 set 2024 nuova condizione se 450 sale da 5 ore e incrocio al rialzo 3-450



                elif (    
                    ma3_last > ma20_last
                    and ma3_last > ma39_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.105
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    
                ):    
                    buy = "BUY 1 compare forever 3<39 - con 3-20 E 300 vicina 450 (anche sotto !) e 3-16 > 0.105 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X 4B NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

              
                
                elif (    
                    ma3_last > ma20_last
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.30
                    and ma3_last > ma54_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.105
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    
                ):    
                    buy = "BUY 1 compare forever 3<39 - con 3-20 E 300 vicina 450 (anche sotto !) e 3-16 > 0.105 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X 4B NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.105
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    
                ):    
                    buy = "BUY 1 compare forever 3<39 - con 3-20 E 300 vicina 450 (anche sotto !) e 3-16 > 0.105 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X4B NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

              
                elif (    
                    ma3_last > ma20_last
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.105
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    
                ):    
                    buy = "BUY 1 compare forever 3<39 - con 3-20 E 300 vicina 450 (anche sotto !) e 3-16 > 0.105 + MACD > E ma2_diff_2_min_ago > 3 - r 1537 A3X4B NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # 25 ott 2023 and deviation_ma3_sopra_ma18 > -0.01 da 0.001
                    #  3 nov 2023 and ma2_differenza_2_min_ago > 3
                    #  7 nov 2023 and deviation_ma3_sopra_ma16 > 0.10 ! ASSOLUTAMENTE ! VEDI 7 NOVEMBRE 2023 ore 11:36 e ore 12:03 CAMBIA la dev 3-16
                    # 15 nov 2023 se compra quando 3>39 (e' capitato) allora metto ASSOLUTAMENTE dev 3-16 > 0.105

              

                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_60_min_ago
                    and ma18_last > ma18_10_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma50_differenza_ma59 >= -14
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 12
                    and ma2_differenza_ma5 > 8
                    
                    and macd_differenza_2_min_ago > 1.50
                ):    
                    buy = "BUY 1 compare forever - con 18> e con 3-18 CON 300 vicina 450 (anche sotto !) e 3-20 + diff macd > 1.50 e 2>5 ! - r 1537 A3 Y1 X1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma100_last < ma100_60_min_ago
                    and ma18_last > ma18_10_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma50_differenza_ma59 >= -14
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 12
                    and ma2_differenza_ma5 > 8
                    
                    and macd_differenza_2_min_ago > 1.50
                ):    
                    buy = "BUY 1 compare forever - con 18> e con 3-18 CON 300 vicina 450 (anche sotto !) e 3-20 + diff macd > 1.50 e 2>5 ! - r 1537 A3 Y1 X1 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last

                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and deviation_ma10_sopra_ma200 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.90

                    and deviation_ma25_sotto_ma300 < -0.75
                    and deviation_ma50_sotto_ma300 < -0.61
                  
                    
                    and ma100_last < ma100_60_min_ago
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.99
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma50_differenza_ma59 >= -14
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    
                    and ma2_differenza_ma5 > 8
                    
                    and macd_differenza_2_min_ago > -1.50
                ):    
                    buy = "BUY 1 compare forever - con 3-18 e 300 vicina 450 (sotto) e 3-20 + diff macd > 1.50  - r 1537 A3 Y1 X1 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90

                    #  5 nov 2024 aggiunto cano staf



                elif (    
                    ma3_last > ma20_last
                    and delta_1 < delta_2

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and ma100_last < ma100_10_min_ago

                    and deviation_ma100_sopra_ma300 < -0.59
                    and deviation_ma25_sotto_ma300 < -0.36
                    and deviation_ma50_sotto_ma300 < -0.30
                    and deviation_ma39 < 0.03
                    and deviation_ma3_sotto_ma50 < 0.01
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.39
                    and deviation_ma5_sopra_ma200 < -0.49
                    and deviation_ma5_sotto_ma300 < -0.59
                    and deviation_ma5_sotto_ma450 < -0.30

                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma450_last < ma450_120_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.03

                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -2.50
                   
                ):    
                    buy = "BUY 1 CF GIORNO - con 3-20 - r 1537 A3 Y1 X1 NUOVA ERA A3 SOFT che diventa strong"
                    action = "buy"
                    percentage = 90

                    #  4 ott 2024 modificata radicalmente prima di cancellare
                    # 15 nov 2024 soft diventa strong ma forse no (perche' non riesco a capire il segmento temporale giusto per prendere i dati)
                    # 10 mar 2025 aggiunto GIORNO

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma100_last < ma100_60_min_ago
                    and ma18_last > ma18_10_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma50_differenza_ma59 >= -14
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 12
                    and ma2_differenza_ma5 > 8
                    
                    and macd_differenza_2_min_ago > 1.50
                ):    
                    buy = "BUY 1 compare forever - con 18> e con 3-18 CON 300 vicina 450 (anche sotto !) e 3-20 + diff macd > 1.50 e 2>5 ! - r 1537 A3 Y1 X1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

              

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.30
                    and ma3_last > ma54_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma18_last > ma18_10_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma50_differenza_ma59 >= -14
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 12
                    and ma2_differenza_ma5 > 8
                    
                    and macd_differenza_2_min_ago > 1.50
                ):    
                    buy = "BUY 1 compare forever - con 18> e con 3-18 CON 300 vicina 450 (anche sotto !) e 3-20 + diff macd > 1.50 e 2>5 ! - r 1537 A3 Y1 X1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma18_last > ma18_10_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma50_differenza_ma59 >= -14
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 12
                    and ma2_differenza_ma5 > 8
                    
                    and macd_differenza_2_min_ago > 1.50
                ):    
                    buy = "BUY 1 compare forever - con 18> e con 3-18 CON 300 vicina 450 (anche sotto !) e 3-20 + diff macd > 1.50 e 2>5 ! - r 1537 A3 Y1 X1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90
                  
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma3_last > ma39_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma18_last > ma18_10_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma50_differenza_ma59 >= -14
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 12
                    and ma2_differenza_ma5 > 8
                    
                    and macd_differenza_2_min_ago > 1.50
                ):    
                    buy = "BUY 1 compare forever - con 18> e con 3-18 CON 300 vicina 450 (anche sotto !) e 3-20 + diff macd > 1.50 e 2>5 ! - r 1537 A3 Y1 X1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90


              
                
                elif (     
                    
                    ma3_last > ma18_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and ma10_last > ma20_last
                    and deviation_ma5_sotto_ma450 < -0.75
                    
                    and ma50_differenza_ma59 >= -16
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.02
                    and deviation_ma300_sopra_ma450 > -0.85
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    
                    and macd_differenza_2_min_ago > -1.50
                    and ma2_differenza_2_min_ago >= 8
                    and ma2_differenza_ma5 > 7
                ):    
                    buy = "BUY 1 compare forever - con 10>20 e dev_ma5_sotto_ma450 < -0.75 e 3-18 E CON 300 vicina alla 450 and 3-20 + diff macd > 1.50 AND 2>5 ! - r 1537 A3 Y1 x2"
                    action = "buy"
                    percentage = 90
                    
                    # questa interviene quando si e' gia' manifestato un certo ribasso (and deviation_ma5_sotto_ma450 < -0.75)
                    # se siamo in presenza di un ribasso piu' marcato HO TOLTO 18 10 min e ho messo 10>20 piu' veloce (che mi evita molti buy inutili sempre durante il ribasso)
                    # 16 set 2024 anticipato ndecchiecella

                

                elif (     
                    
                    ma3_last > ma20_last

                    and deviation_ma300_sopra_ma450 < -0.20
                    and deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago < -1.20
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma39_sotto_ma100 > -0.15

                    and deviation_ma200_sotto_ma300 < -0.17
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma39 < -0.02


                    and ma450_last < ma450_120_min_ago
                    
                    
                    and ma100_last < ma200_last
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30

                    and ma18_last <= ma18_10_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.025
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last > ma5_last
                    
                    and macd > -70
                    and macd_differenza_2_min_ago > -1.50
                 
                ):    
                    buy = "BUY 1 compare forever - con 18 < e con 3-20 E CON deviation_ma200_sotto_ma300 < -0.17 - r 1537 A3 Y1Y"
                    action = "buy"
                    percentage = 80
                    
                    #  7 dic 2023 aggiunta and ma2_differenza_ma5 > 7
                    # 11 dic 2023 ma2_differenza_ma5 a 8 da 7
                    # 11 dic 2023 diff macd a 1.50 da 1.05
                    # 13 dic 2023 3-20 da 3-18
                    # 22 dic 2023 and deviation_ma3_sopra_ma16 > 0.125 da -0.04 se ma 18 di adesso e' piu' bassa di ma18 di 10 min ago
                    # 20 set 2024 anticipata ndecchiecella e aggiunto prendi coltello con il piede

                    #  3 ott 2024 modificata con ma200_last < ma200_120_min_ago aggiunto deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    #  6 feb 2025 anticipata ndecchia
                    # 16 feb 2025 aggiunto continua a scendere circello
                  
                elif (     
                    ma3_last > ma18_last

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma50_differenza_ma59 < -14
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.068
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 17
                    and macd_differenza_2_min_ago > 1.05
                 
                ):    
                    buy = "BUY 1 compare forever - con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) e 3-18 > -0.05 + diff macd > 1.05 AND 2>5 ! - r 1537 A3 Y2 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

                elif (     
                    ma3_last > ma18_last

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and ma5_last > ma50_last
                    
                    and ma50_differenza_ma59 < -14
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.068
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 17
                    and macd_differenza_2_min_ago > 1.05
                 
                ):    
                    buy = "BUY 1 compare forever - con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) e 3-18 > -0.05 + diff macd > 1.05 AND 2>5 ! - r 1537 A3 Y2 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 90



                elif (     
                    ma3_last > ma18_last

                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                    and ma100_last < ma100_10_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma450_last < ma450_360_min_ago

                    and delta_300_200 > delta_300_200_30_min
                    

                    and deviation_ma39 < 0.03
                    and deviation_ma3_sotto_ma50 < 0.01
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15


                    and deviation_ma5_sopra_ma200 < -0.49
                    and deviation_ma5_sotto_ma300 < -0.59
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma50_sotto_ma300 < -0.30
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -18.50
                    
                ):    
                    buy = f"BUY 1 CF - zia amalia + CM - r 1537 A3 Y2 NUOVA ERA A3 SOFT che diventa STRONG - deviation_ma39 {deviation_ma39:.2f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}"
                    action = "buy"
                    percentage = 90

                    # 10 nov 2024 non e' ancora una situazione di crollo ma 
                    # 10 nov 2024 intervengono le condizioni zia amalia
                    # 15 nov 2024 SOFT diventa STRONG
                    # 27 gen 2025 se NOTTE aggiunta and deviation_ma25_sotto_ma300 < -1.20
                    # 20 mar 2025 anticipata ndecchiecella
                    # tolto ma2 >ma2 2 min ago 
                    # tolto macd >-30
                    # aggiunto macd_differenza_2_min_ago > -2.50
                    #  8 ott 2025 aggiunte parentesi graffe sulla stessa riga
                    #  8 ott 2025 macd_differenza_2_min_ago a -18.50 da -2.50
                    #  8 ott 2025 aggiunta and delta_CM_300_25_last < delta_CM_300_25_2_min_ago




                elif (     
                    ma3_last > ma18_last

                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma50_differenza_ma59 < -14
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.068
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 17
                    and macd_differenza_2_min_ago > 1.05
                 
                ):    
                    buy = "BUY 1 compare forever - con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) e 3-18 > -0.05 + diff macd > 1.05 AND 2>5 ! - r 1537 A3 Y2 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

                elif (     
                    ma3_last > ma18_last

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and ma50_differenza_ma59 < -14
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.068
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last >= ma20_last
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago >= 17
                    and macd_differenza_2_min_ago > 1.05
                 
                ):    
                    buy = "BUY 1 compare forever - con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) e 3-18 > -0.05 + diff macd > 1.05 AND 2>5 ! - r 1537 A3 Y2 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90



                
                elif (     
                    
                    ma3_last > ma39_last

                    and ma100_last < ma100_10_min_ago
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    
                    and ma50_differenza_ma59 < -14
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.55
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.04
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and macd_differenza_2_min_ago > -1.50
                 
                ):    
                    buy = "BUY 1 compare forever - con 3-18 E CON 300 vicina alla 450 AND 2>5 ! - r 1537 A3 Y2 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    #  3 feb 2025 questa ha rotto il cazzo.
                    


                
                    
                # BUY 1 tempo ESTATE PIU' VELOCE 100 > 60 min ago (solo l' estate se lo puo' perettere!) considera il passare del TEMPO ! ma30 > 
                
                elif (     
                    ma15_last > ma28_last
                    and macd >= macd_2_min_ago
                    and ma78_last < ma100_last
                    
                    and ma8_last > ma200_last
                    and ma100_last > ma100_60_min_ago
                    
                    and ma30_last > ma30_40_min_ago
                
                    and deviation_ma5_sopra_ma28 > 0.22
                    and deviation_bellissima > 0.06
                    and ma20_last > ma20_2_min_ago
                    and ma5_last > ma5_2_min_ago
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 tempo ESTATE PIU' VELOCE 100 > 60 min ago (solo l' estate se lo puo' permettere!) considera il passare del tempo ! ma30 > - r 1537 B"
                    action = "buy"
                    percentage = 90
                    
                    # 9 giu 2022 15>28 al posto di 50>100 
                    # 9 giu 2022 8>200 al posto di 100>200
                    
                    
               
                # BUY 1 tempo PRIMAVERA che considera il passare del tempo con ma30 <
                
                
                elif (     
                    ma50_last > ma100_last
                    and macd >= macd_2_min_ago
                    and deviation_ma300_sopra_ma450 > -0.17
                    and ma100_last > ma200_last
                    and deviation_buy_ma2_sopra_ma5 > 0.12
                    
                    and ma30_last < ma30_40_min_ago
                 
                    and deviation_ma5_sopra_ma28 > 0.175
                    and deviation_bellissima > 0.03
                    and ma2_last > ma20_last
                    and ma5_last >= ma5_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    
                ):    
                    buy = "BUY 1 tempo PRIMAVERA che considera il passare del tempo con deviation_bellissima > 0.06 and deviation_ma5_sopra_ma28 > 0.18 - r 1562"
                    action = "buy"
                    percentage = 90
                    
                    # 17 mar 2023 per anticipare buy ho rafforzato dicendo che 300 non deve stare lontana dalla 450 (trend laterale)
                
                    
                    
                # BUY 1 tempo INIZIO AUTUNNO con 78 > 150 and (200 > 200 120 min) che considera passare del tempo con ma30 > MA 100 < 200
                
                
                
                    
                
                    
                    
                    
                # BUY 1 tempo INIZIO AUTUNNO (200 > 200 120 min) che considera il passare del tempo con ma30 > MA 100 < 200
                
                elif (     
                    ma50_last > ma100_last
                    and macd >= macd_2_min_ago
                    and ma200_last < ma300_last
                    and ma200_last > ma200_120_min_ago
                    and deviation_ma5_sopra_ma28 > 0.17
                    and ma100_last < ma200_last
                    
                    and ma30_last > ma30_40_min_ago
                    
                    and ma11_last > ma125_last
                  
                    and deviation_bellissima > 0.06
                    and ma20_last > ma20_2_min_ago
                    and ma5_last > ma5_2_min_ago
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 tempo INIZIO AUTUNNO (200 > 200 120 min ago) che considera il passare del tempo con 5-28 > 0.17 and 200<300 - r 1586 b"
                    action = "buy"
                    percentage = 70
                    
                    
                
                # BUY 1 tempo FINE AUTUNNO PRECEDENTE (quasi inverno !)
                
                elif (     
                    ma8_last > ma50_last
                    and macd >= macd_2_min_ago
                    and ma100_last > ma450_last
                    and ma59_last > ma100_last
                  
                    and ma200_last < ma200_120_min_ago
                    and ma100_last < ma200_last
                    
                    and ma30_last >= ma30_30_min_ago
                
                    and deviation_ma3_sopra_ma10 > 0.09
                    and deviation_ma5_sopra_ma28 > 0.13
                    and deviation_bellissima > 0.04
               
                    
                    and ma5_last > ma5_2_min_ago
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 pericolosa MA 59 > 100 FINE AUTUNNO (quasi inverno) passare tempo E CON 3-10 > 0.10 con 5-28 > 0.15 - r 1614 A"
                    action = "buy"
                    percentage = 80
                    
                    # 28 GIU 2022 HO TOLTO 11-125 e sono tornato alle origini con 8-56 !
                    # 20 set 8-50 da 8-56
                    # 11 ott 2022 69-100 da 78-100
                    # 11 ott 2022 dev bellissima 0.045 da 0.05
                    # 18 nov 2022 dev bellissima 0.04 da 0.045 (perche' 125 sta sopra 450 !)
                    # 18 nov 2022 5-29 0.13 da 0.14 (perche' 125 sta sopra 450 !)
                    # 15 gen 2023 59>100 da 69>100
                    
                    
                    
                    
                # BUY 1 tempo FINE AUTUNNO PRECEDENTE (quasi inverno !)
                
                elif (     
                    ma8_last > ma56_last
                    and macd >= macd_2_min_ago
                    and ma78_last < ma100_last
                    
                    and ma200_last < ma200_120_min_ago
                    and ma100_last < ma200_last
                    
                    and ma30_last > ma30_30_min_ago
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.24
                    and deviation_ma5_sopra_ma28 > 0.20
                    and deviation_bellissima > 0.06
               
                    and ma20_last > ma20_2_min_ago
                    and ma5_last > ma5_2_min_ago
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 PERICOLOSA 78<100 tempo FINE AUTUNNO (quasi inverno) con 50-78 considera passare del tempo CON 3-10>0.24 con 5-28 > 0.20 - r 1614 b"
                    action = "buy"
                    percentage = 80
                    
                    # 28 GIU 2022 HO TOLTO 11-125 e sono tornato alle origini con 8-56 !
                    
                    
                   
                    
                    
                # BUY 1 2 sett 2022 ore 5:03 - maria callas casta diva bellini - ma300 che SALE
                
                elif (     
                    ma5_last > ma20_last
                    and macd >= macd_2_min_ago
                    and deviation_callas < -0.12
                    and macd > macd_2_min_ago
                    
                    and deviation_ma50_sotto_ma300 < -0.29
                    and deviation_ma78_sotto_ma300 < -0.20
                    
                    and ma300_last > ma300_301_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma200_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 2 sett 2022 ore 5:03 maria callas casta diva bellini - ma300 5 ore che SALE - r 1615 A"
                    action = "buy"
                    percentage = 80
                    
                    # vedi che c'e' ma 300 5 ore che cresce
                    # 18 set 3-10 a 0.11 da 0.09
                    # se 78 sta lontana dalla 200 3-10 e' ok ! cazzo ! vedi 20 settembre ore 12:26
                    
                
                   
                    
                # BUY 1 maria callas core 'ngrato - 2 sett 2022 ore 5:03 - ma300 che SCENDE
                
                elif (     
                    
                    deviation_callas < -0.14
                    
                    and macd > macd_2_min_ago
                    
                    and deviation_ma50_sotto_ma300 < -0.29
                    and deviation_ma78_sotto_ma300 < -0.23
                    and deviation_ma78_sotto_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.60
                    
                    and ma300_last < ma300_301_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma200_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma2_last >= ma20_last
                    and ma2_last >= ma2_2_min_ago
                ):    
                    buy = "BUY 1 maria callas core 'ngrato con dev_callas -0.14 e con 5 sotto 300 < -0.60 - 2 set 2022 ore 5:03 - ma300 che SCENDE - r 1615 B"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_callas = ma5_last / ma54_last
                    
                    # vedi che c'e' ma 300 che scende
                    # 19 set 2022 ho anticipato maria callas core ngrato di una ndecchiecella
                    # se 78 sta vicino alla 200 3-10 piu' alto ! cazzo ! vedi 20 settembre ore 14:47
                    # 24 set 2022 5-28 > 0.11 da 0.12
                    # 26 set 2022 5-28 > 0.108 da 0.11
                    #  7 ott 2022 5-28 > 0.105 da 0.108
                    # 19 ott 2022 5-28 > 0.10 da 0.105 VIVA MARIA CALLAS ! condizione meravigliosa
                    #  8 nov maria callas con 5-59 - da 5-69
                    # 16 nov ho tolto ma5_last > ma59_last e ho messo dev callas = 5/54 <-0.10 PENSIERO LATERALE - VEDI 16 NOV ore 15 :33
                    # 19 GEN 2023 5-28 a 0.09 da 0.10
                    # 29 gen 2023 deviation_callas < -0.11 da -0.10
                    # 10 mar 2023 5-28 > 0.08 da 0.09
                    #  6  apr 2023 5-28 > 0.07 da 0.08
                    #  6  apr 2023 5-28 > 0.06 da 0.07
                    # 15 apr 2023 dev_callas -0.12
                    # 15 apr 2023 5-28 > 0.05 da 0.06
                    # 15 apr 2023 5-28 > 0.05 da 0.06
                    # 20 apr 2023 5-28 > 0.04 da 0.05
                    # 20 apr 2023 aggiunta macd > macd_2_min_ago
                    #  8 mag 2023 dev_callas -0.14 da -0.12
                    #  8 mag 2023 5-28 > 0.03 da 0.04
                
                # BUY 1 tempo FINE AUTUNNO (quasi inverno !)
                
                elif (     
                    ma8_last > ma50_last
                    and macd >= macd_2_min_ago
                    and ma30_last > ma30_40_min_ago
                    
                    and ma8_last < ma100_last
                    and ma8_last < ma200_last
                    and ma8_last < ma300_last
                    
                    and ma200_last < ma200_120_min_ago
                    and ma100_last < ma200_last
                    
                    and deviation_ma50_sotto_ma200 < -0.22
              
                    and deviation_ma5_sopra_ma28 > 0.20
                    
                    
                    and ma11_last > ma125_last
                    
                    
                    and deviation_bellissima > 0.06
                    and ma20_last > ma20_2_min_ago
                    and ma5_last > ma5_2_min_ago
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                ):    
                    buy = "BUY 1 PERICOLOSA tempo FINE AUTUNNO VELOCE (quasi inverno !) con 50-78 che considera il passare del tempo con 5-28 > 0.20 - r 1651"
                    action = "buy"
                    percentage = 80
                    
                    # 50-78 PRIMA ERA 50-100 (arrivava un po' tardi.) (questa era la mia impressione.)
                    # 8>50
                    
                    
                    ################################################################################################ fine autunno
                    
              
                
                
                # BUY 1 tempo INVERNO 
                
                elif (     
                    ma50_last > ma100_last

                    and ma100_last < ma100_30_min_ago

                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma50_sotto_ma300 < -0.15
                    and deviation_ma39 < -0.06
                    and deviation_ma3_sotto_ma50 < -0.25
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.37
                    and deviation_ma5_sotto_ma200 < -0.27
                    and deviation_ma5_sotto_ma300 < -0.39
                    and macd >= macd_2_min_ago
                    and ma100_last < ma200_last
                    
                    
                    and ma30_last < ma30_40_min_ago
                    and ma11_last > ma125_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                   
                    and ma2_last > ma20_last
                    and ma2_last > ma2_2_min_ago
                
                ):    
                    buy = "BUY 1 INVERNO che considera passare tempo con 100 < 100 30 min ago + NUOVE CONDIZIONI GRAFANA - r 1688"
                    action = "buy"
                    percentage = 90


                    
                    
                # BUY 1 con ma200< e 300< MA doppio delta < and ma100 >60_min_ago STA RISALENDO !


                elif (
                    ma3_last > ma13_last

                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_301_min_ago

                    and ma100_last < ma200_last
                    and deviation_ma39 < -0.30
                    and deviation_ma3_sotto_ma50 < -0.30

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02

                    and macd_differenza_2_min_ago > -18.50
                ):    
        
                    buy = "BUY 1 CON 450> E 300> E MA 100<200 - r 1712 Ax"
                    action = "buy"
                    percentage = 90

                    # 21 mar 2025 anticipato ndecchiecella
                    # 30 mar 2025 anticipata. ho tolto doppio delta < GIORNO !
                    #  7 apr 2025 se 100<200 aggiunta and deviation_ma39 < -0.30
                    #  7 apr 2025 se 100<200 aggiunta and deviation_ma3_sotto_ma50 < -0.30


                elif (
                    ma3_last > ma18_last

                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_301_min_ago
                    
                    and ma200_last < ma200_20_min_ago
                    and delta_1 > delta_2


                    and deviation_ma39 < -0.06
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma25_sotto_ma300 < -0.38
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.035


                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
        
                    buy = f"BUY 1 {deviation_ma39} {deviation_ma3_sotto_ma50} {deviation_ma5_sopra_o_sotto_ma100} {deviation_ma25_sotto_ma300} {deviation_ma100_sopra_o_sotto_ma100_10_min_ago} CON 450> E 300> E  MA ma200 < - r 1712 Ay"
                    action = "buy"
                    percentage = 90
                    
                    # 21 mar 2025 anticipato ndecchiecella
                    # 30 mar 2025 anticipata. ho tolto doppio delta < GIORNO !
                    # 30 mar 2025 se e' notte MA SEMPRE CON 450> aggiungo dev ma39< -0.06 e dev 3-50 < -0.08
                    # 14 apr 2025 e' andata benissimo !
                    #  7 mag 2025 e' andata benissimo - metto parentesi graffe per conoscere i valori !
                    # 30 set 2025 le parentesi graffe hanno funzionato (stanno sulla stessa riga)



                elif (
                    ma3_last > ma18_last

                    and ma39_last < ma39_30_min_ago
                    and deviation_ma3_sotto_ma50 < -0.28

                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_301_min_ago
                    
                    and ma200_last < ma200_20_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and delta_1 < delta_2
                    
                    and macd_differenza_2_min_ago > -2.50
                ):    
        
                    buy = "BUY 1 CON 450> E 300> E GIORNO MA ma200 < E and ma39_last < ma39_30_min_ago + distanza verso il basso - r 1712 B"
                    action = "buy"
                    percentage = 90
                    
                    # 28 apr 2023 ma 100 5 min da 10 min
                    # 28 apr 2023  5-50 da 5-100 con aggiunta macd >= 2 min ago
                    # 21 mar 2025 se ma39_last < ma39_30_min_ago aggiungo and deviation_ma3_sotto_ma50 < -0.28


                elif (
                    ma3_last > ma10_last

                    and ma100_last > ma450_last

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.085
                    and deviation_ma300_sopra_ma450 > -0.085

                    and ma100_last < ma100_90_min_ago
                    and ma200_last < ma200_20_min_ago
                    and ma300_last < ma450_last

                    # CANO STAF
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma10_sopra_ma200 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.20
                    # CANO STAF

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma5_sotto_ma200 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.29

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.08
                    and deviation_ma5_sopra_ma28 > -0.10

                    and macd > -60
                    and macd_differenza_2_min_ago > -2
                ):    
        
                    buy = "BUY 1 CON 450 > 720 min MA ma100< e con dev 5-200 < -0.25 E CON dev 25-300 < -0.29 (osso) + CANO STAF - r 1720 AX"
                    action = "buy"
                    percentage = 90
                    
                    # 27 feb 2025 se 100>450 ok cosi'



                elif (
                    ma3_last > ma10_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15


                    and ma450_last > ma450_720_min_ago
                    

                    and ma100_last < ma100_90_min_ago
                    and ma200_last < ma200_20_min_ago
                    and ma300_last < ma450_last

                    
                    and deviation_ma5_sotto_ma200 < -0.25
                    and deviation_ma5_sotto_ma300 < -0.20

                    and deviation_ma25_sotto_ma300 < -0.29

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.08
                    and deviation_ma5_sopra_ma28 > -0.10

                    and macd_differenza_2_min_ago > -2
                ):    
        
                    buy = "BUY 1 CON 450 > 720 min MA ma100< e con dev 5-200 < -0.25 E CON dev 25-300 < -0.29 (osso) + CANO STAF - r 1720 AY"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 e' andata bene !
                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 27 feb 2025 se anche  ma100_last < ma450_last allora continua a scendere
                    # 27 feb 2025 CONTINUA A SCENDERE







                elif (
                    ma3_last > ma10_last

                    and ma450_last > ma450_720_min_ago

                    and ma100_last < ma100_10_min_ago
                    and ma100_last < ma100_90_min_ago
                    and ma200_last < ma200_20_min_ago
                    and ma300_last < ma450_last


                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.01
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.18
                    and deviation_ma25_sotto_ma300 < -0.30
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13


                    and deviation_ma5_sotto_ma200 < -0.25
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma10_sopra_ma200 < -0.20
                    
                    and deviation_ma3_sopra_ma10 > 0.01

                    and macd_differenza_2_min_ago > -18.50
                  
                ):    
        
                    buy = f"BUY 1 con 100 < 90 min E ma200 < 20 min + CANO STAF - r 1720 B - {deviation_ma39} {deviation_ma3_sotto_ma50} {deviation_ma5_sopra_o_sotto_ma100} {deviation_ma25_sotto_ma300} {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    
                    action = "buy"
                    percentage = 90
                    
                    #  7 ott 2024 DATEMI UN OSSO (and deviation_ma5_sotto_ma200 < -0.30)
                    #  7 ott 2024 DATEMI UN OSSO (and deviation_ma25_sotto_ma300 < -0.60)
                    #  7 ott 2024 aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    # 15 ott 2024 entra il CANO STAF !

                    # 29 gen 2025 e' andata bene !
                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 30 set 2025 aggiunti valori parentesi graffe sulla stessa righe.
                
                    
                    
                    
                # BUY 1 MISTERO CON 8>50 E 5-28 PIU' ALTO ! per arrivare una ndecchia prima del passare del tempo. prendendo rischio
                
                elif (
                    
                    ma8_last > ma50_last
                    and macd >= macd_2_min_ago
                    and ma78_last > ma200_last
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > 0.25
                    
                    and deviation_ma100_sopra_ma200 > -0.60
                    and deviation_ma50_sotto_ma200 < -0.15
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    
                    and deviation_ma13_sopra_ma25 > 0.04
                    and deviation_ma3_sopra_ma7 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 1 MISTERO CON 8>54 E 5-28 PIU' ALTO ! prendendo rischio con 78 > 200 3-10 > 0.05 - riga 1783 A"
                    action = "buy"
                    percentage = 90
                    
                    # ma100 sta sotto la ma200 MA non le e' troppo lontana cioe' NON ci troviamo in una situazione drammatica! ( anche se ma100< e ma200< e ma300< )
                    # MISTERO !
                    
                    
                    
                    
                # BUY 1 MISTERO CON 8>28 E 5-28 PIU' ALTO ! per arrivare una ndecchia prima del passare del tempo. prendendo rischio
                
                elif (
                  
                    ma8_last > ma28_last
                    and macd >= macd_2_min_ago
                    and ma78_last < ma200_last
                    
                    and deviation_ma5_sopra_ma59 < -0.15
                    
                    and deviation_ma3_sopra_ma10 > 0.20
                    and deviation_ma5_sopra_ma28 > 0.28
                    
                    
                    and deviation_ma100_sopra_ma200 > -0.60
                    and deviation_ma50_sotto_ma200 < -0.15
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    
                    and deviation_ma13_sopra_ma25 > 0.04
                    and deviation_ma3_sopra_ma7 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 1 MISTERO CON 8-28 and 5-28 PIU' ALTO ! and 3-10 > 0.24 prendendo rischio con 78 < 200  - riga 1783 B"
                    action = "buy"
                    percentage = 90
                    
                    # ma100 sta sotto la ma200 MA non le e' troppo lontana cioe' NON ci troviamo in una situazione drammatica! ( anche se ma100< e ma200< e ma300< )
                    # MISTERO !
                    # 31 dic 2022 8-28 da 8-50
                    # 31 dic 2022 aggiunta 5-59 < -0.15
                    
                    
                    
                # BUY 1 MISTERO con INCROCIO 8-50 E 5-28 PIU' BASSO per arrivare una ndecchia prima del passare del tempo. prendendo rischio
                
                elif (
                    
                    deviation_ma5_sopra_ma28 > 0.24
                    and macd >= macd_2_min_ago
                    and ma78_last > ma200_last
                    and delta_1_200_78 < delta_2_200_78_60_min
                    
                    and (ma8_prev < ma50_prev and ma8_last > ma50_last)
                    and deviation_ma100_sopra_ma200 > -0.60
                    and deviation_ma50_sotto_ma200 < -0.15
                    
                    and deviation_ma100_sopra_ma300 > -0.80
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    
                    and deviation_ma13_sopra_ma25 > 0.06
                    and deviation_ma3_sopra_ma7 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 1 MISTERO con INCROCIO 8-50 e 5-28 > 0.28 prendendo rischio - E CON delta 200-78 - RIALZO - riga 1825 AA"
                    action = "buy"
                    percentage = 80
                    
                    
                   
                    
                # BUY 1 MISTERO con INCROCIO 8-50 E 5-28 PIU' BASSO per arrivare una ndecchia prima del passare del tempo. prendendo rischio
                
                elif (
                    
                    deviation_ma5_sopra_ma28 > 0.24
                    and macd >= macd_2_min_ago
                    and ma78_last < ma200_last
                    and deviation_ma3_sopra_ma10 > 0.11
                    
                    and delta_1_200_78 < delta_2_200_78_60_min
                    
                    and (ma8_prev < ma50_prev and ma8_last > ma50_last)
                    and deviation_ma100_sopra_ma200 > -0.60
                    and deviation_ma50_sotto_ma200 < -0.15
                    
                    and deviation_ma100_sopra_ma300 > -0.80
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    
                    and deviation_ma13_sopra_ma25 > 0.06
                    and deviation_ma3_sopra_ma7 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 1 MISTERO con INCROCIO 8-50 e 5-28 > 0.28 prendendo rischio - E CON delta 200-78 - RIALZO - riga 1862 AB"
                    action = "buy"
                    percentage = 80
                    
                    
                   
                    
                # BUY 1 MISTERO con INCROCIO 8-50 E 5-28 PIU' BASSO per arrivare una ndecchia prima del passare del tempo. prendendo rischio
                
                elif (
                    
                    deviation_ma5_sopra_ma28 > 0.24
                    and macd >= macd_2_min_ago
                    and delta_1_200_78 > delta_2_200_78_60_min
                    and deviation_ma3_sopra_ma10 > 0.22
                    
                    and (ma8_prev < ma50_prev and ma8_last > ma50_last)
                    and deviation_ma100_sopra_ma200 > -0.60
                    and deviation_ma50_sotto_ma200 < -0.15
                    
                    and deviation_ma100_sopra_ma300 > -0.80
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    
                    and deviation_ma13_sopra_ma25 > 0.06
                    and deviation_ma3_sopra_ma7 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 1 MISTERO con INCROCIO 8-50 e 5-28 > 0.28 prendendo rischio - E CON delta 200-78 - RIBASSO - riga 1898 B"
                    action = "buy"
                    percentage = 80
                    
                   
                    
                    
                # BUY 1 MISTERO con INCROCIO 8-50 E 5-28 PIU' BASSO per arrivare una ndecchia prima del passare del tempo. prendendo rischio
                
                elif (
                    
                    deviation_ma5_sopra_ma28 > 0.14
                    and macd >= macd_2_min_ago
                    and (ma8_prev < ma50_prev and ma8_last > ma50_last)
                    and deviation_ma100_sopra_ma200 > -0.60
                    and deviation_ma50_sotto_ma200 < -0.15
                    
                    and deviation_ma100_sopra_ma300 < -0.80
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    
                    and deviation_ma13_sopra_ma25 > 0.06
                    and deviation_ma3_sopra_ma7 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 1 MISTERO (sembra BUY FIAT) con INCROCIO 8-50 e 5-28 > 0.14 arrivare ndecchia prima del passare del tempo - rischiosa - riga 1936"
                    action = "buy"
                    percentage = 80
                    
                    # ma100 sta sotto la ma200 MA non le e' troppo lontana cioe' NON ci troviamo in una situazione drammatica! ( anche se ma100< e ma200< e ma300< )
                    # MISTERO !
                    
                 
                
                
                # BUY 1 copiata e modificata da RCCR che e' arrivata una ndecchia prima del passare del tempo.
                
                elif (
                    
                    ma8_last > ma140_last
                    and macd >= macd_2_min_ago
                    and deviation_ma100_sopra_ma200 > -0.30
                    and ma20_last > ma200_last
                    
                    and ma100_last > ma100_2_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and ma72_last >= ma72_2_min_ago
                    and ma13_last > ma69_last
                    and deviation_bellissima > 0.21
                    and deviation_ma13_sopra_ma25 > 0.09
                    and deviation_ma3_sopra_ma7 > 0.05
                    and ma3_last > ma3_3_min_ago
                    and ma2_last > ma2_2_min_ago
              
                ):
                    buy = "BUY 1 8-140 copiata e modificata da RCCR che e' arrivata una ndecchia prima del passare del tempo -20>200 - riga 1976 a"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana cioe' NON ci troviamo in una situazione drammatica! (anche se ma200< e ma300<)
                    # 20 maggio 2020 messo ma140 prima era ma150
                    # > estate alzato buy
                    
                    
                
                # BUY 1 copiata e modificata da RCCR che e' arrivata una ndecchia prima del passare del tempo.
                
                elif (    
                    ma8_last > ma140_last
                    and macd >= macd_2_min_ago
                    and deviation_ma100_sopra_ma200 > -0.30
                    and ma20_last < ma200_last
                    and deviation_ma3_sopra_ma10 > 0.24
                    and deviation_ma5_sopra_ma28 > 0.18
                    
                    and ma100_last > ma100_2_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and ma72_last >= ma72_2_min_ago
                    and ma13_last > ma69_last
                    and deviation_bellissima > 0.17
                    and deviation_ma13_sopra_ma25 > 0.07
                    and deviation_ma3_sopra_ma7 > 0.05
                    and ma3_last > ma3_3_min_ago
                    and ma2_last > ma2_2_min_ago
              
                ):
                    buy = "BUY 1 8-140 copiata e modificata da RCCR - 20<200 AND 3-10>0.24 AND 5-28 > 0.18 - riga 2008 b"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana cioe' NON ci troviamo in una situazione drammatica! (anche se ma200< e ma300<)
                    # 20 maggio 2020 messo ma140 prima era ma150
                    
                
                
                # ------------------------------------------------------------  BUY 1 con incrocio 11-69 and ma69_last >= ma69_2_min_ago  "MI PIACE!"
                
                elif (
                    ma20_last > ma200_last
                    and macd >= macd_2_min_ago
                    and ma11_last > ma50_last
                    and ma69_last >= ma69_2_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_bellissima > 0.16
                    and price > price_2_min_ago
                    and ma3_last > ma3_3_min_ago
                    
                    and deviation_ma3_sopra_ma7 > 0.05
                    and deviation_ma13_sopra_ma25 > 0.06
                 
                ):
                    buy = "BUY 1 con ma20_last > ma200_last e con 11 > 59 e ma69> 2 min ago (!) r 2042"
                    action = "buy"
                    percentage = 80
                    
                    

                elif (
                    
                    ma3_last > ma20_last
                    and deviation_ma200_sotto_ma300 < -0.17
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma39 < -0.02
                    and ma5_last > ma50_last
                    
                    and delta_300_225 < delta_300_225_60_min
                    
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma7 > 0.01
                    and deviation_ma13_sopra_ma25 > -0.01
                  
                    and price >= price_2_min_ago
                    and macd > -60
                ):
                    buy = "BUY 1 GIORNO con 3>20 - r 2065 AX"
                    action = "buy"
                    percentage = 80

                    #  6 feb 2025 modificata - GIORNO

                
                elif (    
                    ma3_last > ma25_last

                    and deviation_ma200_sotto_ma300 < -0.17
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma39 < -0.02
                    and ma5_last > ma50_last
                    
                    and delta_300_225 > delta_300_225_60_min
                    
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma7 > 0.01
                    and deviation_ma13_sopra_ma25 > -0.01
                  
                    and price >= price_2_min_ago
                    and macd > -60
                ):
                    buy = "BUY 1 NOTTE con 3>25 ! - r 2065 AY"
                    action = "buy"
                    percentage = 80
                    
                    # > estate anticipato buy di una ndecchia
                    #  3 lug 2023 tolto dev bellissima
                    #  3 lug 2023 tolto ma100_last > ma150_last
                    #  5 feb 2025 modificata - anticipata ndecchiecella - niente di speciale
                    #  6 feb 2025 modificata - NOTTE

                    
                elif (    
                    
                    ma5_last > ma50_last
                    and ma450_last > ma450_90_min_ago

                    and delta_300_225 < delta_300_225_60_min
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma39 < -0.14
                    and deviation_ma3_sotto_ma50 < -0.22
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma3_sopra_ma7 > 0.01
                    
                    and macd_differenza_2_min_ago > -6.50
                ):
                    buy = "BUY 1 con 5>50 se ma450 > ma 450 90 min ago and DOPPIO DELTA 300-225 GIORNO ! - r 2065 Bx 1"
                    action = "buy"
                    percentage = 80
                    
                    # > estate anticipato buy di una ndecchia
                    #  3 lug 2023 tolto dev bellissima
                    #  3 lug 2023 tolto ma100_last > ma150_last
                    #  5 feb 2025 aggiunta questa - niente di speciale

                    # 14 apr 2025 aggiunta and deviation_ma39 < -0.14
                    # 14 apr 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.22
                    # 14 apr 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    


                    
                elif (       
                    ma3_last > ma20_last
                    and (ma78_last > ma150_last or ma100_last > ma100_60_min_ago)

                    and ma10_last > ma10_300_min_ago

                    and ma300_last > ma450_last
                    and (ma200_last > ma300_last or ma5_last > ma78_last)
                    
                    and deviation_ma3_sopra_ma7 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 1 con 3>20 se ma450 > ma 450 90 min ago  ! - r 2065 Bx 2x"
                    action = "buy"
                    percentage = 80

                    # > estate anticipato buy di una ndecchia
                    #  3 lug 2023 tolto dev bellissima
                    #  3 lug 2023 tolto ma100_last > ma150_last
                    #  5 feb 2025 aggiunta questa - niente di speciale
                    # 14 apr 2025 aggiunta questa per anticipare di una ndecchiecella la precedente
                    # 14 apr 2025 200>300 sostituisce and delta_300_225 < delta_300_225_60_min. cazzo.
                    # 15 apr 2025 3-20 da 3-39
                    # 15 apr 2025 ma10_last > ma10_300_min_ago ho dovuto metterla altrimenti avrebbe comprato durante il ribasso
                    #  9 mag 2025 aggiunta or ma5_last > ma78_last. ma gia' andava bene.
                    # 16 mag 2025 se anche ma100_last > ma100_60_min_ago ok cosi'

                
                elif (       
                    ma3_last > ma20_last
                    and (ma78_last < ma150_last or ma100_last < ma100_60_min_ago)
                    and deviation_ma25_sotto_ma300 < -0.50
                    
                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20

                    and ma10_last > ma10_300_min_ago

                    and ma300_last > ma450_last
                    and (ma200_last > ma300_last or ma5_last > ma78_last)
                    
                    and deviation_ma3_sopra_ma7 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 1 con 3>20 se ma450 > ma 450 90 min ago  ! - r 2065 Bx 2y1"
                    action = "buy"
                    percentage = 80

                    # 16 mag 2025 aggiunta and (ma78_last < ma150_last or ma100_last < ma100_60_min_ago)
                    # 16 mag 2025 con deviation_ma25_sotto_ma300 < -0.50 dev39 < -0.08 e 3-50 < -0.08


                elif (       
                    ma3_last > ma20_last
                    and (ma78_last < ma150_last or ma100_last < ma100_60_min_ago)
                    and deviation_ma25_sotto_ma300 < -0.20
                    and deviation_ma25_sotto_ma300 > -0.50

                    and deviation_ma39 < -0.18
                    and deviation_ma3_sotto_ma50 < -0.18
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20

                    and ma10_last > ma10_300_min_ago

                    and ma300_last > ma450_last
                    and (ma200_last > ma300_last or ma5_last > ma78_last)
                    
                    and deviation_ma3_sopra_ma7 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 1 con 3>20 se ma450 > ma 450 90 min ago  ! - r 2065 Bx 2y2"
                    action = "buy"
                    percentage = 80

                    # 16 mag 2025 con deviation_ma25_sotto_ma300 tra >-0.50 e <-0.20 dev39 < -0.18 e 3-50< -0.18
                    


                elif (    
                    ma3_last > ma16_last
                    and ma450_last > ma450_720_min_ago
                    and deviation_ma200_sotto_ma300 < -0.25

                    
                    and ma450_last < ma450_90_min_ago
                    and (ma300_last < ma300_60_min_ago or ma300_last < ma300_120_min_ago)
                    and delta_1 > delta_2

                    and deviation_ma39 < -0.03
                    and deviation_ma3_sotto_ma50 < -0.03

                    and delta_300_225 < delta_300_225_60_min
                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 1 COMINCIA A SCENDERE e con 3>16 e DOPPIO DELTA 300-225 GIORNO ! - r 2065 BY 1"
                    action = "buy"
                    percentage = 80
                    
                    # > estate anticipato buy di una ndecchia
                    #  3 lug 2023 tolto dev bellissima
                    #  3 lug 2023 tolto ma100_last > ma150_last
                    #  5 feb 2025 aggiunta questa - niente di speciale
                    # 17 feb 2025 aggiunta and deviation_ma39 < -0.01
                    # 17 feb 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.04
                    #  2 mar 2025 aggiunta COMINCIA A SCENDERE !
                    # 12 mar 2025 se ma450_last > ma450_720_min_ago e deviation_ma200_sotto_ma300 < -0.25 COMINCIA A SCENDERE  

                elif (    
                    ma3_last > ma16_last

                    and ma450_last < ma450_720_min_ago
                    and ma450_last < ma450_90_min_ago
                    
                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13


                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10

                    and deviation_ma3_sopra_ma7 > 0.01
                    and macd_differenza_2_min_ago > -2.50
                   
                ):
                    buy = "BUY 1 CONTINUA A SCENDERE - r 2065 BY 2"
                    action = "buy"
                    percentage = 80
                    
                    # > estate anticipato buy di una ndecchia
                    #  3 lug 2023 tolto dev bellissima
                    #  3 lug 2023 tolto ma100_last > ma150_last
                    #  5 feb 2025 aggiunta questa - niente di speciale
                    # 17 feb 2025 aggiunta and deviation_ma39 < -0.01
                    # 17 feb 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.04
                    #  2 mar 2025 aggiunta COMINCIA A SCENDERE !
                    # 12 mar 2025 se ma 450 < 450 720 min ago e' un CONTINUA A SCENDERE !
                    
                    
                    
                # buy1 r913 anticipata e modificata sta risalendo
                
                elif (
                    ma100_last > ma200_last
                    and macd >= macd_2_min_ago
                    
                    and ma100_last > ma300_last
                    and ma100_last > ma100_120_min_ago
                    
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and ma11_last > ma50_last
                    
                    and deviation_bellissima > 0.17
                    and price > price_2_min_ago
                    
                    and ma3_last > ma3_3_min_ago
                    and ma4_last > ma4_2_min_ago
                    and deviation_ma3_sopra_ma7 > 0.05
                    and deviation_ma13_sopra_ma25 > 0.06
                 
                ):
                    buy = "BUY 1 r913 anticipata e modificata e con 11 > 50 - SOPRA RIALZO RIALZO - GIORNO - r 2109"
                    action = "buy"
                    percentage = 80
                    
           
        
        
                
                # BUY 1 con 11-69 SE ma200 SALE DA 2 ORE !
                    
                elif (
                    ma200_last > ma200_120_min_ago
                    and macd >= macd_2_min_ago
                    and ma20_last > ma200_last
                    and ma11_last > ma69_last
                    and deviation_ma5_sopra_ma28 > 0.15
                    and deviation_bellissima > 0.17
                    and price > price_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma3_3_min_ago
                    and ma4_last > ma4_2_min_ago
                    and deviation_ma3_sopra_ma7 > 0.05
                    and deviation_ma13_sopra_ma25 > 0.07
                 
                ):
                    buy = "BUY 1 con 11-69 SE ma200 SALE DA 2 ORE ! - r 2133"
                    action = "buy"
                    percentage = 80
                    
                    
                    
           
                elif (
                    ma20_last > ma200_last
                    and macd >= macd_2_min_ago
                    and deviation_buy1 > 0.24
                    and ma13_last > ma50_last
                    and ma78_last > ma78_2_min_ago
                    and deviation_bellissima > 0.18
                    and price > price_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma4_last > ma4_2_min_ago
                ):
                    buy = "BUY 1 con 13>50 and DEVIATION BUY 1 ALTA e ma78> - r 2150"
                    action = "buy"
                    percentage = 80
                    
               
            
            
                elif (
                    ma20_last > ma200_last
                    and macd >= macd_2_min_ago
                    and ma78_last < ma78_2_min_ago
                    and ma39_last > ma78_last
                    and deviation_buy1 > 0.14
                    and deviation_bellissima > 0.17
                    and price > price_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma4_last > ma4_2_min_ago
                    and deviation_ma3_sopra_ma7 > 0.05
                ):
                    buy = "BUY 1 con ma78< and 39>78 and DEVIATION BUY 1 BASSA r 2168"
                    action = "buy"
                    percentage = 80
                    
                    
               
            
            
                elif (
                    ma20_last > ma200_last
                    and macd >= macd_2_min_ago
                    and ma78_last < ma78_2_min_ago
                    and ma39_last > ma78_last
                    and deviation_bellissima > 0.17
                    and price > price_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma4_last > ma4_2_min_ago
                    and deviation_ma3_sopra_ma7 > 0.05
                    and deviation_ma13_sopra_ma25 > 0.05
                ):

                    buy = "BUY 1 se ma78< - BUY 1 con incrocio 39>78 - r 2188"
                    action = "buy"
                    percentage = 80
                    
                   
                
                elif (
                    ma3_last > ma18_last

                    and delta_300_200 < delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -0.49

                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.50
                    
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    
                    and macd >= -50
                ):
             
                    buy = "BUY 1 durante un TREND IN RIALZO 300 > 120 min ago - r 2200 A"
                    action = "buy"
                    percentage = 90

                    # 27 gen 2025 se GIORNO and deviation_ma25_sotto_ma300 < -0.49


                elif (
                    ma3_last > ma18_last

                    and delta_300_200 > delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -1.20

                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.50
                    
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    
                    and macd >= -50
                ):
             
                    buy = "BUY 1 durante un TREND IN RIALZO 300 > 120 min ago - r 2200 B"
                    action = "buy"
                    percentage = 90

                    #  9 dic 2024 aggiunta
                    # 27 gen 2025 se NOTTE and deviation_ma25_sotto_ma300 < -1.20
                
                    
                ################################################  compra durante un rialzo improvviso ! PER ADESSO SOLO SUL BUY 1
                ################################################  con ma30 che ha 30 min di andamento laterale
                 
                elif (
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.50
                    
                    and deviation_rialzo_improvviso_sopra > 0.45
                    and deviation_rialzo_improvviso_1 > 0.45
                    and deviation_rialzo_improvviso_2 > 0.19
                    and deviation_rialzo_improvviso_3 > 0.19
                    and deviation_range_1 < 0.22
                    and deviation_range_1 > -0.22
                    and deviation_range_2 < 0.22
                    and deviation_range_2 > -0.22
                    and deviation_range_x < 0.22
                    and deviation_range_x > -0.22
                ):
             
                    buy = "BUY 1 RIALZO IMPROVVISO con ma200 > E 300 > 120 min ago e con > 0.45 SE MA100 MOLTO IN ALTO DA MA300 - r 2216 AA"
                    action = "buy"
                    percentage = 90



                elif (
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 < 0.50
                    
                    and deviation_rialzo_improvviso_sopra > 0.46
                    and deviation_rialzo_improvviso_1 > 0.46
                    and deviation_rialzo_improvviso_2 > 0.19
                    and deviation_rialzo_improvviso_3 > 0.19
                    and deviation_range_1 < 0.22
                    and deviation_range_1 > -0.22
                    and deviation_range_2 < 0.22
                    and deviation_range_2 > -0.22
                    and deviation_range_x < 0.22
                    and deviation_range_x > -0.22
                ):
             
                    buy = "BUY 1 RIALZO IMPROVVISO durante movimento laterale con ma200 > E 300 > 120 min ago e con > 0.46 - r 2239 AB"
                    action = "buy"
                    percentage = 90
                 
                    # deviation_rialzo_improvviso_sopra = price / ma200_last
                    # deviation_rialzo_improvviso_1 = price / ma30_last
                    # deviation_rialzo_improvviso_2 = price / ma30_10_min_ago
                    # deviation_rialzo_improvviso_3 = price / ma30_20_min_ago
                    # deviation_range_1 = ma30_last / ma30_10_min_ago
                    # deviation_range_2 = ma30_10_min_ago / ma30_20_min_ago
                    # deviation_range_x = ma30_last / ma30_20_min_ago
                    
                    
                    
                
                
                elif (
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_rialzo_improvviso_sopra > 0.50
                    and deviation_rialzo_improvviso_1 > 0.50
                    and deviation_rialzo_improvviso_2 > 0.19
                    and deviation_rialzo_improvviso_3 > 0.19
                    and deviation_range_1 < 0.22
                    and deviation_range_1 > -0.22
                    and deviation_range_2 < 0.22
                    and deviation_range_2 > -0.22
                    and deviation_range_x < 0.22
                    and deviation_range_x > -0.22
                ):
             
                    buy = "BUY 1 RIALZO IMPROVVISO durante movimento laterale con ma200 > E 300 > 120 min ago e con > 0.50 - r 2280 B"
                    action = "buy"
                    percentage = 90
                 
                    # deviation_rialzo_improvviso_sopra = price / ma200_last
                    # deviation_rialzo_improvviso_1 = price / ma30_last
                    # deviation_rialzo_improvviso_2 = price / ma30_10_min_ago
                    # deviation_rialzo_improvviso_3 = price / ma30_20_min_ago
                    # deviation_range_1 = ma30_last / ma30_10_min_ago
                    # deviation_range_2 = ma30_10_min_ago / ma30_20_min_ago
                    # deviation_range_x = ma30_last / ma30_20_min_ago
                    
                    
               
                
                # BUY 1 variazione 1 RIALZO con 20-69
                
                elif (
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and (ma20_prev < ma69_prev and ma20_last > ma69_last)
                    and deviation_rialzo_improvviso_1 > 0.25
                    and deviation_range_1 > 0.20
                    and ma2_last > ma2_2_min_ago
                ):
              
                    buy = "BUY 1 variazione 1 RIALZO con 20-69 - r 2312"
                    action = "buy"
                    percentage = 80
                 
                    # deviation_rialzo_improvviso_1 = price / ma30_last
                    # deviation_range_1 = ma30_last / ma30_10_min_ago
                    
                    
              
                    
                    
                # BUY 1 variazione 2 RIALZO con 20-100
                
                elif (
                  
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and (ma20_prev < ma100_prev and ma20_last > ma100_last)
                   
                    and deviation_rialzo_improvviso_1 > 0.25
                    and deviation_range_1 > 0.20
                    
                    and ma2_last > ma2_2_min_ago
                ):

                    buy = "BUY 1 variazione 2 RIALZO con 20-100 - r 2335"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_rialzo_improvviso_1 = price / ma30_last
                    # deviation_range_1 = ma30_last / ma30_10_min_ago
                    
                    
                
                
                
                # BUY 1 variazione 3 RIALZO con 20-200
                
                elif (
                  
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and (ma20_prev < ma200_prev and ma20_last > ma200_last)
                    and deviation_rialzo_improvviso_1 > 0.25
                    and deviation_range_1 > 0.20
                    and ma2_last > ma2_2_min_ago
                
                ):

                    buy = "BUY 1 variazione 3 RIALZO con 20-200 - r 2358"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_rialzo_improvviso_1 = price / ma30_last
                    # deviation_range_1 = ma30_last / ma30_10_min_ago
                
                
                    
                    
                # rialzo improvviso trend ribassista
                
                elif (    
                   
                    ma200_last < ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_rialzo_improvviso_1 > 1.10
                    and deviation_rialzo_improvviso_2 > 0.20
                    and deviation_rialzo_improvviso_3 > 0.20
                    and deviation_rialzo_improvviso_4 > 0.20
              
                    and deviation_range_1 < 0.20
                    and deviation_range_1 > -0.20
                    and deviation_range_2 < 0.20
                    and deviation_range_2 > -0.20
                    and deviation_range_3 < 0.20
                    and deviation_range_3 > -0.20
             
                    and deviation_range_x < 0.20
                    and deviation_range_x > -0.20
                 
                ):

                    buy = "BUY 1 RIALZO IMPROVVISO con 78 < ( da 1.20 a 1.1 !) sempre tentando di evitare falsi acquisti - r 2392"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_rialzo_improvviso_sopra = price / ma200_last
                    # deviation_rialzo_improvviso_1 = price / ma30_last
                    # deviation_rialzo_improvviso_2 = price / ma30_10_min_ago
                    # deviation_rialzo_improvviso_3 = price / ma30_20_min_ago
                    # deviation_rialzo_improvviso_4 = price / ma30_30_min_ago
                    # deviation_range_1 = ma30_last / ma30_10_min_ago
                    # deviation_range_2 = ma30_10_min_ago / ma30_20_min_ago
                    # deviation_range_3 = ma30_20_min_ago / ma30_30_min_ago
                    # deviation_range_x = ma30_last / ma30_20_min_ago
                    
                    
                    
                    
          
                ########################################################################################################################### ATTENZIONE !
                
                # BUY piccola CORREZIONE FIAT
                # BUY grande CORREZIONE AUDI
                # BUY RIBASSO MASERATI
                # BUY CROLLO FERRARI
                
                ########################################################################################################################### ATTENZIONE !
              
            
            
                # BUY 1 con ma200> piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo ! (compare stammi vicino!)
               
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma28_last > ma28_30_min_ago
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.69
                    and ma3_last > ma28_last
                    and ma5_last > ma100_last
                ):    
                    
                    buy = "BUY 1A con ma200> piccola CORREZIONE FIAT che non e' un forte ribasso e non e' un crollo - r 2434 A"
                    action = "buy"
                    percentage = 80
                    
                    # and ma3_last > ma100_last PERCHE' in questa circostanza 3-28 arriva tardi e mi proteggo
                    # dovrei fare 2-5 MA SAREBBE TROPPO RISCHIOSO perche' ma100 gia' e' in ribasso !
                    
                    
                    
                    
                # BUY 1 con ma200> piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo ! CON ma28 < E CON 5-28 > 0.13 (compare stammi vicino!)
               
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma28_last < ma28_30_min_ago
                    and deviation_ma5_sopra_ma28 > 0.13
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.69
                    and ma3_last > ma28_last
                    and ma5_last > ma100_last
                ):    
                    
                    buy = "BUY 1A con ma200> piccola CORREZIONE FIAT che non e' un forte ribasso e non e' un crollo CON ma28 < E CON 5-28 > 0.13 - r 2458 B"
                    action = "buy"
                    percentage = 80
                    
                    # and ma3_last > ma100_last PERCHE' in questa circostanza 3-28 arriva tardi e mi proteggo
                    # dovrei fare 2-5 MA SAREBBE TROPPO RISCHIOSO perche' ma100 gia' e' in ribasso !
                    
                    
                    
                 
                
                
                # BUY 1 con ma300 > piccola CORREZIONE FIAT che NON E' AUDI e non e' MASERATI e NON E' FERRARI ! (compare stammi vicino!)
              
                elif (

                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.69
                    and deviation_correzione > 0.012
                    and ma5_last > ma72_last
                ):

                    buy = "BUY 1 con ma300 > piccola CORREZIONE FIAT che NON E' una grande correzione AUDI e non e' MASERATI e NON E' FERRARI ! - r 2484"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # ma5 non deve allontanarsi troppo dalla ma200 !
                    # compare prega per me !
                    # and ma3_last > ma69_last SOLTANTO con ma300> va bene anche senza ma sembra che STATISTICAMENTE produce una alta % di piccole perdite
                    
              
                
                # ATTENZIONE !
                # questa condizione che e' una condizione NECESSARIA FUNZIONALE E BUONA compra un po' troppo presto.
                # allora la divido in 3 !
                
                # la prima e' proprio uguale all' originaria ma aumento solo la ma da 5-39 a 5-100 
                # la seconda e' proprio uguale all' originaria ma aumento solo la ma da 5-39 a 5-50
                # la terza e' uguale proprio ma le dico che deve stare a una certa distanza da ma200 ( cioe' tenta di prendere solo il secondo tentativo )
                
                
             
                # BUY 1 piccola CORREZIONE FIAT = r 995 RCCR medie mobili lunghe TUTTE IN RIALZO ! ma si verifica una correzione fiat !


                # 24 nov 2024 cancellata r 2527 A1
                

                elif (
                    ma3_last > ma18_last
                    and ma450_last < ma450_360_min_ago
                    and ma28_last > ma28_30_min_ago
                    
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago

                    

                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.69
                    
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_last > ma3_last
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 1.10
                    and macd > -40
                ):    
                    
                    buy = "BUY 1 CORREZIONE FIAT con medie lunghe TUTTE IN RIALZO ! MA NON ma450 ! - r 2527a2"
                    action = "buy"
                    percentage = 80

                    # 18 dic 2023 tolta macd > macd 2 min ago (fa arrivare in ritardo)
                    # 18 dic 2023 aggiunta and ma2_last > ma3_last
                    # 18 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 18 dic 2023 aggiunta and macd_differenza_2_min_ago > 1.10
                    # 19 set 2024 se 450 > allora anticipa e tolgo 100>10 min perche' fa arrivare tardi
                    #  3 ott 2024 compra solo se and ma28_last > ma28_30_min_ago

                elif (
                    ma3_last > ma25_last
                    and ma450_last < ma450_120_min_ago
                    and ma100_last > ma100_10_min_ago
                    
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.69
                    
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_last > ma3_last
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 1.10
                    and macd > -40
                ):    
                    
                    buy = "BUY 1 CORREZIONE FIAT con medie lunghe tutte in rialzo ! ma 450 < 450 120 min ago ! - r 2527b"
                    action = "buy"
                    percentage = 80

                    # 18 dic 2023 tolta macd > macd 2 min ago (fa arrivare in ritardo)
                    # 18 dic 2023 aggiunta and ma2_last > ma3_last
                    # 18 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 18 dic 2023 aggiunta and macd_differenza_2_min_ago > 1.10


                
                # BUY 1 piccola CORREZIONE FIAT = r 995 RCCR medie mobili lunghe TUTTE IN RIALZO MA ma100 COMINCIA A RIPIEGARE ! correzione fiat
                
                elif (
                    ma3_last > ma25_last
                    and macd >= macd_2_min_ago
                    and ma100_last < ma100_10_min_ago
                    and ma11_last > ma100_last
                    
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.69
                    and ma2_last > ma2_2_min_ago
                    
                ):    
                    
                    buy = "BUY 1 piccola CORREZIONE FIAT = r 995 RCCR medie mobili lunghe TUTTE IN RIALZO MA ma100 COMINCIA A RIPIEGARE ! correzione fiat ! - r 2555"
                    action = "buy"
                    percentage = 80
                    
                    
                
                
                ################################################################################################### ecco le 2 CONDIZIONI PIU' PERICOLOSE !
                
               
                    
                # BUY 1 DURANTE UNA CORREZIONE FIAT che non e' un forte ribasso e non e' un crollo ! (MA ma3 > ma150 mi protegge un po')
                
                
                elif (    
                    
                    deviation_buy_crollo_1 < -0.29
                    and delta_1 < delta_2
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    
                    and ma5_last < ma22_last
                    
                    and deviation_correzione > 0.03
                    and deviation_ma100_sopra_ma300 > -0.30
                    and deviation_ma25_sotto_ma300 < -0.60
                    
                    and deviation_ma5_sotto_ma300 < -0.40
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 FIAT giorno DEVE STARE DISTANTE DALLA 300 ! - r 2575"
                    action = "buy"
                    percentage = 80
                    
                    # questa e' andata benissimo su RCCR ! il 10 ottobre 2022 ! maddog dormiva !
                    # vedi RCCR r 1294
                    #  3 feb 2025 aggiunto GIORNO 
                    
                
                    
                    
                    
                    
                # BUY 1 DURANTE UNA CORREZIONE FIAT che non e' un forte ribasso e non e' un crollo ! (MA ma3 > ma150 mi protegge un po')
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    and deviation_correzione > 0.03
                    
                    and ma100_last < ma300_last
                    and ma5_last > ma125_last
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 DURANTE UNA CORREZIONE FIAT che non e' un forte ribasso e non e' un crollo ! ma100<300 ma5 > ma125 - r 2595"
                    action = "buy"
                    percentage = 80
                    
                    
                   
                    
                    
                # BUY 1 FIAT 5-300 ( ma la ma100 E' ANCORA VICINA alla ma300 !) 
                # ( E ANCHE la ma25 deve stare un po' distante dalla 300 !!! )
                
                elif (
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_correzione > 0.03
                    and deviation_ma25_sotto_ma300 < -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.22
                    and deviation_ma5_sopra_ma28 > 0.05
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 FIAT 5-300 (MA ma100 E' ANCORA VICINA alla ma300) (E CON ma25 un po' distante dalla ma300) - r 2623"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_ma100_sopra_ma300 significa 100/300 ( ma100 ancora NON SI E' ALLONTANATA TROPPO DALLA ma300 )
                    # deviation_ma25_sotto_ma300 significa che anche ma25 deve andare almeno un po' sotto ma300 (per evitare piccole schegge rialziste !)
                    # 19 set 2022 aggiunto 3-10 > 0.22
                    
                    
                  
                ############################################################################################################################################## 
                
                
                # BUY 1 piccola CORREZIONE FIAT = r 701 RCCR ma con rischio ridotto !
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    and ma78_last > ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.12
                    
                    
                    and ma13_last > ma50_last
                    and ma20_last > ma20_22_min_ago
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 1 piccola CORREZIONE FIAT 78>200 = r 701 RCCR ma con rischio ridotto ! 3-10 > 0.12 cazzo ! - r 2651 a"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                # BUY 1 piccola CORREZIONE FIAT = r 701 RCCR ma con rischio ridotto !
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    and ma78_last < ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.12
                    and deviation_ma5_sopra_ma28 > 0.12
                    
                    and ma13_last > ma50_last
                    and ma20_last > ma20_22_min_ago
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 1 piccola CORREZIONE FIAT 78<200 = r 701 RCCR ma con rischio ridotto ! 3-10 > 0.12 cazzo ! AND 5-28>0.12 - r 2673 b"
                    action = "buy"
                    percentage = 80
                    
                   
                
                    
                # BUY 1 piccola CORREZIONE FIAT che non e' una grande correzione AUDI e non e' un forte ribasso MASERATI e non e' un crollo FERRARI !
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    
                    and deviation_ma5_sopra_ma28 > 0.07
                    
                    and deviation_correzione > 0.02
                    and ma5_last > ma100_last
                    and deviation_ma20_laterale > -0.15
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 piccola CORREZIONE FIAT che non e' una grande correzione AUDI e non e' un forte ribasso MASERATI e non e' FERRARI ! - r 2694"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # deviation_ma20_laterale > -0.15 cioe' ma20 ( una ma di breve termine) da ben 60 minuti non perde !
                    
                    # compare prega per me !
                    
                    
                    
                    
                    
                # BUY 1 piccola CORREZIONE FIAT 5-50 che NON E' una grande correzione e non e' un grande ribasso e NON E' un crollo !
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma78_last > ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.145
                    and ma8_last > ma28_last
                    
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma8_sotto_ma100 < -0.50
                    and deviation_buy_crollo_1 > -0.69
                ): 
            
                    buy = "BUY 1 FIAT piccola CORREZIONE 100 VICINA 300  8-28 NO grande correzione NO grande ribasso NO crollo ! 78 > 200 - r 2723"
                    action = "buy"
                    percentage = 70
                    
               
                
                # BUY 1 piccola CORREZIONE FIAT ma300 > 300 5 ore con 5-50 che NON E' una grande correzione e non e' un grande ribasso e NON E' un crollo !
                
                elif (
                    ma2_last >= ma2_2_min_ago
                    
                    and macd > macd_2_min_ago
                    
                    and ma78_last < ma200_last
                    and ma300_last > ma300_301_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.08
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and deviation_ma100_sopra_ma300 > -0.50
                    
                    and deviation_ma8_sotto_ma100 < -0.50
                    and deviation_buy_crollo_1 > -0.89
                ): 
            
                    buy = "BUY 1 FIAT ma300 > 300 5 ore con 100 VICINA 300 no GC no GR no C ! 78 < 200 AND 5-28 > 0.08 + macd  - r 2745 A"
                    action = "buy"
                    percentage = 70
                    
                    # 28 giu 2022 se 78 < 200 ho messo 3-10 > 0.24
                    # 23 lug 2022 5-28 > 0.21 deve essere sicura dopo 5 ore di ribasso !
                    # 26 ott 2022 5-28 > 0.03 da 0.21 !
                    # vedi 25 ottobre ore 22:46 forse dovrai aggiungere 5>300 !
                    #  2 nov 2022 5-28 > 0.11 da 0.03
                    # 27 apr 2023 5-28 > 0.08 da 0.11
                    # 27 apr 2023 aggiunto macd
                    # NO GC grande correzione NO GR grande ribasso NO C crollo
                    
                # BUY 1 piccola CORREZIONE FIAT 5-50 che NON E' una grande correzione e non e' un grande ribasso e NON E' un crollo !
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma78_last < ma200_last
                    and ma300_last < ma300_301_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.22
                    and deviation_ma3_sopra_ma10 > 0.25
                    and ma8_last > ma28_last
                    
                    and deviation_ma100_sopra_ma300 > -0.40
                    
                    and deviation_ma8_sotto_ma100 < -0.50
                    and deviation_buy_crollo_1 > -0.69
                ): 
            
                    buy = "BUY 1 FIAT piccola CORREZIONE 100 VICINA 300  8-28 NO grande correzione NO grande ribasso NO crollo ! 78 < 200  - r 2745 B"
                    action = "buy"
                    percentage = 70
                    
                    # 28 giu 2022 se 78 < 200 ho messo 3-10 > 0.24 
                    
                    
                  
                    
                # BUY 1 piccola CORREZIONE FIAT 5-50 che NON E' una grande correzione e non e' un grande ribasso e NON E' un crollo !
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma8_last > ma50_last
                    and deviation_ma5_sopra_ma28 > 0.20
                    and deviation_ma100_sopra_ma300 < -0.30
                    
                    and deviation_ma8_sotto_ma100 < -0.50
                    and deviation_buy_crollo_1 > -0.69
                    
                    and delta_1 < delta_2
                    and deviation_ma3_sopra_ma10 > 0.05
                ): 
            
                    buy = "BUY 1 FIAT con delta1 < delta2 and 3-10 > 0.05 and 5-28 > 0.20 e con 8-50 e con ma100 LONTANA 300 - r 2773 A"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                elif (    
                    deviation_buy_crollo_1 < -0.27
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.62
                    and ma8_last > ma50_last
                    and ma125_last > ma300_last
                    and ma2_last > ma2_2_min_ago
                
                ):
                    buy = "BUY 1 DURANTE UNA CORREZIONE FIAT che non e' un forte ribasso e non e' un crollo ! condizione RCCR MA 125 > 300 ! - r 2793"
                    action = "buy"
                    percentage = 60
                    
                    
                    
                    
                # BUY 1 piccola CORREZIONE FIAT 5-50 che NON E' una grande correzione e non e' un grande ribasso e NON E' un crollo !
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma8_last > ma50_last
                    and deviation_ma5_sopra_ma28 > 0.20
                    and deviation_ma100_sopra_ma300 < -0.30
                    
                    and deviation_ma8_sotto_ma100 < -0.50
                    and deviation_buy_crollo_1 > -0.69
                    
                    and delta_1 > delta_2
                    and deviation_ma3_sopra_ma10 > 0.17
                ): 
            
                    buy = "BUY 1 FIAT con delta1 > delta2 and 3-10 > 0.17 and 5-28 > 0.20 e con 8-50 e con ma100 LONTANA 300 - r 2795 B"
                    action = "buy"
                    percentage = 80
                    
                    
              
                
                # BUY 1 con ma200> piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo ! ALTRA RIGA RCCR che e' andata bene.
                
                elif (    
                    
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and ma20_last > ma78_last
                    and macd > macd_2_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.165
                    and ma28_last > ma28_2_min_ago
                    
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
             
                ):    
                    
                    buy = "BUY 1 con 200 > con 5-28> 0.165 and ma28_last > ma28_2_min_ago - 20 > 78 - r 2828 A"
                    action = "buy"
                    percentage = 80
                    
                    # 3 mag 2023 aggiunto macd > macd 2 min ago
                    
                    
                    
                    
                # BUY 1 con ma200> piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo ! ALTRA RIGA RCCR che e' andata bene.
                    
                elif (
                    ma3_last > ma13_last
                    and ma39_last > ma39_15_min_ago
                    
                    and ma300_last > ma300_360_min_ago
                    and ma200_last > ma200_20_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and ma20_last < ma78_last
                    and ma90_last > ma110_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > 0.02
                  
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 trend CHIARAMENTE rialzista con 200 > and 20<78 - r 2859 B1"
                    action = "buy"
                    percentage = 80

                    #  8 mar 2024 modificato 

                elif (
                    ma3_last > ma13_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192
                    
                    and ma300_last > ma300_360_min_ago
                    and ma200_last > ma200_20_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and ma20_last < ma78_last
                    and ma90_last > ma110_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > 0.02
                  
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 trend CHIARAMENTE rialzista PUGNO FANTASMA DI MOHAMMAD ALI' con 200 > and 20<78 and - r 2859 B2"
                    action = "buy"
                    percentage = 80

                    #  8 mar 2024 modificato


                elif (
                    ma3_last > ma13_last
                    and ma50_last > ma100_last

                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma300_last > ma300_360_min_ago
                    and ma200_last > ma200_20_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and ma20_last < ma78_last
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                  
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 trend rialzista con ma50 ancora > ma100 PRENDE IL COLTELLO CON IL PIEDE - r 2859 B3x"
                    action = "buy"
                    percentage = 80


                elif (
                    ma3_last > ma13_last
                    and ma25_last < ma50_last
                    and ma50_last < ma100_last
                    
                    
                    and ma200_last > ma200_60_min_ago

                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sotto_ma200 < -0.70

                    and ma300_last > ma300_360_min_ago
                    and ma200_last > ma200_20_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and ma20_last < ma78_last
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                  
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 trend rialzista MA ha cominciato a scenere forte ! PRENDE IL COLTELLO CON IL PIEDE - r 2859 B3y"
                    action = "buy"
                    percentage = 80
                    
                    # > estate anticipato buy di una ndecchiecella
                    # 2 nov 2022 anticipato di molto con 300 > 360 min ago !
                    # 2 nov 3-10 = 0.05 da 0.17
                    # 2 nov 5-28 = 0.05 da 0.15
                    # 15 feb 2023 13>13 2 min ago da 18>18 min ago
                    # 16 mar 2023 aggiunta 3-18 > 0.265
                    
                    #  8 mar 2024 modificato
                    #  9 set 2024 and deviation_ma5_sopra_o_sotto_ma100 < -0.40 da -0.30 MA FORSE E' DA TOGLIERE
                    #  5 ott 2024 trend rialzista MA HA COMINCIATO A SCENDERE FORTE !
                    #  5 ott 2024 aggiunta and deviation_ma5_sotto_ma200 < -0.70 ! cazzo 


                
                # BUY 1 che mancava se dopo 300 min di rialzo c'e' una correzione improvvisa 
                
                elif (    
                    
                    deviation_callas < -0.11
                    and macd >= macd_2_min_ago
                    and deviation_ma5_sopra_ma59 < -0.45
                    and ma300_last > ma300_300_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.70
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.04
                    
                    and ma2_last > ma2_2_min_ago
                ):    
                    
                    buy = "BUY 1 che mancava se dopo 300 min di rialzo c'e' una correzione improvvisa - riga 2860"
                    action = "buy"
                    percentage = 80
                    
                    # 3 set 5-48 da 5-50
                    # 3 set dev 5-28 0.04 da 0.05
                    # dev callas - pensiero laterale 
                    # 18 nov ho tolto ma5_last > ma54_last e ho messo dev callas = 5/54 <-0.10 PENSIERO LATERALE - VEDI 16 NOV ore 15:33
                    # 13 feb 2023 dev callas <-0.11 da < -0.10
                    # 13 feb 2023 per anticipare buy voglio essere ancora piu' sicuro e ho aggiunto 5-59 < -0.45
                    
                    
                
                    
                    
                    
                    
                
                
                
                # BUY 1 con ma200> piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo ! ALTRA RIGA RCCR che e' andata bene.
                
                elif (    
                    
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and ma28_last > ma28_30_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.19
                    and ma28_last < ma28_2_min_ago
                    
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
             
                ):    
                    
                    buy = "BUY 1 con 200 > con 5-28> 0.19 and ma28_last < ma28_2_min_ago and ma28_last > ma28_30_min_ago - riga 2894"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                    
                    
                    
                # BUY 1 con ma200> piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo ! ALTRA RIGA RCCR che e' andata bene.
                
                elif (    
                    
                    ma200_last > ma200_20_min_ago
                    and macd >= macd_2_min_ago
                    and ma28_last < ma28_30_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.25
                    and ma28_last < ma28_2_min_ago
                    
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
             
                ):    
                    
                    buy = "BUY 1 con 200 > con 5-28> 0.19 and ma28_last < ma28_2_min_ago and ma28_last < ma28_30_min_ago - riga 2925"
                    action = "buy"
                    percentage = 80
                    
                    
                  
                
                # BUY 1 piccola CORREZIONE FIAT 5-39 ma con ma5 piu' distante da ma200 che NON E' un grande ribasso e NON E' un crollo ! STA RISALENDO
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma5_last > ma34_last
                    and deviation_ma5_sopra_ma28 > 0.175
                    and deviation_ma5_sotto_ma200 < -0.85
                    
                    and rapporto_delta_1_delta_2_69_39 < 1
                    and ma39_last > ma39_30_min_ago
                    
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma8_sotto_ma100 < -0.50
                    and deviation_buy_crollo_1 > -0.69
                ): 
            
                    buy = "BUY 1 CORREZIONE FIAT 5-34 ma con ma5 piu' distante da ma200 - SOTTO RIALZO RIALZO - GIORNO ! - r 2954"
                    action = "buy"
                    percentage = 80
                    
                    # 5-28 se non c'e' un minimo di accelerazione che cazzo mi compri !
                    # CORREZIONE FIAT NON E' un grande ribasso e NON E' un crollo 

                    
                
                
                
                # BUY 1 con ma200 < e ma300 < piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo !
                
                elif (

                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    and ma11_last > ma69_last
                    
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.69
                    
                ):

                    buy = "BUY 1 con ma200< e ma300< piccola CORREZIONE FIAT che NON E'una grande correzione e NON E' un grande ribasso e NON E' un crollo - r 2979"
                    action = "buy"
                    percentage = 80
                    
                    
                    

                
                # BUY 1 con RIBASSO VELOCE MA la distanza tra ma100 e ma200 si sta riducendo - USANDO UN DOPPIO DELTA ! STA RISALENDO
                    
                elif (
                    ma3_last > ma13_last
                    and deviation_ma100_sopra_ma450 > 1.50
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma3 < -1.30
                    and delta_1 < delta_2
                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and macd >= macd_2_min_ago
                
                ):
                    buy = "BUY 1 con RIBASSO VELOCE mentre distanza tra ma100 e ma200 si sta riducendo - GIORNO ! - r 2998 a1"
                    action = "buy"
                    percentage = 80

                    #  8 mar 2024 modificato se trend CHIARAMENTE crescente and ma100_last > ma100_60_min_ago



                elif (
                    ma3_last > ma13_last
                    and deviation_ma100_sopra_ma450 > 1.50
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma3 < -1.30
                    and delta_1 < delta_2
                    and deviation_ma3_sopra_ma10 > 0.06
                    
                    and macd >= macd_2_min_ago
                
                ):
                    buy = "BUY 1 con RIBASSO VELOCE mentre distanza tra ma100 e ma200 si sta riducendo - GIORNO ! - r 2998 a2"
                    action = "buy"
                    percentage = 80
                    
                    # and delta_1 < 0.25
                    # and delta_2 > 0.40
                    # STUDIARE MEGLIO DELTA 1 E DELTA 2
                    # compare grazie. altre parole io non ho.
                    # 21 gen 2023 aggiunta 3-10 > 0.06 vedi 21 gen 2023 ore 11:47

                    #  8 mar 2024 modificato se trend CHIARAMENTE crescente and ma100_last < ma100_60_min_ago



                elif (
                    ma3_last > ma20_last
                    and deviation_ma100_sopra_ma450 < 1.50
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma3 < -1.30
                    and delta_1 < delta_2
                    and deviation_ma3_sopra_ma10 > 0.05
                    
                    and macd >= macd_2_min_ago
                
                ):
                    buy = "BUY 1 con RIBASSO VELOCE mentre distanza tra ma100 e ma200 si sta riducendo - GIORNO ! - r 2998 b1"
                    action = "buy"
                    percentage = 80
                    
                    #  8 mar 2024 modificato se trend crescente and ma100_last > ma100_60_min_ago



                elif (
                    ma3_last > ma20_last
                    and deviation_ma100_sopra_ma450 < 1.50
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma3 < -1.30
                    and delta_1 < delta_2
                    and deviation_ma3_sopra_ma10 > 0.06
                    
                    and macd >= macd_2_min_ago
                
                ):
                    buy = "BUY 1 con RIBASSO VELOCE mentre distanza tra ma100 e ma200 si sta riducendo - GIORNO ! - r 2998 b2"
                    action = "buy"
                    percentage = 80
                    
                    # and delta_1 < 0.25
                    # and delta_2 > 0.40
                    # STUDIARE MEGLIO DELTA 1 E DELTA 2
                    # compare grazie. altre parole io non ho.
                    # 21 gen 2023 aggiunta 3-10 > 0.06 vedi 21 gen 2023 ore 11:47
                    
                    #  8 mar 2024 modificato se trend crescente and ma100_last > ma100_60_min_ago
                    
                    
                  
                
                # BUY 1 grande CORREZIONE AUDI che NON E' una piccola CORREZIONE FIAT che NON E' un grande ribasso MASERATI e NON E' un crollo FERRARI !)
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and (ma20_prev < ma200_prev and ma20_last > ma200_last)
                    and deviation_correzione_1 > 0.03
                    
                    and deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -0.90
                  
                ):
                    buy = "BUY 1 grande CORREZIONE AUDI che NON E' FIAT e NON E' MASERATI e NON E' FERRARI ! + deviation_correzione> 0.02 - r 3022"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma5_last / ma30_last
                    
              
                
                
                
                # BUY 1 grande CORREZIONE AUDI che NON E' FIAT e NON E' MASERATI e NON E' FERRARI ! con deviation trend ma200
                
                elif (
                    ma2_last >= ma2_2_min_ago
                    
                    and macd >= macd_2_min_ago
                    and deviation_trend_ma200 > -0.30
                    and ma4_last > ma16_last
                    
                    and deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -0.90
                    
                    and deviation_ma3_sopra_ma10 > 0.12
                    and deviation_ma3_sopra_ma16 > 0.121
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                  
                ):
                    buy = "BUY 1 AUDI che NON E' un grande ribasso MASERATI e NON E' un crollo FERRARI ! con deviation trend ma200 e 4-16 and 3-10 > 0.12 - r 3043"
                    action = "buy"
                    percentage = 80
                    
                    # CROLLO STIAMO ANCORA IN ALTO con 3-16 perche' paradossalmente serve piu'prudenza vedi 27 feb 2023 ore 17:04
                    # 11 giu 2023 aggiunto 3-10 > 0.12
                    # 20 feb 2024 aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.50 prendi il coltello con il piede
                    
                
                     
                   
                    
                    
                
                    
                
                    
                ######################################################################################################
                ###################################################################################################### attenzione qui applico il doppio delta !
                
                # quando la ma100 si avvicina risalendo verso la ma200 ok cosi'
                # quando la ma100 si allontana verso il basso dalla ma 200 metto 8-50 altrimenti e' una perdita continua !
                
            
                # BUY 1 FIAT che non funzionava MA CHE HA FUNZIONATO ! ( DOPPIO DELTA 200-100 E DOPPIO DELTA 69-39 !) STA RISALENDO
                
                elif (    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    
                    and deviation_ma5_sopra_ma28 > 0.11
                    
                    and ma3_last > ma9_last
                    
                    and ma200_last < ma300_last
                    and ma20_last < ma100_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma200_sotto_ma300 < -0.27
                  
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and rapporto_delta_1_delta_2_69_39 < 1
                    and ma39_last > ma39_30_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 FIAT che non funzionava MA CHE HA FUNZIONATO ! SOTTO RIALZO RIALZO - GIORNO ! - r 3086"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # and deviation_correzione > 0.10
                    
                    # and delta_1 < 0.25 la puoi aggiungere in un secondo momento
                    # and delta_2 > 0.40 la puoi aggiungere in un secondo momento
                    
                    # compare prega per me !
                    
                    
                    
                    
                # BUY 1 OK FIAT ( DOPPIO DELTA) STA RISALENDO
                
                elif (    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    and deviation_correzione > 0.10
                    and deviation_ma5_sopra_ma28 > 0.07
                    and ma200_last < ma300_last
                    and ma20_last < ma100_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma200_sotto_ma300 < -0.27
                   
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 FIAT OK DOPPIO DELTA STA RISALENDO - SOTTO RIALZO RIALZO - GIORNO ! - r 3120"
                    action = "buy"
                    percentage = 80
                    
                    # and delta_1 < 0.50
                    # and delta_2 > 0.69
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # MA DEVE AVERE UN PO' DI FORZA 5-28 > 0.07 !
                    # compare prega per me !
                    
                    
                
                
                
                #  BUY 1 FIAT copia BIS della r701 del RCCR che non funzionava e che invece HA FUNZIONATO ! ( CON DOPPIO DELTA in RIBASSO !) 8-39
                
                elif (    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma5_sopra_ma28 > 0.15
                    and ma8_last > ma39_last
                    and ma200_last < ma300_last
                    and ma20_last < ma100_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma200_sotto_ma300 < -0.27
             
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 FIAT 300 > 120 min agocopia BIS della r701 del RCCR che non funzionava e che invece HA FUNZIONATO ! - NOTTE ! ! 8-39 - r 3158"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                    
                #  BUY 1 FIAT copia BIS della r701 del RCCR che non funzionava e che invece HA FUNZIONATO ! ( CON DOPPIO DELTA in RIBASSO !) 8-39
                
                elif (    
                    deviation_buy_crollo_1 < -0.29
                    and macd >= macd_2_min_ago
                    and deviation_buy_crollo_1 > -0.69
                    
                    and ma300_last < ma300_120_min_ago
                    and deviation_ma5_sopra_ma28 > 0.285
                    
                    and ma8_last > ma39_last
                    and ma200_last < ma300_last
                    and ma20_last < ma100_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma200_sotto_ma300 < -0.27
             
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 1 FIAT 300 < 120 min ago copia BIS della r701 del RCCR che non funzionava e che invece HA FUNZIONATO ! - NOTTE ! ! 8-39 - r 3186"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    
                    # and delta_1 > 0.40 la puoi aggiungere in un secondo momento
                    # and delta_2 < 0.25 la puoi aggiungere in un secondo momento
                    
                    # compare prega per me !
                    
                    
                
                
                # BUY 1 FIAT OK ( con doppio delta in ribasso !) 8-39
                
                elif (    
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
                    and ma8_last > ma39_last
                    
                    and ma200_last < ma300_last
                    and ma20_last < ma100_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma200_sotto_ma300 < -0.27
                    
                 
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma5_sopra_ma28 > 0.25
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 FIAT OK (DOPPIO DELTA) RIBASSO ! 8-39  SOTTO RIBASSO RIBASSO  - NOTTE ! - r 3227"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    
                    # and delta_1 > 0.69
                    # and delta_2 > 0.50
                    
                    # compare prega per me !
                    
                    
                    
                    
                #####################################################################################################################
                
                
                # BUY 1 RIBASSO AUDI A importato dal BUY 2 che e' andato benissimo dopo il blocco
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    
                    and deviation_ma8_sotto_ma300 > -1.20
                    
                    and ma5_last > ma16_last
                    and deviation_ma5_sopra_ma16 > 0.11
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 RIBASSO AUDI A importato dal BUY 2 CON 8 sotto 300 > -1.20 - 5-16 > 0.11 E 5-28 > 0.01 - riga 3264 A"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    
                    
                    
                    
                # BUY 1 RIBASSO AUDI B importato dal BUY 2 CON 8 sotto 300 < -1.20
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    
                    and deviation_ma8_sotto_ma300 < -1.20
                  
                    and deviation_ma3_sopra_ma10 > 0.18
                    and deviation_ma5_sopra_ma28 > 0.02
                  
                    and ma78_last < ma200_last
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 1 RIBASSO AUDI B importato dal BUY 2 CON 8 sotto 300 < -1.20 - 5-28 > 0.02 and 3-10 > 0.19 - r 3289 B"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    
                    # > vacanza 3-10 > 0.19 da 0.15
                    # roma 5-25
                    # 14 ott aggiunta 5-28 > 0.03 attenzione ! l' aggiunta di and deviation_ma8_sotto_ma300 < -1.20 aveva fatto conflitto !
                    # 17 feb 2023 3-10 a 0.18 da 0.19
                    # 17 feb 2023 5-28 a 0.02 da 0.18
                    
                    
                # BUY 1 ultimo e meraviglioso RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO e che non e' un crollo ! (compare dove sei!)   
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.60
                    and deviation_buy_crollo_1 > -1.70
                    and deviation_ma5_sopra_ma16 > 0.11
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and deviation_ma100_laterale < -0.50
                    
                    and ma5_last > ma16_last
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 1 ultimo e meraviglioso RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO e che non e' un crollo !  - riga 3326"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # and deviation_ma100_laterale < -0.50 significa che ma5 sa sotto di almeno 0.50 rispetto alla ma100 - questa e' necessaria
                    
                    
                    
                    
                    
                    
                # BUY 1 RIBASSO AUDI PIU' LENTA copiata da RCCR CHE E' ANDATA BENISSIMO CHE NON E' UN CROLLO ! (compare stammi vicino!)
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    and delta_1 < delta_2
                    
                    and deviation_ma5_sopra_ma16 > 0.09
                    and deviation_ma5_sopra_ma28 > 0.18
                    
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 RIBASSO AUDI PIU' LENTA CHE NON E' UN CROLLO ! and delta_1 < delta_2 con dev 5-16 > 0.09 E 5-28 > 0.18 - riga 3354 A"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # ho dovuto aggiungere 5-28 > 0.18 perche' non riesco a fare modifiche con 5-300>-3.00 e 5-300<-3.00
                    # e il compare non risponde
                    
                    
                
                
                # BUY 1 DURANTE UN RIBASSO AUDI PIU' LENTA LENTA copiata da RCCR CHE E' ANDATA BENISSIMO CHE NON E' UN CROLLO ! (compare stammi vicino!)
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    and delta_1 > delta_2
                    
                    and ma11_last > ma25_last
                    
                    and ma5_last > ma16_last
                    and deviation_ma5_sopra_ma16 > 0.10
                    
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 DURANTE UN RIBASSO AUDI PIU' LENTA CHE NON E' UN CROLLO ! and delta_1 > delta_2 con dev 5-16 > 0.10 e 1q>25 - r 3386 B1"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # dev 5-16 c'e' perche' sto riducendo piano piano
                    
                    # > estate 5-16 0.10 da 0.05
                    # 20 feb 2023 11-25 da 13-25
                    
                    
                    
                    
                # BUY 1 DURANTE UN RIBASSO AUDI PIU' LENTA LENTA copiata da RCCR CHE E' ANDATA BENISSIMO CHE NON E' UN CROLLO ! (compare stammi vicino!)
                
                 
                elif (
                    
                    deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    and delta_1 > delta_2
                    
                    and ma13_last < ma25_last
                    and deviation_ma3_sopra_ma10 > 0.35
                    
                    and ma8_last > ma54_last
                    
                    
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 RIBASSO AUDI PIU' LENTA CHE NON E' UN CROLLO ! and delta_1 > delta_2 con 8-54 > 0.10 e 13<25 E 3-10 > 0.35 ! - r 3417 B2"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # dev 5-16 c'e' perhe' sto riducendo piano piano
                    # 15 nov 2022 8-54 (delta 1 > delta 2)
                    
                    
                
                # BUY 1 DURANTE UN RIBASSO AUDI PIU' GIU' E PIU' VELOCE LENTA copiata da RCCR CHE E' ANDATA BENISSIMO CHE NON E' UN CROLLO !
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    
                    
                    and deviation_ma3_sopra_ma16 > 0.46
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 RIBASSO AUDI PIU' GIU' -0.70 E PIU' VELOCE CHE NON E' UN CROLLO ! con deviation 3-16 > 0.46  - riga 3452"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # 1 GIUGNO 2022 3-15 troppo veloce e troppi buy affrettati ! e perdite conseguenti !
                    # 7 giugno 2022 3-16> 0.20
                    
                    
                 
                # copia della riga 530 del RCCR CHE FUNZIONA BENISSIMO ma solo un po' piu' prudente ! - BUY grande ribasso AUDI CHE NON E' UN CROLLO !
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    and deviation_bellissima > 0.02
                    and deviation_correzione_1 > 0.03
                    and ma13_last > ma50_last
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "copia della riga 530 del RCCR ma piu' prudente ! - BUY GRANDE RIBASSO AUDI CHE NON E' UN CROLLO ! - r 3479"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                
                
                
                # QUA DEVI VEDERE - vanno in sovrapposizione - vedi prima come vanno poi correggi
                
                # BUY 1 GRANDE RIBASSO MASERATI CHE NON E' UN CROLLO ! (compare stammi vicino!) HA FUNZIONATO ! viva ro combaro meo !
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -0.91
                    and deviation_buy_crollo_1 > -1.50
                    and deviation_ma5_sopra_ma28 > 0.03
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 GRANDE RIBASSO MASERATI CHE NON E' UN CROLLO ! con 5-28 - r 3499"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    
                    
               
                ##############################################################################################################################
                # IMPORTANTISSIMO ! - PER COMPRARE DURANTE IL CROLLO - FERRARI - compa prega per me - ( cruise - david gilmour )
                ##############################################################################################################################

                # entriamo nell' area dell' ipervenduto, compa !
                # QUI LASCIO GLI INCROCI !
                
                
                
                # BUY 1 CROLLO FERRARI - modo 1
                
                elif (
                    ma2_last >= ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma3_last > ma16_last
                    and deviation_ma3_sopra_ma10 > 0.20
                    and ma78_last < ma300_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 CROLLO FERRARI 3-16 and deviation_ma3_sopra_ma10 > 0.20 - modo 1 and ma78_last < ma300_last - r 3525"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # era 3-7 ma MI DISPIACE TANTO ma ho dovuto mettere 3-16
                    # aggiunto 3-10 0.31
                    # 24 ago 2023 3-10 a 0.20 da 0.31


                    
                # BUY 1 CROLLO FERRARI - modo 2 questa condizione e' entrata in azione ! ( e mi e' sembrata ben fatta !)
                
                elif (
                    ma5_last > ma11_last
                    and deviation_buy_crollo_1 < -1.61
                    
                    and ma78_last < ma300_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 1 CROLLO FERRARI 5-11 and macd > - modo 2 and ma78_last < ma300_last - r 3543a"
                    action = "buy"
                    percentage = 80

                
                elif (
                    ma3_last > ma11_last
                    and deviation_buy_crollo_1 < -1.61

                    and deviation_ma39 < -0.69
                    and deviation_ma3_sotto_ma50 < -0.72

                    and ma78_last < ma300_last
                    
                    and macd_differenza_2_min_ago > -18
                    
                ):
                    buy = "BUY 1 CROLLO FERRARI 3-11 and ma78_last < ma300_last and macd_diff > -12 - r 3543 B"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # 14 GIU 2022 5-18
                    # 19 apr 2023 5-11 and macd > macd_2_min_ago
                    # 31 lug 2023 tolto ma2_last >= ma2_2_min_ago c'e' il MACD per la ferrari
                    # 11 gen 2024 la diifferenza MACD durante il crollo ferrari significa che RALLENTA IL CROLLO
                    # 27 feb 2025 aggiunta and deviation_ma39 < -0.69
                    # 27 feb 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.72
                

                # condizione crollo ferrari - bird of paradise - snowy white
                
                elif (
                    ma3_last > ma7_last
                    and deviation_buy_crollo_1 < -2.30
                    
                    and ma2_differenza_2_min_ago > 15
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.20
                    and macd < -150
                    and macd_differenza_2_min_ago > -18
                  
                ):
                    buy = "BUY 1 DURANTE IL CROLLO - and ma2_differenza_2_min_ago > 15 E macd_differenza_2_min_ago > -18 ! 3-7 + MACD - bird of paradise - snowy white - r 3545"
                    action = "buy"
                    percentage = 90

                    # oggi 11 dic 2023 ore 3:19 il macd e' arrivato tardi !
                    # ma2 quando il macd risaliva e' andato per 2 min lateralmente o poco sotto e quindi non ha comprato dopo che era gia' un po' tardi
                    # 11 dic 2023 aggiunto and ma2_differenza_2_min_ago > 15
                    # 11 dic 2023 aggiunto and macd < -150 CIOE' STA CROLLANDO
                    # 11 dic 2023 aggiunto and macd_differenza_2_min_ago > -18 CIOE' IL MACD STA COMINCIANDO A NON CROLLARE CIOE' A RALLENTARE IL CROLLO
                    # 11 dic 2023 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.20 significa che ma2 sta crescendo



                
                    
                    
                    
                
                    
                    
                    
                # BUY 1 crollo MISSILE COMPA ! modo 1
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.60
                    and deviation_ma3_sopra_ma16 > 0.028
                    and ma78_last < ma300_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 crollo MISSILE COMPA modo 1 con dev 3-16 > 0.028 + macd >= macd 2 min ago and ma78_last < ma300_last - r 3561"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # 27 apr 2023 da dev 3-16 > 0.028 da 3-13 
                    # 27 apr 2023 aggiunto macd




                # BUY 1 crollo MISSILE COMPA ! modo 2
                 
                elif (    
                    ma3_last > ma4_last
                    and ma78_last < ma300_last
                    and macd < -245
                ):
                    buy = "BUY 1 crollo MISSILE COMPA modo 2 con 3>4 AND MACD < -245 ! and ma78_last < ma300_last - AGOSTO 2023 - r 3562"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                
                    
                    
                 
                    
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma5_last > ma15_last
                    
                    and ma78_last > ma300_last
                    and deviation_ma5_sopra_ma28 > 0.05
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 CROLLO FERRARI - modo 1 and ma78_last > ma300_last - r 3583"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # era 3-7 ma MI DISPIACE TANTO ma ho dovuto mettere 5-15
                    
                    
                    
                
                
                # BUY 1 CROLLO FERRARI - modo 2 questa condizione e' entrata in azione ! ( e mi e' sembrata ben fatta !)

                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -1.61
                    and deviation_buy_crollo_2 > 0.01
                    
                    and ma78_last > ma300_last
                    and deviation_ma5_sopra_ma28 > 0.05
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 CROLLO FERRARI - modo 2 and ma78_last > ma300_last - r 3604"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_buy_crollo_2 = ma3_last / ma13_last
                    
                    
                    
                    
                # BUY 1 crollo MISSILE COMPA !
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.60
                    and ma3_last > ma13_last
                    
                    and ma78_last > ma300_last
                    and deviation_ma5_sopra_ma28 > 0.05
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 crollo MISSILE COMPA 3-13 and ma78_last > ma300_last - r 3624"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    
                    
                  
            
                ##################################################################################################### CONDIZIONI ESPERIMENTALI !
                
                
                # BUY 1 ECCEZIONALE - se ma200 sale da 15 min e ma69> COMPRA con 4-25 e un po' piu' su della ma100

                elif (
                    ma200_last > ma200_15_min_ago
                    and ma69_last > ma69_2_min_ago
                    and deviation_ma100_laterale > 0.50
                    
                    and deviation_ma4_sopra_ma25 > 0.10
                    
                    and (ma4_prev < ma25_prev and ma4_last > ma25_last)
                    and ma2_last > ma2_2_min_ago
                    and (ma3_prev < ma8_prev and ma3_last > ma8_last)
                    and ma36_last > ma36_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 ECCEZIONALE - se ma200 sale da 15 min e 69> COMPRA con deviation 4-25 e un po' piu' su della ma100 ! - r 3657"
                    action = "buy"
                    percentage = 80
                    
                    # deviation 4-25 forse, in futuro, da aumentare un pochino.
                    
                    
             
                # BUY 1 DOCCIA 
                
                elif (    

                    ma200_last > ma200_120_min_ago
                    and ma20_last > ma200_last
                    and ma20_last > ma69_last
                    and ma2_last > ma2_2_min_ago
                    and (ma3_prev < ma8_prev and ma3_last > ma8_last)
                    and ma3_last > ma69_last
                    and (ma4_prev < ma25_prev and ma4_last > ma25_last)
                    
                    and deviation_buy_ma3_sopra_ma25 > 0.08
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.01
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 1 DOCCIA se ma200 > da 120 min ! COMPRA - r 3680"
                    action = "buy"
                    percentage = 80
                    
                    # > estate 3-25 0.08 da 0.05
                
                
                ############################################################################################################################
                
                
                
                # e non e' ancora una situazione cosi' drammatica.
                
                elif (    
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
                    
                    and deviation_ma3_sopra_ma10 > 0.125
                    
                    and ma8_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 ribasso AUDI o correzione FIAT che non e' un forte ribasso e non e' un crollo !  - r 3702"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                
                # ECCO LA CONDIZIONE FIAT CHE FA PAURA ! MA CERCHIAMO DI FARLA ATTIVARE NEL MOMENTO GIUSTO (SOTTO RIALZO RIBASSO) AURORA
                
                elif (
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
                    
                    
                    and delta_1 < delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.05
                    
                    and ma300_last < ma300_60_min_ago
                    and ma100_last < ma200_last
                    and deviation_ma200_sotto_ma300 > -0.15
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_correzione > 0.03
                    
                    
                    and deviation_ma25_sotto_ma300 < -0.60
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 CORREZIONE FIAT CHE FA PAURA ! (MA ma100 e ma200 sono ANCORA VICINE alla ma300) (SOTTO cresce diminuisce) AURORA - riga 3749"
                    action = "buy"
                    percentage = 80
                    
                    
                  
                    
                # FIAT SOTTO RIBASSO RIBASSO - NOTTE
                
                elif (
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
                    
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma100_last < ma200_last
                    and deviation_ma200_sotto_ma300 > -0.15
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_correzione > 0.03
                    
                    
                    and deviation_ma25_sotto_ma300 < -0.60
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 CORREZIONE FIAT CHE FA PAURA ! (MA ma100 e ma200 sono ANCORA VICINE alla ma300) (SOTTO RIBASSO RIBASSO ) NOTTE ! - riga 3783"
                    action = "buy"
                    percentage = 80
                    
                    # questa e' la condizione che piu' di tutte mi ha fatto soffrire.
                    # ma molte volte ha dato grandi soddisfazioni sul RCCR
                    # io ho cercato di prendere LA PARTE MIGLIORE.
                    # SPERIAMO. sempre.
                    
                    # deviation_ma100_sopra_ma300 significa 100/300 ( ma100 ancora NON SI E' ALLONTANATA TROPPO DALLA ma300 )
                    # deviation_ma25_sotto_ma300 significa che anche ma25 deve andare almeno un po' sotto ma300 (per evitare piccole schegge rialziste !)
                    # NON TOCCARE 5-28 > 0.05 !
                    
                    
                 
                
                # BUY 1 CROLLO FERRARI ok - RCCR - questa condizione mi e' sembrata ben fatta !


                elif (
                    ma3_last > ma8_last
                    and deviation_ma39 < -1.00
                    and deviation_buy_crollo_1 < -1.61
                    and deviation_ma25_sotto_ma300 < -2.00
                    and ma78_last < ma300_last

                ):
                    buy = "BUY 1 CROLLO FERRARI senza sovrastrutture con 3-8 and macd > - modo 2 and ma78_last < ma300_last - r 3812"
                    action = "buy"
                    percentage = 80

                    #  3 feb 2025 nuova condizione crollo ferrari senza sovrastrutture !
                    #  3 mar 2025 ottima - me la tengo stretta.


                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -1.61
                    and deviation_buy_crollo_2 > 0.01
                    and deviation_ma3_sopra_ma10 > 0.22
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 CROLLO FERRARI ok CON 3-10 necessaria ! - RCCR - r 3813"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_buy_crollo_2 = ma3_last / ma13_last
                    # fondamentale aggiunta 3-10 perche' anche ferrari NE HA BISOGNO ma non 5-28 ! CHE COMINCIA AD ESSERE INAPPROPRIATA
                    # 27 giu 2022 3-10 0.155 NON MENO DI QUESTA PERDIO !
                    # 15 gen 2023 3-10 0.22







                    
                # BUY 1 SUL SUPPORTO 300 !
          
                elif (    
                    ma5_last > ma13_last
                    and (ma3_last > ma285_last and ma3_last < ma285_last)
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma2_last > ma300_last
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 SUL SUPPORTO 300 ! - r 3837"
                    action = "buy"
                    percentage = 80
                    
                    # madonna compa !
                    
                    
                    
                # BUY 1 dopo ribasso MA CON TUTTE LE MA > e con incrocio al rialzo 8-140 !
                
                elif (    
                    ma50_last > ma100_last
                    and (ma8_last < ma140_last and ma8_last > ma140_last)
                 
                    and ma100_last > ma100_60_min_ago
                   
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma2_last > ma300_last
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 dopo ribasso MA CON TUTTE LE MA > e con incrocio al rialzo 8-140 - r 3864"
                    action = "buy"
                    percentage = 80
                    
                    # madonna compa !
                    
                    
                    
                   
                    
                # BUY 1 CHE MANCAVA ! con incrocio 11-50 AND 5-28 > 0.20 ( CON 100 < AND 200 < AND 300 < ) (!)
                
                elif (
                    deviation_ma5_sopra_ma28 > 0.265
                    and (ma11_last < ma50_last and ma11_last > ma50_last)
                    and deviation_ma8_sotto_ma300 < -0.30
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.20
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
            
                ):
                    buy = "BUY 1 CHE MANCAVA ! con incrocio 11-50 AND 5-28 > 0.265 (!) ( CON 100 < AND 200 < AND 300 < ) (!)  - r 3896"
                    action = "buy"
                    percentage = 80
                    
                    # madonna compa !
                    
                    
                 
                   
                    
                # BUY 1 CHE MANCAVA DOPO BUY-SELL CROLLO ! delta 150-100 GIORNO ! E 50 > 100
                
                elif (
                    deviation_ma5_sotto_ma300 < -0.40
                    and ma8_last > ma50_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sopra_ma28 > 0.15
                    and deviation_ma3_sopra_ma10 > 0.10
                    
                 
                    and ma50_last > ma100_last
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and delta_150_100 < delta_150_100_60_min
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 78 > 200 che mancava DOPO BUY-SELL e nuovo CROLLO ! 50 > 100 AND delta 150-100 GIORNO ! and 3-10 > 0.10 and 5-28 > 0.15 - r 3968 A2"
                    action = "buy"
                    percentage = 80
                    
                    # > estate 5-28 0.15 e 3-10 0.10
                    
                    
                
                    
                    
                # BUY 1 PENSIERO LATERALE !
                
                elif (
                    
                    ma78_last < ma200_last
                    
                    and deviation_ma5_sopra_ma59 < -0.20
                    and deviation_ma54_sopra_ma100 < -0.40
                    
                    and deviation_ma10_sopra_ma200 < -0.80
                    
                    and deviation_ma3_sopra_ma10 > 0.102
                    and deviation_ma3_sopra_ma16 > 0.148
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma5_last > ma33_last
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                  
                ):
                    buy = "BUY 1 PENSIERO LATERALE ! - r 4000"
                    action = "buy"
                    percentage = 80
                    
                    # 10 mar 2023 3-10 a 0.102 da 0.01
                    # 7 mag 2023 aggiunto macd > macd 2 min ago
                    # 7 mag 2023 aggiunto 3-16 > 0.148
                    
                    
                    
                    
                
                    
                    
                    
                # BUY 1 CHE MANCAVA DOPO 5 ore di ribasso

                
                elif (    
                    ma3_last < ma20_last
                    and delta_1 < delta_2
                    and ma100_last > ma300_last

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma100_laterale > -0.80
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_301_min_ago
                    and ma200_last < ma200_301_min_ago
                    and ma300_last < ma300_301_min_ago
                    
                    and deviation_ma300__diviso_ma300_5_ore_ago < -0.25
                    and deviation_ma5_sotto_ma300 < -0.43
                    
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 DOPO 5 ore di ribasso MA GIORNO E ma100>ma300 - r 4040 Ax"
                    action = "buy"
                    percentage = 80
                    
                    # > estate anticipata ndecchiecella 5-28 0.17 da 0.20
                    # aggiunta 3-10 > 0.07
                    # 5-28 0.16 da 0.17 (adesso c'e' anche 3-10)
                    # 17 nov 2022 HO MESSO 5 < 54 ! vedi 16 nov ore 13:47 e ore 17:16
                    # 27 feb 2025 anticipata ndecchiecella

                


                elif (
                    ma3_last > ma18_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2
                    and delta_300_200 < delta_300_200_30_min

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.10

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma300__diviso_ma300_5_ore_ago < -0.25
                    
                    and ma100_last < ma200_last
                    and ma100_last < ma300_last
                    and ma200_last < ma300_last

                    and ma100_last < ma100_301_min_ago
                    and ma200_last < ma200_301_min_ago
                    and ma300_last < ma300_301_min_ago
                    
                    

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 1 CONTINUA A SCENDERE DNA - r 4040 Ay"
                    action = "buy"
                    percentage = 80
                    
                    # > estate anticipata ndecchiecella 5-28 0.17 da 0.20
                    # aggiunta 3-10 > 0.07
                    # 5-28 0.16 da 0.17 (adesso c'e' anche 3-10)
                    # 17 nov 2022 HO MESSO 5 < 54 ! vedi 16 nov ore 13:47 e ore 17:16
                    #  2 mar 2025 aggiunta senza pieta' COMINCIA A SCENDERE !
                    #  3 mar 2025 comincia a scendere e' diventato CONTINUA A SCENDERE DNA
                  
                    
                    
                # BUY 1 CHE MANCAVA DOPO 5 ore di ribasso
                
                elif (
                    deviation_ma5_sopra_ma28 > 0.22
                    and deviation_ma100_laterale < -0.80
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_301_min_ago
                    and ma200_last < ma200_301_min_ago
                    and ma300_last < ma300_301_min_ago
                    
                    and deviation_ma300__diviso_ma300_5_ore_ago < -0.25
                    and deviation_ma5_sotto_ma300 < -0.43
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 CHE MANCAVA DOPO 5 ore di ribasso con 5-28> 0.22 se entra dopo 5 ore deve essere piu' sicuro CON 5 molto lontana da 100- r 4040 B"
                    action = "buy"
                    percentage = 80
                    
                    
                  
                    
                # BUY 1 CHE MANCAVA DOPO BUY-SELL CROLLO ! 150-100 GIORNO ! MA 50 < 100
                
                elif (
                    ma8_last > ma150_last
                    and deviation_ma3_sopra_ma10 > 0.25
                    and deviation_ma5_sopra_ma28 > 0.18
                    
                    and ma50_last < ma100_last
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and delta_150_100 < delta_150_100_60_min
                    and ma100_last > ma100_3_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 laterale CHE MANCAVA DOPO BUY-SELL CROLLO ! 50 < 100 AND 150-100 GIORNO ! and 3-10 > 0.25 and 5-28 > 0.18 - r 4042"
                    action = "buy"
                    percentage = 80
                    
                    # madonna compa ! 
                    # the sound of silence
                    # ASSURDO ! questa 100 > 100 3 min e' incredibile ! si e' verificata dopo il BUY-SELL del crollo ! NON TOCCARE
                    # SI STA RIDUCENDO LA DISTANZA TRA 150 E 100
                    
                    # 10 giu 2022 5-28 0.12 da 0.09 cazzo
                    # 21 giu 2022 3-10 > 0.25 da > 0.05 CAZZO
                    # 29 ago 5-28 0.18
                    
                    
                    
                

                # 30 dic 2024 cancellata r 4050 CANE STAF + zia amalia



                elif (    
                    ma78_last < ma200_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma5_last > ma50_last
                    
                    and deviation_ma5_sotto_ma300 > -0.20
                    and deviation_ma10_sopra_ma200 > -0.20
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma5_last > ma10_last
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 1 78<200 pensiero laterale - r 4050 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 80


                # 22 set 2024 CANCELLATA r 4050 NUOVA ERA A3 SOFT
                

                elif (    
                    ma78_last < ma200_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and deviation_ma5_sotto_ma300 > -0.20
                    and deviation_ma10_sopra_ma200 > -0.20
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma5_last > ma10_last
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 1 78<200 pensiero laterale - r 4050 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 80



                elif (    
                    ma78_last < ma200_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and deviation_ma5_sotto_ma300 > -0.20
                    and deviation_ma10_sopra_ma200 > -0.20
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma5_last > ma10_last
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 1 78<200 pensiero laterale - r 4050 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma78_last < ma200_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma3_last > ma39_last
                    
                    and deviation_ma5_sotto_ma300 > -0.20
                    and deviation_ma10_sopra_ma200 > -0.20
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma5_last > ma10_last
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 1 78<200 pensiero laterale - r 4050 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80

                
                elif (    
                    ma78_last < ma200_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma3_last > ma39_last
                    
                    and deviation_ma5_sotto_ma300 > -0.20
                    and deviation_ma10_sopra_ma200 > -0.20
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma5_last > ma10_last
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 1 78<200 pensiero laterale - r 4050 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 80
                    
                    # 28 AGO 2023 forse aggiungere macd > 5

          

   


              
                # BUY 1 che ci riprova quando se ne va lateralmente dopo il crollo
                
                elif (
                    
                    ma3_last > ma20_last

                    and deviation_ma39 < -0.13
                    and deviation_ma3_sotto_ma50 < -0.19
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    
                    and deviation_ma5_sotto_ma450 < -0.01
                    and deviation_ma5_sotto_ma450 > -0.33

                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and delta_300_100 < delta_300_100_60_min

                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > -50
                    and macd_differenza_2_min_ago > -2
                ):
               
                    buy = "BUY 1 che ci riprova quando se ne va lateralmente - r 4082 A1"
                    action = "buy"
                    percentage = 80

                    # compare prega per me !
                    #  9 dic 2024 modificato
                    
                    
                # BUY 1 che ci riprova quando se ne va lateralmente dopo il crollo
                
                elif (
                    ma28_last > ma300_last
                  
                    and ma20_last < ma50_last
                    
                    and deviation_ma3_sopra_ma10 > 0.155
                    and deviation_ma5_sopra_ma28 > 0.40
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and delta_300_100 < delta_300_100_60_min
                    
                    and deviation_ma100_sopra_ma300 > -0.40
                    and deviation_ma200_sopra_ma300 > -0.40
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 1 che ci riprova quando se ne va lateralmente dopo il crollo - r 4111 A2"
                    action = "buy"
                    percentage = 80

                    # compare prega per me !
                    # 6 luglio 2022 SE 20 < 50 5-28 > 0.40 ! NON TOCCARE
                    
                    
                    
                    
                    
                # BUY 1 che ci riprova quando se ne va lateralmente dopo il crollo
                
                
                elif (    
                    ma5_last > ma200_last
                    and ma450_last > ma450_300_min_ago
                    
                    and deviation_ma300_sopra_ma450 > -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and (delta_300_100 < delta_300_100_30_min or delta_300_100 < delta_300_100_60_min)
                    
                    and deviation_ma100_sopra_ma300 > -0.40
                    and deviation_ma200_sopra_ma300 > -0.40
                    
                    and macd_differenza_2_min_ago > -5.00
                ):
               
                    buy = "BUY 1 che ci riprova DOLCEMENTE con ma200_last < ma200_120_min_ago MA delta_300_100 < delta_300_100_30_min - r 4138 B1"
                    action = "buy"
                    percentage = 80
                    
                    # provo delta 39-69
                    #  1 ago 2023 ma13_last > ma200_last invece di 28-300
                    # 11 ago 2023 ma5_last > ma200_last invece di 13-200
                    # 30 apr 2025 anticipata ndecchiecella aggiungendo delta_300_100 < delta_300_100_30_min



                # BUY 1 che ci riprova quando se ne va lateralmente dopo il crollo
                
                elif (
                    ma3_last > ma20_last

                    and (ma5_last > ma200_last or ma5_last > ma200_last)

                    and ma450_last < ma450_180_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and deviation_ma300_sopra_ma450 > -0.10
                    and (delta_300_100 < delta_300_100_60_min or delta_300_100 < delta_300_100_30_min)

                    and deviation_ma39 < -0.05

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and deviation_ma100_sopra_ma300 > -0.40
                    and deviation_ma200_sopra_ma300 > -0.40

                    and macd_differenza_2_min_ago > -5.00
                ):
               
                    buy = "BUY 1 che ci riprova DOLCEMENTE con 13-300 quando se ne va lateralmente - r 4138 B2"
                    action = "buy"
                    percentage = 80
                    
                    # provo delta 39-69
                    #  1 ago 2023 ma13_last > ma200_last invece di 28-300
                    # 11 ago 2023 ma5_last > ma200_last invece di 13-200
                    # 30 apr 2025 modificata di poco con qualche or
                    
                    
                
                    
                    
                    
                ##################################################################################### esperimento ! andato male ! avevo messo
                
                # 5-28 piu' alto nella prima condizione ( che mi copriva e mi faceva comprare sicuramente )
                # incrocio al rialzo e ma2 > ma2 2 min ago (che mi faceva comprare al secondo tentativo)
                
                ######################################################################################
                
                # BUY 1 CHE MANCAVA aggressiva - (SEMBRA pari al BUY DURANTE UN RIBASSO AUDI !)
                
                elif (
                    ma5_last < ma33_last
                    
                    and deviation_ma3_sopra_ma10 > 0.085
                    and deviation_ma5_sopra_ma28 > 0.11
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                   
                    and deviation_ma8_sotto_ma100 < -0.70
                    and deviation_ma8_sotto_ma200 < -1.10
                    and deviation_ma8_sotto_ma300 < -1.30
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 pari al BUY AUDI CHE MANCAVA ! con 5-33 () 3-10 > 0.085 e 5-28 0.11 - r 4166"
                    action = "buy"
                    percentage = 80
                    
                    # madonna compa che ti sei dimenticato di me !
                    # 18 set 5-33 e 3-10 > 0.085
                    # 20 set 3-10 > 0.085 da 0.09
                    # 22 set ho aggiunto 5-28 > 0.11
                    
                    
                
            
                # BUY 1 con con 200 > 200 20 min ago (100 < and 200 < MA 300 >)
                
                elif (    
               
                    ma3_last > ma28_last
                    and ma300_last > ma450_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and ma200_last > ma200_20_min_ago
                    and ma8_last > ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma5_sopra_ma28 > 0.08
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 con 200 > 200 20 min ago (100 < and 200 < MA 300 >) and 8-200 !  - riga 4190"
                    action = "buy"
                    percentage = 80
                    
                    # aggiunta 5-28 e 3-10 vedi 9 ott 2022 ore 21:07
                    
                    
                
                    
                
                # BUY 1 SITUAZIONE TREND LATERALE che mancava con DOPPIO DELTA 200-100 giorno - GIORNO
                
                elif (    
               
                    ma8_last > ma300_last
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                    
                    and ma28_last > ma28_30_min_ago
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.14
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 SITUAZIONE TREND LATERALE che mancava con DOPPIO DELTA 200-100 GIORNO ! and 5-28 > 0.14 con 28>28 30 min ago - riga 4215 A"
                    action = "buy"
                    percentage = 80
                    
                    # ho aggiunto 5-28 > 0.05
                    # cosa curiosa SEMBRA CHE and ma2_last > ma2_2_min_ago abbia fatto ritardare questo BUY.
                    # ho tenuto i 2 minuti e ho ridotto 5-28
                    
                    
                    
                    
                # BUY 1 SITUAZIONE TREND LATERALE che mancava con ma300 > - DOPPIO DELTA - RIALZO
                
                elif (    
               
                    ma8_last > ma300_last
                    and ma78_last > ma100_last
                    and ma300_last > ma300_301_min_ago
                    
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                    
                    and ma28_last < ma28_30_min_ago
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.10
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 SITUAZIONE TREND LATERALE con ma300 > - GIORNO ! and 5-28 > 0.14 MA 28 < 28 30 min ago e 300 >5 ore! - r 4246 B1x"
                    action = "buy"
                    percentage = 80
                    
                    # ho aggiunto 5-28 > 0.05
                    # cosa curiosa SEMBRA CHE and ma2_last > ma2_2_min_ago abbia fatto ritardare questo BUY.
                    # ho tenuto i 2 minuti e ho ridotto 5-28
                    # > estate 3-10 0.17 da 0.07 e 5-28 0.10 da 0.06
                    
                    
                # BUY 1 SITUAZIONE TREND LATERALE che mancava con ma300 > - DOPPIO DELTA - RIALZO
                
                elif (    
               
                    ma8_last > ma300_last
                    and ma78_last > ma100_last
                    and ma300_last < ma300_301_min_ago
                    
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                    
                    and ma28_last < ma28_30_min_ago
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.10
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 TREND LATERALE con ma300 > - GIORNO ! MA 28 < 28 30 min ago AND 3-10 > 0.17 e 300 < 5 ore ! - r 4246 B1y"
                    action = "buy"
                    percentage = 80
                    
                    # ho aggiunto 5-28 > 0.05
                    # cosa curiosa SEMBRA CHE and ma2_last > ma2_2_min_ago abbia fatto ritardare questo BUY.
                    # ho tenuto i 2 minuti e ho ridotto 5-28
                    
                    # > estate aumentati 3-10 e 5-28
                    
                    
                    
                    
                    
                # BUY 1 SITUAZIONE TREND LATERALE che mancava con ma300 > - DOPPIO DELTA - RIALZO
                
                elif (    
               
                    ma8_last > ma300_last
                    and ma78_last < ma100_last
                    
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                    
                    and ma28_last < ma28_30_min_ago
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.14
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 SITUAZIONE TREND LATERALE con ma300 > - GIORNO ! and 5-28 > 0.14 MA 28 < 28 30 min ago AND 3-10 > 0.17 - r 4278 B2"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                    
                    
                    
                    
                # BUY 1 SITUAZIONE TREND LATERALE modo A che mancava con ma300 < - DOPPIO DELTA - RIALZO
                
                elif (    
               
                    ma8_last > ma200_last
                    and deviation_ma5_sotto_ma300 > 0.40
                    
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                 
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    and ma300_last < ma300_60_min_ago
           
                    and deviation_ma5_sopra_ma28 > 0.13
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 SITUAZIONE TREND LATERALE che mancava con ma300 < - SOPRA RIALZO RIALZO - GIORNO ! and 5-28 > 0.13 - r 4301 A"
                    action = "buy"
                    percentage = 80
                    
                    # 3 set modo a
                    
                    
                    
                    
                # BUY 1 SITUAZIONE TREND LATERALE che mancava con ma300 < MA DOPPIO DELTA - RIALZO
                
                elif (
                    ma3_last > ma18_last
                    and ma300_last > ma450_last

                    and ma39_last < ma50_last
                    and ma300_last > ma300_60_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > 0.15
                    and ma39_last < ma39_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.02


                    and deviation_ma5_sotto_ma300 < 0.40
                    and deviation_ma5_sotto_ma300 > -0.30
                   
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                 
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 TREND LATERALE con 300>450 ma con ma300 < - GIORNO ! - r 4301 Bx"
                    action = "buy"
                    percentage = 80
                    
                    # 3 set modo b
                    # 14 set aggiunta 3-10 > 0.08
                    
                    

                elif (
                    ma3_last > ma18_last
                    and ma300_last > ma450_last

                    and ma39_last < ma50_last
                    and ma300_last > ma300_60_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > 0.15
                    and ma39_last < ma39_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.02


                    and deviation_ma5_sotto_ma300 < 0.40
                    and deviation_ma5_sotto_ma300 > -0.30
                   
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                 
                    and delta_1 > delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 TREND LATERALE con 300>450 ma con ma300 < - NOTTE ! - r 4301 By"
                    action = "buy"
                    percentage = 80
                    
                    # 3 set modo b
                    # 14 set aggiunta 3-10 > 0.08
                    
                    
                    
                    
                # BUY 1 SITUAZIONE TREND LATERALE modo C che mancava con ma300 < - DOPPIO DELTA - RIALZO
                
                elif (    
               
                    ma8_last > ma200_last
                    and deviation_ma5_sotto_ma300 < -0.30
                    
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                 
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    and ma300_last < ma300_60_min_ago
           
                    and deviation_ma5_sopra_ma28 > 0.12
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 SITUAZIONE TREND LATERALE modo C che mancava con ma300 < - SOPRA RIALZO RIALZO - GIORNO ! and 5-28 > 0.12 - r 4301 C"
                    action = "buy"
                    percentage = 80
                    
                    # 3 set modo c
                    
                    
                    
                    
                    
                    
                # BUY 1 forever young 1 PIU' PRUDENTE se ma200 > e se ma200 > ma300

                elif (  
                    ma3_last > ma15_last
                    and ma39_last > ma39_15_min_ago
                    
                    and ma300_last > ma300_301_min_ago
                    and (ma3_prev < ma180_prev and ma3_last > ma180_last)
                    
                    and ma200_last > ma300_last
                    and ma300_last >= ma300_120_min_ago
                    and ma200_last >= ma200_15_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.005
                    and deviation_ma3_sopra_ma16 > 0.001
                    
                    and ma3_last >= ma11_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):

                    buy = "BUY 1 ma 39 > 39 15 min ago con 300 > 5 ore ! e ma200 > ma300 E CON 3-16 > 0.07 - r 4325 a1 x"
                    action = "buy"
                    percentage = 80
                    
                    #  8 mar 2024 modificato


                elif (  
                    ma3_last > ma15_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192

                    and ma300_last > ma300_301_min_ago
                    and (ma3_prev < ma180_prev and ma3_last > ma180_last)
                    
                    and ma200_last > ma300_last
                    and ma300_last >= ma300_120_min_ago
                    and ma200_last >= ma200_15_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.005
                    and deviation_ma3_sopra_ma16 > 0.001
                    
                    and ma3_last >= ma11_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):

                    buy = "BUY 1 PUGNO FANTASMA DI MOHAMMAD ALI' con 300 > 5 ore ! e ma200 > e se ma200 > ma300 E CON 3-16 > 0.07 - r 4325 a1 y"
                    action = "buy"
                    percentage = 80

                    #  8 mar 2024 modificato


                elif (  
                    ma3_last > ma15_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and ma300_last > ma300_301_min_ago
                    and (ma3_prev < ma180_prev and ma3_last > ma180_last)
                    
                    and ma200_last > ma300_last
                    and ma300_last >= ma300_120_min_ago
                    and ma200_last >= ma200_15_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.005
                    and deviation_ma3_sopra_ma16 > 0.001
                    
                    and ma3_last >= ma11_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):

                    buy = "BUY 1 PRENDE IL COLTELLO CON IL PIEDE con 300 > 5 ore ! e ma200 > ma300 E CON 3-16 > 0.07 - r 4325 a1 z"
                    action = "buy"
                    percentage = 80
                    
                    # tolto and ma10_last >= ma20_last se 300> 5 ore e incrocio al rialzo 3-180
                    #  8 mar 2024 modificato 


                elif (  
                    ma3_last > ma28_last
                    and ma100_last >= ma100_10_min_ago
                    and ma300_last < ma300_301_min_ago
                    and ma10_last >= ma20_last
                    and ma200_last > ma300_last
                    and ma300_last >= ma300_120_min_ago
                    and ma200_last >= ma200_15_min_ago
                    
                    and deviation_ma3_sopra_ma16 > 0.005
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last >= ma11_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 2.7
                ):

                    buy = "BUY 1 forever young 1 con 300 che scende da 5 ore ! MA 300 > 120 min ago e ma200 > e ma200 > ma300 E 3-16 > 0.07 e macd_diff_2_min_ago > 2.7 - r 4325 A2 X"
                    action = "buy"
                    percentage = 80
                    
                    # 13 feb 2024 se 100 > ok cosi'

                elif (  
                    ma3_last > ma28_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma300_last < ma300_301_min_ago
                    and ma10_last >= ma20_last
                    and ma200_last > ma300_last
                    and ma300_last >= ma300_120_min_ago
                    and ma200_last >= ma200_15_min_ago
                    
                    and deviation_ma3_sopra_ma16 > 0.005
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last >= ma11_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.020
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 2.7
                ):

                    buy = "BUY 1 forever young 1 con 300 che scende da 5 ore ! MA 300 > 120 min ago e ma200 > e ma200 > ma300 E 3-16 > 0.07 e macd_diff_2_min_ago > 2.7 - r 4325 A2 Y"
                    action = "buy"
                    percentage = 80
                    
                    # la troppa prudenza qualche volta genera perdite
                    #  4 mag 2023 aggiunta 3-18 > 0.20
                    # 17 ott 2023 tolto ma10> ma10 2 min ago
                    # 17 ott 2023 3-18 > 0.10 da > 0.20
                    # 17 ott 2023 5-28 > 0.04 da > 0.08
                    # 12 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 15 gen 2024 aggiunta and macd_differenza_2_min_ago > 3
                    # 13 feb 2024 se 100< 100 10 min ago allora 5 deve stare sotto 100 di almeno -0.40 ! (una specie di nuoa era)

   
                # BUY 1 forever young 1 PIU' PRUDENTE se ma200 > e se ma200 > ma300
                
                elif (  
                    ma5_last > ma28_last
                    and ma10_last < ma20_last
                    
                    and ma39_last >= ma100_last
                    and ma200_last > ma300_last
                    and ma300_last >= ma300_120_min_ago
                    and ma200_last >= ma200_15_min_ago
                    
                    
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last >= ma11_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                ):

                    buy = "BUY 1 forever young 1 con 300 > 120 min ago e ma200 > e se ma200 > ma300 E CON 3-16 > 0.07 - r 4325 b"
                    action = "buy"
                    percentage = 80
                    
                    # la troppa prudenza qualche volta genera perdite
                    #  4 mag 2023 aggiunta 3-18 > 0.20
                    # 17 ott 2023 tolto ma10> ma10 2 min ago
                    # 17 ott 2023 3-18 > 0.10 da > 0.20
                    # 17 ott 2023 5-28 > 0.04 da > 0.08
                    # 12 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02

                


                # BUY 1 forever young 1 PIU' PRUDENTE se ma 200 > e se ma200 > ma300 AND 78 > 200

                elif (  
                    ma3_last > ma28_last
                    
                    
                    and ma5_last > ma39_last

                    and ma300_last > ma300_360_min_ago
                    and ma100_last > ma300_last
                    
                    and deviation_ma100_laterale > 0.05
                    
                    and ma5_last > ma200_last
                    and ma3_last > ma11_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.05
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd > -40
                    and macd_differenza_2_min_ago > -3.25
                ):

                    buy = "BUY 1 forever young 1 PIU' PRUDENTE se ma 200 > e se ma100 > ma300 AND 300> 6 ore ago - r 4353 X1"
                    action = "buy"
                    percentage = 80
                    
                    #  6 mar 2024 and ma39_last > ma39_5_min_ago ok cosi'
                    # 29 ott 2024 5>39 al posto di 39 > 39 5 min ago
                    # 29 ott 2024 and macd > -40 al posto di macd > macd 2 min ago
                    # 29 ott 2024 and macd_differenza_2_min_ago > -3.25


                elif (  
                    ma3_last > ma28_last
                    and ma39_last > ma39_5_min_ago
                    and ma3_prev < ma100_prev and ma3_last > ma100_last
                    
                    and ma300_last > ma300_360_min_ago
                    and ma100_last > ma300_last
                    
                    and deviation_ma100_laterale > 0.05
                    
                    and ma5_last > ma200_last
                    and ma3_last > ma11_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.07
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 1 forever young 1 PIU' PRUDENTE se ma 200 > e se ma100 > ma300 AND 300> 6 ore ago - r 4353 x2"
                    action = "buy"
                    percentage = 80
                    
                    #  6 mar 2024 and ma39_last > ma39_5_min_ago con incrocio al rialzo 3-100
                    


                elif (  
                    ma3_last > ma28_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192

                    and ma300_last > ma300_360_min_ago
                    and ma100_last > ma300_last
                    
                    and deviation_ma100_laterale > 0.05
                    
                    and ma5_last > ma200_last
                    and ma3_last > ma11_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.07
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 1 forever young 1 PIU' PRUDENTE se ma 200 > e se ma100 > ma300 AND 300> 6 ore ago - r 4353 y"
                    action = "buy"
                    percentage = 80

                    #  6 mar 2024 se ma39_last < ma39_15_min_ago PUGNO FANTASMA DI MOHAMMAD ALI'


                elif (  
                    ma3_last > ma28_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.24

                    and ma300_last > ma300_360_min_ago
                    and ma100_last > ma300_last
                    
                    and deviation_ma100_laterale > 0.05
                    
                    and ma5_last > ma200_last
                    and ma3_last > ma11_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.07
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 1 forever young 1 PIU' PRUDENTE se ma 200 > e se ma100 > ma300 AND 300> 6 ore ago - r 4353 z"
                    action = "buy"
                    percentage = 80
                    
                    # 1 ott 2023 3-10 > 0.035
                    # 2 nov 2023 100 > 300 da 200 > 300
                    # 7 lug 2023 5-28 a 0.05 da 0.09 (300> 5 ore ago!)
                    # 31 lug 2023 and deviation_ma100_laterale > 0.07 da 0.12
                    # 13 dic 2023 3-28 da 5-28
                    # 13 dic 2023 and deviation_ma100_laterale a 0.05 da 0.07

                    #  6 mar 2024 se ma39_last < ma39_15_min_ago PRENDI IL COLTELLO CON IL PIEDE



          
                


                elif (  
                    ma3_last > ma11_last
                    
                    and ma39_last > ma100_last
                    and ma100_last > ma450_last
                    and deviation_ma100_laterale > -0.03
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.25
                ):

                    buy = "BUY 1 forever young 2 con 39>100 and macd_differenza_2_min_ago > -18.25 - r 4355 a"
                    action = "buy"
                    percentage = 80
                    
                    # 24 ago 2023 and deviation_ma100_laterale > 0.05 da 0.07 con 200>300
                    # 28 ago 2023 100>150
                    # 31 ott 2023 aggiunto and macd_differenza_2_min_ago > 0.25
                    # 26 apr 2025 anticipata ndecchia



                elif (  
                    ma100_last > ma150_last
                    and ma28_last < ma28_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma5_120_min_ago > 0.80
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and ma5_last > ma200_last
                    and ma3_last > ma11_last
                    
                    and deviation_ma100_laterale > 0.03
                    
                    and deviation_ma3_sopra_ma10 > 0.035
                    and deviation_ma5_sopra_ma28 > 0.05
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.25
                ):

                    buy = "BUY 1 forever young 2 con 28< con aggiunta di prendi il coltello e ma100 > ma150 - r 4355 b1"
                    action = "buy"
                    percentage = 80

                    # 23 set 2024 aggiunta di prendi il coltello con il piede SE e' cresciuta tanto e ma28 SCENDE !




                elif (
                    ma3_last > ma11_last
                    and ma450_last > ma450_720_min_ago

                    and ma20_last < ma50_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10

                    and ma28_last < ma28_10_min_ago
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.025

                    and deviation_ma5_sopra_o_sotto_ma5_120_min_ago < 0.80
                    
                    and deviation_ma100_laterale > -0.04
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):

                    buy = "BUY 1 con ma450_last > ma450_720_min_ago e 28< con aggiunta di prendi il coltello e ma100 > ma150 - r 4355 B2 X1"
                    action = "buy"
                    percentage = 80

                    # 24 ago 2023 and deviation_ma100_laterale > 0.05 da 0.07 con 200>300
                    # 28 ago 2023 100>150
                    # 31 ott 2023 aggiunto and macd_differenza_2_min_ago > 0.25
                    #  8 ott 2024 anticipata ! deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.015 RICORDA IL BUY 2 CHE RICOMPRA
                    #  8 ott 2024 ma l' ultimo minimo e' superiore al penultimo minimo e quasi uguale al suo precedente (del penultimo)
                    #  8 ott 2024 cioe' crescono i minimi !!!

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 apr 2025 se 20<50 aggiungo deviation_ma5_sopra_o_sotto_ma100 < -0.10



                elif (
                    ma3_last > ma11_last

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.13

                    and ma450_last < ma450_720_min_ago

                    and ma100_last > ma150_last
                    and ma28_last < ma28_10_min_ago
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.015

                    and deviation_ma5_sopra_o_sotto_ma5_120_min_ago < 0.80
                    
                    and deviation_ma100_laterale > -0.03
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.05
                    
                    and macd >= -60
                    and macd_differenza_2_min_ago > -1.50
                ):

                    buy = "BUY 1 con ma450_last < ma450_720_min_ago e 28< con aggiunta di prendi il coltello e ma100 > ma150 - r 4355 B2 X2"
                    action = "buy"
                    percentage = 80
                    
                    # 24 ago 2023 and deviation_ma100_laterale > 0.05 da 0.07 con 200>300
                    # 28 ago 2023 100>150
                    # 31 ott 2023 aggiunto and macd_differenza_2_min_ago > 0.25
                    #  8 ott 2024 anticipata ! deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.015 RICORDA IL BUY 2 CHE RICOMPRA
                    #  8 ott 2024 ma l' ultimo minimo e' superiore al penultimo minimo e quasi uguale al suo precedente (del penultimo)
                    #  8 ott 2024 cioe' crescono i minimi !!!
                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 17 feb 2025 aggiunta and deviation_ma39 < -0.10
                    # 17 feb 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.13



                elif (  
                    ma100_last > ma150_last
                    and ma28_last < ma28_10_min_ago
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago < -0.015

                    and deviation_ma5_sopra_o_sotto_ma5_120_min_ago < 0.80
                    
                    and ma5_last > ma200_last
                    and ma3_last > ma11_last
                    
                    and deviation_ma100_laterale > 0.03
                    
                    and deviation_ma3_sopra_ma10 > 0.035
                    and deviation_ma5_sopra_ma28 > 0.05
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.25
                ):

                    buy = "BUY 1 forever young 2 con 28< con aggiunta di prendi il coltello e ma100 > ma150 - r 4355 b2Y"
                    action = "buy"
                    percentage = 80
                    
                    
                    # 24 ago 2023 and deviation_ma100_laterale > 0.05 da 0.07 con 200>300
                    # 28 ago 2023 100>150
                    # 31 ott 2023 aggiunto and macd_differenza_2_min_ago > 0.25
                    


                # BUY 1 legge della minore decrescenza ! RITORNO ESTATE 2024 con ma450_last > ma450_120_min_ago

                elif (      
                    ma450_last > ma450_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.10
                    and deviation_ma100_laterale > 0.01

                    and ma50_last < ma50_2_min_ago
                    and deviation_ma39 < -0.25    
                    
                    and (ma5_prev < ma450_prev and ma5_last > ma450_last)

                    and ma3_last > ma11_last
                  
                    and deviation_ma3_sopra_ma10 > 0.035
                    and deviation_ma5_sopra_ma28 > 0.01
                   
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > -1.25
                ):

                    buy = "BUY 1 legge della minore decrescenza ! - RITORNO ESTATE 2024 con ma450_last > ma450_120_min_ago - r 4356"
                    action = "buy"
                    percentage = 80
                    
                    
                    # 10 set 2024 and deviation_ma39 < -0.25 (da un precedente sell) significa che PRENDO IL COLTELLO CON IL PIEDE !
                    # 10 set 2024 and macd_differenza_2_min_ago > -1.25 significa che il MACD ha rallentato da un crollo - decresce di meno !
                    # 10 set 2024 LEGGE DELLA MINORE DECRESCENZA !
                    
                
                  
                    
                    
                # BUY 1 forever young 1 PIU' PRUDENTE se ma 200 > e se ma200 > ma300 AND 78 < 200 
                
                elif (  
                    ma200_last > ma300_last
                    and ma78_last < ma200_last
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma78_last < ma100_last
                    and deviation_ma100_laterale > 0.07
                    and ma8_last > ma100_last
                    and ma200_last > ma200_15_min_ago
                    
                    
                    and ma3_last > ma11_last
                    and ma4_last > ma100_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 1 forever young 1 USATA MOVIMENTO LATERALE se ma 200 > e se ma200 > ma300 AND 78 < 200 AND 3-10 > 0.10 e 300>60 min ago - r 4379 B1"
                    action = "buy"
                    percentage = 80
                    
                    # la troppa prudenza qualche volta genera perdite !
                    # RCCR r1852 e' arrivata una ndecchia prima. studia le piccole differenze.
                    # 30 set 3-10 a 0.10 da 0.04
                    # 21 lug 2023 300 > 60 min no 120 min
                    
                    
                    
                # BUY 1 forever young 1 PIU' PRUDENTE se ma 200 > e se ma200 > ma300 MA 300 < 120 min ago AND 78 < 200
                
                elif (  
                    ma5_last > ma20_last
                    and ma50_last > ma59_last
                    
                    and deviation_ma100_laterale > -0.10
                    
                    and ma78_last < ma100_last
                    and ma78_last < ma200_last
                    and ma300_last < ma300_120_min_ago
                    and deviation_ma5_sotto_ma300 < -0.42
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 1 forever young 1 con 50 > 59 con 78<200 e ma300 < 120 min ago - r 4379 B2x"
                    action = "buy"
                    percentage = 70

                    # 18 set 2024 anticipata 
                    # 18 set 2024 aggiunto prendi il coltello con il piede
                    
                
                elif (  
                    ma3_last > ma13_last

                    and ma50_last < ma59_last
                    and (ma78_last < ma100_last or ma78_last < ma200_last)
                    
                    and ma300_last < ma300_120_min_ago

                    and (ma3_last > ma100_last or ma3_last > ma200_last)
                    and deviation_ma100_laterale > 0.08
                    
                    and ma200_last > ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                ):

                    buy = "BUY 1 forever young 1 con 50 > 59 e se ma 200 > e se ma200 > ma300 MA 78 < 200 e MA 300 < 120 min - r 4379 B2y"
                    action = "buy"
                    percentage = 70
                    
                    # la troppa prudenza qualche volta genera perdite
                    # 20 ottobre 2022 5-28 0.13 da 0.09
                    # 21 apr 2023 aggiunta macd >
               
                ################################################################################################
                
                
                # BUY 1 FOREVER YOUNG

                elif (  
                    ma3_last > ma18_last
                    and ma39_last > ma100_last

                    and ma450_last > ma450_240_min_ago
                    and ma300_last > ma300_301_min_ago
                    and (ma100_last > ma450_last or ma200_last > ma450_last)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -15.25
                ):
                    
                    buy = "BUY 1 FOREVER YOUNG - GIORNO - con ma450_last > ma450_240_min_ago e con 39>100 - r 4410 A1"
                    action = "buy"
                    percentage = 80
                    
                    # 12 giu 2023 aggiunta 3-18 > 0.055
                    # 11 ago 2023 tolta ma5 > ma5 2 min ago
                    # 24 ago 2023 macd> 3
                    # 17 apr 2025 and macd_differenza_2_min_ago > -15.25
                    # 17 apr 2025 con ma450_last > ma450_240_min_ago anticipata ndecchiecella 
                    # 30 apr 2025 piccolissima modifica. niente di importante.
                    #  7 mag 2025 aggiunto ma39_last > ma100_last



                elif (  
                    ma3_last > ma18_last
                    and ma39_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.40

                    and ma450_last > ma450_240_min_ago
                    and ma300_last > ma300_301_min_ago
                    and (ma100_last > ma450_last or ma200_last > ma450_last)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -15.25
                ):
                    
                    buy = "BUY 1 FY - GIORNO - con ma450_last > ma450_240_min_ago MA SE ma39_last < ma100_last and dev 3-50 < -0.30 - r 4410 A2"
                    action = "buy"
                    percentage = 80
                    
                    # 12 giu 2023 aggiunta 3-18 > 0.055
                    # 11 ago 2023 tolta ma5 > ma5 2 min ago
                    # 24 ago 2023 macd> 3
                    # 17 apr 2025 and macd_differenza_2_min_ago > -15.25
                    # 17 apr 2025 con ma450_last > ma450_240_min_ago anticipata ndecchiecella 
                    # 30 apr 2025 piccolissima modifica. niente di importante.
                    #  7 mag 2025 SE ma39_last < ma100_last AGGIUNGO and deviation_ma3_sotto_ma50 < -0.40



                # BUY 1 FOREVER YOUNG AGGRESSIVO 
                
                
                elif (      
                    ma3_last > ma20_last

                    and ma450_last < ma450_300_min_ago
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma200_sotto_ma300 < -0.32
                    and deviation_ma3_sotto_ma50 < -0.28


                    and ma450_last < ma450_240_min_ago
                    and ma39_last < ma39_15_min_ago
                    and ma39_last < ma100_last
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30

                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.04
                    and deviation_ma5_sotto_ma200 < -0.08
                    and deviation_ma5_sotto_ma450 < -0.15

                    and deviation_ma25_sotto_ma300 < -0.04
                    
                    and ma10_last < ma20_last
                    
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -3.25
  
                ):
                    
                    buy = "BUY 1 AGGRESSIVO + distanze al ribasso se ma450_last < ma450_300_min_ago - r 4410 B"
                    action = "buy"
                    percentage = 80
                    
                    # 12 giu 2023 aggiunta 3-18 > 0.055
                    # 11 ago 2023 tolta ma5 > ma5 2 min ago
                    # 24 ago 2023 macd>5
                    #  6 ott 2024 MODIFICATO RADICALMENTE per anticipare
                    #  3 feb 2025 aggiunta and deviation_ma5_sotto_ma300 < -0.40
                    #  3 feb 2025 aggiunta and deviation_ma10_sopra_ma200 < -0.30
                    # 20 mar 2025 aggiunte distanze al ribasso se ma450_last < ma450_300_min_ago !
                    
                    
                    
                # BUY 1 NEW FOREVER YOUNG piccola CORREZIONE FIAT in alto - ALTRA RIGA RCCR che e' andata bene.
                
                elif (    
                    
                    deviation_ma100_sopra_ma300 > 0.50
                    and ma5_last > ma50_last
                    
                    and ma3_last > ma28_last
                    and ma200_last > ma200_20_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.113
                    and deviation_ma3_sopra_ma16 > 0.225
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 1 NEW FOREVER YOUNG piccola CORREZIONE FIAT in alto - ALTRA RIGA RCCR che e' andata bene - r 4411 A"
                    action = "buy"
                    percentage = 40
                    
                    # 13 set aggiunte 3-10 and 5-28
                    # se sta molto in alto per comprare 5 deve incrociare dal basso con la 100 ed avere 3-10 > 0.11 vedi ore 12:06 del 26 set 2022
                    # VA IN CONFLITTO. allora ho lasciato solo 3-10 > 0.11
                    # BUY 1 correzione FIAT con riga 1384 RCCR + 3-10 - altra riga RCCR che e' andata bene.
                    # vedi 30 set ore 18:26 RCCR riga 1384
                    # in MADDOG ho aggiunto 3-10 > 0.07 e lasciato 3-28
                    # 6 apr 2023 5-50 da 5-150 ! 
                    # 6 apr 2023 aggiunta 3-16 > 0.225 (se ricompra DOPO UN GRANDE RIALZO serve prudenza) (cerca di non perdere quello che hai guadagnato)
                    
                  
                    
                # BUY 1 FOREVER YOUNG PRUDENTE se ma 200 > e se ma200 > ma300 con doppio delta > 1 (ribasso) and deviation_ma5_sopra_ma28 > 0.30
                
                elif (  
                    ma200_last > ma300_last
                    and ma300_last > ma300_120_min_ago
                    and ma200_last > ma200_15_min_ago
                    and deviation_ma100_laterale < -0.60
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.17
                    
                    and ma6_last > ma6_2_min_ago
                    and ma8_last > ma54_last
                    and ma13_last > ma13_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    
                    buy = "BUY 1 FOREVER YOUNG - NOTTE - MA 300 > 120 min ago and dev_ma5_sopra_ma28 > 0.30 se ma 200 > e se ma200 > ma300 - r 4440 A1"
                    action = "buy"
                    percentage = 80
                    
                    # dev 100 laterale significa che 5 deve essere distante dalla 100
                    # 24 set vuoi comprare di notte ? allora dev 5-100 = dev 100 laterale deve essere distante di almeno - 0.60 (distanza della 5 dalla 100 !)
                    
                    
                   
                    
                    
                # BUY 1 FOREVER YOUNG PRUDENTE se ma 200 > e se ma200 > ma300 con doppio delta > 1 (ribasso) and deviation_ma5_sopra_ma28 > 0.30
                
                elif (  
                    ma200_last > ma300_last
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma3_sopra_ma10 > 0.22
                    
                    and ma200_last > ma200_15_min_ago
                 
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.30
                
                    and ma6_last > ma6_2_min_ago
                    and ma13_last > ma69_last
                    and ma13_last > ma13_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    
                    buy = "BUY 1 FOREVER YOUNG PRUDENTE SOPRA RIBASSO RIBASSO - NOTTE - and dev_ma5_sopra_ma28 > 0.30 se ma 200 > e se ma200 > ma300 - r 4440 B"
                    action = "buy"
                    percentage = 80
                    
            
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
                    and deviation_correzione > 0.03
                    
                    and deviation_ma3_sopra_ma10 > 0.16
                    and deviation_ma5_sopra_ma28 > 0.11
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma100_sopra_ma300 <-2.30
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 DURANTE UNA CORREZIONE FIAT da r701 RCCE ho dovuto metterla ! con deviation_correzione > 0.03 MA 100 lontana da 300 ! - riga 4485"
                    action = "buy"
                    percentage = 80
                    
                    # 100 sopra 300 MA IN REALTA' STA SOTTO.
                    # 100 lontana da 300
                    # 100< 200< 300< da oltre 120 min
                    
                    # deve essere cosi' altrimenti la r701 RCCR genera molte perdite.
                    # ma il 9 maggio 2022 RCCR ha comprato in situazione DRAMMATICA ed e' andata benissimo mentre MADDOG DORMIVA.
                    # 14 set 2022 ho aggiunto 3-10 e 5-28
                    
                    
                    
                
                # BUY 1 piccola CORREZIONE FIAT CHE FA PAURA ! ( ma la ma100 E' ANCORA VICINA alla ma300 !) NON TOCCARE 5-28 > 0.10 !
                # ( E ANCHE la ma25 deve stare un po' distante dalla 300 !!! )
                
                elif (
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.59
                    
                    and deviation_correzione > 0.03
                    and deviation_ma5_sopra_ma28 > 0.05
                    
                    and ma78_last > ma100_last
                    and ma200_last > ma300_last
                    and deviation_ma100_sopra_ma300 > -0.30
                    and deviation_ma25_sotto_ma300 < -0.60
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 FIAT (MA ma100 ANCORA VICINA alla ma300 e 200 e' ancora sopra 300) (E CON ma25 un po' distante da ma300) 50% 78>100 - riga 4514 A"
                    action = "buy"
                    percentage = 50
                    
                    # deviation_ma100_sopra_ma300 significa 100/300 ( ma100 ancora NON SI E' ALLONTANATA TROPPO DALLA ma300 )
                    # ma200 sta ancora sopra ma300 !
                    # deviation_ma25_sotto_ma300 significa che anche ma25 deve andare almeno un po' sotto ma300 (per evitare piccole schegge rialziste !)
                    # NON TOCCARE 5-28 > 0.05 !
                    
                    
                    
                    
                    
                # BUY 1 piccola CORREZIONE FIAT CHE FA PAURA ! ( ma la ma100 E' ANCORA VICINA alla ma300 !) NON TOCCARE 5-28 > 0.10 !
                # ( E ANCHE la ma25 deve stare un po' distante dalla 300 !!! )
                
                elif (
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.59
                    
                    and deviation_correzione > 0.03
                    and deviation_ma5_sopra_ma28 > 0.19
                    
                    and ma78_last < ma100_last
                    and deviation_ma3_sopra_ma10 > 0.12
                    and ma200_last > ma300_last
                    and deviation_ma100_sopra_ma300 > -0.30
                    and deviation_ma25_sotto_ma300 < -0.60
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 FIAT (MA ma100 ANCORA VICINA alla ma300 e 200 e' ancora >300) (E CON ma25 distante da ma300) 50% E 78<100 E 3-10 > 0.15 - r 4514 B"
                    action = "buy"
                    percentage = 50
                    
                    # deviation_ma100_sopra_ma300 significa 100/300 ( ma100 ancora NON SI E' ALLONTANATA TROPPO DALLA ma300 )
                    # ma200 sta ancora sopra ma300 !
                    # deviation_ma25_sotto_ma300 significa che anche ma25 deve andare almeno un po' sotto ma300 (per evitare piccole schegge rialziste !)
                    # NON TOCCARE 5-28 > 0.05 !
                    
                    # > estate 5-28 0.19 da 0.05 e 3-10 0.15 da 0.10
                
                
                
                # BUY 1 con DEVIATION ASSURDA  se ma200 > da 20 min COMPRA con INCROCIO ma8 - ma200 >

                elif (    
                    ma3_last > ma13_last

                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    
                    and (ma5_last > ma200_last or ma5_last > ma300_last)
                    
                    and (ma3_prev < ma8_prev and ma3_last > ma8_last)
                    
                    and (ma20_last > ma20_2_min_ago or ma39_last > ma39_2_min_ago or ma69_last > ma69_2_min_ago)
                    
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 con delta_CM_300_25_last < delta_CM_300_25_2_min_ago - r 4542"
                    action = "buy"
                    percentage = 80

                    # 15 ott 2025 anticipata ndecchiecella
                    
                    
                    
                
               
                    
                # BUY 1 5 LUGLIO 2022 ma100 sotto ma300 di almeno -0.90 ! E CON 3-10 > 0.16
                
                elif (
                    
                    deviation_ma100_sopra_ma300 < -0.90
                    
                    and ma5_last > ma39_last
                    and deviation_ma3_sopra_ma10 > 0.16
                    and deviation_ma5_sopra_ma59 > 0.42
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and price > price_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 5 LUGLIO 2022 con 5-39 and ma100 sotto ma300 di almeno -0.90 ! 3-10 > 0.16 and 5-59 > 0.42 - r 4570 A"
                    action = "buy"
                    percentage = 70

                    # 22 lug 2022 3-10 0.16 da 0.12 cazzo
                    # 15 nov 2022 8-39 da 8-54
                    # 15 dic 2022 5-39 da 8-39
                    # 25 gen 2023 and deviation_ma5_sopra_ma59 > 0.42
                 
                    
                    
                    
                    
                    
                    
                # BUY 1 DURANTE UN RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO ! 22 ago 2022
                
                elif (
                    delta_1 < delta_2
                    and deviation_ma5_sopra_ma16 > 0.20
                    and deviation_ma50 > -0.50
                    and deviation_buy_crollo_1 < -0.60
                    and deviation_buy_crollo_1 > -1.60
                    
                    and ma78_last < ma200_last
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 1 DURANTE UN RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO ! 22 ago 2022 - riga 4571a"
                    action = "buy"
                    percentage = 50
                    
                    # 14 sett dev 5-16 ho dovuto purtroppo portarla a 0.20 da 0.10 dopo il crollo del 13 set
                    # non e' partita ferrari
                    # non riesco a fare 5-300 > -3.00 e 5-300 < -3.00 che casino ! il compare non risponde
                    # deviation_ma50 = ma50 di adesso / ma50 di 60 min ago
                    # vedi 14 ottobre 2022 ore 16:35
                    
                    
                    
                
                    
                    
                elif (    
                    ma50_last < ma50_2_min_ago
                    and ma5_last > ma39_last
                     
                    and deviation_ma5_sotto_ma300 < 0.30
                      
                        
                    and ma300_last < ma300_120_min_ago
                    and ma100_last > ma100_60_min_ago
                      
                    and ma5_last > ma5_2_min_ago
                     
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    sell = "BUY 1 ZIA MARIA con ma50 < MA ma100 > E ma300 < e con 5-39 - r 4597"
                    action = "sell"


                
                # BUY 1 CROLLO IMPROVVISO e RISALITA SUPERVELOCE - la piu' pericolosa d tutte ! - BUY con il 30% - dovrebbe evitarmi il "buy alto"


                elif (    
                    
                    price >= ma3_last
                    
                    and ma100_last > ma300_last
                    
                    and deviation_ma3_sotto_ma100 < -1.70
                    and deviation_ma3_sotto_ma300 < -1.60
                    
                    and deviation_ribasso_e_rialzo_velocissimo_1 < -1.50
                    and deviation_ribasso_e_rialzo_velocissimo_2 > -0.50
                    
                    and deviation_ma100_sopra_ma300 < 0.40
                    and macd >= macd_2_min_ago
               
                ):
                    buy = "BUY 1 CROLLO IMPROVVISO e RISALITA SUPERVELOCE - la piu' pericolosa d tutte ! - BUY con il 30% - dovrebbe evitarmi il buy alto - r 4598"
                    action = "buy"
                    percentage = 30
                    
                    
                    # deviation_ribasso_e_rialzo_velocissimo_1 = price / price_10_min_ago
                    # deviation_ribasso_e_rialzo_velocissimo_2 = price / price_2_min_ago
                    
                    # importante : il prezzo puo' essere anche piu' basso del prezzo di 2 min ago ! - fidati - 
                    # in questa circostanza ma2 arriva tardissimo !
                    # se 100 > 300 NON E' UN CROLLO !
                    
                    # and deviation_ma100_sopra_ma300 < 0.40 significa che CON QUESTE CONDIZIONI COSI' AGGRESSIVE 
                    # NON COMPRA mentre scende precipitosamente dopo un grandissimo rialzo !
                    # potra' anche farlo ma considerando il 3-10 e il 5-28
                    
                    # Manchester Orchestra - I Know How To Speak
                  
            
            #############################################################################################################      COMPRA sessione 2
            
            elif self.session == 2:

                if (    
                    ma3_last > ma18_last

                    and ma20_last < ma50_last
                    and (ma3_last < ma20_last or ma20_last < ma20_2_min_ago or ma33_last < ma33_3_min_ago)
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma5_sotto_ma300 < -0.01
                    
                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.05

                    and deviation_ma100_sopra_ma300 > 0.20
                    
                    and delta_1_200_78 < delta_2_200_78_60_min
                    and delta_300_200 < delta_300_200_60_min

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.07
                    
                    and macd_differenza_2_min_ago > -18.5
                
                ):
                    buy = f"BUY 2 {ma300_last} {ma300_120_min_ago} GIORNO con 78>200 AND 300>300 120 min MA RITRACCIA ! - r 4639 A1 X1 X1x"
                    action = "buy"
                    percentage = 80

                    # 21 gen 2025 anticipata ndecchia con 300 > 300 120 min ago !
                    # 28 gen 2025 aggiunto and delta_300_200 < delta_300_200_60_min GIORNO
                    # 27 mar 2025 con ma5 che sta ancora sopra ma150 se ritraccia compra con deviation_ma39 < -0.12
                    # 10 apr 2025 correzione or e aggiunta f
                    # 14 apr 2025 se ritraccia - aggiunto 20<50 deve essere and deviation_ma5_sotto_ma300 < -0.01



                elif (    
                    ma3_last > ma20_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma100_sopra_ma300 > 0.20
                    
                    and delta_1_200_78 < delta_2_200_78_60_min
                    and delta_300_200 > delta_300_200_60_min

                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > -0.07
                    and deviation_ma5_sopra_ma28 > -0.10
                    
                    and price > price_2_min_ago
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -1.5
                
                ):
                    buy = "BUY 2 GIORNO con 78 > 200 AND 300 >300 120 min ago ! - r 4639 A1 X1 X2"
                    action = "buy"
                    percentage = 80

                    # 21 gen 2025 anticipata ndecchia con 300 > 300 120 min ago !
                    # 28 gen 2025 aggiunto and delta_300_200 > delta_300_200_60_min NOTTE
                    # 28 gen 2025 and deviation_ma3_sopra_ma10 > 0.02 da > 0.01 ( ha comprato prestissimo quasi attaccato al sell precedente.)




                elif (
                    ma69_last > ma69_2_min_ago
                    and ma39_last < ma100_last

                    and deviation_ma25_sotto_ma300 < -1.40
                    and deviation_ma50_sotto_ma300 < -1.20
                    and deviation_ma39 < -0.25
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.20
                    and deviation_ma5_sotto_ma200 < -1.30
                    and deviation_ma5_sotto_ma300 < -1.40

                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.20
                    and ma78_last > ma200_last
                    and delta_1_200_78 < delta_2_200_78_60_min
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma5_sopra_ma28 > -0.03
                    
                    and deviation_buy_ma3_sopra_ma13 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and price > price_2_min_ago
                    and macd > -40
                    and macd_differenza_2_min_ago > -1.25
                ):
                    buy = "BUY 2 rialzo o laterale con 78 > 200 AND 300 >300 120 min ago ! - r 4639 A1 X1 Y"
                    action = "buy"
                    percentage = 80

                    # 11 nov 2024 se ma39 < ma100 (meglio di ma100 < ma100 30 min ago) allora entra in gioco ZIA AMALIA




                elif (
                    ma69_last > ma69_2_min_ago
                    and ma39_last < ma39_30_min_ago
                    and ma39_last > ma39_2_min_ago
                    
                    and ma2_differenza_2_min_ago > 5
                    and macd_differenza_2_min_ago > 0.5
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.20
                    and ma78_last > ma200_last
                    and delta_1_200_78 < delta_2_200_78_60_min
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.03
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.09
                    
                    and ma2_last > ma2_2_min_ago
                    and price > price_2_min_ago
                    and macd >= macd_2_min_ago
                    
                    
                ):
                    buy = "BUY 2 rialzo o laterale con 78 > 200 AND 300 >300 120 min ago ! - r 4639 A1 X2 x"
                    action = "buy"
                    percentage = 80

              
                elif (
                    ma69_last > ma69_2_min_ago
                    and ma39_last < ma39_30_min_ago
                    and ma39_last < ma39_2_min_ago
                    and deviation_ma39 > 0.33
                    
                    and ma2_differenza_2_min_ago > 5
                    and macd_differenza_2_min_ago > 0.5
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.20
                    and ma78_last > ma200_last
                    and delta_1_200_78 < delta_2_200_78_60_min
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.03
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.09
                    
                    and ma2_last > ma2_2_min_ago
                    and price > price_2_min_ago
                    and macd >= macd_2_min_ago
                    
                    
                ):
                    buy = "BUY 2 rialzo o laterale con 78 > 200 AND 300 >300 120 min ago ! - r 4639 A1 X2 y"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last
                    # 16 nov 2023 tolta deviation bellissima. (ma300 sale da 2 ore e devo anticipare il buy) (poi mettero' 3-10 e 3-16 e 5-28)
                    # 16 nov 2023 tolta dev 7>40 (ma300 sale da 2 ore e devo anticipare il buy)

                    # 20 nov 2023 ha comprato con ma2 piu' basso di 2 min ago e allora ho aggiunto le prossime 2
                    # 20 nov 2023 and and ma2_differenza_2_min_ago > 5
                    # 20 nov 2023 and macd_differenza_2_min_ago > 0.5
                    #  9 gen 2024 se ma39_last < ma39_30_min_ago and ma39_last < ma39_2_min_ago BUY con and deviation_ma39 > 0.33 PUGNO FANTASMA DI MOHAMMAD ALI'


              
                elif (
                    ma69_last > ma69_2_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.20
                    and ma78_last > ma200_last
                    and delta_1_200_78 > delta_2_200_78_60_min
                    and deviation_ma3_sopra_ma30 > 0.31
                    
                    and deviation_buy2 > 0.01
                    and deviation_bellissima > 0.151
                    and deviation_buy_ma3_sopra_ma13 > 0.09
                    and deviation_ma7_sopra_ma40 > 0.05
                    and ma2_last > ma2_2_min_ago
                    and price > price_2_min_ago
                    and ma3_last > ma40_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 rialzo o laterale con 78 > 200 AND 300 >300 120 min ago ! - r 4639 A1y"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last
                    # vedi BUY 29 ottobre 2022 ore 19:52
                
                
                elif (
                    ma69_last > ma69_2_min_ago
                    and ma300_last < ma300_120_min_ago
                    and deviation_ma100_sopra_ma300 > 0.20
                    and ma78_last > ma200_last
                    
                    and deviation_buy2 > 0.03
                    and deviation_bellissima > 0.151
                    and deviation_buy_ma3_sopra_ma13 > 0.09
                    and deviation_ma7_sopra_ma40 > 0.05
                    
                    and price > price_2_min_ago
                    and ma3_last > ma40_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 2 rialzo o laterale con 78 > 200 - r 4639 A2"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last
                    #  6 giu 2023 aggiunto macd >
                    
                    
                elif (
                    ma69_last > ma69_2_min_ago
                    and deviation_ma100_sopra_ma300 > 0.20
                    and ma78_last < ma200_last
                    
                    and deviation_buy2 > 0.04
                    and deviation_bellissima > 0.151
                    and deviation_buy_ma3_sopra_ma13 > 0.09
                    and deviation_ma7_sopra_ma40 > 0.07
                    and ma2_last > ma2_2_min_ago
                    and price > price_2_min_ago
                    and ma3_last > ma40_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 rialzo o laterale con 78 < 200 - r 4661 b"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last


                    
                    
                elif (
                    ma3_last < ma18_last
                    and ma450_last > ma450_720_min_ago

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.02

                    and ma100_last < ma100_90_min_ago
                    and ma200_last < ma200_20_min_ago
                    and ma300_last < ma450_last

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    and deviation_ma5_sotto_ma200 < -0.25
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma25_sotto_ma300 < -0.39
                    and deviation_ma50_sotto_ma300 < -0.36

                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.08
                    and deviation_ma5_sopra_ma28 > -0.10

                    and macd_differenza_2_min_ago > -2.50
                ):    
        
                    buy = "BUY 2 con 450> MA ma100< 100 90 min ago + CANO STAF + zia amalia + MODELLO CONTINUA A SCENDERE - r 4670"
                    action = "buy"
                    percentage = 90
                    
                    #  7 ott 2024 DATEMI UN OSSO (and deviation_ma5_sotto_ma200 < -0.30)
                    #  7 ott 2024 DATEMI UN OSSO (and deviation_ma25_sotto_ma300 < -0.60)
                    #  7 ott 2024 aggiunta anche and deviation_ma5_sopra_o_sotto_ma100 < -0.13
                    # 15 ott 2024 inervento del CANO STAF che forse ha un piccolo segreto 
                    # 15 ott 2024 che forse e' prorio questo ! and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15

                    # 27 feb 2025 CONTINUA A SCENDERE ! - MODELLO -



                elif (    
                    ma4_last > ma50_last
                    and ma450_last < ma450_120_min_ago
                    and ma100_last <= ma200_last
                    
                    and ma50_last > ma59_last
                    and ma100_last > ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd_differenza_2_min_ago > 0.20
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 con 50>59 AND and ma450_last < ma450_120_min_ago CON ma100_last > ma300_last MA 100<200 and macd > macd_2_min_ago - r 4675"
                    action = "buy"
                    percentage = 80

                    # 22 set 2025 aggiunta da RCCR - maddog ha comprato con molto ritardo

                    

                elif (
                    
                    ma3_last > ma100_last
                    and ma450_last > ma450_180_min_ago
                    and ma200_last > ma200_301_min_ago
                    
                    and ma100_last >= ma100_2_min_ago
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_ma100_laterale < 0.20
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma16 > 0.077
                    
                    and ma3_last > ma40_last
                    and price >= price_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2A ribasso o laterale and ma10_last > ma200_last AND 200 > 200 301 min - r 4685 AX"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last  
                    # tolta and ma2_last >= ma2_2_min_ago !
                    #  9 ott 2022 69>200 da 78>200
                    # 12 ott 2022 7-40 0.04 da 0.05
                    # 1 nov se ma200 sale da 5 ore compra con 7-40 > 0.005 !
                    # 10 dic 2022 50>200 da 59>200
                    # 18 dic 2022 20>200 da 50>200
                    #  3 gen 2023 5-28 > 0.10
                    # 13 giu 2023 10>100 da 20>200
                    
                elif (
                    
                    ma20_last > ma200_last
                    and ma450_last < ma450_180_min_ago
                    and ma200_last > ma200_301_min_ago
                    
                    and ma100_last >= ma100_2_min_ago
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_ma100_laterale < 0.20
                    and deviation_buy2 > 0.005
                    and deviation_ma5_sopra_ma28 > 0.10
                    
                    and deviation_ma7_sopra_ma40 > 0.005
                    and deviation_buy_ma3_sopra_ma13 > 0.07
                    
                    and ma3_last > ma40_last
                    and price >= price_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2A ribasso o laterale and ma20_last > ma200_last AND 200 > 200 301 min - r 4685 Ay"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last  
                    # tolta and ma2_last >= ma2_2_min_ago !
                    #  9 ott 2022 69>200 da 78>200
                    # 12 ott 2022 7-40 0.04 da 0.05
                    # 1 nov se ma200 sale da 5 ore compra con 7-40 > 0.005 !
                    # 10 dic 2022 50>200 da 59>200
                    # 18 dic 2022 20>200 da 50>200
                    #  3 gen 2023 5-28 > 0.10



                    
                elif (
                    
                    ma5_last > ma54_last
                    and ma450_last > ma450_300_min_ago

                    and ma100_last > ma100_60_min_ago

                    and ma59_last >= ma59_2_min_ago
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_buy2 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_ma3_sopra_ma10 > 0.04
                    
                    and deviation_ma7_sopra_ma40 > 0.04
                    and deviation_buy_ma3_sopra_ma13 > 0.08
                    
                    and ma3_last > ma40_last
                    and price >= price_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2A ribasso o laterale and ma5_last > ma59_last con 450 > 450 300 min ago - r 4685 Bx 1x"
                    action = "buy"
                    percentage = 80
                    
                    # 27 set 2023 se 450 > 450 300 min ago
                    # 27 set 2023 5-54 da 59-200


                        
                
                elif (    
                    ma3_last > ma18_last

                    and ma450_last > ma450_480_min_ago
                    and ma78_last < ma150_last


                    and deviation_ma100_sopra_ma200 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.70
                    and deviation_ma50_sotto_ma100 < -0.25
                    and deviation_ma3_sotto_ma50 < -0.02

                    and ma450_last > ma450_300_min_ago

                    and deviation_ma50_sotto_ma300 < -0.20
                    and deviation_ma200_sotto_ma300 < -0.17

                    and ma300_last < ma300_60_min_ago
                    and ma100_last < ma100_60_min_ago

                    and deviation_ma39 < -0.02

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.25
                    and deviation_ma5_sotto_ma300 < -0.30

                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.10
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 2 con ma3_last > ma20_last con 450 > 450 300 min ago + distanza al ribasso - r 4685 BX 1Y"
                    action = "buy"
                    percentage = 80
                    
                    # 27 set 2023 se 450 > 450 300 min ago
                    # 27 set 2023 5-54 da 59-200
                    # 10 nov 2024 aggiunte NUOVE CONDIZIONI GRAFANA - ZIA AMALIA
                    #  5 feb 2025 aggiunta and deviation_ma25_sotto_ma300 > -0.50 significa che la smette di comprare se continua il ribasso

                    #  6 feb 2025 aggiunta importantissima ! deviation_ma200_sotto_ma300 < -0.17
                    #  6 feb 2025 aggiunta importantissima ! and deviation_ma39 < -0.02
                    #  6 feb 2025 aggiunta and deviation_ma25_sotto_ma300 < -0.50 da > -0.50 con dev39 <-0.02 mi assumo la responsabilita' !
                    #  6 feb 2025 and macd >= -70 da >-40
                    # 26 mar 2025 and macd_differenza_2_min_ago > -18.00 da -5.00 (in questa situazione speciale !)


                # 22 set 2024 CANCELLATA r 4685 BX 2x
                
                
                elif (    
                    ma59_last > ma200_last
                    and ma450_last < ma450_300_min_ago
                    and ma100_last < ma100_120_min_ago
                    and ma59_last >= ma59_2_min_ago
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_buy2 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_ma3_sopra_ma10 > 0.04
                    
                    and deviation_ma7_sopra_ma40 > 0.04
                    and deviation_buy_ma3_sopra_ma13 > 0.08
                    
                    and ma3_last > ma40_last
                    and price >= price_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2A ribasso o laterale  and ma69_last > ma200_last - r 4685 BX 2y"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last  
                    # tolta and ma2_last >= ma2_2_min_ago !
                    #  9 ott 2022 69>200 da 78>200
                    # 12 ott 2022 7-40 0.04 da 0.05
                    # 18 nov 2022 5-28 0.11
                    # 11 gen 2023 5-28 a 0.10 da 0.11
                    # 11 gen 2023 3-10 a 0.04 da 0.05
                    # 11 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018



                
                elif (    
                    ma3_last > ma18_last

                    and deviation_ma25_sotto_ma300 < -0.49
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30

                    and deviation_ma250_sopra_ma300 < 0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.33
                    
                    and (ma450_last > ma450_300_min_ago or ma200_last > ma450_last)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 con 100>450 and 5-100 < -0.30 - r 4685 BY 1 xx1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 10 mag 2025 aggiunta and ma100_last > ma100_60_min_ago
                    # 11 mag 2025 aggiunta or ma200_last > ma450_last
                    # 21 mag 2025 and 5-100 < -0.30
                    # 29 mag 2025 modificata per farla comprare piu' giu'
                    # 16 ott 2025 ok !
                    # 16 ott 2025 aggiunte parentesi graffe




                elif (    
                    ma3_last > ma18_last

                    and delta_50_25_last < delta_50_25_30_min_ago

                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.35)
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and deviation_ma250_sopra_ma300 < 0.17
                    and deviation_ma250_sopra_ma300 > -0.17
                    
                    and (ma450_last > ma450_300_min_ago or ma200_last > ma450_last)
                    and (ma100_last > ma450_last or ma100_last > ma100_60_min_ago or deviation_ma100_sopra_ma300 > -0.05)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 con 250 vicino alla 300 + CM + delta_50_25_last < delta_50_25_30_min_ago - r 4685 BY 1 xx2 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 80

                    # 10 mag 2025 aggiunta and ma100_last > ma100_60_min_ago
                    # 11 mag 2025 aggiunta or ma200_last > ma450_last
                    # 21 mag 2025 and 5-100 < -0.25
                    #  7 ott 2025 aggiunta and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.35)
                    #  8 ott 2025 aggiunta and delta_50_25_last < delta_50_25_30_min_ago
                    #  8 ott 2025 aggiunte parentesi graffe sulla stessa riga


                elif (    
                    ma3_last > ma13_last
                    

                    and (ma100_last < ma100_60_min_ago or ma20_last < ma50_last)

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.2
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma25_sotto_ma300 < -0.40
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04

                    and ma450_last > ma450_300_min_ago
                    and (ma100_last > ma450_last or deviation_ma100_sopra_ma300 > -0.05)
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 con 100>450 - r 4685 BY 1X y - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    
                    action = "buy"
                    percentage = 80

                    # 10 mag 2025 aggiunta and ma100_last > ma100_60_min_ago or 
                    # 10 mag 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.13
                    # 22 mag 2025 and deviation_ma3_sotto_ma50 a -0.15 da -0.13
                    # 22 mag 2025 aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    #  8 ott 2025 ko compra mentre scende dopo un rialzo. aggiungo parentesi graffe per capire
                    #  8 ott 2025 intanto metto and deviation_ma39 < -0.08
                    #  8 ott 2025 intanto metto and deviation_ma3_sotto_ma50 < -0.15
                    #  8 ott 2025 intanto metto and deviation_ma5_sopra_o_sotto_ma100 < -0.13
                    # 24 ott 2025 aggiunte dev da parentesi di un successivo buy



                elif (    
                    ma3_last > ma13_last

                    and ma450_last < ma450_300_min_ago
                    and delta_1_50_20 < delta_2_50_20

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.13
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 2 con condizioni che sono andate bene durante il ribasso - r 4685 BY 1Y X1 -  deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}

                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """

                    action = "buy"
                    percentage = 80

                    # 27 mag 2025 3-13 da 3-18
                    # 28 mag 2025 se doppio delta 50-20 giorno ok cosi'
                    #  7 ago 2025 aggiunta and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    #  7 ago 2025 aggiuntaand deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176
                    # 25 set 2025 aggiunte parentesi graffe
                    # 25 set 2025 aggiunte le deviation delle parentesi graffe
                    #  8 ott 2025 aggiunta deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago} sulla stessa riga
                    #  8 ott 2025 (le parentesi graffe a colonna non funzionano)
                    #  8 ott 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago a -0.05 da -0.15

                elif (
                    ma3_last > ma13_last

                    and deviation_ma39 < -0.31
                    and deviation_ma3_sotto_ma50 < -0.42
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.80
                    and deviation_ma25_sotto_ma300 < -1.45
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.186


                    and delta_1_50_20 > delta_2_50_20
                    
                    and ma450_last < ma450_300_min_ago
                    and deviation_ma100_sopra_ma300 > -0.20
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 2 con 100>450 - r 4685 BY 1Y X2"
                    action = "buy"
                    percentage = 80

                    # 27 mag 2025 3-13 da 3-18
                    # 28 mag 2025 se doppio delta 50-20 notte aggiungo and deviation_ma3_sotto_ma50 < -0.05
                    # 28 giu 2025 aggiunto un po' di distanza al ribasso.



                elif (    
                    ma3_last > ma10_last

                    and (ma450_last < ma450_300_min_ago or ma100_last < ma450_last)
                    and deviation_ma50_sotto_ma100 < -0.45
                    
                    and deviation_ma39 < -0.14
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma25_sotto_ma300 < -0.40
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.085
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 con 450< or 100<450 - r 4685 BY 1y Y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    #  7 mag 2025 aggiunta questa
                    #  7 mag 2025 COMPRA SE 50<100 DI MOLTO e ANCHE 3<50 DI MOLTO (e va bene cosi')
                    # 16 aggiunte parentesi graffe sulla stessa riga e condizioni parentesi graffe



                elif (    
                    ma3_last > ma18_last
                    and (ma450_last < ma450_300_min_ago or ma100_last < ma450_last)

                    and (deviation_ma50_sotto_ma100 > -0.15 and deviation_ma3_sotto_ma50 < -0.50)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 2 con 450 < or 100<450 - r 4685 BY 1y Y2"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last  
                    # tolta and ma2_last >= ma2_2_min_ago !
                    #  9 ott 2022 69>200 da 78>200
                    # 12 ott 2022 7-40 0.04 da 0.05
                    # 18 nov 2022 5-28 0.11
                    # 11 gen 2023 5-28 a 0.10 da 0.11
                    # 11 gen 2023 3-10 a 0.04 da 0.05
                    # 26 apr 2026 anticipato ndecchia
                    # 29 apr 2025 tolto 39>100

                    #  7 mag 2025 aggiunta questa
                    #  7 mag 2025 COMPRA ANCHE SE 50<100 NON DI MOLTO MA 3<50 (deve essere) DI MOLTO ! (ro cano vuole l' osso !)
                    #  7 mag 2025 questo e' un modo per evitare BUY non appena comincia a scendere ! cazzo ! 





                elif (    
                    ma3_last > ma18_last

                    and ma450_last > ma450_720_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma39 < -0.14
                    and deviation_ma3_sotto_ma50 < -0.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma300_sopra_ma450 < 0.40
                    and deviation_ma300_sopra_ma450 > -0.40
                    
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and ma100_last < ma125_last
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    
                    and macd_differenza_2_min_ago > -8.50
                ):
                    buy = "BUY 2 LATERALE con ma450_last > ma450_720_min_ago - r 4685 BY 2A X1"
                    action = "buy"
                    percentage = 80

                    # 14 apr 2025 anticipata ma proprio di una ndecchiecella
                    # 14 apr 2025 aggiunta and deviation_ma39 < -0.14
                    # 14 apr 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.22
                    # 14 apr 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13 
                    # 12 mag 2025 3-50 a -0.50 da -0.22



                elif (    
                    ma3_last > ma18_last
                    and ma450_last > ma450_720_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and ma39_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.28

                    and deviation_ma300_sopra_ma450 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.20
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and ma100_last < ma125_last
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 2 LATERALE con ma450_last > ma450_720_min_ago MA 39<100 + distanza al ribasso - r 4685 BY 2A X2"
                    action = "buy"
                    percentage = 80

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 21 mar 2025 tolta and macd > -60
                    # 21 mar 2025 se ma39_last < ma100_last aggiunta and deviation_ma3_sotto_ma50 < -0.28 - distanza al ribasso



                
                elif (    
                    ma8_last > ma54_last
                    and ma450_last < ma450_720_min_ago
                    
                    and ma450_last > ma450_480_min_ago
                    and ma59_last >= ma59_2_min_ago
                    and deviation_ma300_sopra_ma450 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.20
                    
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and ma100_last < ma125_last
                    
                    and deviation_ma3_sopra_ma10 > 0.04
                    and deviation_ma3_sopra_ma16 > 0.077
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.08
                    
                    and price >= price_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 LATERALE con ma450_last < ma450_720_min_ago and ma69_last > ma200_last - r 4685 BY 2A Y"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last  
                    # tolta and ma2_last >= ma2_2_min_ago !
                    #  9 ott 2022 69>200 da 78>200
                    # 12 ott 2022 7-40 0.04 da 0.05
                    # 18 nov 2022 5-28 0.11
                    # 11 gen 2023 5-28 a 0.10 da 0.11
                    # 11 gen 2023 3-10 a 0.04 da 0.05

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIBASSO
                    

                    
                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 80
                  

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 80
                  

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma5_last > ma50_last
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 80
                  

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 80
                  

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 80
                  

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.30
                    and ma3_last > ma54_last
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and ma3_last > ma39_last
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80
                    
                    # 13 dic 2023 aggiunta and macd_differenza_2_min_ago > -3
                    # 30 dic 2023 anticipata ndecchiecella


                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma3_last > ma39_last
                    
                    and ma450_last > ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and price >= price_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2 BX NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 80
                    
                    # 13 dic 2023 aggiunta and macd_differenza_2_min_ago > -3
                    # 30 dic 2023 anticipata ndecchiecella




       
                elif (    
                    ma3_last > ma28_last

                    and delta_150_100 <= delta_150_100_60_min

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.11
                    
                    
                    and ma450_last < ma450_180_min_ago
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma300_sopra_ma450 > -0.30
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    
                    and price >= price_2_min_ago
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = f"BUY 2A laterale - r 4685 BY 2B y NUOVA ERA A1 SOFT - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 15 ott 2025 anticipata ndecchiecella
                    # 15 ott 2025 aggiunte p.g.
                    # 15 ott 2025 aggiunte and delta_150_100 <= delta_150_100_60_min



                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma450_last < ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.20
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.11
                    
                    and price >= price_2_min_ago
                    and macd_differenza_2_min_ago > -1.7
                    
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2B y NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 80




                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma450_last < ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25
                    
                    and deviation_ma100_sopra_ma300 < 0.20

                    and deviation_ma39 < -0.02
                    and deviation_ma3_sopra_ma10 > -0.01
                    
                    and macd_differenza_2_min_ago > -18.5
                    
                ):
                    buy = "BUY 2 laterale - r 4685 BY 2B y NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 80

                    # 27 mar 2025 and deviation_ma39 < -0.02



                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma450_last < ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.20
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.11
                    
                    and price >= price_2_min_ago
                    and macd_differenza_2_min_ago > -1.7
                    
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2B y NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and ma3_last > ma54_last
                    
                    and ma450_last < ma450_180_min_ago
                    
                    and ma450_last < ma450_480_min_ago
                    and ma100_last < ma125_last
                    
                    and deviation_ma300_sopra_ma450 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.20
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.11
                    
                    and price >= price_2_min_ago
                    and macd_differenza_2_min_ago > -1.7
                    
                ):
                    buy = "BUY 2A laterale - r 4685 BY 2B y NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 80

                
                elif (    
                    ma3_last > ma15_last

                    and ma450_last < ma450_180_min_ago
                    and ma450_last < ma450_480_min_ago
                    and deviation_ma3_sotto_ma50 < -1.20

                    and ma100_last < ma125_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 2 con ma450_last < ma450_180_min_ago E deviation_ma3_sotto_ma50 < -1.20 - r 4685 BY 2B y NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    
                    # tolta and ma2_last >= ma2_2_min_ago !
                    #  9 ott 2022 69>200 da 78>200
                    # 12 ott 2022 7-40 0.04 da 0.05
                    # 18 nov 2022 5-28 0.11
                    # 11 gen 2023 5-28 a 0.10 da 0.11
                    # 11 gen 2023 3-10 a 0.04 da 0.05
                    # 11 ago 2023 8-39
                    # 17 nov 2023 macd >2 min ago e' arrivato tardi !
                    # 17 nov 2023 gli ho detto basta che il macd di adesso rispetto a quello di 2 min fa NON SCENDE TROPPO ! (and macd_differenza_2_min_ago > -1.7)
                    #  7 apr 2025 SE ma450_last < ma450_180_min_ago and deviation_ma3_sotto_ma50 < -1.20

              
                    
                
                elif (    
                    ma3_last > ma15_last

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.20

                    and ma39_last < ma100_last

                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma50_sotto_ma300 < -0.60

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma5_sotto_ma200 < -0.37
                    and deviation_ma5_sotto_ma300 < -0.57
                    and deviation_ma5_sotto_ma450 < -0.87

                    and ma450_last > ma450_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    

                    and deviation_ma3_sopra_ma10 > -0.005
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > -50
                    and macd_differenza_2_min_ago > -3.25
                      
                ):
                    buy = "BUY 2A ribasso o laterale and ma78_last < ma200_last + DNAM - r 4709 B"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last
                    # roma aggiunta 5-28
                    #  3 ott 2024 aggiunto cane STAF
                    #  5 ott 2024 aggiunta zia amalia
                    #  1 dic 2024 DNAM
                

                # BUY 2 CHE MANCAVA con 150-100 GIORNO !
                
                elif (    
                    ma5_last > ma30_last
                    and ma5_last > ma100_last

                    and ma300_last >= ma300_10_min_ago
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma78_last < ma200_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and delta_150_100 <= delta_150_100_60_min
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 con 150-100 GIORNO CHE MANCAVA DOPO BUY-SELL CROLLO ! and 3-10 > 0.01 and macd > macd 2 min ago - r 4710"
                    action = "buy"
                    percentage = 80
                    
                    # madonna compa ! 
                    # the sound of silence
                    # ASSURDO ! questa 100 > 100 3 min e' incredibile ! si e' verificata dopo il BUY-SELL del crollo ! NON TOCCARE
                    # SI STA RIDUCENDO LA DISTANZA TRA 150 E 100
                    
                    # 10 giu 2022 5-28 0.12 da 0.09 cazzo
                    #  2 lug 2022 3-10 0.15 da 0.05 cazzo
                    # > estate 5-28 0.18 da 0.12 e 3-10 0.15 da 0.05 HO ALZATO IL BUY !
                    # 7 nov 2022 aggiunta 59 > 59 45 min ago
                    # aggiunta 31 ago 2023 rccr ok m ko
                    # 28 set 2023 anticipata ndecchiecella
                    #  9 set 2024 fatta piccola modifica MA FORSE E' DA CANCELLARE
                    # 21 set 2024 fatta altra modifica forse da cancellare


                

                
                elif (    
                    ma3_last > ma18_last

                    and (ma39_last < ma100_last or ma100_last < ma100_10_min_ago)
                    and deviation_ma3_sotto_ma50 < -0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.13
                    

                    and ma300_last < ma300_180_min_ago
                    
                    and ma450_last > ma450_720_min_ago

                    and deviation_ma300_sopra_ma450 < 0.02
                    and deviation_ma300_sopra_ma450 > -0.02
                    
                    and deviation_ma100_sopra_ma300 < 0.35
                    and deviation_ma100_sopra_ma300 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd > -100
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 2 TREND LATERALE MA 39<100 or 100 scende da 10 min - ritracciamento - r 4711"
                    action = "buy"
                    percentage = 80

                    # 12 mag 2025 aggiunta questa che mancava
                    # 27 mag 2025 e' andata molto bene




                elif (    
                    ma3_last > ma18_last
                  
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.15
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd > -30
                    and macd_differenza_2_min_ago > 1.30
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND dev 4-18 and deviation_ma3_sopra_ma16 > 0.12 - r 4713 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70
                    
                    #  3 nov 2023 tolto macd ! al buy 2
                    # 3 nov 2023 mi basta che macd > -3
                    #  3 nov 2023 and deviation_ma3_sopra_ma16 > 0.08 da 0.12
              

                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.15
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd > -30
                    and macd_differenza_2_min_ago > 1.30
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND dev 4-18 and deviation_ma3_sopra_ma16 > 0.12 - r 4713 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 70
                    
                    #  3 nov 2023 tolto macd ! al buy 2
                    # 3 nov 2023 mi basta che macd > -3
                    #  3 nov 2023 and deviation_ma3_sopra_ma16 > 0.08 da 0.12

              

                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.15
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND dev 4-18 and deviation_ma3_sopra_ma16 > 0.12 - r 4713 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 70
                    
                    #  3 nov 2023 tolto macd ! al buy 2
                    # 3 nov 2023 mi basta che macd > -3
                    #  3 nov 2023 and deviation_ma3_sopra_ma16 > 0.08 da 0.12
               

          
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.15
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd > -30
                    and macd_differenza_2_min_ago > 1.30
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND dev 4-18 and deviation_ma3_sopra_ma16 > 0.12 - r 4713 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70
                  

                elif (    
                    ma3_last > ma18_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    and deviation_ma5_sopra_ma28 > -0.15
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 2 migliore con ma450_last < ma450_450_min_ago - r 4713 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    #  3 nov 2023 tolto macd ! al buy 2
                    #  3 nov 2023 mi basta che macd > -3
                    #  3 nov 2023 and deviation_ma3_sopra_ma16 > 0.08 da 0.12
                    #  3 mar 2025 sarebbe da fare continua a scendere DNA ma e' andata bene in fondo alla discesa e me la tengo !

                
                elif (    
                    ma3_last > ma18_last
                    and delta_300_200 > delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -1.20

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15

                    and ma100_last < ma100_10_min_ago

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                  
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma5_sopra_ma28 > -0.16
                    
                    
                    and macd_differenza_2_min_ago > -5.25
                ):
                    buy = "BUY 2 NOTTE che considera distanza 5-300 AND dev 10-200 < -0.24 AND cano STAF - r 4713 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    #  3 nov 2023 tolto macd ! al buy 2
                    #  3 nov 2023 mi basta che macd > -3
                    #  3 nov 2023 and deviation_ma3_sopra_ma16 > 0.08 da 0.12
                    # 11 set 2024 anticipata ndecchiecella
                    #  2 ott 2024 se 300< allora aggiunta solo sul BUY 2 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15 da cano STAF
                    #  2 ott 2024 cioe' ma100 decresce ma non cosi' tanto ! 
                    # 27 gen 2025 se NOTTE aggiungo and deviation_ma25_sotto_ma300 < -1.20
                    
                elif (
                    
                    ma3_last > ma28_last
                    and ma10_last >= ma20_last
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.21
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and delta_100_200_last < delta_100_200_120_min_ago

                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 9
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd > -11
                    and macd_differenza_2_min_ago > 1.00
                    
                ):
                    buy = "BUY 2 24 feb 2024 > 180 min di ribasso con 4-28 5-100 < -0.21 SE doppio delta 100-200 GIORNO - r 4714"
                    action = "buy"
                    percentage = 90


                    

                elif (
                    ma3_last > ma18_last
                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma39_sotto_ma100 > -0.15



                    and ma50_last < ma50_2_min_ago

                    and deviation_ma25_sotto_ma300 < -1.20
                    and deviation_ma50_sopra_o_sotto_ma300 < -0.70

                    and deviation_ma39 < -0.025
                    and deviation_ma3_sotto_ma50 < -0.10

                    and deviation_ma5_sotto_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and price > price_2_min_ago
                    and macd >= -70
                ):
                    buy = "BUY 2 con DNAM + continua a scendere - r 4732 A"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last
                    # 18 set aggiunta 3-10 ! 0.11
                    #  1 dic 2024 aggiunta DNAM
                    # 26 feb 2025 aggiunta continua a scendere


                
                elif (
                    ma78_last < ma78_2_min_ago
                    and deviation_ma5_sotto_ma300 < -0.59
                    and delta_1 < delta_2
                    
                    and ma5_last > ma15_last
                    and deviation_ma3_sopra_ma10 > 0.15
                    
                    and ma2_last > ma2_2_min_ago
                    and price > price_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 durante crollo - 5 sotto 300 di molto ! PIU' AGGRESSIVO (delta 1 < delta 2) (ma100 sta risalendo) - r 4732 b1"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last
                    
                    
                    
                elif (
                    ma78_last < ma78_2_min_ago
                    and deviation_ma5_sotto_ma300 < -0.59
                    and delta_1 > delta_2
                    
                    and ma5_last > ma15_last
                    and deviation_ma3_sopra_ma10 > 0.15
                    
                    and deviation_buy2 > 0.04
                    and deviation_bellissima > 0.06
                    and deviation_ma13_sopra_ma25 > 0.03
                    and deviation_buy_ma3_sopra_ma13 > 0.03
                    and deviation_ma7_sopra_ma40 > 0.04
                    
                    and ma2_last > ma2_2_min_ago
                    and price > price_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2  durante crollo - 5 sotto 300 di molto ! PIU' PRUDENTE (delta 1 > delta 2) (ma100 si allontana verso il basso da ma200)- r 4732 b2"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_ma3_sopra_ma13 > x e' fondamentale !
                    # deviation_buy2 = ma8_last/ma50_last
                    
                    
            
                ##################################################################################
                ##################################################################################
                
                
                
                # BUY 2 con ma200> piccola CORREZIONE FIAT che NON E' un forte ribasso e NON E' un crollo ! ALTRA RIGA RCCR che e' andata bene.
                elif (     
                    ma200_last > ma200_20_min_ago
                    and ma10_last > ma20_last
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_360_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma20_last < ma78_last
                    and ma90_last > ma110_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.02
                    
                    and ma5_last >= ma5_2_min_ago
                    
                    and ma3_last > ma28_last
                    
                    and ma2_last > ma2_2_min_ago
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 1.25
                ):    
                    
                    buy = "BUY 2 con 300 > 300 360 min ago and ma5_last > ma5_2_min_ago - 20 < 78 and 3-10 > 0.05 con 5-28 > 0.05 E con dev ma2 e diff macd - r 4735 a"
                    action = "buy"
                    percentage = 80
                    
                    # 29 dic 2023 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    # 29 dic 2023 and macd_differenza_2_min_ago > 1.25

                
                elif (     
                    ma200_last > ma200_20_min_ago
                    and ma10_last <= ma20_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_360_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma20_last < ma78_last
                    and ma90_last > ma110_last
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > 0.05
                    
                    and ma5_last >= ma5_2_min_ago
                    
                    and ma3_last > ma28_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    
                    buy = "BUY 2 con 300 > 300 360 min ago E 20 < 78 CON prendi il coltello con il piede E con macd> macd 2 min ago - r 4735 b"
                    action = "buy"
                    percentage = 80
                    
                    #  > estate anticipato buy di una ndecchiecella
                    #  2 nov 2022 anticipato di molto con 300 > 360 min ago !
                    #  2 nov 3-10 = 0.05 da 0.17
                    #  2 nov 5-28 = 0.05 da 0.15
                    # 28 set 2023 5> 5 2 min ago da 28> 28 min ago (ma300 sale da 360 min !)
                    # 23 set 2024 aggiunta di prendi il coltello con il piede
                    
                elif (
                    
                    ma8_last > ma59_last
                    and deviation_ma5_sopra_ma59 < -0.12
                    
                    
                    and deviation_ma10_sopra_ma200 < -0.25
                    and deviation_ma10_sopra_ma200 > -0.40
                  
                    and deviation_ma100_sopra_ma200 > -0.40
                    
                    and deviation_ma5_sotto_ma300 < 0.45
                    and deviation_ma5_sotto_ma300 > -0.75
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-59 - da buy 1 riga 1043 B  - r 4742"
                    action = "buy"
                    percentage = 50
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    
                    # 21 ottobre 2022  aggiunta di 3-10 e 5-28
                    # 21 ottobre 2022 3-10 = 0.01
                    # 21 ottobre 2022 5-28 = 0.05
                    # 28 ottobre 2022 5-28 = 0.04
                    # ave comba
                    # 31 ottobre aggiunta dev 10-200 - formula MY COMPA
                    # 12 dic 2022 8-59 da 8-50 e aggiungo pensiero laterale (condizione sotto)
                    # 22 dic 2022 and deviation_ma5_sopra_ma59 < -0.10
                    
                    
                    
                    
                    
                    
                    
                # BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-50 - formula MY COMPA (importata dal BUY 1 r 1043 B)
                
                elif (
                    
                    ma3_last > ma39_last
                    and delta_1 < delta_2

                    and deviation_ma5_sotto_ma300 < -0.40

                    and deviation_ma10_sopra_ma200 < -0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.03
                   
                    and macd_differenza_2_min_ago > -1.25
                ):
                    buy = "BUY 2 che considera distanza 5-300 AND dev 10-200 < -0.30 AND 3-39 E dif MACD - formula MY COMPA - r 4743 A"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    
                    # 21 ottobre 2022  aggiunta di 3-10 e 5-28
                    # 21 ottobre 2022 3-10 = 0.01
                    # 21 ottobre 2022 5-28 = 0.05
                    # 28 ottobre 2022 5-28 = 0.04
                    # ave comba
                    # 31 ottobre aggiunta dev 10-200 - formula MY COMPA
                    # 19 gen 2023 doppio delta 200 100 giorno
                    # 11 ott 2023 5-39 da 8-50
                    # 11 ott 2023 5-28 a 0.02 da 0.04
                    #  6 dic 2023 and deviation_ma5_sopra_ma28 > -0.02 da 0.02
                    #  6 dic 2023 ma4_last > ma39_last da 5-39
                    # 10 set 2024 MODIFICATA
                    # 20 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 20 gen 2025 and macd_differenza_2_min_ago > -1.25 da 1.25



              
                
                elif (    
                    ma3_last > ma13_last
                    
                    and delta_1 > delta_2
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25
                    
                    and deviation_ma10_sopra_ma200 < -0.25
                    and deviation_ma10_sopra_ma200 > -0.40
                  
                    and deviation_ma5_sotto_ma300 < 0.45
                    and deviation_ma5_sotto_ma300 > -0.75
                    
                    and deviation_ma3_sopra_ma10 > 0.01

                    and ma3_last >= ma3_2_min_ago
                    and price > ma4_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-50 - formula MY COMPA - r 4743 B"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    
                    # 21 ottobre 2022  aggiunta di 3-10 e 5-28
                    # 21 ottobre 2022 3-10 = 0.01
                    # 21 ottobre 2022 5-28 = 0.05
                    # 28 ottobre 2022 5-28 = 0.04
                    # ave comba
                    # 31 ottobre aggiunta dev 10-200 - formula MY COMPA
                    # 19 gen 2023 doppio delta notte compra ma piu' difficile
                    # 21 apr 2023 aggiunta ma3 > ma3 2 min ago
                    # 21 apr 2023 price > ma4 !
                    #  7 apr 2025 anticipato ndecchiecella
                    #  7 apr 2025 aggiunto and deviation_ma39 < -0.17
                    #  7 apr 2025 aggiunto and deviation_ma3_sotto_ma50 < -0.25
                
                    
                # BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-50 - formula MY COMPA (importata dal BUY 1 r 1043 B)
                
                elif (
                    
                    ma3_last > ma13_last
                    and deviation_ma3_sotto_ma50 < -0.25
                    
                    and deviation_ma10_sopra_ma200 < -0.25
                    and deviation_ma10_sopra_ma200 > -0.40
                  
                    and deviation_ma100_sopra_ma200 > -0.40
                    
                    and deviation_ma5_sotto_ma300 < 0.45
                    and deviation_ma5_sotto_ma300 > -0.75
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.03
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 2 con distanza 5-300 e dev 10-200 < -0.24 AND 8-50 - formula MY COMPA - r 4743 C"
                    action = "buy"
                    percentage = 80
                    
                    # 30 ago 2023 and macd > 3 min ago
                    # 30 ago 2023 and macd > 1
                    #  2 apr 2025 and deviation_ma3_sotto_ma50 < -0.25

                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 IMPORTATA da BUY 1 r 1043 B2 considera distanza 5-300 E dev 10-200 < -0.24 E dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 4760 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 50
                    
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago


                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma5_last > ma50_last
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 IMPORTATA da BUY 1 r 1043 B2 considera distanza 5-300 E dev 10-200 < -0.24 E dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 4760 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 50
                    
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago
  

                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 IMPORTATA da BUY 1 r 1043 B2 considera distanza 5-300 E dev 10-200 < -0.24 E dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 4760 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 50
                    
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago


                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 IMPORTATA da BUY 1 r 1043 B2 considera distanza 5-300 E dev 10-200 < -0.24 E dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 4760 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 50
                    
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago


                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 7
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 IMPORTATA da BUY 1 r 1043 B2 considera distanza 5-300 E dev 10-200 < -0.24 E dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 4760 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 50
                    
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago


                elif (    
                    ma3_last > ma13_last


                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma5_sotto_ma450 < -0.50
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    and deviation_ma3_sopra_ma16 > -0.125
                    and deviation_ma5_sopra_ma28 > -0.155
                   
                ):
                    buy = "BUY 2  distanza 5-300 E dev 10-200 < -0.24 E dev 3-18 and dev_ma3_sopra_ma16 > -0.125 - r 4760 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80

                    #  3 feb 2025 anticipata ndecchiecella
                    #  3 feb 2025 and deviation_ma5_sotto_ma300 < -0.40 da < -0.30


                
                elif (    
                    ma3_last > ma13_last

                    and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.35
                    and deviation_ma5_sotto_ma450 < -0.30

                    and deviation_ma10_sopra_ma200 < -0.30

                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.125
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = f"BUY 2 che considera 5-300 E dev 10-200 < -0.24 - r 4760 NUOVA ERA A3 STRONG - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 80
                    
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago
                    #  7 apr 2025 tolte sovrastrutture per anticipare
                    # 13 apr 2025 piccola modifica - aggiunto anche and deviation_ma10_sopra_ma200 < -0.30

                    #  8 ott 2025 aggiunta and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago
                    #  8 ott 2025 aggiunte parentesi graffe
                    
                    
                    
                    
                    ###########################################################################################
                    ###########################################################################################
                    
                    
                
                elif (    
                    ma3_last > ma18_last

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.156

                    and deviation_ma39 < -0.25
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.80
                    and deviation_ma25_sotto_ma300 < -1.45
                    
                    and ma100_last < ma300_last
                    and ma100_last < ma200_last

                ):
                    buy = "BUY 2 > grande ribasso 29 mag 2025 aggiunta da un sell con parentesi graffe - grazie compa ! - r 4763"
                    action = "buy"
                    percentage = 90

                    #  6 ago 2025 ok
                    #  6 ago 2025 ko
                    #  6 ago 2025 aggiunta and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)




                # BUY 2C ( SOPRA and DOPPIO DELTA < 1 and 100> ) (ribasso-rialzo) - CREPUSCOLO and deviation_ma5_sopra_ma28 > 0.14

                elif (
                    deviation_buy2 > 0.10
                    and ma100_last > ma100_60_min_ago
                  
                    
                    and delta_1 > delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.16
                    and deviation_ma5_sopra_ma28 > 0.14
                 
                    and deviation_bellissima > 0.12
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C (SOPRA) (delta1 > delta2 and 100 > ) - CREPUSCOLO - and dev_ma5_sopra_ma28 > 0.14 AND 3-10 > 0.16 - r 4765"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    
                    
                
                
                
                # BUY 2 300 > 120 min ago e 200> con doppio delta > 1 trend ribasso and deviation_ma5_sopra_ma28 > 0.16
                
                
                elif (
                    deviation_buy2 > 0.08
                    and ma300_last > ma300_720_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.20
                    
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.05
                    and ma4_last > ma9_last
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C SOPRA RIBASSO RIBASSO - NOTTE con 5-28 0.20 - r 4796 A1"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    # > estate ho alzato buy
                    # 11 ott 2022 5-28 0.17 da 0.15
                    # 20 ott 2022 5-28 0.20 da 0.17
                    # 23 feb 2023 buy2 0.08 da 0.10
                    
                    
                elif (
                    deviation_buy2 > 0.10
                    and ma300_last < ma300_720_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.20
                    and deviation_bellissima > 0.12
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and ma4_last > ma9_last
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C SOPRA RIBASSO RIBASSO - NOTTE con 5-28 0.20 - r 4796 A2"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    # > estate ho alzato buy
                    # 11 ott 2022 5-28 0.17 da 0.15
                    # 20 ott 2022 5-28 0.20 da 0.17
                    
                    
                # BUY 2 300 > 120 min ago MA 200< con doppio delta > 1 trend ribasso and deviation_ma5_sopra_ma28 > 0.19
                
                elif (
                    deviation_buy2 > 0.12
                    and ma300_last > ma300_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.18
                    
                    and deviation_bellissima > 0.15
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C SOPRA RIBASSO RIBASSO - NOTTE - r 4796 A"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    # > estate ho alzato buy
                    
                    
                 
                    
                # BUY 2 300 < 120 min ago con doppio delta > 1 trend ribasso and deviation_ma5_sopra_ma28 > 0.16
                
                elif (
                    deviation_buy2 > 0.10
                    and ma300_last < ma300_120_min_ago
                    and deviation_buy_ma2_sopra_ma5 > 0.27
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and deviation_bellissima > 0.12
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C SOPRA RIBASSO RIBASSO - NOTTE - r 4827"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    
                    # incredibile :  anticipa con 300 < 120 min ago
                    
                    
                    
                    
                # BUY 2C dopo grande rialzo e grande ribasso 
                
                elif (
                    deviation_buy2 > 0.09
                    
                    and deviation_ma5_sotto_ma200 > 0.05
                    
                    and deviation_ma3_sopra_ma10 > 0.15
                    and deviation_ma5_sopra_ma28 > 0.30
                    
                    and ma200_last > ma200_120_min_ago
                    
                    and ma5_last > ma18_last
                    
                    and ma100_last < ma100_50_min_ago
                    and deviation_bellissima > 0.165
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C dopo grande rialzo e grande ribasso - r 4858 a"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    
                    
                    
                # BUY 2C dopo grande rialzo e grande ribasso
                
                elif (
                    deviation_buy2 > 0.09
                    
                    and deviation_ma5_sotto_ma200 < 0.05
                    and deviation_ma5_sotto_ma200 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.32
                    
                    and ma200_last > ma200_120_min_ago
                    
                    and ma5_last > ma18_last
                    
                    and ma100_last < ma100_50_min_ago
                    and deviation_bellissima > 0.165
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C dopo grande rialzo e grande ribasso - r 4858 b"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    
                # BUY 2C dopo grande rialzo e grande ribasso
                
                elif (
                    deviation_buy2 > 0.09
                    
                    and deviation_ma5_sotto_ma200 < -0.35
                    
                    and deviation_ma3_sopra_ma10 > 0.15
                    and deviation_ma5_sopra_ma28 > 0.30
                    
                    and ma200_last > ma200_120_min_ago
                    
                    and ma5_last > ma18_last
                    
                    and ma100_last < ma100_50_min_ago
                    and deviation_bellissima > 0.165
                    
                    and deviation_buy_ma3_sopra_ma13 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma40_last
                    and ma4_last > ma78_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2C dopo grande rialzo e grande ribasso - r 4858 c"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50



                elif (
                    ma3_last > ma8_last
                    and deviation_ma39 < -1.00
                    and deviation_buy_crollo_1 < -1.61
                    and deviation_ma25_sotto_ma300 < -2.00
                    and ma78_last < ma300_last

                ):
                    buy = "BUY 2 CROLLO FERRARI senza sovrastrutture con 3-8 and macd > - modo 2 and ma78_last < ma300_last - r 4880"
                    action = "buy"
                    percentage = 80

                    #  3 feb 2025 nuova condizione crollo ferrari senza sovrastrutture !

                    #  3 feb 2025 con 3-39 < -1.00 compra con 3-8 da 4-11
                    #  3 feb 2025 deviation_buy_crollo_1 = ma8_last / ma78_last
                    #  3 feb 2025 BUY in purezza in uno scenario drammatico il macd scendeva ma il prezzo saliva !!!
                    #  3 feb 2025 devi dare un paio di colpitogliendo tutte le sovrastrutture ma2 e macd
                    #  3 feb 2025 and deviation_ma39 < -1.00
                    #  3 feb 2025 and deviation_buy_crollo_1 < -1.61
                    #  3 feb 2025 and deviation_ma25_sotto_ma300 < -2.00
                    
                
             
                
                

                
                
                elif (    
                    ma3_last > ma13_last

                    and ma100_last < ma100_60_min_ago
                    and ma50_last < ma50_2_min_ago

                    and deviation_ma200_sotto_ma300 < -0.03


                    and deviation_ma39 < -0.06
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma25_sotto_ma300 < -0.38
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.035

                    and delta_1 > delta_2
                    
                        
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                        
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 - NOTTE - IMPORTATO DA SELL 2 RCCR - modificato - osso or avvicinamento - r 4887 a - {deviation_ma39} {deviation_ma3_sotto_ma50} {deviation_ma5_sopra_o_sotto_ma100} {deviation_ma25_sotto_ma300} {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    
                    action = "buy"
                    percentage = 80

                    # 29 apr 2025 aggiunta osso or avvicinamento 
                    # 29 apr 2025 aggiunta and deviation_ma200_sotto_ma300 < -0.03
                    # 10 ago 2025 anticipato ndecchiecella
                    # 30 set 2025 aggiunte parentesi graffe vediamo se funzionano (stanno tutte sulla stessa riga)


                elif (
                    ma50_last < ma50_2_min_ago

                    and ma450_last < ma450_480_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.023

                    and delta_1 > delta_2
                    and deviation_ma25_sotto_ma300 < -1.20
                    and deviation_ma50_sopra_o_sotto_ma300 < -0.70

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma5_sotto_ma200 < -0.20
                  
                    and ma3_last > ma18_last
                    
                    and ma100_last < ma100_60_min_ago
                        
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                        
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 2 ORIGINALE CHE CI RIPROVA IMPORTATO DA SELL 1 ! - NOTTE - prende il coltello con il piede + OSSO - r 4887 b"
                    action = "buy"
                    percentage = 80

                    # 16 set 2024 aggiunta and deviation_ma50_sopra_o_sotto_ma300 < -0.30
                    # 20 set 2024 ho aggiunto prendi il coltello con il piede
                    # 15 ott 2024 aggiunto osso (anche 5 sotto 200 ! e 25 sotto 300)
                    #  5 nov 2024 aggiunta zia amalia
                    # 27 gen 2025 se NOTTE and deviation_ma25_sotto_ma300 < -1.20 da < -0.70
                    # 11 mar 2025 anticipata ndecchiecella togliendo ma2 > ma2 2 min ago e macd > -50
                    # 12 mar 2025 se ma450_last < ma450_480_min_ago allora and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.023



                        
                # BUY 2 DURANTE UN RIBASSO AUDI CHE NON E' UN CROLLO ! E CHE CI RIPROVA (compare stammi vicino!)
                
                elif (
                    
                    deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    
                    and ma5_last > ma28_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 DURANTE UN RIBASSO AUDI CHE NON E' UN CROLLO ! E CHE CI RIPROVA con 5 > 28 - riga 4905"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    
                    # 19 giu 2022 dev_5-16 a 0.08 da 0.09
                    # 9 luglio ho messo 5>22 perche' cosi' e' chiaro chi interviene e comunque 5-16 >0.08 era arrivata molto tardi e 5-16 arriva una ndecchia prima
                    
                    # > estate 5-28 da 5-22
                    
                    
                    
                   
                # IL BUY 2 CI RIPROVA CON INCROCIO 8-50
                
                elif (
                    deviation_buy2 > 0.01
                    and ma100_last > ma100_50_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last > ma300_301_min_ago
                    
                    
                    
                    and (ma8_prev < ma50_prev and ma8_last > ma50_last)
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 con INCROCIO 8-50 con 100< and 200< MA 300 > 300 301 min ago - r 4906 A"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy2 = ma8_last / ma50
                    # incrocio va bene nel trend laterale NON TOCCARLO ! ho messo incrocio per evitare punti sopvrapposti
                    # 1 feb 2023 aggiunto 5-28 > 0.12


                    
                    
                # BUY 2 CHE CI RIPROVA
                
                elif (
                    ma3_last > ma20_last
                    and (ma3_prev < ma18_prev and ma3_last > ma18_last)

                    and ma100_last < ma100_50_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last > ma300_301_min_ago

                    and deviation_ma39 < -0.22
                    and deviation_ma3_sotto_ma50 < -0.20
                    and deviation_ma50_sotto_ma100 < -0.15

                    and deviation_ma3_sopra_ma10 > 0.01
                   
                    and macd_differenza_2_min_ago > -18.50
                ):
               
                    buy = "BUY 2 con INCROCIO 3-20 con 100< and 200< MA 300 > 300 301 min ago - r 4906 B"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy2 = ma8_last / ma50
                    # incrocio va bene nel trend laterale NON TOCCARLO ! ho messo incrocio per evitare punti sopvrapposti
                    #  1 feb 2023 aggiunto 5-28 > 0.12
                    # 19 mag 2025 3-39 < -0.22
                    # 19 mag 2025 3-50 < -0.20
                    # 19 mag 2025 dev 50-100 < -0.15
                    
                    
                # IL BUY 2 CI RIPROVA CON INCROCIO 8-50
                
                elif (
                    deviation_buy2 > 0.005
                    and ma50_last > ma100_last
                    
                    and deviation_ma100_sopra_ma300 > -0.60
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma18 > 0.13
                  
                    and ma200_last < ma200_120_min_ago
                    
                    and ma100_last < ma100_50_min_ago
                    and (ma7_prev < ma50_prev and ma7_last > ma50_last)
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 con 100< and 200< con INCROCIO 7-50 100 NON DISTANTE DA 300 - r 4934 A"
                    action = "buy"
                    percentage = 80
                    
                    #  2 mag 2023 aggiunta 3-18 >0.13
                    
                    
                # IL BUY 2 CI RIPROVA CON INCROCIO 8-50
                
                elif (
                    deviation_buy2 > 0.005
                    and ma50_last > ma100_last
                    
                    and deviation_ma100_sopra_ma300 < -0.60
                    and deviation_ma3_sopra_ma10 > 0.17
                    
                    and ma200_last < ma200_120_min_ago
                    
                    and ma100_last < ma100_50_min_ago
                    and (ma7_prev < ma50_prev and ma7_last > ma50_last)
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2C con 100< and 200< con INCROCIO 7-50 100 MOLTO SOTTO 300 CON 3-10 > 0.17 QUA DEVE DIMOSTRARE UNA CERTA FORZA ! - r 4956 b"
                    action = "buy"
                    percentage = 80
                    
                  
            
            
                # BUY 2 con 100< and 200< con INCROCIO 7-50 PIU' FORTE (SOPRA -CRESCE-DIMINUISCE) aurora
                
                elif (
                    deviation_buy2 > 0.01
                    
                    
                    and delta_1 < delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.10
                    
                    and ma50_last < ma100_last
                    
                    
                    and ma200_last < ma200_120_min_ago
                    
                    and ma100_last < ma100_50_min_ago
                    and (ma7_prev < ma50_prev and ma7_last > ma50_last)
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 con 100< and 200< con INCROCIO 7-50 and 5-28 > 0.10 (SOPRA - aurora - r 4989"
                    action = "buy"
                    percentage = 80
                    
                    # 6 giu 2022 5-28 a 0.10 da 0.07
                    
                    
                    
                    
                # BUY 2 con 100< and 200< con INCROCIO 7-50 PIU' FRAGILE (SOPRA DIMINUISCE DIMINUISCE) notte
                
                elif (
                    deviation_buy2 > 0.01
                    
                    
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.29
                    
                    and ma50_last < ma100_last
                    
                    and ma200_last < ma200_120_min_ago
                    
                    and ma100_last < ma100_50_min_ago
                    and (ma7_prev < ma50_prev and ma7_last > ma50_last)
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 con 100< and 200< con INCROCIO 7-50 and 5-28 > 0.29 - NOTTE! - r 5018"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy2 = ma8_last / ma50
                    # incrocio va bene nel trend laterale NON TOCCARLO ! ho messo incrocio per evitare punti sopvrapposti
                    
                    
                    
                    
                
                
                # BUY 2 DURANTE UN RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO ! 22 ago 2022
                
                
                elif (
                    deviation_ma300_sopra_ma450 > 0.15
                    
                    and deviation_buy_crollo_1 < -0.60
                    and deviation_buy_crollo_1 > -1.60
                    
                    and ma4_last > ma15_last
                    and deviation_ma3_sopra_ma10 > 0.125
                    and deviation_ma5_sopra_ma16 > 0.09
                    
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 DURANTE UN RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO ! 22 ago 2022 - r 5019 A"
                    action = "buy"
                    percentage = 50
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # 16 mar 2023 aggiunta 3-10 > 0.125 3-10 deve stare sopra 0.115
                    # 6 apr 2023 4-15 da 5-16



                    
                
                elif (
                    ma3_last > ma18_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 2 COMINCIA A SCENDERE DNA - r 5019 B"
                    action = "buy"
                    percentage = 50
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # 16 mar 2023 aggiunta 3-10 > 0.125 3-10 deve stare sopra 0.115
                    # 6 apr 2023 4-15 da 5-16
                    # 26 feb 2025 tolto ribasso audi ! aggiunta comincia a scendere !
                    #  2 mar 2025 aggiunto comincia a scendere con and deviation_ma200_sotto_ma300 < -0.25
                    #  3 mar 2025 aggiunta COMINCIA A SCENDERE DNA







                elif (
                    ma3_last > ma13_last

                    and ma78_last < ma200_last
                    and deviation_ma300_sopra_ma450 < -0.15
                    and deviation_ma25_sotto_ma300 > -2.00

                    and deviation_buy_crollo_1 < -0.60
                    and deviation_buy_crollo_1 > -1.60
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 2 DURANTE UN RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO ! 22 ago 2022 - r 5019 C1"
                    action = "buy"
                    percentage = 50
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # 16 mar 2023 aggiunta 3-10 > 0.125 3-10 deve stare sopra 0.115
                    #  6 apr 2023 4-15 da 5-16
                    #  7 apr 2025 se deviation_ma25_sotto_ma300 > -2.00

                    

                elif (
                    ma3_last > ma13_last
                    
                    and ma78_last < ma200_last
                    and deviation_ma300_sopra_ma450 < -0.15
                    and deviation_ma25_sotto_ma300 < -2.00
                    and deviation_ma3_sotto_ma50 < -1.20

                    and deviation_buy_crollo_1 < -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 2 DURANTE UN RIBASSO AUDI con 5-16 copiata da RCCR CHE E' ANDATA BENISSIMO ! 22 ago 2022 - r 5019 C2"
                    action = "buy"
                    percentage = 50
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !
                    # 16 mar 2023 aggiunta 3-10 > 0.125 3-10 deve stare sopra 0.115
                    #  6 apr 2023 4-15 da 5-16
                    #  7 apr 2025 se deviation_ma25_sotto_ma300 < -2.00 aggiungo deviation_ma3_sotto_ma50 < -1.20
                    
                    
                    
                    
                    
                    
                # IL BUY 2 CI RIPROVA MA PIU' IN ALTO ! non toccare questa altrimenti fa punti sovrapposti !
                
                elif (
                    deviation_buy2 > 0.01
                    and ma200_last < ma200_120_min_ago
                    
                    and ma100_last < ma100_50_min_ago
                    
                    and deviation_buy > 0.50
                    and deviation_ma5_sopra_ma28 > 0.60
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2C con 100 < and 200 < con DEVIATION BUY > 0.50 and 5-28 > 0.60 - r 5044"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy2 = ma8_last / ma50
                    # deviation buy e 5-28 cosi' alte per evitare punti sovrapposti NON TOCCARE
                    
                    
                    
                
                ####################################################################################################### BUY 2 DURANTE IL CROLLO CHE CONTINUA !
                
                # se il crollo continua dopo che ha venduto sell 1 durante il crollo - ro cano CI RIPROVA !     
                
                # BUY 2  primo modo DURANTE IL CROLLO
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma3_last > ma15_last
                    and deviation_ma3_sopra_ma10 > 0.125
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 DURANTE IL CROLLO - modo 1 2-7 - r 5067"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # 14 GIU 2022 3-15 PERCHE' COMPRAVA CONTINUAMENTE DURANTE IL CROLLO CON 3-7
                    # 17 mar 2023 ho aggiunto 3-10 > 0.125 vedi 3 mar 2023 ore 2:51
                    
                    
                    
                # BUY 2 avvento del macd ! DURANTE IL CROLLO - porcupine tree - lazarus
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma3_last > ma7_last
                    and macd > macd_2_min_ago
                    and macd < -35
                  
                ):
                    buy = "BUY 2 DURANTE IL CROLLO - AVVENTO DEL MACD ! 3-7 + MACD - porcupine tree - lazarus - r 5068a"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # 14 GIU 2022 3-15 PERCHE' COMPRAVA CONTINUAMENTE DURANTE IL CROLLO CON 3-7
                    # 17 mar 2023 ho aggiunto 3-10 > 0.125 vedi 3 mar 2023 ore 2:51
                    # 27 APR 2023 AVVENTO DEL MACD !


                elif (
                    ma3_last > ma7_last
                    and deviation_buy_crollo_1 < -2.30
                    
                    and ma2_differenza_2_min_ago > 15
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.20
                    and macd < -150
                    and macd_differenza_2_min_ago > -18 
                  
                ):
                    buy = "BUY 2 DURANTE IL CROLLO - and ma2_differenza_2_min_ago > 15 E macd_differenza_2_min_ago > -18 ! 3-7 + MACD - bird of paradise - snowy white - r 5068b"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # 14 GIU 2022 3-15 PERCHE' COMPRAVA CONTINUAMENTE DURANTE IL CROLLO CON 3-7
                    # 17 mar 2023 ho aggiunto 3-10 > 0.125 vedi 3 mar 2023 ore 2:51
                    # 27 APR 2023 AVVENTO DEL MACD !
                    
                    # 11 dic 2023 tolto macd
                    # 11 dic 2023 aggiunto and ma2_differenza_2_min_ago > 15
                    # 11 dic 2023 aggiunto and macd < -150 CIOE' STA CROLLANDO
                    # 11 dic 2023 aggiunto and macd_differenza_2_min_ago > -18 CIOE' IL MACD STA COMINCIANDO A NON CROLLARE CIOE' A RALLENTARE IL CROLLO
                    # 11 dic 2023 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.20 significa che ma2 sta crescendo

                    
                # BUY 2 secondo modo - DURANTE IL CROLLO - questa condizione e' entrata in azione ! ( e mi e' sembrata ben fatta !)

                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -1.70
                    and deviation_buy_crollo_1 > -2.29
                    and deviation_buy_crollo_2 > 0.11
                    and deviation_ma5_sopra_ma28 > 0.03
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 DURANTE IL CROLLO - modo 2 - r 5085"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_buy_crollo_2 = ma3_last / ma13_last
                    
                    
                    
                    
                # BUY 2 CHE MANCAVA DOPO BUY-SELL CROLLO ! 150-100 GIORNO !
                
                elif (
                    deviation_ma5_sopra_ma28 > 0.10
                    and deviation_ma3_sopra_ma10 > 0.20
                    
                    and deviation_ma100_sopra_ma300 < -0.20
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and delta_150_100 < delta_150_100_60_min
                    and ma100_last > ma100_3_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 CHE MANCAVA DOPO BUY-SELL CROLLO ! 150-100 GIORNO ! - r 5116"
                    action = "buy"
                    percentage = 90
                    
                    # madonna compa ! 
                    # the sound of silence
                    # ASSURDO ! questa 100 > 100 3 min e' incredibile ! si e' verificata dopo il BUY-SELL del crollo ! NON TOCCARE
                    # SI STA RIDUCENDO LA DISTANZA TRA 150 E 100
                    # and deviation_ma100_sopra_ma300 < -0.20 significa che stiamo ancora in una situazione di ribasso !
                    
                    
                  
                    
              
                ################################################### per comprare durante UNA piccola CORREZIONE che NON E' un forte ribasso e NON E' un crollo
                
                
                # BUY 2A PAZZA DURANTE UNA piccola CORREZIONE che NON E' un forte ribasso e NON E' un crollo ! (compare stammi vicino!)
             
                elif (
                    deviation_ma5_sopra_ma28 > 0.23
                    
                    and deviation_ma100_sopra_ma300 > -1.20
                    
                    and deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
               
                    and deviation_correzione > 0.015
                    and deviation_buy_ma5_sopra_ma20 > 0.10
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 2A PAZZA AUDI che non e' un forte ribasso e non e' un crollo ! deviation 5-28 > 0.05 CON 100 non lontana dalla 300 - r 5150 a"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # ma5 non deve allontanarsi troppo dalla ma200 !
                    # compare prega per me !
                    
                    
                    
                    
                # BUY 2A PAZZA DURANTE UNA piccola CORREZIONE che NON E' un forte ribasso e NON E' un crollo ! (compare stammi vicino!)
             
                elif (
                    deviation_ma5_sopra_ma28 > 0.05
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma100_sopra_ma300 < -1.20
                    
                    and deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
               
                    and deviation_correzione > 0.015
                    and deviation_buy_ma5_sopra_ma20 > 0.10
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 2A PAZZA AUDI che non e' un forte ribasso e non e' un crollo ! deviation 5-28 > 0.05 CON 100 MOLTO SOTTO 300 - r 5178 b"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # ma5 non deve allontanarsi troppo dalla ma200 !
                    # compare prega per me !
                    
                    
                   
                
                # BUY 2 CORREZIONE che NON E' un forte ribasso e NON E' un crollo ! con deviation_correzione > 0.02
                 
                elif (

                    ma2_last > ma2_2_min_ago
                    and (ma20_prev < ma200_prev and ma20_last > ma200_last)
                    and deviation_correzione_2 > 0.03
                    and deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -0.90
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 2 CORREZIONE che NON E' un forte ribasso e NON E' un crollo ! con deviation_correzione > 0.02 - r 5207"
                    action = "buy"
                    percentage = 80
                  
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma5_last / ma30_last
                    # compare prega per me !
                    
                    
                    

                    

                
                # BUY 2 FORTE RIBASSO che NON E' UN CROLLO ! (compare stammi vicino!) 
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -0.70
                    and deviation_buy_crollo_1 > -1.50
                    and deviation_bellissima > 0.15
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 FORTE RIBASSO che NON E' UN CROLLO ! and deviation_bellissima > 0.15 - r 5229"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    
                    
                    
                    
                # BUY 2 esperimentali # CON INCROCIO 3-200 HO RISOLTO IL PROBLEMA DEL BUY 2 ECCEZIONALE CHE COINCIDEVA QUASI CON IL SELL 1 ! 
                
                # BUY 2 nuovo TREND LATERALE !

                elif (
                    ma100_last > ma300_last
                    and ma100_last > ma200_last
                    and ma8_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                        
                    and deviation_ma100_sopra_ma300 < 0.04
                    and deviation_ma100_sopra_ma200 < 0.05
                    and deviation_ma5_sopra_ma28 > 0.18
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 nuovo TREND LATERALE ! - r 5252"
                    action = "buy"
                    percentage = 80
                    
                    # SE ma100 E' cosi' VICINA A ma200 E ma300 vuo dire che non c'e' un grande rialzo in atto ma un TREND LATERALE !
                    # 5-28 a 0.10 da 0.07
                    # > estate 5-28 0.18 da 0.10
                    
                    
                    
                    
                # BUY 2 andamento laterale - se ma200 sale da 20 min compra con 4-30 ma sul BUY 2 lo 0.50 evita GLI EFFETTI LATERALI !

                elif (
                    ma200_last > ma200_20_min_ago
                    and ma20_last > ma200_last
                    
                    and (ma3_prev < ma200_prev and ma3_last > ma200_last)
                    and (ma20_prev < ma69_prev and ma20_last > ma69_last)
                    
                    and ma2_last > ma2_2_min_ago
                    and ma7_last > ma25_last
                    and ma10_last > ma10_2_min_ago
                    
                    and deviation_ma4_sopra_ma30 > 0.17
                    and deviation_ma100_laterale > 0.49
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 andamento laterale se ma200> da 20 min compra con 4-30 (SUL BUY 2 0.50 e 20-69 vs EFFETTI LATERALI !) - r 5279"
                    action = "buy"
                    percentage = 80
                    
                    
                
                
                # BUY 2 andamento laterale - se ma200 sale da 20 min compra con 4-30 ma sul BUY 2 lo 0.50 vs EFFETTI LATERALI !

                elif (
                    
                    ma200_last > ma200_20_min_ago
                    and ma20_last > ma200_last
                    
                    and (ma3_prev < ma100_prev and ma3_last > ma100_last)
                    and (ma20_prev < ma69_prev and ma20_last > ma69_last)
                    
                    and ma2_last > ma2_2_min_ago
                    and ma7_last > ma25_last
                    and ma10_last > ma10_2_min_ago
                    
                    and deviation_ma4_sopra_ma30 > 0.17
                    and deviation_ma100_laterale > 0.49
                   and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 andamento laterale se ma200> da 20 min compra con 4-30 (SUL BUY 2 0.50 e 20-69 vs EFFETTI LATERALI !) - r 5304"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                    
                    
                # BUY 2 DOCCIA
                
                elif (    

                    ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_90_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma20_last > ma200_last
                    
                    and deviation_ma100_sopra_ma300 > 0.70
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma59_last
                    
                    
                    and deviation_ma5_sopra_ma30 > 0.02
                    and deviation_buy_ma3_sopra_ma25 > 0.04
                    
                    and (ma4_prev < ma25_prev and ma4_last > ma25_last)
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ): 
                    buy = "BUY 2 DOCCIA se ma200 > da 90 min ! E 3-10 > 0.01 - 100 MOLTO ALTA RISPETTO A 300 - r 5333 A"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                    
                # BUY 2 DOCCIA
                
                elif (    

                    ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_90_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma20_last > ma200_last
                    and deviation_ma100_sopra_ma300 < 0.70
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma59_last
                    and ma11_last > ma59_last
                    
                    and deviation_ma5_sopra_ma30 > 0.03
                    and deviation_buy_ma3_sopra_ma25 > 0.05
                    
                    and (ma4_prev < ma25_prev and ma4_last > ma25_last)
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ): 
                    buy = "BUY 2 DOCCIA se ma200 > da 90 min ! E 3-10 > 0.01 -100 NON LONTANA DA 300  r 5360 B"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                    
                
                
                # BUY 2 con DEVIATION ASSURDA = ma2 / ma200_last CON ma200 >

                elif (    
                    ma200_last > ma200_120_min_ago
                    and deviation_assurda > 0.10
                    and ma5_last > ma300_last
                    and ma10_last > ma10_2_min_ago
                    
                    and deviation_ma4_sopra_ma30 > 0.13
                    and deviation_ma100_laterale > 0.10
                    and (ma3_prev < ma200_prev and ma3_last > ma200_last)
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 con DEVIATION ASSURDA se ma200 sale da 120 min BUY con ma2-ma200 (ma5 > ma300 evita GLI EFFETTI LATERALI !) - r 5382"
                    action = "buy"
                    percentage = 70    
          
                    # deviation_assurda = ma2 / ma200
            
            
            
            
            
                # ------------------------------------------------------------ BUY 2 laterale

                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 0.30
                ):  
                
                    buy = "BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 80


   
                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 0.30
                ):  
                
                    buy = "BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 80

  
                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 0.30
                ):  
                
                    buy = "BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 80

  
                elif (    
                    ma3_last > ma11_last

                    and (ma300_last > ma300_120_min_ago or ma450_last > ma450_480_min_ago)

                    and (ma100_last > ma100_10_min_ago or deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12)
                    
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):  
                
                    buy = f"BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A3 SOFT - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 25 ott 2025 aggiunte pg
                    # 25 ott 2025 tentato di anticipare ndecchiecella - non aveno ancora a disposizione i valori nelle pg



    
                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 0.30
                ):  
                
                    buy = "BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 80



                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 0.30
                ):  
                
                    buy = "BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 80


                elif (    
                    ma3_last > ma28_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 0.30
                ):  
                
                    buy = "BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80

                
                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 7
                    
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 0.30
                ):  
                
                    buy = "BUY 2 laterale con 300>450 and 4-28 e macd > 2.0 and macd_diff_2_min_ago > 0.20 e dev 3-18 > 0.02 - r 5412 X1 AX 1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 80
                    
                    # 10 dic 2023 aggiunta and ma2_last > ma5_last
                    # 10 dic 2023 aggiunta and ma2_last > ma3_last
                    # 18 dic 2023 aggiunta and ma2_differenza_2_min_ago > 7
                    # 18 dic 2023 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02







                elif (    
                    ma3_last > ma18_last
                    and delta_100_59 > delta_100_59_30_min

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and ma50_last > ma100_last
                    and (ma300_last > ma300_120_min_ago or ma450_last > ma450_480_min_ago)
                    
                    and ma2_last > ma5_last

                    and macd_differenza_2_min_ago > -18.50
                
                ):
                    buy = "BUY 2 con 300 > 2 ore MA NOTTE and 3-18 and macd_diff_2_min_ago > -18.50 - r 5412 X1 AX 2x1"
                    action = "buy"
                    percentage = 80

                    #  5 mar 2024 se ma39 > ma39 15 min ago ok cosi'
                    #  9 nov 2024 anticipata ndecchiecella
                    # 11 nov 2024 con 100 > 100 30 min ago
                    # 27 mag 2025 anticipata ndecchiecella
                    #  8 ago 2025 con delta_100_59 > delta_100_59_30_min deve dare un accenno di risalita perche' continua a comprare mentre scende


                elif (    
                    ma3_last > ma20_last

                    and ma100_last < ma100_30_min_ago
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80

                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago

                    and delta_100_59 > delta_100_59_30_min
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and ma2_last > ma5_last

                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > -1.3
                
                ):
                    buy = "BUY 2 laterale con 300>450 and 4-20 con zia amalia grafana - NOTTE - r 5412 X1 AX 2x2"
                    action = "buy"
                    percentage = 80

                    #  5 mar 2024 se ma39 > ma39 15 min ago ok cosi'
                    #  9 nov 2024 anticipata ndecchiecella
                    # # 11 nov 2024 con 100 < 100 30 min ago zia amalia grafana


                elif (    
                    ma3_last > ma28_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192
                    
                    and ma2_differenza_2_min_ago > 5
                    and delta_100_59 > delta_100_59_30_min
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and ma2_last > ma5_last
                    and macd >= macd_2_min_ago
                    and macd > -11.0
                    and macd_differenza_2_min_ago > 1.3
                
                ):
                    buy = "BUY 2 laterale con 300>450 and 4-28 and macd > 2.0 and macd_differenza_2_min_ago > 1.30 - NOTTE - r 5412 X1 AX 2y"
                    action = "buy"
                    percentage = 80
                    
                    #  5 mar 2024 se ma39 < ma39 15 min ago BUY con deviation_ma39 > 0.192 ( pugno fantasma di mohammad ali' )




                # 24 nov 2024 cancellata r 5412 X1 AX 2z
                


                    
                elif (    
                    ma3_last > ma18_last

                    and ma450_last < ma450_480_min_ago

                    and deviation_ma39 < -0.14
                    and deviation_ma3_sotto_ma50 < -0.22
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    
                    
                    and ma300_last > ma450_last
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.20
                  
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                    and macd_differenza_2_min_ago > -8.50
                ):  
                
                    buy = "BUY 2 laterale con 300>450 - r 5412 X2A"
                    action = "buy"
                    percentage = 80
                    
                    # 19 set 2022 aggiunta 3-10 > 0.07
                    #  3 ott 2022 3-10 0.113 da 0.07
                    #  4 mag 2023 3-10 0.07 da 0.113 con 300>450
                    # 23 mag 2023 3-39 da 8-59 con 300>450 e 100 attaccata alla 300
                    # 24 mag 2023 3-10 > 0.07 con 450 < 450 480 min ago !
                    # 29 nov 2023 3-39 da 5-39
                    # 29 nov 2023 sostituito 78> con 50>59
                    # 14 apr 2025 tolto 50>59

                    # 14 apr 2025 aggiunta and deviation_ma39 < -0.14
                    # 14 apr 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.22
                    # 14 apr 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13



                    
                elif (    
                    ma3_last > ma13_last

                    and ma50_last < ma59_last
                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.045

                    and ma450_last < ma450_480_min_ago
                    and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago 

                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma100_sopra_ma300 > -0.50
                  
                    and macd_differenza_2_min_ago > 28.50
                ):  
                
                    buy = f"BUY 2 piu' o meno laterale con 450 < 450 480 min ago MA 300>450 MA 50<59 and 3-39 < -0.05 - r 5412 X2b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80
                    
                    # 19 set 2022 aggiunta 3-10 > 0.07
                    #  3 ott 2022 3-10 0.113 da 0.07
                    #  4 mag 2023 3-10 0.07 da 0.113 con 300>450
                    # 23 mag 2023 3-39 da 8-59 con 300>450 e 100 attaccata alla 300
                    # 24 mag 2023 3-10 > 0.07 con 450 < 450 480 min ago !
                    # 27 set 2023 and deviation_ma100_sopra_ma300 > -0.30 da -0.20
                    # 27 set 2023 and deviation_ma3_sopra_ma18 > 0.16 da 0.169
                    # 29 nov 2023 sostituito 78< con 50<59
                    # 15 apr 2025 ma3_last > ma20_last
                    # 30 apr 2025 aggiunta and deviation_ma39 < -0.05
                    # 17 ott 2025 aggiunte pg
                    # 17 ott 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.05
                    # 17 ott 2025 aggiunta deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    # 21 ott 2025 aggiunta and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago 

                    
                elif (    
                    ma8_last > ma59_last
                    and ma300_last < ma450_last
                    and deviation_ma100_sopra_ma300 < 0.20
                    and deviation_ma100_sopra_ma300 > -0.20
                    
                    and deviation_ma3_sopra_ma10 > 0.113
                 
                    and ma300_last > ma300_120_min_ago
                    and macd >= macd_2_min_ago
                ):  
                
                    buy = "BUY 2 laterale con 300<450 - r 5412 y"
                    action = "buy"
                    percentage = 80
                    
                    # 19 set 2022 aggiunta 3-10 > 0.07
                    #  3 ott 2022 3-10 0.113 da 0.07
                    
                    
                    
                    
                # BUY 2 che ci riprova TORNANDO ALLE ORIGINI ( TREND LATERALE !) con ma200< and ma300< AND 100 vicina alla 300
                
                elif (
                    deviation_buy2 > 0.02
                    and deviation_ma100_sopra_ma300 > -0.20
                    and ma300_last > ma450_last
                    and deviation_ma3_sopra_ma10 > 0.14
                    and deviation_ma5_sopra_ma28 > 0.18
                    
                    and deviation_bellissima > 0.05
                    and ma8_last >= ma8_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma7_last
                    and ma3_last > ma13_last
                    and deviation_buy_ma3_sopra_ma20 > 0.05
                    and deviation_ma4_sopra_ma25 > 0.04
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 che ci riprova TORNANDO ALLE ORIGINI ( TREND LATERALE !) con ma200< and ma300< AND 100 vicina alla 300 - r 5412a"
                    action = "buy"
                    percentage = 70
                    
                    
                elif (
                    deviation_buy2 > 0.05
                    and deviation_ma100_sopra_ma300 > -0.20
                    and ma300_last < ma450_last
                    and deviation_ma3_sopra_ma10 > 0.14
                    and deviation_ma5_sopra_ma28 > 0.18
                    
                    and deviation_bellissima > 0.13
                    and ma8_last > ma8_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma7_last
                    and ma3_last > ma13_last
                    and deviation_buy_ma3_sopra_ma20 > 0.05
                    and deviation_ma4_sopra_ma25 > 0.05
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 che ci riprova TORNANDO ALLE ORIGINI ( TREND LATERALE !) con ma200< and ma300< AND 100 vicina alla 300 - r 5412b"
                    action = "buy"
                    percentage = 70

                    # compare prega per me !
                    # se ma200< e ma300< si torna alle origini ! 8-50 ! (con ma2 > ma2 2 min ago)
                    # deviation_buy2 = ma8_last / ma50_last
                    
                    # SE 100 STA VICINO ALLA 300 TREND LATERALE ! - 5-28 DEVE AVERE UNA SPINTA MAGGIORE !
                    
                    
                # 24 nov 2024 cancellata r 5445 A1  
                

                elif (
                    ma3_last > ma20_last

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.085
                    and deviation_ma300_sopra_ma450 > -0.085

                    and ma100_last > ma100_120_min_ago
                    and ma100_last > ma300_last

                    and ma450_last < ma450_180_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and ma10_last > ma20_last
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.03

                    and deviation_ma100_sopra_ma300 > -0.60
                    and deviation_ma200_sopra_ma300 > -0.60
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -1.50
                ):
               
                    buy = "BUY 2 con ma450_last > ma450_720_min_ago e con 100>300 e 3-20 e con 10>20 E CON 100>300 - r 5445 A2 X1 A"
                    action = "buy"
                    percentage = 80

                    # 15 nov 2024 se 100>300 anticipo ndecchia
                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima


                elif (
                    ma3_last > ma15_last

                    and ma450_last < ma450_720_min_ago
                    
                    and (ma100_last > ma100_120_min_ago or ma100_last > ma300_last)
                    
                    and ma450_last < ma450_180_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.11
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma25_sotto_ma300 < -0.15
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.035

                    and deviation_ma3_sopra_ma10 > 0.001
                    
                    and deviation_ma100_sopra_ma300 > -0.70
                    and deviation_ma200_sopra_ma300 > -0.70
                   
                    and macd > -80
                    and macd_differenza_2_min_ago > -18.50
                ):
               
                    buy = "BUY 2 con ma450_last < ma450_720_min_ago MA CON 100>300 e 3-20 e con 10>20 - r 5445 A2 X1 B - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 15 nov 2024 se 100>300 anticipo ndecchia
                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 17 ott 2025 aggiunte pg
                    # 17 ott 2025 importate dev da condizione con valori dev che sono andate bene



                elif (
                    ma3_last > ma10_last

                    and ma100_last < ma300_last

                    and ma450_last < ma450_180_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.13
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.08
                    

                    and delta_1_50_20 < delta_2_50_20
                    and (delta_1 < delta_2 or ma50_last > ma100_last)

                    and (deviation_ma100_sopra_ma300 > -0.60 or deviation_ma200_sopra_ma300 > -0.60)
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 che ci riprova quando se ne va lateralmente - GIORNO - r 5445 A2 X2 - deviation_ma39 {deviation_ma39:.2f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}"
                    
                    action = "buy"
                    percentage = 80

                    # 15 ott 2024 con 100>100 60 min ago
                    # 11 mar 2025 anticipata ndecchiecella con aggiunta GIORNOal posto di 100 > 100 60 min ago
                    # 25 set 2025 aggiunta or ma50_last > ma100_last per anticipare
                    #  7 ott 2025 aggiunta and delta_1_50_20 < delta_2_50_20
                    #  7 ott 2025 aggiunta and deviation_ma25_sotto_ma300 < -0.25
                    #  7 ott 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05
                    #  7 ott 2025 aggiunte parentesi graffe sulla stessa riga


                elif (
                    ma3_last > ma20_last

                    and deviation_ma39 < -0.06
                    and deviation_ma3_sotto_ma50 <-0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.24
                    and deviation_ma25_sotto_ma300 < -0.38
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.02

                    and ma450_last < ma450_720_min_ago
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma100_sopra_ma200 < -0.13

                    and deviation_ma300_sopra_ma450 < 0.13
                    and deviation_ma300_sopra_ma450 > -0.13

                    and ma450_last < ma450_180_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.25
                ):
               
                    buy = f"""BUY 2 con 3-20 che ci riprova quando se ne va lateralmente + OSSO - r 5445 A2 Y

                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}
                    """

                    action = "buy"
                    percentage = 80

                    # 15 ott 2024 SE 100<100 60 min ago + OSSO
                    # 29 gen 205 st cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 16 apr 2025 se ma450_last < ma450_720_min_ago aggiunta deviation_ma100_sopra_ma200 < -0.13
                    # 16 mag 2025 e' andata bene. ok cosi'
                    # 16 mag 2025 aggiunte parentesi graffe. 
                    



                elif (
                    ma3_last > ma20_last
                    and ma450_last < ma450_180_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.015

                    and ma10_last > ma20_last
                    and deviation_ma3_sopra_ma10 > 0.08
                    and deviation_ma5_sopra_ma28 > -0.03

                    and ma5_last > ma5_2_min_ago
                    
                    
                    and deviation_ma100_sopra_ma300 > -0.60
                    and deviation_ma200_sopra_ma300 > -0.60
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.010
                    and macd_differenza_2_min_ago > -3.25
                ):
               
                    buy = "BUY 2 che ci riprova quando ma50 > ma50 di 90 min ago MENTRE se ne va lateralmente > crollo e 5 CON 10>20 - r 5445 A3"
                    action = "buy"
                    percentage = 80

                    # compare prega per me !
                    # 29 set 2022 3-10 > 0.08 da 0.10
                    # 29 set 2022 28 20 min ago da 28 30 min ago
                    #  1 giu 2023 and macd > macd_2_min_ago
                    # 11 ago 2023 5-78 da 78-200
                    #  6 set 2023 28 10 min da 28 20 min
                    # 15 set 2023 28 5 min da 28 10 min
                    # 27 set 2023 20 5 min da 28 10 min
                    
                    #  8 gen 2024 10>20 al posto di 20> 20 5 min ago 
                    #  8 gen 2024 macd_differenza_2_min_ago > 1.00
                    # 16 set 2024 esta condizione non deve comprare quando ma450 scende da 3 ore !
                    #  8 ott 2024 forse cancellare
                    #  8 ott 2024 qua NON SERVE L' OSSO PERCHE' STA RISALENDO !
                    #  8 ott 2024 ho tolto anche ma2 > ma2 2 min ago


                
                # BUY 2 che ci riprova quando se ne va lateralmente dopo il crollo
                
                elif (
                    ma78_last > ma200_last
                    and ma28_last < ma28_30_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.20
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and delta_300_100 < delta_300_100_60_min
                    
                    and deviation_ma100_sopra_ma300 > -0.50
                    and deviation_ma200_sopra_ma300 > -0.50
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 CON 78 > 200 che ci riprova quando se ne va lateralmente dopo il crollo CON 28 < 28 30 min ago E 3-10 > 0.20 - r 5476 a2"
                    action = "buy"
                    percentage = 80

                    # compare prega per me !
                    
                    
                    
                # BUY 2 che ci riprova quando se ne va lateralmente dopo il crollo
                
                elif (
                    ma78_last > ma200_last
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.20
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and delta_300_100 < delta_300_100_60_min
                    
                    and deviation_ma100_sopra_ma300 > -0.50
                    and deviation_ma200_sopra_ma300 > -0.50
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 CON 78 < 200 che ci riprova quando se ne va lateralmente dopo il crollo - r 5503 b"
                    action = "buy"
                    percentage = 80
                    
                    # > estate aumentato buy 3-10 0.17 e 5-28 0.20

                   
                    
                    
                    
                # BUY 2 che ci riprova TORNANDO ALLE ORIGINI (TREND RIBASSO !) con ma200< and ma300< AND 5 NON MOLTO SOTTO 300
                
                elif (
                    deviation_buy2 > 0.05
              
                    and deviation_ma100_sopra_ma300 < -0.20
                    and deviation_ma5_sotto_ma300 > -0.70
                    and deviation_ma5_sopra_ma28 > 0.29
                    and deviation_bellissima > 0.14
                    and ma8_last > ma8_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma3_last > ma7_last
                    and ma3_last > ma13_last
                    and deviation_buy_ma3_sopra_ma20 > 0.05
                    and deviation_ma4_sopra_ma25 > 0.05
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    and macd >= macd_2_min_ago
                ):
               
                    buy = "BUY 2 che ci riprova TORNANDO ALLE ORIGINI (TREND RIBASSO !) con ma200< and ma300< AND 5 NON MOLTO SOTTO 300 - r 5531 A"
                    action = "buy"
                    percentage = 70

                    # compare prega per me !
                    # se ma200< e ma300< si torna alle origini ! 8-50 ! (con ma2 > ma2 2 min ago)
                    # deviation_buy2 = ma8_last / ma50_last
                    
                    # 9 giu 2022 dev_buy2 (8-50) a 0.06 da 0.08
                    # 9 giu 2022 dev_bellissima a 0.15 da 0.16
                    # 16 set 2022 dev buy 2 0.05 da 0.06
                    
                    
                    





                # BUY 2 che ci riprova TORNANDO ALLE ORIGINI (TREND RIBASSO !) con ma200< and ma300< AND 5 molto sotto 300
                
                elif (
                    ma3_last > ma13_last

                    and ma39_last < ma100_last
                    and ma78_last < ma200_last
                    
                    and deviation_ma3_sotto_ma50 < -1.20

                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                  
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma100_sopra_ma300 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.70
                    
                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -12.50
                ):
               
                    buy = "BUY 2 che ci riprova TORNANDO ALLE ORIGINI (TREND RIBASSO !) con ma200< and ma300< AND 5 molto sotto 300 - r 5531 B"
                    action = "buy"
                    percentage = 70

                    # compare prega per me !
                    # se ma200< e ma300< si torna alle origini ! 8-50 ! (con ma2 > ma2 2 min ago)
                    # deviation_buy2 = ma8_last / ma50_last
                    
                    # 9 giu 2022 dev_buy2 (8-50) a 0.06 da 0.08
                    # 9 giu 2022 dev_bellissima a 0.15 da 0.16
                    
                    # > estate aumentato un po' il buy
                    #  4 mar 2025 anticipato con aggiunta GIORNO !


              
                
                # BUY 2 con ma200> e ma300> DURANTE UNA piccola CORREZIONE che NON E' un forte ribasso e NON E' un crollo !  
                
                elif (

                    ma2_last > ma2_2_min_ago
                    and ma28_last > ma28_30_min_ago
                    
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma200_last > ma300_last
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.59
                    and deviation_correzione > 0.017
                    and deviation_buy_ma5_sopra_ma20 > 0.12
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 2 con ma200> e ma300> DURANTE UNA piccola CORREZIONE che non e' un forte ribasso e non e' un crollo - r 5562"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                    
                # BUY 2 con ma200> e ma300> DURANTE UNA piccola CORREZIONE che NON E' un forte ribasso e NON E' un crollo !  
                
                elif (

                    ma2_last > ma2_2_min_ago
                    and ma28_last < ma28_30_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma200_last > ma300_last
                    and deviation_buy_crollo_1 < -0.33
                    and deviation_buy_crollo_1 > -0.59
                    and deviation_correzione > 0.017
                    and deviation_buy_ma5_sopra_ma20 > 0.12
                    
                    and deviation_ma5_sopra_ma28 > 0.18
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 2 con ma200> e ma300> DURANTE UNA piccola CORREZIONE che non e' un forte ribasso e non e' un crollo - r 5586"
                    action = "buy"
                    percentage = 70
                    
                    
                    
               
                # --------------------------------------- BUY 2 che considera il passare tempo con TREND IN RIALZO ! e 78 > 200 e sempre 20 > 200
                
                elif (     
                    seconds_since_last_trade > max_hold_time_in_seconds_nuova
                    and ma78_last > ma200_last
                    
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_bellissima > 0.07
                    
                    and ma30_last > ma30_40_min_ago
                    
                    and ma20_last > ma200_last
                    and ma20_last > ma100_last
                    
                    and ma4_last > ma100_last
                    
                    and ma100_last < ma300_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 che considera il passare tempo (SE > 120 min) and 5-28 > 0.10 e ma30 > ma 30 40 min ago (TREND IN RIALZO) con 78>200  - r 5610 A"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                # --------------------------------------- BUY 2 che considera il passare tempo con TREND IN RIALZO ! e 78 < 200 e sempre 20 > 200
                
                elif (     
                    seconds_since_last_trade > max_hold_time_in_seconds_nuova
                    and ma78_last < ma200_last
                    
                    and deviation_ma5_sopra_ma28 > 0.20
                    and deviation_bellissima > 0.07
                    
                    and ma30_last > ma30_40_min_ago
                    
                    and ma20_last > ma200_last
                    and ma20_last > ma100_last
                    
                    and ma4_last > ma100_last
                    
                    and ma100_last < ma300_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 che considera il passare del tempo (SE > 120 min) and 5-28 > 0.10 e ma30 > ma 30 40 min ago (TREND IN RIALZO) con 78>200 - r 5610 B"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                    
                elif (  
                    ma3_last > ma10_last
                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and ma78_last < ma200_last

                    and ma450_last > ma450_720_min_ago

                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05

                    
                    and deviation_ma10_sopra_ma200 > -0.25
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                  
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 laterale con 450> 6 ore and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05 con cv giorno - r 5630 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 23 ott 2025 se cv giorno ok cosi
                    # 23 ott 2025 aggiunte pg


                elif (  
                    ma3_last > ma10_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago

                    and deviation_ma39 < 0.01
                    and deviation_ma3_sotto_ma50 < -0.02
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07

                    and ma78_last < ma200_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                  
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    

                    and ma450_last > ma450_720_min_ago

                    and deviation_ma10_sopra_ma200 > -0.50

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 2 laterale con 450> 6 ore and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05 con cv notte and dev pg - r 5630 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 15 apr 2025 anticipata ndecchiecella
                    # 24 set 2025 e' andata male mentre scende
                    # 24 set 2025 3-20 da 5-54 provo ad anticipare ma sarebbe quasi ora di toglierla. non e', non sembra, situazione laterale.
                    # 25 set 2025 per adesso la tengo.
                    #  7 ott 2025 aggiunta and deviation_ma25_sotto_ma300 < -0.25
                    #  7 ott 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05
                    # 23 ott 2025 se cv notte aggiungo deviation da un sell successivo.
                    # 23 ott 2025 aggiunte pg


                    
                    
                # --------------------------------------- BUY 2 che considera il passare del tempo con TREND IN RIBASSO ! sempre 20 > 200
                
                elif (     
                    seconds_since_last_trade > max_hold_time_in_seconds_nuova
                    and deviation_ma5_sopra_ma28 > 0.17
                    and ma30_last < ma30_40_min_ago
                    
                    and ma20_last > ma200_last
                    and ma20_last > ma100_last
                    
                    and ma4_last > ma100_last
                    
                    and ma100_last < ma300_last
                    and deviation_bellissima > 0.07
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 che considera il passare del tempo (SE > 120 min) and 5-28 > 0.17 and ma30 < ma30 40 min ago (TREND IN RIBASSO) - r 5634"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                
                # BUY 2 FIAT che non funzionava MA CHE HA FUNZIONATO BENISSIMO ! ( DOPPIO DELTA AND 100> ) risalita ! copiato da BUY 1 perche' PERFETTO
                
                elif (    
                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
                    and ma3_last > ma9_last
                    
                    and ma200_last < ma300_last
                    and ma20_last < ma100_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma200_sotto_ma300 < -0.27
                  
                    
                    and delta_1 < delta_2
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma5_sopra_ma28 > 0.07
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 FIAT che non funzionava MA CHE HA FUNZIONATO BENISSIMO ( SOTTO RIALZO RIALZO ) GIORNO ! copiato da BUY 1 - r 5660"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                # BUY 2 nuovo RIALZO IMPROVVISO ma trend gia' in rialzo da 120 min and 0.27 sopra ultimo sell se 300>120 min e 100 sopra 300> 0.40

                elif (
                    ma200_last > ma200_20_min_ago

                    and ma39_last < ma39_20_min_ago
                    
                    and ma20_last >= ma20_2_min_ago
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 > 0.40
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_buy > 0.22
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma150_last > ma150_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.50
                ):
                    
                    buy = "BUY 2 RIALZO CON trend in rialzo E 0.22 sopra ultimo sell se 300>120 min  - r 5670 a1"
                    action = "buy"
                    percentage = 70


                elif (
                    ma200_last > ma200_20_min_ago

                    and ma39_last < ma39_20_min_ago
                    and deviation_ma39 < -0.17

                    and ma20_last >= ma20_2_min_ago
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 > 0.40
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_buy > 0.22
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma150_last > ma150_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.50
                ):
                    
                    buy = "BUY 2 RIALZO CON trend in rialzo E 0.22 sopra ultimo sell se 300>120 min + specie di osso - r 5670 a2"
                    action = "buy"
                    percentage = 70
                    
                    # 6 apr 2023 3-18 > 0.08
                    # 5 mag 2023 3-16 > 0.11
                    # 5 mag 2023 and deviation_buy > 0.275 da 0.27
                    # 5 mag 2023 and macd > macd 2 min ago
                    # 27 set 2023 and deviation_buy > 0.272 da > 0.275
                    # 13 dic 2023 anticipato ndecchiecella se ma20 >= ma20 2 min ago

              
                elif (
                    ma200_last > ma200_20_min_ago
                    and ma20_last < ma20_2_min_ago
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 > 0.40
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_buy > 0.262
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma3_sopra_ma16 > 0.09
                    
                    
                    and ma150_last > ma150_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.50
                ):  
                    
                    buy = "BUY 2 RIALZO IMPROVVISO con trend in rialzo and 0.262 sopra ultimo sell se 300>120 min e 100 sopra 300> 0.40 - r 5670b"
                    action = "buy"
                    percentage = 70
                    
                    # 6 apr 2023 3-18 > 0.08
                    # 5 mag 2023 3-16 > 0.11
                    # 5 mag 2023 and deviation_buy > 0.275 da 0.27
                    # 5 mag 2023 and macd > macd 2 min ago
                    # 27 set 2023 and deviation_buy > 0.272 da > 0.275
                    # 13 dic 2023 and deviation_buy a 0.262 da 0.272
                  
                # BUY 2 RIALZO IMPROVVISO ! con ma200 > and ma100_last > ma200_last
                
                elif (
                    ma200_last > ma200_20_min_ago
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 > 0.40
                    
                    and deviation_rialzo_improvviso_sopra > 0.40
                    and deviation_rialzo_improvviso_1 > 0.46
                    and deviation_rialzo_improvviso_2 > 0.19
                    and deviation_rialzo_improvviso_3 > 0.19
                    and deviation_range_1 < 0.20
                    and deviation_range_1 > -0.20
                    and deviation_range_2 < 0.20
                    and deviation_range_2 > -0.20
                    and deviation_range_x < 0.20
                    and deviation_range_x > -0.20
                    and macd >= macd_2_min_ago
                ):
             
                    buy = "BUY 2 RIALZO IMPROVVISO ! con ma200 > and 100>200 (solo per il buy 2 e per il buy 3) AND 100 SOPRA 300 > 0.40 - r 5686 a"
                    action = "buy"
                    percentage = 70
                    
                  
                    
                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma8_last >= ma8_2_min_ago

                    and deviation_ma39 < -0.257 
                    and deviation_ma3_sotto_ma50 < -0.246 
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma25_sotto_ma300 < 0.10
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.007


                    and ma450_last < ma450_300_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.25
                    and deviation_ma250_sopra_ma300 > -0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.001
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -18.25
                    
                ):
                    buy = f"BUY 2 da RCCR - r 5687 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 17 ott 2025 aggiunta questa
                    # 17 ott 2025 aggiunte pg
                    # 18 ott 2025 aggiunte deviation pg


                # BUY 2 RIALZO IMPROVVISO ! con ma200 > and ma100_last > ma200_last
                
                elif (
                    ma200_last > ma200_20_min_ago
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 < 0.40
                    
                    and deviation_rialzo_improvviso_sopra > 0.47
                    and deviation_rialzo_improvviso_1 > 0.47
                    and deviation_rialzo_improvviso_2 > 0.185
                    and deviation_rialzo_improvviso_3 > 0.185
                    and deviation_range_1 < 0.22
                    and deviation_range_1 > -0.22
                    and deviation_range_2 < 0.22
                    and deviation_range_2 > -0.22
                    and deviation_range_x < 0.22
                    and deviation_range_x > -0.22
                    
                    and macd > 20
                    and macd_differenza_2_min_ago > 0.50
                ):
             
                    buy = "BUY 2 RIALZO IMPROVVISO ! con ma200 > and 100>200 (solo per il buy 2 e per il buy 3) AND 100 SOPRA 300 < 0.40 - r 5711 B1"
                    action = "buy"
                    percentage = 70
                    
                    # 30 dic 2023 se macd > 20 forte ! allora puo' essere un rialzo improvviso con deviation_rialzo_improvviso_sopra > 0.47

                
                elif (
                    ma200_last > ma200_20_min_ago
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 < 0.40
                    
                    and deviation_rialzo_improvviso_sopra > 0.57
                    and deviation_rialzo_improvviso_1 > 0.57
                    and deviation_rialzo_improvviso_2 > 0.185
                    and deviation_rialzo_improvviso_3 > 0.185
                    and deviation_range_1 < 0.22
                    and deviation_range_1 > -0.22
                    and deviation_range_2 < 0.22
                    and deviation_range_2 > -0.22
                    and deviation_range_x < 0.22
                    and deviation_range_x > -0.22
                    
                    and macd < 20
                    and macd_differenza_2_min_ago > 2.50
                ):
             
                    buy = "BUY 2 RIALZO IMPROVVISO ! con ma200 > and 100>200 (solo per il buy 2 e per il buy 3) AND 100 SOPRA 300 < 0.40 - r 5711 B2"
                    action = "buy"
                    percentage = 70
                    
                    # 30 dic 2023 se macd < 20 debole ! allora forse non ci troviamo nella situazione di un rialzo improvviso. MA comunque se diff macd > 2.50 compra. ma piu' alto.
                    # FORSE E' UN FALSO SEGNALE
                  
                
                # --------------------------------------- BUY 2 che entra in azione se ma2 va sopra SELL 1 di almeno 0.45 !
                
                elif (     
                    seconds_since_last_trade > max_hold_time_in_seconds_delta_buy2_sell1
                    and delta_buy2_dal_sell1 > 0.30
                    and deviation_ma5_sopra_ma28 > 0.29
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma100_last > ma200_last
                    and ma3_last > ma8_last
                    and ma5_last > ma18_last
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 che entra in azione se DOPO 2 MINUTI ma2 va sopra SELL 1 > 0.30 E 5-28 > 0.29 ! - r 5732"
                    action = "buy"
                    percentage = 70
                    
                    # il BUY 2 con deviation buy2 (8-50) ma anche con (6-30) ARRIVA IN RITARDO !
                    
                    # 16 giu 2022 delta_buy2_dal_sell1 a 0.30 da 0.45
                    # vedi r180
                    # vedi r409
                    # vedi r1829
                    # compa prega per me !
                    
                    
                
                
                
                # BUY 2 ECCEZIONALE - se ma100 sale da 20 min compra con 4-30 IMPORTATA DA RCCR perche' andava molto bene nel trend laterale

                elif (
                    
                    ma200_last > ma200_20_min_ago
                    and deviation_buy_ma2_sopra_ma5 > 0.10
                    
                    and deviation_ma5_sopra_ma28 > 0.27
                    and ma5_last > ma15_last
                    and deviation_ma4_sopra_ma30 > 0.13
                    and deviation_correzione > 0.12
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 ECCEZIONALE se ma200 sale da 20 min compra con deviation 4-30 and deviation 3-25 IMPORTATA DA RCCR - riga 5762"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_correzione = 3/25    
                    # non toccare 5 > 15 !
                    # and deviation_buy_ma2_sopra_ma5 > 0.10 FONDAMENTALE
                    
                    
                    
                
                
                # BUY 2 PENULTIMA condizione ! ma tutte negative MA BUY con 8 > 125
                
                elif (     
               
                    ma25_last > ma200_last
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma300_last > ma300_60_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and deviation_buy_ma5_sopra_ma20 > 0.05
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 PENUULTIMA CONDIZIONE ! ma tutte negative MA BUY con 25-200 (ho sostituito 8 > 125) - r 5794 A"
                    action = "buy"
                    percentage = 70
                    
                    # BUY con 25>200 ha sostituito 8>125 (che un po' mi piaceva ma era troppo rischiosa)
                    
                    
                    
                # BUY 2 PENULTIMA condizione ! ma tutte negative MA BUY con 8 > 125
                
                elif (     
               
                    ma25_last > ma200_last
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma300_last < ma300_60_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.16
                    and deviation_ma5_sopra_ma28 > 0.14
                    and deviation_buy_ma5_sopra_ma20 > 0.05
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 PENUULTIMA CONDIZIONE ! ma tutte negative MA BUY con 25-200 (ho sostituito 8 > 125) - r 5794 B"
                    action = "buy"
                    percentage = 70
                    
                    # BUY con 25>200 ha sostituito 8>125 (che un po' mi piaceva ma era troppo rischiosa)
                    # se 300 < 120 min ago aggiunte 3-10 and 5-28 !
                    
                    
                    
                
                
                elif (
                    
                    ma3_last > ma13_last
                    and (ma39_last > ma100_last or ma28_last > ma100_last)

                    and ma10_last < ma20_last
                    
                    and deviation_ma5_sotto_ma300 > -0.60
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.025
                    
                    and ma2_last > ma5_last
                    
                    and ma8_last >= ma8_2_min_ago
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = f"BUY 2 del 18 ott 2025 > 180 min di ribasso CON ma10 < ma20 - r 5820 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"

                    # 18 ott 2025 aggiunta questa condizione da un BUY 3 del RCCR che era andata bene.
                    # 18 ott 2025 aggiunte pg




                # BUY 2 15 apr 2025

                elif (
                    ma3_last > ma13_last
                    and ma8_last > ma8_2_min_ago
                    and ma3_last > ma8_last

                    and (ma450_last > ma450_360_min_ago or ma300_last > ma450_last)
                    and delta_DNA_1 < delta_DNA_2
                    
                    and (ma3_prev < ma300_prev and ma3_last > ma300_last or delta_CM_300_25_last < delta_CM_300_25_2_min_ago)
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.32
                    
                    and macd_differenza_2_min_ago > -28.50
                ):  
                
                    buy = f"BUY 2 ma300_last > ma450_last e con ma200 che sale da 30 min - GIORNO - r 5829 AX - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 27 mar 2025 and macd_differenza_2_min_ago > -5.50 da > -2.50
                    # 15 apr 2025 modifiche per anticipare BUY
                    # 18 ott 2025 aggiunte pg
                    # 21 ott 2025 anticipata ndecchiecella




               
                elif (
                    ma3_last > ma18_last
                    and ma450_last > ma450_360_min_ago
                    and (ma20_last < ma50_last or delta_DNA_1 > delta_DNA_2 or ma50_last < ma100_last)

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.25
                    and deviation_ma39 < -0.05

                    and ma300_last > ma450_last
                    and ma100_last > ma100_120_min_ago
                    
                    and deviation_ma5_sotto_ma200 > -0.70
                    and deviation_ma100_sopra_ma300 < 0.40

                    and deviation_ma3_sopra_ma10 > 0.01
                    and ma3_last > ma13_last 
                    
                    and macd_differenza_2_min_ago > -12.50
                ):  
                
                    buy = "BUY 2 ma300_last > ma450_last e con ma200 che sale da 30 min + DNA - NOTTE - ritracciamento - r 5829 AY"
                    action = "buy"
                    percentage = 70

                    # 28 feb 2025 DOPO UN LUNGO RIALZO se comincia a curvare verso il basso ALLORA deviation_ma3_sotto_ma50 < -0.03
                    # 19 apr 2025 se 20<50 ritracciamento
                    # 19 apr 2025 se ritracciamento aggiunto and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    # 28 apr 2025 se anche 50<100 dev 39 < -0.05
                    # 30 apr 2025 and deviation_ma3_sotto_ma50 a -0.25

                    
                    
                elif (    
                    ma5_last > ma50_last
                    and ma100_last > ma200_last
                    and ma200_last > ma200_20_min_ago
                    and ma300_last < ma450_last
                    
                    and deviation > -0.60
                    
                    and deviation_ma3_sopra_ma10 > 0.01

                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.05
                    
                    and ma3_last > ma13_last
                    
                    and macd > -70
                ):  
                
                    buy = "BUY 2 con ma300 < ma450 e con ma200 che sale da 20 min 5>50 and 3-10 > 0.10 - r 5829 B1"
                    action = "buy"
                    percentage = 70
                    
                    # 21 mag 2023 5-50 da 33-78 !
                    # 21 mag 2023 aggiunta macd > macd 2 min ago
                    # 27 set 2023 5-28 0.13 da 0.14
                    # 27 set 2023 and ma200_last > ma200_20_min_ago da ma200_last > ma200_20_min_ago
                    # 22 feb 2025 anticipata ndecchiecella




                elif (    
                    ma3_last > ma18_last

                    and ma450_last > ma450_180_min_ago
                    and ma200_last > ma200_20_min_ago

                    and ma100_last < ma200_last
                    and ma300_last < ma450_last
                    
                    
                    and deviation > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma9_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):  
                
                    buy = "BUY 2 con ma300<ma450 MA ma450_last > ma450_180_min_ago E 200 sale da 20 min - r 5829 B2 x1"
                    action = "buy"
                    percentage = 80

                    # 27 feb 2025 se ma450_last > ma450_180_min_ago anticipato ndecchiecella




                elif (    
                    ma3_last > ma11_last

                    and ma450_last > ma450_180_min_ago
                    and ma200_last > ma200_20_min_ago

                    and (ma100_last < ma200_last or ma300_last < ma450_last)
                    
                    and deviation_ma39 < -0.09
                    and deviation_ma3_sotto_ma50 < -0.115
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma25_sotto_ma300 < -0.022
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.039
                    
                    and ma2_last > ma6_last
                    
                ):  
                
                    buy = f"BUY 2 da un sell con pg del 24 ott 2025 - r 5829 B2 x2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 27 feb 2025 se ma450_last > ma450_180_min_ago anticipato ndecchiecella
                    # 23 ott 2025 aggiunta questa condizione





                elif (    
                    ma3_last > ma20_last
                    and delta_1_50_20 < delta_2_50_20

                    and ma450_last < ma450_180_min_ago
                    and ma100_last < ma200_last
                    and ma300_last < ma450_last

                    and (ma200_last > ma200_20_min_ago or delta_1 < delta_2)
                    
                    and deviation_ma39 < -0.123
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.25

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma9_last
                    and macd_differenza_2_min_ago > -18.50
                ):  
                
                    buy = "BUY 2 con 300<450 MA ma450 > ma450_180_min MA ma200 sale da 20 min con dev39 < -0.123 e 3-50 < -0.15 - 50-20 GIORNO - r 5829 B2yx"
                    action = "buy"
                    percentage = 80



                elif (    
                    ma3_last > ma20_last
                    and delta_1_50_20 > delta_2_50_20

                    and ma450_last < ma450_180_min_ago
                    and ma100_last < ma200_last
                    and ma300_last < ma450_last

                    and (ma200_last > ma200_20_min_ago or delta_1 < delta_2)
                    
                    and deviation_ma39 < -0.22
                    and deviation_ma3_sotto_ma50 < -0.24
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.41
                    and deviation_ma25_sotto_ma300 < -0.50

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma9_last
                    and macd_differenza_2_min_ago > -18.50
                ):  
                
                    buy = "BUY 2 con 300<450 MA ma450 > ma450_180_min MA ma200 sale da 20 min con dev39 < -0.123 e 3-50 < -0.15 - 50-20 NOTTE - r 5829 B2yy"
                    action = "buy"
                    percentage = 80
                    
                    # 21 mag 2023 5-50 da 33-78 !
                    # 21 mag 2023 aggiunta macd > macd 2 min ago
                    # 27 set 2023 5-28 0.13 da 0.14
                    # 27 set 2023 and ma200_last > ma200_20_min_ago da ma200_last > ma200_20_min_ago
                    # 27 feb 2025 se anche ma450_last < ma450_180_min_ago ok cosi'
                    # 30 apr 2025 aggiunta and deviation_ma39 < -0.05
                    # 30 apr 2025 aggiunta or delta_1 < delta_2
                    # 19 mag 2025 and deviation_ma39 < -0.123
                    # 19 mag 2025 and deviation_ma3_sotto_ma50 < -0.15
                    # 19 mag 2025 and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    # 19 mag 2025 and deviation_ma25_sotto_ma300 < -0.25
                    # 27 mag 2025 se 50-20 notte allora OSSO

                    
                # BUY 2 con ma200 che sale da 60 min etc. importata dal BUY 3 RCCR

                elif (
                    ma10_last >= ma10_2_min_ago
                    and ma39_last > ma39_15_min_ago
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.40
                    
                    and ma33_last < ma78_last
                    and deviation_ma3_sopra_ma10 > 0.20
                    and deviation_ma5_sopra_ma28 > 0.14
                    
                    and deviation_ma4_sopra_ma30 > 0.11
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and deviation_ma7_sopra_ma40 > 0.03
                    and ma7_last > ma25_last
                    
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):  
                
                    buy = "BUY 2 con ma200 che sale da 60 min 33 < 78 ! - r 5860 B1"
                    action = "buy"
                    percentage = 70
                    
                    #  6 mar 2024 and ma39_last > ma39_15_min_ago
                    

                elif (
                    ma10_last >= ma10_2_min_ago
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192

                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.40
                    
                    and ma33_last < ma78_last
                    and deviation_ma3_sopra_ma10 > 0.20
                    and deviation_ma5_sopra_ma28 > 0.14
                    
                    and deviation_ma4_sopra_ma30 > 0.11
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and deviation_ma7_sopra_ma40 > 0.03
                    and ma7_last > ma25_last
                    
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):  
                
                    buy = "BUY 2 PUGNO FANTASMA DI MOHAMMAD ALI' con ma200 che sale da 60 min 33 < 78 ! - r 5860 B2"
                    action = "buy"
                    percentage = 70

                    #  6 mar 2024 and ma39_last < ma39_15_min_ago PUGNO FANTASMA DI MOHAMMAD ALI'


                elif (
                    ma10_last >= ma10_2_min_ago
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.40
                    
                    and ma33_last < ma78_last
                    and deviation_ma3_sopra_ma10 > 0.20
                    and deviation_ma5_sopra_ma28 > 0.14
                    
                    and deviation_ma4_sopra_ma30 > 0.11
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and deviation_ma7_sopra_ma40 > 0.03
                    and ma7_last > ma25_last
                    
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):  
                
                    buy = "BUY 2 PRENDI IL COLTELLO CON IL PIEDE con ma200 che sale da 60 min 33 < 78 ! - r 5860 B3"
                    action = "buy"
                    percentage = 70




                elif (
                    
                    ma3_last > ma13_last

                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.37
                    and deviation_ma50_sotto_ma300 < -0.25
                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.05
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.33
                    and deviation_ma5_sotto_ma300 < -0.36
                    and deviation_ma5_sotto_ma450 < -0.39

                    and ma450_last > ma450_120_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and ma39_last < ma39_15_min_ago
                    and ma33_last < ma78_last

                    and (ma3_prev < ma13_prev and ma3_last > ma13_last)
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -1.25
                ):  
                
                    buy = "BUY 2 con 3-13 con ma450 > 2 ore e ma200 che sale da 1 ora con 33<78 + DNAM - r 5860 B4 A"
                    action = "buy"
                    percentage = 70

                    #  6 mar 2024 aggiunto anche incrocio al rialzo 3-180
                    #  9 dic 2024 tolto incrocio 3-180 e aggiunta DNAM. cazzo.




                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and ma39_last < ma39_15_min_ago
                    and ma33_last < ma78_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10

                    and (ma3_prev < ma150_prev and ma3_last > ma150_last)
                   
                    and ma3_last > ma13_last
                    
                    and macd_differenza_2_min_ago > -18.25
                ):  
                
                    buy = "BUY 2 incrocio al rialzo 3-150 con ma450 > 2 ore e ma200 che sale da 1 ora con 33<78 ! - ritracciamento ! - r 5860 B4 B1"
                    action = "buy"
                    percentage = 70

                    #  6 ott 2024 aggiunto anche incrocio al rialzo 3-150
                    # 28 giu 2025 credo che siamo in presenza di un ritracciamento !
                    # 28 giu 2025 aggiungo deviation_ma5_sopra_o_sotto_ma100 < -0.10


                elif (
                    ma3_last > ma13_last
                    
                    and (ma20_last < ma50_last or ma33_last < ma78_last or ma39_last < ma39_15_min_ago)
                    and deviation_ma5_sotto_ma300 < -0.01

                    and ma450_last > ma450_120_min_ago
                    and ma200_last > ma200_60_min_ago

                    and (ma3_prev < ma200_prev and ma3_last > ma200_last)

                    and delta_1 < delta_2

                    and ma5_last >= ma5_2_min_ago
                    
                    and macd_differenza_2_min_ago > -18.50
                ):  
                
                    buy = "BUY 2 incrocio al rialzo 3-200 con ma450 > 2 ore e ma200 che sale da 1 ora MA RITRACCIAMENTO ! - r 5860 B4 B2"
                    action = "buy"
                    percentage = 70

                    #  6 ott 2024 aggiunto anche incrocio al rialzo 3-150
                    #  6 gen 2025 3-200 al rialzo
                    # 10 mar 2025 se and ma33_last < ma78_last and ma39_last < ma39_15_min_ago ho aggiunto GIORNO invece di cancellare
                    # 14 apr 2025 se e' ritracciamento NON ME NE FREGA NIENTE 5 DEVE STARE SOTTO 300
                    # 14 apr 2025 correzione or



                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and ma39_last < ma39_15_min_ago
                    and (ma3_prev < ma50_prev and ma3_last > ma50_last)
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15

                    and ma33_last < ma78_last
               
                    and ma3_last > ma13_last
                    
                    and ma2_last >= ma2_2_min_ago
                    
                    and macd_differenza_2_min_ago > -1.25
                ):  
                
                    buy = "BUY 2 incr al rialzo 3-50 MA 5-100 < -0.15 con ma450 > 2 ore e ma200 che sale da 1 ora e 33<78 - r 5860 B4 B3"
                    action = "buy"
                    percentage = 70

                    #  6 ott 2024 aggiunto anche incrocio al rialzo 3-150
                    #  6 gen 2025 3-50 al rialzo ma 3-100 MA 5-100 < -0.15 altrimenti prende molto prima.
                  
                    
                    
                elif (    
                    ma450_last > ma450_720_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma100_last > ma300_last
                    and ma20_last > ma50_last
                    
                    and delta_1 > delta_2
                    
                    and ma100_last >= ma100_10_min_ago
                    and (ma3_prev < ma90_prev and ma3_last > ma90_last)
                    
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
                    buy = "BUY 2 con 450> e 20>50 E incrocio 3-90 - r 5870 Ax 1x"
                    action = "buy"
                    percentage = 70
                    
                    # 13 feb 2023 aggiunta questa
                    # 22 feb 2024 aggiunta and ma100_last > ma100_10_min_ago
                    # 17 set 2024 3-90 invece di 5-90
                    # 29 mar 2025 se ritraccia con 450> and ma3_last > ma39_last
                    # 29 mar 2025 attenzione 3>39 vuol dire che forse non sta ancora ritracciando (sta al posto di 20>50)
                    # 10 apr 2025 con 20>50 non dovrebbe essere ritracciamento - bravo mario !
                    

                elif (
                    ma3_last > ma18_last
                    
                    and (ma20_last < ma50_last or ma3_last < ma39_last)
                    and ma450_last > ma450_720_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma100_last > ma300_last

                    and deviation_ma3_sotto_ma50 < -0.30
                    
                    and delta_1 > delta_2
                    
                    and ma100_last >= ma100_10_min_ago
                    and (ma3_prev < ma90_prev and ma3_last > ma90_last)
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
                    buy = f"BUY 2 {ma450_last} {ma450_120_min_ago} con 450> MA ritracciamento E incrocio 3-90 e dev 3-50 < -0.30 - r 5870 Ax1 xy"
                    action = "buy"
                    percentage = 70
                    
                    # 13 feb 2023 aggiunta questa
                    # 22 feb 2024 aggiunta and ma100_last > ma100_10_min_ago
                    # 17 set 2024 3-90 invece di 5-90
                    # 29 mar 2025 se ritraccia con 450> and ma3_last > ma39_last
                    # 29 mar 2025 attenzione 3>39 vuol dire che forse non sta ancora ritracciando (sta al posto di 20>50)
                    # 10 apr 2025 con 20<50 dovrebbe essere ritracciamento
                    # 10 apr 2025 con 20<50 and deviation_ma3_sotto_ma50 < -0.30
                    


                elif (
                    ma3_last > ma18_last
                    
                    and (ma20_last < ma50_last or ma3_last < ma39_last)
                    and ma450_last > ma450_720_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma100_last > ma300_last

                    and deviation_ma3_sotto_ma50 < -0.30

                    and delta_1 > delta_2
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    and deviation_ma5_sotto_ma200 < -0.15

                    and ma100_last >= ma100_10_min_ago
                    and (ma3_prev < ma90_prev and ma3_last > ma90_last)
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
                    buy = f"BUY 2 {ma450_last} {ma450_120_min_ago} con 450> 120 min MA ritraccia E incrocio 3-90 - r 5870 Ax2"
                    action = "buy"
                    percentage = 70
                    
                    # 13 feb 2023 aggiunta questa
                    # 22 feb 2024 aggiunta and ma100_last > ma100_10_min_ago
                    # 17 set 2024 3-90 invece di 5-90
                    # 29 mar 2025 se ritraccia con 450> MA ma3_last < ma39_last
                    # 29 mar 2025 attenzione 3<39 vuol dire che forse sta cominciando a ritracciare (sta al posto di 20<50)
                    # 10 apr 2025 ritracciamento con and (ma20_last < ma50_last or ma3_last < ma39_last)
                    

                elif (
                    ma3_last > ma18_last

                    and ma450_last > ma450_120_min_ago
                    and ma100_last >= ma100_10_min_ago
                    and ma100_last > ma300_last

                    and ma450_last < ma450_720_min_ago
                    and delta_1 > delta_2

                    and ((ma3_prev < ma90_prev and ma3_last > ma90_last) or (ma3_prev < ma200_prev and ma3_last > ma200_last))
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
                    buy = "BUY 2 con 450> and ma3_last > ma39_last e ma450_last > ma450_120_min_ago E incrocio 3-90 or 3-200 - r 5870 Ay1"
                    action = "buy"
                    percentage = 70
                    
                    # 13 feb 2023 aggiunta questa
                    # 22 feb 2024 aggiunta and ma100_last > ma100_10_min_ago
                    # 17 set 2024 3-90 invece di 5-90
                    # 29 mar 2025 se ritraccia con 450< and ma3_last > ma39_last
                    # 29 mar 2025 attenzione 3>39 vuol dire che forse non sta ancora ritracciando (20<50)
                    # 11 apr 2025 tolto 3-39
                    # 11 apr 2025 questa condizione con incrocio al rialzo 3-90 per adesso la tengo.
                    # 31 mag 2025 aggiunta or incrocio al rialzo 3-200



                elif (
                    ma3_last > ma13_last
                    
                    and (ma20_last < ma50_last or ma3_last < ma39_last)
                    and ma450_last > ma450_120_min_ago
                    and ma100_last > ma300_last
                    and ma100_last >= ma100_10_min_ago

                    and ma450_last < ma450_720_min_ago
                    and delta_1 > delta_2

                    and deviation_ma3_sotto_ma50 < -0.07
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    and deviation_ma5_sotto_ma200 < -0.15

                    and (ma3_prev < ma90_prev and ma3_last > ma90_last)
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
                    buy = f"BUY 2 {ma450_last} {ma450_120_min_ago} con 450< MA RITRACCIA E incrocio 3-90 - r 5870 Ay2"
                    action = "buy"
                    percentage = 70
                    
                    # 13 feb 2023 aggiunta questa
                    # 22 feb 2024 aggiunta and ma100_last > ma100_10_min_ago
                    # 17 set 2024 3-90 invece di 5-90
                    # 29 mar 2025 se ritraccia con 450< and ma3_last < ma39_last
                    # 29 mar 2025 attenzione 3<39 vuol dire che forse sta cominciando a ritracciare (sta al posto di 20<50)
                    # 10 apr 2025 RITRACCIAMENTO scritto cosi' and (ma20_last < ma50_last or ma3_last < ma39_last)
                    # 11 apr 2025 ordine e progresso


                
                elif (    
                    ma450_last > ma450_120_min_ago
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.23
                    
                    and (ma5_prev < ma90_prev and ma5_last > ma90_last)
                    and ma100_last > ma300_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 con ma450_last > ma450_120_min_ago E incrocio 5-90 - r 5870b"
                    action = "buy"
                    percentage = 70
                    
                    # 13 feb 2023 aggiunta questa
                    # 22 feb 2024 aggiunta se ma100_last < ma100_10_min_ago and deviation_ma5_sopra_o_sotto_ma100 > 0.23


                



                elif (
                    ma3_last > ma11_last

                    and ma20_last < ma50_last
                    
                    and ma450_last > ma450_360_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma250_last
                    and ma50_last > ma100_last

                    and delta_DNA_1 < delta_DNA_2
                    and delta_1 < delta_2

                    and deviation_ma3_sotto_ma50 < -0.01
                    and deviation_ma39 < -0.05

                    and (ma300_last > ma450_last or ma100_last > ma300_last)
                    
                    
                    and deviation_ma100_sopra_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma200 < -0.15
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                  
                ):    
                    buy = f"BUY 2 {ma450_last} {ma450_360_min_ago} con ma450_last > 120 min - GIORNO - con 20<50 ! - r 5892 A1 x1 x1 x1"
                    action = "buy"
                    percentage = 70

                    # 11 set 2024 forse e' da cancellare
                    # 16 feb 2025 se anche ma100_last > ma100_120_min_ago anticipata ndecchiecella
                    # 28 feb 2025 GIORNO !
                    # 28 mar 2025 quando ritraccia vedi 20<50
                    # 30 mar 2025 and deviation_ma200_sotto_ma300 > -0.07 ignifica che sotto questa soglia non si tratta piu' di ritracciamento.
                    #  3 apr 2025 and deviation_ma3_sotto_ma50 < -0.25 da -0.06
                    #  6 apr 2025 aggiunto and deviation_ma100_sopra_ma300 < -0.30
                    #  6 apr 2025 aggiunto and deviation_ma25_sotto_ma300 < -0.30
                    #  8 apr 2025 le basi del ritracciamento non ci sono se 100>100 60 min ago
                    #  8 apr 2025 se 50 sta SOPRA 100 non ci sono ancora le basi del ritracciamento
                    # 10 apr 2025 correzione or e aggiunta f
                    # 11 apr 2025 ordine e progresso



                elif (
                    ma3_last > ma11_last

                    and (ma20_last < ma50_last or ma50_last < ma100_last)
                    and ma450_last > ma450_360_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma300_last > ma450_last
                    and ma200_last > ma250_last
                    and ma100_last > ma300_last
                    and delta_1 < delta_2
                    and delta_DNA_1 < delta_DNA_2

                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma39 < -0.05
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    
                    and deviation_ma3_sotto_ma50 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.30

                    and deviation_ma5_sotto_ma200 < -0.15
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                  
                ):    
                    buy = f"BUY 2 {ma450_last} {ma450_360_min_ago} con ma450_last > 120 min - GIORNO - MA RITRACCIAMENTO ! - r 5892 A1x1 x1x2"
                    action = "buy"
                    percentage = 70
                    
                    # 11 set 2024 forse e' da cancellare
                    # 16 feb 2025 se anche ma100_last > ma100_120_min_ago anticipata ndecchiecella
                    # 28 feb 2025 GIORNO !
                    # 28 mar 2025 quando ritraccia vedi 20<50
                    # 30 mar 2025 and deviation_ma200_sotto_ma300 > -0.07 ignifica che sotto questa soglia non si tratta piu' di ritracciamento.
                    #  3 apr 2025 and deviation_ma3_sotto_ma50 < -0.25 da -0.06
                    #  6 apr 2025 aggiunto and deviation_ma100_sopra_ma300 < -0.30
                    #  6 apr 2025 aggiunto and deviation_ma25_sotto_ma300 < -0.30
                    #  8 apr 2025 le basi del ritracciamento non ci sono se 100>100 60 min ago
                    #  8 apr 2025 se anche 50 sta SOTTO 100 ci sono le basi del ritracciamento



                elif (
                    ma3_last > ma11_last

                    and ma20_last < ma50_last
                    and ma450_last > ma450_360_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma200_last > ma250_last
                    and (ma300_last > ma450_last or ma100_last > ma300_last)
                    and delta_1 < delta_2
                    and delta_DNA_1 < delta_DNA_2

                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma3_sotto_ma50 < -0.01

                    and deviation_ma100_sopra_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.30

                    and deviation_ma39 < -0.05

                    and ma100_last < ma100_60_min_ago
                    and deviation_ma5_sotto_ma200 < -0.15
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                  
                ):    
                    buy = f"BUY 2 {ma450_last} {ma450_360_min_ago} con ma450 > ma450 360 min E GIORNO MA ritracciamento - r 5892 A1x1 x1x"
                    action = "buy"
                    percentage = 70
                    
                    # 11 set 2024 forse e' da cancellare
                    # 16 feb 2025 se anche ma100_last > ma100_120_min_ago anticipata ndecchiecella
                    # 28 feb 2025 GIORNO !
                    # 28 mar 2025 quando ritraccia vedi 20<50
                    
                    #  3 apr 2025 and deviation_ma3_sotto_ma50 < -0.25 da -0.06
                    #  6 apr 2025 aggiunto and deviation_ma100_sopra_ma300 < -0.30
                    #  6 apr 2025 aggiunto and deviation_ma25_sotto_ma300 < -0.30
                    #  8 apr 2025 le basi del ritracciamento ci sono perche' anche 100 < 100 60 min ago
                    # 11 apr 2025 ordine e progresso



                
                elif (
                    ma3_last > ma18_last

                    and ma20_last < ma50_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma3_sotto_ma50 < -0.15

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 > delta_DNA_2
                    
                    

                    and ma100_last > ma100_120_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and ma200_last > ma250_last
                    and ma200_last > ma200_120_min_ago
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -10.50
                    
                ):    
                    buy = "BUY 2 con ma450 > ma450 120 min e 300>300 60 min + DNA - NOTTE E se 20<50 ritracciamento - r 5892 A1x1 X2"
                    action = "buy"
                    percentage = 70

                    # 11 set 2024 forse e' da cancellare
                    # 16 feb 2025 se anche ma100_last > ma100_120_min_ago anticipata ndecchiecella
                    # 28 feb 2025 aggiunta DNA - NOTTE !

                    # 18 apr 2025 se 20<50 ritracciamento
                    # 18 apr 2025 SE ritracciamento allora and deviation_ma5_sopra_o_sotto_ma100 < -0.15



                elif (
                    ma3_last > ma39_last

                    and ma100_last > ma100_300_min_ago
                    and ma100_last < ma100_120_min_ago

                    and ma300_last > ma300_120_min_ago
                    and ma78_last < ma150_last
                    

                    and deviation_ma25_sotto_ma300 < -0.35
                    and deviation_ma50_sotto_ma300 < -0.35
                    and deviation_ma39 < 0.07
                    and deviation_ma3_sotto_ma50 < 0.03
                    and deviation_ma5_sopra_o_sotto_ma100 < 0.01
                    and deviation_ma5_sotto_ma200 < -0.15
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma5_sotto_ma450 < -0.25

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12

                    and ma450_last > ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and ma3_last > ma8_last
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd > -70
                ):    
                    buy = "BUY 2 con ma450_last > ma450_120_min_ago E con 3-39 e con 300>300 60 min ago  - r 5892 A1x1 y"
                    action = "buy"
                    percentage = 70

                    # 11 set 2024 forse e' da cancellare
                    # 16 feb 2025 aggiunta osso e cuspide 


                elif (
                    ma8_last > ma50_last
                    and ma450_last > ma450_120_min_ago
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and ma200_last > ma250_last
                    and ma200_last > ma200_120_min_ago
                    
                    and deviation > -0.30
                    and deviation_bellissima > 0.02
                    and deviation_ma4_sopra_ma30 > 0.15
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last > ma8_last
                    and ma3_last >= ma39_last
                    and ma5_last >= ma15_last
                    
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 con ma450_last > ma450_120_min_ago E con 8-50 e e con prendi il coltello con il piede se 300<300 60 min ago - r 5892 A1x2"
                    action = "buy"
                    percentage = 70

                    # 11 set 2024 aggiunta coltello con il piede se ma300<300 60 min ago


                elif (
                    ma3_last > ma20_last
                    and ma450_last < ma450_120_min_ago

                    and deviation_ma3_sotto_ma50 < -0.16
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    
                    and ma200_last > ma250_last
                    and ma200_last > ma200_120_min_ago

                    and ma3_last > ma8_last
                    
                    and ma5_last >= ma5_2_min_ago
                    and macd_differenza_2_min_ago > -18.50
                ):    
                    buy = "BUY 2 CON ma450_last < ma450_120_min_ago MA  - r 5892 A1 Y1"
                    action = "buy"
                    percentage = 70

                    # 26 feb 2025 se 39 continua a stare sopra 50 NESSUN PROBLEMA !
                    # 15 apr 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.15
                    # 15 apr 2025 aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    #  7 ago 2025 aggiunta and ma5_last >= ma5_2_min_ago
                    #  7 ago 2025 and deviation_ma3_sotto_ma50 a -0.16 da -0.15


                elif (
                    ma3_last > ma20_last
                    and ma450_last < ma450_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma200_last > ma200_60_min_ago

                    and ma20_last < ma50_last
                    and deviation_ma3_sotto_ma50 < -0.01
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > 0.72
                    and ma39_last < ma39_10_min_ago
                    
                    and ma25_last > ma200_last
                    and ma200_last > ma250_last
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -5.50
                    
                ):    
                    buy = f"BUY 2 {ma200_last} {ma200_120_min_ago} CON ma450< MA 200> and ma20_last < ma50_last - RITRACCIAMENTO ! - r 5892 A1 Y2"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    #  2 ott dev bellissima 0.06 da 0.07
                    #  4 feb 2025 se 25>100 anticipata !
                    # 26 feb 2025 MA se 39 VA SOTTO 50 allora :
                    # 26 feb 2025 ritracciamento !
                    # 10 apr 2025 and ma20_last < ma50_last ritracciamento
              
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and ma200_last < ma250_last
                    
                    
                    and ma8_last > ma50_last
                    and ma200_last > ma200_120_min_ago
                    and ma78_last > ma78_20_min_ago
                    
                    and deviation > -0.30
                    and deviation_bellissima > 0.06
                    
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last >= ma69_last
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO se ma39 > ma50 E CON 78 > 78 30 min ago - r 5892 A2"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 2 ott dev bellissima 0.06 da 0.07
                    
                    
                    
                    
                    
                    
                # BUY 2 RIVOLUZIONARIO se ma39 > ma50 - r 3450
                
                
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma250_sopra_ma300 > 0.04
                    and delta_1_200_78 < delta_2_200_78_60_min
                    
                    and deviation_ma3_sopra_ma10 > 0.08
                    and deviation_bellissima > 0.02
                    
                    and ma200_last > ma200_120_min_ago
                    and ma78_last < ma78_30_min_ago
                    
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO se ma39 > ma50 MA 78 < 78 30 min ago E CON 3-10 > 0.17 - r 5919 b1x"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    
                    
                    
                    
                # BUY 2 RIVOLUZIONARIO se ma39 > ma50 - r 3450
                
                
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma250_sopra_ma300 > 0.04
                    and delta_1_200_78 > delta_2_200_78_60_min
                    and deviation_ma3_sopra_ma30 > 0.31
                    
                    and deviation_ma3_sopra_ma10 > 0.08
                    and deviation_ma5_sopra_ma28 > 0.20
                    and deviation_bellissima > 0.02
                    
                    and ma200_last > ma200_120_min_ago
                    and ma78_last < ma78_30_min_ago
                    
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO se ma39 > ma50 MA 78 < 78 30 min ago E CON 3-10 > 0.17 - r 5919 b1y"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # doppio delta > notte aumento 5-28 cazzo
                    # aggiungo dev 3-30 ! vedi 29 ottobre 2022 ore 19:52
                    # il BUY C'E' MA E' COME SE NON CI FOSSE !
                    
                    
                 
                    
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma250_sopra_ma300 < 0.04
                    and deviation_ma250_sopra_ma300 > -0.04
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma3_sopra_ma16 > 0.173
                    and deviation_bellissima > 0.03
                    
                    and ma200_last > ma200_120_min_ago
                    and ma78_last < ma78_30_min_ago
                    
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO se ma39 > ma50 MA 78 < 78 30 min ago E CON 3-10 > 0.10 and deviation_ma3_sopra_ma16 > 0.173 - r 5919 B2"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 8 giu aggiunta and deviation_ma3_sopra_ma16 > 0.173
                    
                    
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma250_sopra_ma300 < -0.04
                    
                    and deviation_ma3_sopra_ma10 > 0.15
                    and deviation_bellissima > 0.05
                    
                    and ma200_last > ma200_120_min_ago
                    and ma78_last < ma78_30_min_ago
                    
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO se ma39 > ma50 MA 78 < 78 30 min ago E CON 3-10 > 0.17 - r 5919 b3"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    
                    
                    
                # BUY 2 RIVOLUZIONARIO A1 (100 NON E' ATTACCATA ALLA 300 !) deviation_ma100_sopra_ma300 > 0.05 e 39>50 E 8>200
                
                elif (
                    deviation_ma4_sopra_ma30 > 0.14
                    and deviation_bellissima > 0.06
                    
                    and deviation_ma100_sopra_ma300 > 0.05
                    
                    and ma200_last < ma200_120_min_ago
                    and ma8_last > ma200_last
                    
                    and deviation > -0.30
                    
                    and ma28_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO A1 (100 CHE NON E' ATTACCATA ALLA 300 !) e ma39 > ma50 E 8>200 - r 5945 A1"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 26 set 100-300 se stanno attaccate e' molto rischioso ! vedi ore 22:48 24 set 2022
                    
                    
                # BUY 2 RIVOLUZIONARIO A2 (100 E' ATTACCATA ALLA 300 !) (pericolo !) (deviation_ma100_sopra_ma300 tra 0.05 e -0.05) e 39>50 E 8>200
                
                elif (
                    deviation_ma4_sopra_ma30 > 0.14
                    and deviation_bellissima > 0.06
                    
                    and deviation_ma100_sopra_ma300 < 0.05
                    and deviation_ma100_sopra_ma300 > -0.05
                    and deviation_ma3_sopra_ma10 > 0.11
                    
                    and ma200_last < ma200_120_min_ago
                    and ma8_last > ma200_last
                    
                    and deviation > -0.30
                    
                    and ma28_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO A2 (con 100 CHE E' ATTACCATA ALLA 300 !) (pericolo !) E 3-10 > 0.11 e 39 > 50 and 8 > 200 - r 5945 A2"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 26 set 100-300 se stanno attaccate e' molto rischioso ! vedi ore 22:48 24 set 2022
                    
                    
                    
                    
                # BUY 2 RIVOLUZIONARIO A3x (100 NON E' ATTACCATA ALLA 300 !) e 39>50 E 8>200 and deviation_ma100_sopra_ma300 > 0.05

                elif (
                    ma3_last > ma8_last

                    and ma100_last > ma100_60_min_ago

                    and ma300_last > ma300_301_min_ago
                    and ma200_last < ma200_120_min_ago
                    
                    and ma5_last > ma50_last
                    and delta_1 < delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= -60
                ):    
                    buy = "BUY 2 CON ma300_last > ma300_301_min_ago e con delta_1 < delta_2 E 100< - r 5945 A3 X1 X"
                    action = "buy"
                    percentage = 70
                    
                    # 26 set 100-300 se stanno attaccate e' molto rischioso ! vedi ore 22:48 24 set 2022
                    # 15 dic 2022 8-28 da 28-50
                    # 23 feb 2023 aggiunta 3-18 > 0.10
                    # 22 mag 2023 se ma300_last > ma300_301_min_agovbuy con 5-50 da 5-200
                    # 28 gen 2025 se GIORNO anticipata ndecchia
                    # 14 ago 2025 se 100 > 60 min ok cosi'



                elif (
                    ma3_last > ma8_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.35)

                    and ma300_last > ma300_301_min_ago
                    and ma200_last < ma200_120_min_ago
                    
                    and ma5_last > ma50_last
                    and delta_1 < delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= -60
                ):    
                    buy = "BUY 2 CON ma300_last > ma300_301_min_ago e con delta_1 < delta_2 MA 100< + IL MIO CAPOLAVORO - r 5945 A3 X1 Y"
                    action = "buy"
                    percentage = 70
                    
                    # 26 set 100-300 se stanno attaccate e' molto rischioso ! vedi ore 22:48 24 set 2022
                    # 15 dic 2022 8-28 da 28-50
                    # 23 feb 2023 aggiunta 3-18 > 0.10
                    # 22 mag 2023 se ma300_last > ma300_301_min_agovbuy con 5-50 da 5-200
                    # 28 gen 2025 se GIORNO anticipata ndecchia
                    # 14 ago 2025 se 100 < 60 min OR delta CV 25-300 NOTTE aggiunto IL MIO CAPOLAVORO

                    
                    
                    
                # BUY 2 RIVOLUZIONARIO A3x (100 NON E' ATTACCATA ALLA 300 !) e 39>50 E 8>200 and deviation_ma100_sopra_ma300 > 0.05 
                
                elif (
                    ma4_last > ma30_last
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and ma300_last < ma300_301_min_ago
                    and ma200_last < ma200_120_min_ago
                    
                    and delta_1 < delta_2
                    and deviation_ma100_sopra_ma300 < -0.05 
                    
                    and deviation_ma3_sopra_ma16 > 0.07
                    
         
                    and deviation > -0.30
                    
                    and delta_buy3_incrocio_ma3_ma8 >= 0.01
                    
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO A3x con ma300 < 6 ore con delta_1 < delta_2 e con 100 CHE NON E' ATTACCATA ALLA 300 ! con 5-39 - r 5945 A3 X2"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 26 set 100-300 se stanno attaccate e' molto rischioso ! vedi ore 22:48 24 set 2022
                    # 15 dic 2022 8-28 da 28-50
                    # 23 feb 2023 aggiunta 3-18 > 0.10
                    # 21 FEB 2024 ANTICIPATA NDECCHIECELLA
                    
                    
                    
                    
                # BUY 2 RIVOLUZIONARIO A3y (100 NON E' ATTACCATA ALLA 300 !) e 39>50 E 8>200 and deviation_ma100_sopra_ma300 > 0.05

                
                elif (
                    ma5_last > ma50_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma200_last < ma200_120_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation > -0.30
                    and deviation_ma4_sopra_ma30 > 0.04
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO con 5-50 e CON delta_1 > delta_2 e con 100 CHE NON E' ATTACCATA ALLA 300 ! e 8>50 and 5>72 - r 5945 A3 Y NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70

                
                elif (
                    ma5_last > ma50_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma5_last > ma50_last
                    
                    and ma200_last < ma200_120_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation > -0.30
                    and deviation_ma4_sopra_ma30 > 0.04
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO con 5-50 e CON delta_1 > delta_2 e con 100 CHE NON E' ATTACCATA ALLA 300 ! e 8>50 and 5>72 - r 5945 A3 Y NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 70

                
                elif (
                    ma3_last > ma20_last

                    and deviation_ma300_sopra_ma450 < -0.22
                    and deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago < -1.10
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15
                    

                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma10_sopra_ma200 < -0.20
                   
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.15
                    and deviation_ma50_sotto_ma300 < -0.15

                    and deviation_ma39 < 0.03
                    and deviation_ma3_sotto_ma50 < 0.03

                    and deviation_ma5_sopra_o_sotto_ma100 < 0.01
                    and deviation_ma5_sotto_ma200 < -0.01
                    and deviation_ma5_sotto_ma300 < -0.10
                    and deviation_ma5_sotto_ma450 < -0.10

                    and ma200_last < ma200_120_min_ago
                    and delta_1 > delta_2
                    
                    and ma3_last > ma8_last
                    and macd >= -70
                ):    
                    buy = "BUY 2 con 3-20 e CON delta_1 > delta_2 e con DNAM e continua a scendere circello - r 5945 A3 Y NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 70

                    #  1 dic 2024 aggiunta DNAM SOFT perche' e' presente and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    #  3 feb 2025 aggiunta and deviation_ma5_sotto_ma300 < -0.40
                    #  3 feb 2025 aggiunta and deviation_ma10_sopra_ma200 < -0.30
                    # 17 feb 2025 aggiunta continua a scendere circello

                
                elif (
                    ma3_last > ma39_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma200_last < ma200_120_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation > -0.30
                    and deviation_ma4_sopra_ma30 > 0.04
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO con 5-50 e CON delta_1 > delta_2 e con 100 CHE NON E' ATTACCATA ALLA 300 ! e 8>50 and 5>72 - r 5945 A3 Y NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70

                
                elif (
                    ma5_last > ma50_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                    
                    and ma200_last < ma200_120_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation > -0.30
                    and deviation_ma4_sopra_ma30 > 0.04
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO con 5-50 e CON delta_1 > delta_2 e con 100 CHE NON E' ATTACCATA ALLA 300 ! e 8>50 and 5>72 - r 5945 A3 Y NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70

                elif (
                    ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma3_last > ma39_last
                    
                    and ma200_last < ma200_120_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation > -0.30
                    and deviation_ma4_sopra_ma30 > 0.04
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO con 5-50 e CON delta_1 > delta_2 e con 100 CHE NON E' ATTACCATA ALLA 300 ! e 8>50 and 5>72 - r 5945 A3 Y NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70

              
                elif (
                    ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma3_last > ma39_last
                    
                    and ma200_last < ma200_120_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma100_sopra_ma300 < -0.05
                    and deviation > -0.30
                    and deviation_ma4_sopra_ma30 > 0.04
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 RIVOLUZIONARIO con 5-50 e CON delta_1 > delta_2 e con 100 CHE NON E' ATTACCATA ALLA 300 ! e 8>50 and 5>72 - r 5945 A3 Y NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 26 set 100-300 se stanno attaccate e' molto rischioso ! vedi ore 22:48 24 set 2022
                    # 15 dic 2022 8-28 da 28-50
                    # 10 nov 2023 5-72 da 5-200
                  
                    
                    
                    
                # BUY 2 nuovo tentando di prendere il coltello con il piede
                
                elif (
                    
                    deviation_ma39 < -0.10
                    and ma300_last > ma300_301_min_ago

                    and ma8_last < ma200_last
                    and ma78_last < ma78_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma20_last <= ma20_2_min_ago
                    and ma50_last <= ma50_2_min_ago

                    and ma10_last > ma20_last
                    and deviation_ma5_sotto_ma200 > -0.64
                    
                    and ma3_last > ma8_last
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
               
                ):    
                    buy = "BUY 2 nuovo tentando di prendere il coltello con il piede - r 5945 B"
                    action = "buy"
                    percentage = 70
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # > estate se 8 sta sotto 200 4-30 >0.20 and dev bellissima >0.10
                    # 12 set 2024 modificata radicalmente questa condizione
                    
                
                
                
                # RIALZO IMPROVVISO 200< DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE !
                
                elif (    
                   
                    ma200_last < ma200_20_min_ago
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_rialzo_improvviso_1 > 0.99
                    and deviation_rialzo_improvviso_2 > 0.20
                    and deviation_rialzo_improvviso_3 > 0.20
                    and deviation_rialzo_improvviso_4 > 0.20
              
                    and deviation_range_1 < 0.20
                    and deviation_range_1 > -0.20
                    and deviation_range_2 < 0.20
                    and deviation_range_2 > -0.20
                    and deviation_range_3 < 0.20
                    and deviation_range_3 > -0.20
             
                    and deviation_range_x < 0.20
                    and deviation_range_x > -0.20
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 2 RIALZO IMPROVVISO NO CROLLO con 200 < pericolo falsi acquisti DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE ! - r 5978 A"
                    action = "buy"
                    percentage = 70
                    
                    # 8 luglio 2022 ore 3:28 e' capitato rialzo improvviso sul BUY 2 !
                    
                    
                    
                # RIALZO IMPROVVISO 200< DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE !
                
                elif (    
                   
                    ma200_last < ma200_20_min_ago
                    and deviation_ma100_sopra_ma300 < -0.30
                    and deviation_ma3_sopra_ma10 > 0.05
                    
                    and deviation_rialzo_improvviso_1 > 0.99
                    and deviation_rialzo_improvviso_2 > 0.20
                    and deviation_rialzo_improvviso_3 > 0.20
                    and deviation_rialzo_improvviso_4 > 0.20
              
                    and deviation_range_1 < 0.20
                    and deviation_range_1 > -0.20
                    and deviation_range_2 < 0.20
                    and deviation_range_2 > -0.20
                    and deviation_range_3 < 0.20
                    and deviation_range_3 > -0.20
             
                    and deviation_range_x < 0.20
                    and deviation_range_x > -0.20
                    and macd >= macd_2_min_ago
                ):

                    buy = "BUY 2 RIALZO IMPROVVISO DURANTE CROLLO (aggiunta 3-10 !) con 200 < pericolo falsi acquisti - POTREBBE SUCCEDERE ! e' successo ! - r 5978 B"
                    action = "buy"
                    percentage = 70
                    
                    # 8 luglio 2022 ore 3:28 e' capitato rialzo improvviso sul BUY 2 !
                    # 13 ott 2022 ore 14:30 ha comprato durante un crollo pesante...
                    
                    
                    
                    
                # RIALZO IMPROVVISO 200> DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE !
                
                elif (
                    ma200_last > ma200_20_min_ago
                    
                    and deviation_rialzo_improvviso_sopra > 0.78
                    and deviation_rialzo_improvviso_1 > 0.46
                    and deviation_rialzo_improvviso_2 > 0.19
                    and deviation_rialzo_improvviso_3 > 0.19
                    and deviation_range_1 < 0.22
                    and deviation_range_1 > -0.22
                    and deviation_range_2 < 0.22
                    and deviation_range_2 > -0.22
                    and deviation_range_x < 0.22
                    and deviation_range_x > -0.22
                    and macd >= macd_2_min_ago
                ):
             
                    buy = "BUY 2 RIALZO IMPROVVISO con 200 > e con > 0.72 DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE e' successo ! - r 5979 A"
                    action = "buy"
                    percentage = 70
                    
                    # 1 luglio a 0.72 da 0.82
                    # 8 luglio 2022 ore 3:28 e' capitato rialzo improvviso sul BUY 2
                    # 21 lug 2022 0.78 da 0.22
                    
                    
                    
                    
                    
                    
                # BUY 2 CHE MANCAVA DOPO 5 ore di ribasso
                
                elif (
                    deviation_ma5_sopra_ma28 > 0.30
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_301_min_ago
                    and ma200_last < ma200_301_min_ago
                    and ma300_last < ma300_301_min_ago
                    
                    and deviation_ma300__diviso_ma300_5_ore_ago < -0.25
                    and deviation_ma5_sotto_ma300 < -0.43
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 2 CHE MANCAVA DOPO 5 ore di ribasso buy con 5-28>0.30 perdio se entra >5 ore deve essere piu' sicuro ! - r 5979 B"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                    
                # BUY 2 ultima condizione ! ma tutte negative MA BUY con 50-100 (integra r2505)
                
                elif (     
               
                    ma50_last > ma100_last
                    and ma78_last > ma100_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.11
                    and deviation_ma5_sopra_ma28 > 0.13
                    and deviation_buy_ma5_sopra_ma20 > 0.01
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):    
                    buy = "BUY 2 ULTIMA CONDIZIONE ! ma tutte negative MA 50 > 100 (integra r2505) con 78>100 - r 5980 a"
                    action = "buy"
                    percentage = 70
                    
                    # aggiunta di 5-28 > 0.12
                    # 22 set aggiunta di 3-10 > 0.11
                    
                    
                    
                # BUY 2 ultima condizione ! ma tutte negative MA BUY con 50-100 (integra r2505)
                
                   
                
                elif (    
                    ma13_last > ma50_last
                    
                    and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago

                    and ma100_last < ma100_10_min_ago
                    and ma100_last < ma100_60_min_ago
                
                    and deviation_ma39 < 0.13

                    and ma39_last < ma100_last
                    and ma78_last < ma100_last
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and macd_differenza_2_min_ago > -18.5
                ):    
                    buy = f"""BUY 2 ULTIMA CONDIZIONE ! ma tutte negative e con 78<100 MA 13 > 50 - r 5980 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}
                    
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """

                    action = "buy"
                    percentage = 70
                    
                    # aggiunta di 5-28 > 0.12
                    # 26 set 2025 anticipata e aggiunte parentesi graffe
                    # 16 ott 2025 aggiunto and delta_CM_300_25_last < delta_CM_300_25_2_min_ago
                    # 16 ott 2025 aggiunte parentesi graffe sulla stessa riga




                # LA MIA OPERA D' ARTE - prendi il coltello con il piede + vendita bocelli

                elif (
                    ma3_last > ma20_last
                    and deviation_ma78_sopra_o_sotto_ma78_30_min_ago < -0.10
                    and ma300_last < ma300_301_min_ago
                    and deviation_ma5_sotto_ma200 < -0.40
                    and delta_1 > delta_2
                    
                    and ma50_differenza_ma59 < -5
                    
                    and deviation_ma5_sotto_ma300 < -0.42
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02

                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.05

                    and ma2_last >= ma5_last
                    and macd_differenza_2_min_ago > -2.50
 
                ):
                    buy = "BUY 2 durante un TREND RIBASSISTA LA MIA OPERA D' ARTE - prendi il coltello con il piede + vendita bocelli - r 5983"
                    action = "buy"
                    percentage = 80
                    
                    # 13 feb 2023 3-10 > 0.02
                    #  1 ago 2023 5-200 invece di 10-100
                    # 24 ago 2023 and macd > macd_2_min_ago
                    # 24 ago 2023 and macd > 5
                    # 16 set 2023 5-78 invece di 5-200
                    # 13 nov 2023 non ha preso macd > !!! allora l' ho messo anche sopra
                    # 13 nov 2023 5-39 da 5-54 posso farlo perche' il sell e' molto piu' reattivo ! RICORDA dev 39 < 0.13 !
                    # 30 nov 2023 ma78 e' proprio discendente. continuava a comprare inutilmente. 
                    # 30 nov 2023 IL TITOLO SEMBRA AVER INTRAPRESO UN VERO E PRORIO TREND RIBASSISTA !
                    # 18 set 2024 aggiunta perche' non aveva comprato come, invece, aveva fatto RCCR ma con l' avvento di prendi il coltello con il piede !
                    # 18 set 2024 E DELLA VENDITA BOCELLI. perche' mi e' sembrato giusto comprare quando ha venduto !!!
                    #  2 mar 2025 la mia opera d' arte ho voluto tenerla anche se avrei potuto modificarla con COMINCIA A SCENDERE !
                    #  2 mar 2025 ma io sono un romantico e poi le commissioni di binance mi consentono di provarci.
                        
                elif (
                    
                    ma8_last > ma54_last
                    and ma78_last > ma200_last
                    and deviation_ma5_sotto_ma300 > -0.40
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 > 0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > 5
                ):
                    buy = "BUY 2 > 180 min di ribasso 26 luglio 2023 MA SE ma78_last > ma200_last COMPRA 8-54 - r 5984a"
                    action = "buy"
                    percentage = 90
                    
                    # 24 ago 2023 macd > macd 2 min ago
                    # 24 ago 2023 macd > 5



                elif (
                    
                    ma3_last > ma18_last

                    and delta_1 < delta_2
                    
                    and ma78_last < ma200_last
                    and ma100_last < ma100_60_min_ago

                    and deviation_ma25_sotto_ma300 < -0.40
                    and deviation_ma50_sotto_ma300 < -0.30
                    and deviation_ma39 < 0.20
                    and deviation_ma3_sotto_ma50 < 0.04
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma5_sotto_ma300 < -0.25

                    and deviation_ma5_sotto_ma300 > -0.60
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 2 > 180 min di ribasso 26 luglio 2023 CON 78<200 - se GIORNO and deviation_ma39 < -0.20 - r 5984 Bx"
                    action = "buy"
                    percentage = 90

                    # 27 mar 2025 se GIORNO and deviation_ma39 < -0.20



                
                elif (    
                    ma3_last > ma18_last
                    
                    and delta_1 > delta_2

                    and ma78_last < ma200_last
                    and ma100_last < ma100_60_min_ago

                    and deviation_ma25_sotto_ma300 < -0.40
                    and deviation_ma50_sotto_ma300 < -0.30
                    and deviation_ma39 < -0.40
                    and deviation_ma3_sotto_ma50 < 0.04
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma5_sotto_ma300 < -0.25

                    and deviation_ma5_sotto_ma300 > -0.60
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 2 > 180 min di ribasso 26 luglio 2023 CON 78<200 - se NOTTE and deviation_ma39 < -0.40 - r 5984 By"
                    action = "buy"
                    percentage = 90
                    
                    # 24 ago 2023 macd > macd 2 min ago
                    # 24 ago 2023 macd > 5
                    # 10 nov 2024 aggiunta ZIA AMALIA 
                    # 10 nov 2024 ho tenuto and deviation_ma5_sotto_ma300 > -0.60 perche' non e' una condizione di crollo
                    # 10 nov 2024 durante il crollo intervengono altre condizioni
                    # 27 mar 2025 ok solo macd diff > -18.50
                    # 27 mar 2025 se NOTTE and deviation_ma39 < -0.40

              

                # BUY 2 crollo MISSILE COMPA ! modo 2

                elif (    
                    ma3_last > ma4_last
                    
                    and (ma450_last > ma450_480_min_ago or ma78_last < ma300_last)

                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.05

                    and macd < -245
                ):
                    buy = "BUY 2 crollo MISSILE COMPA modo 2 con 3>4 AND MACD < -245 ! - AGOSTO 2023 - r 5985 x"
                    action = "buy"
                    percentage = 80

                    #  3 mar 2025 e' andata benissimo ! resta !
                    #  3 mar 2025 aggiunta and (ma450_last > ma450_480_min_ago)
                    #  3 apr 2025 aggiunta 3-39 e 3-50
                    # 17 ago 2025 MISSILE COMPA e' andato bene. voglio tenerlo. (anche se il trend ha continuato a scendere)



                      
                elif (    
                    ma3_last > ma4_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
                    and ma78_last < ma300_last
                    and macd < -245
                ):
                    buy = "BUY 2 crollo MISSILE COMPA modo 2 con 3>4 AND MACD < -245 ! and ma78_last < ma300_last - AGOSTO 2023 - r 5985 y"
                    action = "buy"
                    percentage = 80

                    #  3 mar 2025 e' andata benissimo ! resta !
                    #  3 mar 2025 aggiunta and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)


                elif (    
                    ma50_last < ma50_2_min_ago
                    and ma5_last > ma39_last
                     
                    and deviation_ma5_sotto_ma300 < 0.30
                      
                        
                    and ma300_last < ma300_120_min_ago
                    and ma100_last > ma100_60_min_ago
                      
                    and ma5_last > ma5_2_min_ago
                     
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 2 ZIA MARIA con ma50 < MA ma100 > E ma300 < e con 5-39 - r 5987"
                    action = "sell"

              
                    
                elif (     
                    ma3_last > ma18_last
                    and ma39_last > ma39_15_min_ago
                    
                    and ma2_last >= ma20_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 3
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 prendo coltello con il piede E ma450 che sale da 6 ore and 3-18 > -0.02 + MACD > - r 5994 a"
                    action = "buy"
                    percentage = 90


                elif (     
                    ma3_last > ma18_last

                    and ma100_last < ma100_30_min_ago

                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma50_sotto_ma300 < -0.36
                    and deviation_ma39 < 0.13
                    and deviation_ma3_sotto_ma50 < -0.02
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma5_sotto_ma200 < -0.25
                    and deviation_ma5_sotto_ma300 < -0.60
                    and deviation_ma5_sotto_ma300 < -1.20

                    and ma39_last < ma39_15_min_ago
                    
                   
                    and ma450_last > ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.010
                    and ma3_differenza_2_min_ago > 3
                    and macd >= -40
                    and macd_differenza_2_min_ago > -1.30
                ):    
                    buy = "BUY 2 prendo coltello con il piede E ma450 che sale da 6 ore and 3-18 > -0.02 + MACD > - r 5994 B"
                    action = "buy"
                    percentage = 90

                    #  9 set 2024 and deviation_ma5_sopra_o_sotto_ma100 < -0.40 da -0.35 MA FORSE E' DA TOGLIERE
                    #  7 ott 2024 aggiunto osso and deviation_ma5_sopra_o_sotto_ma100 < -0.13 
                    #  4 nov 2024 aggiunta and deviation_ma3_sotto_ma50 < -0.02
                    #  9 nov 2024 aggiunte tutte le NUOVE DEVIATION GRAFANA

                elif (     
                    ma3_last > ma18_last
                    
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192
               
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma20_last
                    
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma3_differenza_2_min_ago > 3
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 pugno fantasma di mohammad ali' E ma450 che sale da 6 ore and 3-18 > -0.02 + MACD > - r 5994 c"
                    action = "buy"
                    percentage = 90
                    
                    # 17 ott 2023 and deviation_ma3_sopra_ma10 > 0.027 da > 0.025 (per favore lascia almeno 0.027 al 3-10)
                    # 17 ott 2023 3-18 > -0.02 da > -0.02
                    # 17 ott 2023 3-18 da 3-20
                    # 31 ott 2023 aggiunto and ma2_last > ma5_last
                    #  1 dic 2023 aggiunto and ma2_differenza_2_min_ago > 5
                    #  7 dic 2023 aggiunta and ma3_differenza_2_min_ago > 5
                    #  7 dic 2023 diff ma2 a > 6 da > 5
                    
                    # 23 dic 2023 diff ma2 a 9 da 6
                    # 23 dic 2023 and ma3_differenza_2_min_ago a 6 da 5
                    # 23 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 23 dic 2023 aggiunta and macd_differenza_2_min_ago > 0.30
                    # 11 gen 2024 and deviation_ma300_sopra_ma450 > -0.70 da -0.60
                    # 11 gen 2024 and macd_differenza_2_min_ago > 0.10 da 0.30 
                    # 22 feb 2024 aggiunta perche' sul RCCR e' andata benissimo (ma ho aggiunto anche and deviation_ma5_sopra_o_sotto_ma100 < -0.36)




                elif (
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 compare forever importato da r 1537 A3y con 3-18 E 300 vicina alla 450 ( anche poco sotto ! ) we 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

                
                elif (
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 compare forever importato da r 1537 A3y con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) and 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90

                
                elif (
                    ma3_last > ma18_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 compare forever importato da r 1537 A3y con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) and 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90

                elif (
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 compare forever importato da r 1537 A3y con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) and 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90

                elif (
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 compare forever importato da r 1537 A3y con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) and 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (
                    ma3_last > ma18_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 compare forever importato da r 1537 A3y con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) and 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90
                    

                elif (
                    ma3_last > ma18_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 compare forever importato da r 1537 A3y con 3-18 E CON 300 vicina alla 450 ( anche sotto ! ) and 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (
                    ma3_last > ma18_last

                    and delta_300_200 > delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -1.20

                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_30_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.70
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last >= ma20_last
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 4
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.10
                ):    
                    buy = "BUY 2 NOTTE - CF con 300 vicina alla 450 ( anche sotto ! ) e 3-18 > -0.02 + MACD > - r 5995 A NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # 17 ott 2023 and deviation_ma3_sopra_ma10 > 0.027 da > 0.025 (per favore lascia almeno 0.027 al 3-10)
                    # 17 ott 2023 3-18 > -0.02 da > -0.02
                    # 17 ott 2023 3-18 da 3-20
                    # 31 ott 2023 aggiunto and ma2_last > ma5_last
                    #  1 dic 2023 aggiunto and ma2_differenza_2_min_ago > 5
                    #  7 dic 2023 aggiunta and ma3_differenza_2_min_ago > 5
                    #  7 dic 2023 diff ma2 a > 6 da > 5
                    
                    # 23 dic 2023 diff ma2 a 9 da 6
                    # 23 dic 2023 and ma3_differenza_2_min_ago a 6 da 5
                    # 23 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 23 dic 2023 aggiunta and macd_differenza_2_min_ago > 0.30
                    # 11 gen 2024 and deviation_ma300_sopra_ma450 > -0.70 da -0.60
                    # 11 gen 2024 and macd_differenza_2_min_ago > 0.10 da 0.30
                    # 28 gen 2025 se NOTTE and deviation_ma25_sotto_ma300 < -1.20



                
                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma50_last > ma59_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50>59 con 3-20 E 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + MACD > - r 5995 B1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    
                    and ma50_last > ma59_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50>59 con 3-20 E 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + MACD > - r 5995 B1 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 90

              

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.52
                    
                    and ma50_last > ma59_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50>59 con 3-20 E 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + MACD > - r 5995 B1 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    
                    and ma50_last > ma59_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50>59 con 3-20 E 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + MACD > - r 5995 B1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma5_last > ma54_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    
                    and ma50_last > ma59_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50>59 con 3-20 E 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + MACD > - r 5995 B1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma3_last > ma39_last
                    
                    and ma50_last > ma59_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50>59 con 3-20 E 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + MACD > - r 5995 B1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                  
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma3_last > ma39_last
                    
                    and ma50_last > ma59_last
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50>59 con 3-20 E 300 vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + MACD > - r 5995 B1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90


              



                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

              
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma50_last < ma59_last
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and ma100_last < ma100_60_min_ago
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.13
                    and deviation_ma3_sopra_ma18 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):    
                    buy = "BUY 2 compare forever con 50 < 59 e 3-20 E 300 vicina 450 (anche sotto !) e 3-18 > -0.01 + MACD > - r 5995 B2 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90

              


                elif (     
                        ma3_last > ma20_last
                        
                        and ma39_last > ma100_last

                        and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                        and ma200_last > ma300_last
                        and ma300_last > ma300_120_min_ago
                  
                        and ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago
                        
                        and ma2_last > ma2_2_min_ago
                        and macd > macd_2_min_ago
                        and macd > -20
                    ):
                        buy = "BUY 2 novembre 2023 con ma450 > 6 ore E ma100 > ma100 60 min E ma50 < and ma3_last > ma20_last - r 5999 A1"
                        action = "buy"
                        percentage = 70



                elif (     
                        ma3_last > ma20_last
                        
                        and ma39_last < ma100_last

                        and deviation_ma25_sotto_ma300 < -0.37
                        and deviation_ma50_sotto_ma300 < -0.27
                        and deviation_ma39 < -0.12
                        and deviation_ma3_sotto_ma50 < -0.15
                        and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                        and deviation_ma5_sotto_ma200 < -0.31
                        and deviation_ma5_sotto_ma300 < -0.41
                        and deviation_ma5_sotto_ma450 < -0.51
                        and deviation_ma300_sopra_ma450 < -0.072


                        and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                        and ma200_last > ma300_last
                        and ma300_last > ma300_120_min_ago
                  
                        and ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago
                        
                        and ma2_last > ma2_2_min_ago
                        and macd > macd_2_min_ago
                        and macd > -20
                    ):
                        buy = "BUY 2 novembre 2023 con ma450 > 6 ore E ma100 > ma100 60 min E ma50 < and ma3_last > ma20_last - r 5999 A2"
                        action = "buy"
                        percentage = 70

                        # anticipato ndecchiecella
                        # aggiunto prendi il coltello con il piede
                        # la cosa curiosa e' che mancava percentage e faceva acquisti di 3,94 euro
                        # 15 ott 2024 anticipata ndecchiecella
                        #  5 gen 2025 se 39<100 allora DNAM





                elif (     
                        ma3_last > ma20_last
                        and (ma100_last < ma100_60_min_ago or ma20_last < ma50_last)

                        and deviation_ma39 < -0.15
                        and deviation_ma3_sotto_ma50 < -0.15

                        and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                        and deviation_ma5_sotto_ma200 < -0.10
                        and deviation_ma25_sotto_ma300 < -0.11

                        and ma200_last > ma300_last
                        and ma300_last > ma300_120_min_ago
                  
                        and ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago

                        and macd_differenza_2_min_ago > -5.00
                    ):
                        buy = f"BUY 2 {ma100_last} {ma100_60_min_ago} nov 23 con ma450> 6 ore MA 100 < 100 60 min + OSSO + 3-50 e 3-39 - r 5999 B"
                        action = "buy"
                        percentage = 70
                        
                        # anticipato ndecchiecella
                        # aggiunto prendi il coltello con il piede
                        # la cosa curiosa e' che mancava percentage e faceva acquisti di 3,94 euro
                        # 15 ott 2024 se ma100<ma100 60 min ago allora il cane vuole un osso !
                        #  1 dic 2024 dev 5-100 < -0.25

                        # 13 apr 2025 aggiunto or and ma20_last < ma50_last
                        # 13 apr 2025 aggiunto and deviation_ma39 < -0.15
                        # 13 apr 2025 aggiunto and deviation_ma3_sotto_ma50 < -0.15
                        # 13 apr 2023 aggiunto f

              
                # BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND dev 5-30 CON AGGIUNTA PENSIERO LATERALE
                
                elif (
                    
                    ma4_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A1 SOFT "
                    action = "buy"
                    percentage = 50


                elif (
                    
                    ma4_last > ma18_last
                  
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 50

                
                elif (
                    
                    ma4_last > ma18_last
                  
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 50



                elif (
                    
                    ma4_last > ma18_last
                  
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 50

                elif (
                    
                    ma4_last > ma18_last
                  
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 50
                  

                elif (
                    
                    ma4_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.30
                    and ma3_last > ma54_last
                   
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 50

                elif (
                    
                    ma4_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and ma3_last > ma39_last
                   
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 50



                elif (
                    
                    ma4_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma3_last > ma39_last
                   
                    and deviation_ma5_sopra_ma28 < 0.01
                    and deviation_ma3_sopra_ma10 > 0.107
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 2 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 CON AGGIUNTA PENSIERO LATERALE and macd > macd 2 min ago - r 6000 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 50
                  
                    #  1 ago 2023 5-28 < 0.05
                    #  1 ago 2023 3-10 > 0.107
                    # 12 set 2023 5-28 < 0.01 da 0.05





              

                elif (
                    ma3_last > ma18_last
                    
                    and ma450_last < ma450_300_min_ago
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma200_sotto_ma300 < -0.32
                    and deviation_ma3_sotto_ma50 < -0.20


                    and ma78_last < ma200_last
                    and delta_300_200 > delta_300_200_60_min
                    and deviation_ma25_sotto_ma300 < -1.20

                    and ma100_last < ma100_10_min_ago
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma10_sopra_ma200 < -0.20
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -3.25
                ):
                    buy = "BUY 2 - NOTTE - pensiero laterale - PRENDI IL COLTELLO CON IL PIEDE + distanza al ribasso se 450<450 5 ore - r 6001"
                    action = "buy"
                    percentage = 80

                    # 27 gen 2025 NOTTE ! aggiunta and deviation_ma25_sotto_ma300 < -1.20
                    # 20 mar 2025 distanza al ribasso se 450<450 5 ore



                
                elif (    
                    ma3_last > ma15_last

                    and ma450_last > ma450_720_min_ago

                    and ma39_last < ma100_last
                    and ma78_last < ma150_last
                    
                    and deviation_ma300_sopra_ma450 < -0.22

                    and deviation_ma50_sotto_ma100 < -0.25
                    and deviation_ma100_sopra_ma200 < -0.75
                    and deviation_ma25_sotto_ma300 < -1.25
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.06
                    
                    and deviation_ma39 < -0.30
                    and deviation_ma3_sotto_ma50 < -0.30

                    and deviation_ma5_sopra_ma59 < -0.10
                    and deviation_ma5_sotto_ma300 < -0.10

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    
                    and ma2_last > ma5_last
                    and ma2_last > ma10_last
                    
                    

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 2 modificato importando un vecchio pensiero laterale + distanza al ribasso - r 6002"
                    action = "buy"
                    percentage = 90

                    #  4 feb 2025 aggiunta
                    # 21 mar 2025 se ma39_last < ma100_last aggiunta dstanza al ribasso
                    # 25 mar 2025 articolando distanza al ribasso
                    #  4 apr 2025 modificata
                


                
                
                
                
                    
                    
                    
                    
                    
           
            ############################################################################################################ COMPRA sessione 3
            
            # forse dal BUY 3 in poi (o dal BUY 4 in poi) DEVE ESSERE ma100 > E ma2 > ma100 !
            # deviation_buy3 = ma4_last/ma30_last 
                    

            elif self.session == 3:
                
                if (
                    
                    ma8_last > ma39_last
                    and ma300_last > ma450_last
                    and ma450_last > ma450_360_min_ago
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    and deviation_ma3_sopra_ma10 > 0.11
                    and deviation_ma5_sopra_ma28 > 0.13
                    
                    and deviation_ma4_sopra_ma30 > 0.10
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and deviation_ma7_sopra_ma40 > 0.05
                    and ma7_last > ma25_last
                    
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd_differenza_2_min_ago > 1.30
                ):  
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma300_last > ma450_last and ma8_last > ma39_last and macd_differenza_2_min_ago > 1.30 - r 6016 A1"
                    action = "buy"
                    percentage = 80
                    
                    #  1 gen 2023 se 450 > 450 360 min ago 5-28 > 0.13
                    # 30 gen 2024 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 30 gen 2024 aggiunto and macd_differenza_2_min_ago > 1.30

                
                
                elif (    
                    ma8_last > ma39_last
                    and ma300_last > ma450_last
                    and ma450_last < ma450_360_min_ago
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    and deviation_ma3_sopra_ma10 > 0.11
                    and deviation_ma5_sopra_ma28 > 0.20
                    
                    and deviation_ma4_sopra_ma30 > 0.10
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and deviation_ma7_sopra_ma40 > 0.05
                    and ma7_last > ma25_last
                    
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    and ma2_last >= ma2_2_min_ago
                    
                ):  
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma300_last > ma450_last and ma8_last > ma39_last - r 6016 A2"
                    action = "buy"
                    percentage = 80


                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    #  1 gen 2023 se 450 < 450 360 min ago 5-28 > 0.20 !



                    
                elif (
                    ma3_last > ma10_last

                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05

                    and delta_1_50_20 < delta_2_50_20
                    
                    and ma300_last < ma450_last
                    and deviation_ma39 < -0.03
                    and (ma200_last > ma200_60_min_ago or delta_1 < delta_2)
                    
                    and ma3_last > ma9_last

                    and macd_differenza_2_min_ago > -18.50
                ):  
                
                    buy = "BUY 3 con ma200 che sale da 60 min OR GIORNO and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05 - r 6016 B"
                    action = "buy"
                    percentage = 80

                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 30 apr 2025 anticipata ndecchiecella
                    # 19 mag 2025 aggiunta and deviation_ma39 < -0.03
                    
                    # 27 mag 2025 aggiunto and delta_1_50_20 < delta_2_50_20 - giorno ! - ha comprato durante un forte ribasso
                    #  7 ott 2025 aggiunta deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05



                # 22 set 2024 CANCELLATA r 6017

                
                
                    
                    
                
                
                
                # BUY 3 crollo MISSILE COMPA ! modo 2
                 
                elif (    
                    ma3_last > ma4_last
                    and ma78_last < ma300_last
                    and macd < -245
                ):
                    buy = "BUY 3 crollo MISSILE COMPA modo 2 con 3>4 AND MACD < -245 ! and ma78_last < ma300_last - AGOSTO 2023 - r 6020"
                    action = "buy"
                    percentage = 80

                    # 17 ago 2025 aggiunto sul BUY 3 perche' e' andato bene su RCCR invece maddog stava a guardare - MISSILE COMPA




                elif (   
                    ma3_last > ma13_last

                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    and ma8_last >= ma8_2_min_ago

                    and deviation_ma300_sopra_ma450 > -0.10
                    and deviation_ma200_sotto_ma300 > -0.10

                    and ma10_last < ma20_last
                    and ma39_last < ma100_last
                    
                    and deviation_ma5_sotto_ma300 > -0.60

                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                ):
                    buy = f"BUY 3 > 180 min di ribasso con MC GIORNO e CON ma10<ma20 con 3-20 MA LE MEDIE LUNGHE SONO VICINISSIME - r 6050 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    #  3 giu 2025 aggiunta ma modificata 300 vicinissima alla 450 e 200 vicinissima alla 300 anche se sembra che cominci un ribasso. 
                    #  3 giu 2025 e' andata benissimo sul RCCR e io ho aggiunto questa piccola ma importante modifica
                    # 25 set 2025 la lascio
                    # 23 ott 2025 se cm giorno ok cosi'
                    # 23 ott 2025 aggiungo pg



                elif (   
                    ma3_last > ma13_last
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.03 
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.08
                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.067

                    and ma10_last < ma20_last
                    and ma39_last < ma100_last
                    
                    and deviation_ma5_sotto_ma300 > -0.60

                    and deviation_ma300_sopra_ma450 > -0.10
                    and deviation_ma200_sotto_ma300 > -0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma2_last > ma5_last
                     
                ):
                    buy = f"BUY 3 > 180 min di ribasso con MC NOTTE + DEVIATIONE e CON ma10<ma20 con 3-20 MA LE MEDIE LUNGHE SONO VICINISSIME - r 6050 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    #  3 giu 2025 aggiunta ma modificata 300 vicinissima alla 450 e 200 vicinissima alla 300 anche se sembra che cominci un ribasso. 
                    #  3 giu 2025 e' andata benissimo sul RCCR e io ho aggiunto questa piccola ma importante modifica
                    # 25 set 2025 la lascio
                    # 23 ott 2025 se cm notte aggiungo pg di un successivo sell
                    # 23 ott 2025 aggiungo pg




                elif (
                    ma10_last > ma10_2_min_ago
                    and ma28_last < ma78_last
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma100_sopra_ma300 > 0.50
                    and deviation_ma3_sopra_ma10 > 0.25
                    and deviation_ma5_sopra_ma28 > 0.155
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                 
                    and deviation_ma4_sopra_ma30 > 0.11
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and deviation_ma7_sopra_ma40 > 0.08
                    and ma7_last > ma25_last
                    
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                    
                ):  
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last MA 100> 60 min ago CON 100 MOLTO SOPRA 300 - r 6056 a"
                    action = "buy"
                    percentage = 80

                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    
                    
                    
                elif (
                    ma10_last > ma10_2_min_ago
                    and ma28_last < ma78_last
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.50
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.155
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                   
                    and deviation_ma4_sopra_ma30 > 0.11
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and deviation_ma7_sopra_ma40 > 0.08
                    and ma7_last > ma25_last
                    
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                    
                ):  
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last MA 100> 60 min ago CON 100 POCO SOPRA 300 - r 6090 b"
                    action = "buy"
                    percentage = 80

                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    
                    
                elif (

                    ma3_last > ma20_last
                    and ma100_last > ma100_300_min_ago
                    and ma100_last < ma100_120_min_ago

                    and ma300_last > ma300_120_min_ago
                    and ma78_last < ma150_last
                    

                    and deviation_ma25_sotto_ma300 < -0.35
                    and deviation_ma50_sotto_ma300 < -0.35
                    and deviation_ma39 < 0.07
                    and deviation_ma3_sotto_ma50 < 0.03
                    and deviation_ma5_sopra_o_sotto_ma100 < 0.01
                    and deviation_ma5_sotto_ma200 < -0.15
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma5_sotto_ma450 < -0.25

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12

                    and ma300_last > ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago

                    and ma28_last < ma78_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > -1.25
                      
                ):  
                
                    buy = "BUY 3 con 300 > 300 301 min ago con ma200 che sale da 60 min MA 28<78 E macd_diff_2_min_ago > -1.25 - r 6121 A"
                    action = "buy"
                    percentage = 80

                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 28 set con 300 > 301 min ago anticipa ndecchia
                    # 23 feb 2023 5>5 2 min ago invece di 10> 10 2 min ago
                    # 300 sale da 5 ore NON DIMENTICARLO !
                    # 19 gen 2025 anticipata di molto
                    # 28 gen 2025 anticipata ancora ma di una ndecchiecella. ma e' andata bene.
                    # 16 feb 2025 aggiunta osso e cuspide che gia' era presente in forma embrionale
                    
                elif (    
                    ma4_last > ma50_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma28_last < ma78_last
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last - r 6121 B NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma4_last > ma50_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma28_last < ma78_last
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last - r 6121 B NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma28_last < ma78_last
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last - r 6121 B NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 80




                elif (    
                    ma3_last > ma20_last

                    and ma20_last > ma50_last
                    and delta_1_69_39 < delta_2_69_39
                
                    and ma450_last < ma450_10_min_ago
                    and ma100_last < ma300_last
                    and ma100_last < ma200_last


                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.01
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma25_sotto_ma300 < -0.38
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.035
                    
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.001
                    
                ):    
                
                    buy = f"""BUY 3 del 26 set 2025 che riprende un precedente sell - r 6121 B NUOVA ERA A3 SOFT
                    deviation_ma39 {deviation_ma39} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    
                    action = "buy"
                    percentage = 80

                    # 26 set 2025 anticipata riprendendo un precedente sell
                    # 26 set 2025 aggiunta parentesi graffe ( che al momento non stanno funzionando.)
                    # 30 set 2025 le parentesi graffe non hanno funzionato ! ho tolto la riga vuota proprio sotto buy = f"""BUY 3 etc.
                    # 30 set 2025 tolto :.2f dentro la parentesi graffa della deviation_ma39


                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma28_last < ma78_last
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last - r 6121 B NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 80



                elif (    
                    ma4_last > ma54_last
                    
                    and ma5_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma28_last < ma78_last
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last - r 6121 B NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma30_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma28_last < ma78_last
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last - r 6121 B NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80

                
                elif (    
                    ma3_last > ma30_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last < ma300_301_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma28_last < ma78_last
                    
                    and ma200_last > ma200_60_min_ago
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma2_2_min_ago
                ):    
                
                    buy = "BUY 3 con ma200 che sale da 60 min and ma28_last < ma78_last - r 6121 B NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 80

                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    
                   
                    
                    
                # BUY 3A con ma69 > MA ma200 scende da 60 min ! MA CON ma300>60 min ago
                
                elif (
                    ma69_last >= ma69_2_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.14
                    and deviation_bellissima > 0.35
                    and deviation > -0.30
                    
                    and deviation_buy3 > 0.12
                    and deviation_ma4_sopra_ma30 > 0.12
                    and ma3_last > ma13_last
                    and deviation_ma7_sopra_ma40 > 0.08
                    and ma4_last > ma9_last
                    and ma7_last > ma25_last
                    and deviation_buy_ma2_sopra_ma13 > 0.10
                    and ma4_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                ):      
              
                    buy = "BUY 3 con ma69 > MA ma200 scende da 60 min ! e CON ma300 < 60 min ago - r 6163"
                    action = "buy"
                    percentage = 80
                    
                    
                    
                
                
                # BUY 3 nuovo TREND LATERALE !
                
                elif (
                    ma100_last > ma300_last
                    and ma100_last > ma200_last
                    and ma78_last > ma200_last
                    and deviation_ma78_sotto_ma200 > 0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.07
                    
                    and ma8_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                        
                    and deviation_ma100_sopra_ma300 < 0.04
                    and deviation_ma100_sopra_ma200 < 0.05
                    
                ):
                    buy = "BUY 3 nuovo TREND LATERALE ! dev 78-200 > 0.25 - 78 > 200 con 3-10 > 0.01 - r 6187 A1"
                    action = "buy"
                    percentage = 80
                    
                    # SE ma100 E' cosi' VICINA A ma200 E ma300 vuo dire che non c'e' un grande rialzo in atto ma un TREND LATERALE !
                # BUY 3 nuovo TREND LATERALE !
                
                
                
                elif (
                    ma100_last > ma300_last
                    and ma100_last > ma200_last
                    and ma78_last > ma200_last
                    and deviation_ma78_sotto_ma200 < 0.25
                    and deviation_ma78_sotto_ma200 > -0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.16
                    and deviation_ma5_sopra_ma28 > 0.07
                    
                    and ma8_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                        
                    and deviation_ma100_sopra_ma300 < 0.04
                    and deviation_ma100_sopra_ma200 < 0.05
                    
                ):
                    buy = "BUY 3 nuovo TREND LATERALE ! dev 78-200 > -0.25 - 0.25 - 78 > 200 con 3-10 > 0.16 - r 6187 A2"
                    action = "buy"
                    percentage = 80
                    
                    # SE ma100 E' cosi' VICINA A ma200 E ma300 vuo dire che non c'e' un grande rialzo in atto ma un TREND LATERALE !
                    
                    
                    
                elif (
                    ma100_last > ma300_last
                    and ma100_last > ma200_last
                    and ma78_last > ma200_last
                    and deviation_ma78_sotto_ma200 < -0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.07
                    
                    and ma8_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                        
                    and deviation_ma100_sopra_ma300 < 0.04
                    and deviation_ma100_sopra_ma200 < 0.05
                    
                ):
                    buy = "BUY 3 nuovo TREND LATERALE ! dev 78-200 < -0.25 - 78 > 200 con 3-10 > 0.01 - r 6187 A3"
                    action = "buy"
                    percentage = 80
                    
                    # SE ma100 E' cosi' VICINA A ma200 E ma300 vuo dire che non c'e' un grande rialzo in atto ma un TREND LATERALE !
                    
                    
               
                    
                # BUY 3 nuovo TREND LATERALE !
                
                elif (
                    ma100_last > ma300_last
                    and ma100_last > ma200_last
                    and ma78_last < ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma5_sopra_ma28 > 0.07
                    
                    and ma8_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                        
                    and deviation_ma100_sopra_ma300 < 0.04
                    and deviation_ma100_sopra_ma200 < 0.05
                    
                ):
                    buy = "BUY 3 nuovo TREND LATERALE ! - 78 < 200 con 3-10 > 0.07 - r 6214 b"
                    action = "buy"
                    percentage = 80
                    
                    # SE ma100 E' cosi' VICINA A ma200 E ma300 vuo dire che non c'e' un grande rialzo in atto ma un TREND LATERALE !


                    
                    
                   
                
                #  BUY 3A con ma69 > MA ma200 scende da 60 min ! and ma300_last > ma300_60_min_ago
                
                elif (  
                    ma3_last > ma15_last

                    and ma100_last > ma100_60_min_ago

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.156

                    and ma100_last < ma100_120_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.07

                    and (ma200_last > ma200_120_min_ago or ma300_last > ma300_60_min_ago or ma300_last > ma450_last)

                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma39_sotto_ma200 < 0.20
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and deviation_ma3_sopra_ma10 > -0.005
                    
                    and macd_differenza_2_min_ago > -12.25 
                ):      
              
                    buy = "BUY 3 da RCCR and ma300 > ma450 MA ma100_last < ma100_120_min_ago E 100 > 60 min - r 6225 X"
                    action = "buy"
                    percentage = 80


                

                elif (  
                    ma3_last > ma10_last
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05

                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.17
                    and deviation_ma25_sotto_ma300 < -0.15
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04
                    and ma8_last >= ma8_2_min_ago

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.15)

                    and (deviation_ma200_sotto_ma300 > -0.15 or delta_DNA_1 < delta_DNA_2)
                    

                    and ma100_last < ma100_120_min_ago
                    

                    and (ma200_last > ma200_120_min_ago or ma300_last > ma300_60_min_ago or ma300_last > ma450_last)

                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    
                    and deviation_ma300_sopra_ma450 > -0.45
                    
                    and macd_differenza_2_min_ago > -18.00
                ):      
              
                    buy = f"BUY 3 da RCCR and ma300 > ma450 MA ma100_last < ma100_120_min_ago E 100 < 60 min + IL MIO CAPOLAVORO - r 6225 Y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 16 mag 2025 aggiunta questa
                    # 28 giu 2025 se ma100_last < ma100_120_min_ago aggiungo deviation_ma5_sopra_o_sotto_ma100 < -0.07
                    #  6 ago 2025 aggiunta and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    #  6 ago 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.156
                    #  6 ago 2025 continuava a comprare durante il ribasso. aggiunto dalle condizioni migliori. deve dare un segno !
                    # 14 ago 2025 con 100< 60 OR delta_CV_300_25 NOTTE aggiungo IL MIO CAPOLAVORO
                    # 26 set 2025 anticipata ndecchiecella
                    #  8 ott 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05
                    #  8 ott 2025 aggiunte parentesi graffe sulla stessa riga 
                    # 18 ott 2025 aggiunte deviation pg + and ma8_last >= ma8_2_min_ago

                
                ####################################################################################
                ####################################################################################
                
                # BUY 3 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-59 - da buy 1 riga 1043 B - ma senza doppio delta
                
                elif (
                    
                    ma8_last > ma59_last
                    and deviation_ma5_sopra_ma59 < -0.12
                    
                    
                    and deviation_ma10_sopra_ma200 < -0.25
                    and deviation_ma10_sopra_ma200 > -0.40
                  
                    and deviation_ma100_sopra_ma200 > -0.40
                    
                    and deviation_ma5_sotto_ma300 < 0.45
                    and deviation_ma5_sotto_ma300 > -0.75
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.04
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 3 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-59 - da buy 1 riga 1043 B ma senza doppio delta - r 6242"
                    action = "buy"
                    percentage = 50
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    
                    # 21 ottobre 2022  aggiunta di 3-10 e 5-28
                    # 21 ottobre 2022 3-10 = 0.01
                    # 21 ottobre 2022 5-28 = 0.05
                    # 28 ottobre 2022 5-28 = 0.04
                    # ave comba
                    # 31 ottobre aggiunta dev 10-200 - formula MY COMPA
                    # 12 dic 2022 8-59 da 8-50 e aggiungo pensiero laterale (condizione sotto)
                    # 22 dic 2022 and deviation_ma5_sopra_ma59 < -0.10
                    
                    
                    
                # BUY 3 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-50 - formula MY COMPA (importata dal BUY 1 r 1043 B)
                
                elif (  
                    ma3_last > ma18_last

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.13
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.13
                    

                    and deviation_ma10_sopra_ma200 < -0.25
                    and deviation_ma10_sopra_ma200 > -0.60
                  
                    and deviation_ma100_sopra_ma200 > -0.40
                    
                    and deviation_ma5_sotto_ma300 < 0.45
                    and deviation_ma5_sotto_ma300 > -0.80
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.075
                    and deviation_ma5_sopra_ma28 > -0.04
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 3 con 5-300 AND dev 10-200 < -0.25 and > -0.40 - formula MY COMPA - r 6243 A"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    # 30 mag 2023 5-18 da 5-50
                    # 10 giu 2023 aggiunta 3-16 IL BUY 3 deve avere 3-16 !
                    #  2 ott 2024 con 300< aggiunta da staf and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    #  2 ott 2024 ma forse e' da cancellare ma prima aggiungi and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    #  7 ott 2024 aggiunta 5-100 <-0.13 e anticipata ndecchiecella
                    
                # BUY 3 migliore formula MY COMPA - che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-50 - (importata dal BUY 1 r 1043 B)
                



                elif (
                    ma3_last > ma11_last

                    and ma20_last < ma50_last
                    and (ma300_last > ma450_last or ma100_last > ma300_last)
                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma200_last

                    and delta_1 > delta_2
                    and deviation_ma3_sotto_ma50 < -1.20
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    and deviation_ma5_sotto_ma200 < -0.15

                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and delta_100_59 < delta_100_59_60_min
                    
                    and deviation_ma10_sopra_ma200 > -0.40
                    and deviation_ma100_sopra_ma200 > -0.40
                    
                    and deviation_ma5_sotto_ma300 < 0.45
                    and deviation_ma5_sotto_ma300 > -0.75
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
              
                ):
                    buy = f"BUY 3 {ma450_last} {ma450_720_min_ago} migliore formula MY COMPA quando ritraccia con 450> - r 6243 Bx1"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    
                    # 21 ottobre 2022  aggiunta di 3-10 e 5-28
                    # 21 ottobre 2022 3-10 = 0.01
                    # 21 ottobre 2022 5-28 = 0.05
                    # 28 ottobre 2022 5-28 = 0.04
                    # ave comba
                    # 31 ottobre aggiunta dev 10-200 - formula MY COMPA
                    # 7 feb 2023 3-10 0.068
                    # 25 mar 2025 tolte sovrastrutture
                    # 28 mar 2025 quando ritraccia vedi 20<50
                    # 29 mar 2025 quando ritraccia con 450>
                    #  7 apr 2025 and deviation_ma3_sotto_ma50 < -1.20 e vafangulo ! 
                    # 10 apr 2025 correzione or e aggiunta f


                elif (
                    ma3_last > ma11_last

                    and ma20_last < ma50_last
                    and (ma300_last > ma450_last or ma100_last > ma300_last)
                    and ma300_last > ma300_301_min_ago
                    
                    and ma450_last < ma450_720_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and delta_1 > delta_2

                    
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.15


                    and ma100_last > ma200_last
                    and delta_100_59 < delta_100_59_60_min
                    
                    and deviation_ma10_sopra_ma200 > -0.40
                    and deviation_ma100_sopra_ma200 > -0.40
                    
                    and deviation_ma5_sotto_ma300 < 0.45
                    and deviation_ma5_sotto_ma300 > -0.75
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
              
                ):
                    buy = f"BUY 3 {ma450_last} {ma450_720_min_ago} formula MY COMPA quando ritraccia con 300> 5 ore MA 450<12 ore - r 6243 Bx2"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma100 sta sotto la ma200 non le e' troppo lontana
                    
                    # 21 ottobre 2022  aggiunta di 3-10 e 5-28
                    # 21 ottobre 2022 3-10 = 0.01
                    # 21 ottobre 2022 5-28 = 0.05
                    # 28 ottobre 2022 5-28 = 0.04
                    # ave comba
                    # 31 ottobre aggiunta dev 10-200 - formula MY COMPA
                    # 7 feb 2023 3-10 0.068
                    # 25 mar 2025 tolte sovrastrutture
                    # 28 mar 2025 quando ritraccia vedi 20<50
                    # 29 mar 2025 quando ritraccia con 450>
                    # 11 apr 2025 correzione or e aggiunta f



                    
                ####################################################################################
                #################################################################################### 
                
                # BUY 3 RCCR PORTATA MADDOG maria callas core 'ngrato - 2 sett 2022 ore 5:03 - ma300 che SCENDE
                
                elif (     
                    ma3_last > ma18_last
                    and (ma39_last < ma100_last or ma20_last < ma50_last)

                    and (ma300_last < ma300_60_min_ago or ma300_last < ma300_120_min_ago)
                    and ma300_last < ma300_301_min_ago
                    and delta_1 > delta_2

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.025

                    and deviation_callas < -0.10

                    and deviation_ma200_sotto_ma300 < -0.27
                    and deviation_ma100_sopra_ma300 < -0.49
                    and deviation_ma50_sotto_ma300 < -0.70
                    and deviation_ma25_sotto_ma300 < -0.80
                    
                    and deviation_ma5_sotto_ma200 < -0.50
                    and deviation_ma5_sotto_ma300 < -0.60
                    and deviation_ma5_sotto_ma450 < -0.70

                    and ma100_last < ma200_last
                    and ma200_last < ma200_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma18_last
                    and macd_differenza_2_min_ago > -6.50
                ):    
                    buy = "BUY 3 maria callas core 'ngrato con ma300<6 ore +osso + comincia a scendere - r 6244"
                    action = "buy"
                    percentage = 80
                    
                    # vedi che c'e' ma 300 che scende
                    # 19 set 2022 ho anticipato maria callas core ngrato di una ndecchiecella
                    # se 78 sta vicino alla 200 3-10 piu' alto ! cazzo ! vedi 20 settembre ore 14:47
                    # 24 set 2022 5-28 > 0.11 da 0.12
                    # 26 set 2022 5-28 > 0.108 da 0.11
                    #  7 ott 2022 5-28 > 0.105 da 0.108
                    # 19 ott 2022 5-28 > 0.10 da 0.105 VIVA MARIA CALLAS ! condizione meravigliosa
                    #  8 nov maria callas con 5-59 - da 5-69
                    #  16 nov ho tolto ma5_last > ma59_last e ho messo dev callas = 5/54 <-0.10 PENSIERO LATERALE - VEDI 16 NOV ore 15 :33
                    # 20 apr 2023 5-28 a 0.07 da 0.10
                    # 20 apr 2023 5-28 a 0.03 da 0.07
                    #  2 mar 2025 aggiunta comincia a scendere
                    #  2 mar 2025 ATTENZIONE ! ho tolto 3-39 e 3-50 perche' essendo BUY 3 la ma3 e' gia' sopra alla ma39 e alla ma50 !
                    # 12 mar 2025 se BUY 3 con ma300_last < ma300_301_min_ago allora  aggiungo and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.025
                    # 11 apr 2025 correzione or qua non ho messo f perche' non voglio sacrificare maria callas.



                # 10 set 2024 CANCELLATA r 6260 a

               
                     
                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma39_last < ma39_15_min_ago
                    
                    and (ma33_last < ma78_last or ma20_last < ma50_last)
                    and deviation_ma50_sotto_ma100 < -0.02
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.30

                    and ma450_last > ma450_120_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    and (ma3_prev < ma180_prev and ma3_last > ma180_last)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.25
                ):  
                
                    buy = "BUY 3 incrocio al rialzo 3-180 con ma450 > 2 ore e ma200 che sale da 1 ora con 33<78 ! ritracciamento - r 6260 b"
                    action = "buy"
                    percentage = 70

                    # 6 mar 2024 aggiunto incrocio al rialzo 3-180





                elif (  
                    ma3_last > ma11_last

                    and ma20_last < ma50_last
                    and (ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or deviation_ma200_sotto_ma300 > -0.10)
                    
                    and delta_1 < delta_2
                    and ma300_last > ma450_last
                    and ma450_last > ma450_120_min_ago

                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma5_sotto_ma200 < -0.22

                    and ma3_last < ma100_last

                    and deviation_ma39 < -0.15
                    and deviation_ma3_sotto_ma50 < -0.15
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
                    buy = f"BUY 3 {ma450_last} {ma450_120_min_ago} con ma450 > ma450 2 ore e 20<50 - vedi condizioni ritracciamento - r 6270"
                    action = "buy"
                    percentage = 80
                    
                    # 13 feb 2023 aggiunta questa
                    #  3 ott 2024 compra solo se and ma28_last > ma28_30_min_ago
                    # 28 mar 2025 quando ritraccia ! vedi ma20 sotto ma50 !
                    # 30 mar 2025 tolto incrocio al rialzo 5-90 arrivava tardi ! ed era in contrasto con il buy durante il ritracciamento
                    # 30 mar 2025 deviation_ma200_sotto_ma300 > -0.07 significa che sotto questo limite non e' piu' un ritracciamento !
                    #  3 apr 2025 and deviation_ma3_sotto_ma50 < -0.07 da -0.06
                    #  4 apr 2025 and deviation_ma3_sotto_ma50 < -0.75 da -0.07
                    #  4 apr 2025 and deviation_ma39 < -0.75 da -0.06

                    #  6 apr 2025 and deviation_ma39 < -0.15 da -0.75 (aggiunto GIORNO)
                    #  6 apr 2025 and deviation_ma3_sotto_ma50 < -0.15 da -0.75 (aggiunto GIORNO)
                    #  6 apr 2025 aggiunto and deviation_ma100_sopra_ma300 < -0.30 
                    #  6 apr 2025 aggiunto and deviation_ma25_sotto_ma300 < -0.30
                    #  8 apr 2025 se ritraccia 3 DEVE STARE SOTTO 100 non c'e' niente da fare !
                    #  8 apr 2025 aggiunto basi del ritracciamento
                    # 11 apr 2025 correzione or e aggiunta f
                    # 14 apr 2025 and deviation_ma5_sotto_ma200 a -0.22 da -0.15
                    # 14 apr 2025 ATTENZIONE ! sembra che il 450 non mi da il valore !!! sembra che non lo prenda - MA ASPETTIAMO !



                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma5_sopra_o_sotto_ma5_50_min_ago > 1.80
                    and ma10_last > ma20_last
                    and delta_1_40_20 < delta_2_40_20
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_bellissima > 0.07
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 3B da RCCR - se ma39 > ma50 - r 6280 a1x"
                    action = "buy"
                    percentage = 80

                    #  8 mar 2024 modificato ma20-ma40 GIORNO



                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma5_sopra_o_sotto_ma5_50_min_ago > 1.80
                    and ma10_last > ma20_last
                    and delta_1_40_20 > delta_2_40_20
                    and deviation_buy > 0.15
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_bellissima > 0.07
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 3B da RCCR - se ma39 > ma50 - r 6280 a1y"
                    action = "buy"
                    percentage = 80

                    #  8 mar 2024 modificato se 20-40 NOTTE allora compra sopra 0.15 dal precedente SELL



                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma5_sopra_o_sotto_ma5_50_min_ago > 1.80
                    and ma10_last < ma20_last

                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.11
                    and deviation_bellissima > 0.07
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 3B da RCCR - se ma39 > ma50 - r 6280 a2"
                    action = "buy"
                    percentage = 80

                    #  8 mar 2024 modificato


                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma5_sopra_o_sotto_ma5_50_min_ago < 1.80
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_bellissima > 0.07
                    
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 3B da RCCR - se ma39 > ma50 - r 6280 b"
                    action = "buy"
                    percentage = 80
                    
                    # > estate aggiunti 3-10 and 5-28
                    #  8 mar 2024 modificato
                    
                    
                    
                elif (
                    ma3_last > ma8_last
                    and deviation_ma39 < -1.00
                    and deviation_buy_crollo_1 < -1.61
                    and deviation_ma25_sotto_ma300 < -2.00
                    and ma78_last < ma300_last

                ):
                    buy = "BUY 3 CROLLO FERRARI senza sovrastrutture con 3-8 - r 6299"
                    action = "buy"
                    percentage = 80

                    #  3 feb 2025 nuova condizione crollo ferrari senza sovrastrutture !

                    #  3 feb 2025 con 3-39 < -1.00 compra con 3-8 da 4-11
                    #  3 feb 2025 deviation_buy_crollo_1 = ma8_last / ma78_last
                    #  3 feb 2025 BUY in purezza in uno scenario drammatico il macd scendeva ma il prezzo saliva !!!
                    #  3 feb 2025 devi dare un paio di colpitogliendo tutte le sovrastrutture ma2 e macd
                    #  3 feb 2025 and deviation_ma39 < -1.00
                    #  3 feb 2025 and deviation_buy_crollo_1 < -1.61
                    #  3 feb 2025 and deviation_ma25_sotto_ma300 < -2.00
                    #  3 feb 2025 C SONO 3 CROLLI FERRARI SENZA SOVRASTRUTTURE !
                    

                # BUY 3C RIVOLUZIONARIO
                
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma250_sopra_ma300 > 0.04
                    and deviation_bellissima > 0.05
                    
                    and (ma3_prev < ma22_prev and ma3_last > ma22_last)
                    and deviation > -0.30
                    
                  
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 3C RIVOLUZIONARIO se ma39 > ma50 - r 6301 A"
                    action = "buy"
                    percentage = 80
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # ho dovuto aggiungere incrocio dal basso!
                    
                    
                # BUY 3C RIVOLUZIONARIO
                
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma250_sopra_ma300 < 0.04
                    and deviation_ma250_sopra_ma300 > -0.04
                    and deviation_bellissima > 0.06
                  
                    and (ma3_prev < ma22_prev and ma3_last > ma22_last)
                    and deviation > -0.30
                    
                    and ma28_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 3C RIVOLUZIONARIO se ma39 > ma50 - r 6301 B"
                    action = "buy"
                    percentage = 80
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # ho dovuto aggiungere incrocio dal basso!
                    
                    
                    
                    
                # BUY 3C RIVOLUZIONARIO
                
                elif (
                    deviation_ma4_sopra_ma30 > 0.15
                    and deviation_ma250_sopra_ma300 < -0.04
                    and deviation_bellissima > 0.07
                    
                    and (ma3_prev < ma22_prev and ma3_last > ma22_last)
                    and deviation > -0.30
                    
                    and ma39_last > ma50_last
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 3C RIVOLUZIONARIO se ma39 > ma50 - r 6301 C"
                    action = "buy"
                    percentage = 80
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # ho dovuto aggiungere incrocio dal basso!
                    
                    
                    
                    
                    
                elif (
                    ma69_last < ma69_2_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation > -0.30
                    
                    and ma78_last > ma200_last
                    
                    and deviation_buy3 > 0.02
                    and deviation_ma13_sopra_ma25 > 0.040
                    and delta_buy3_incrocio_ma3_ma8 > 0.07
                    and deviation_ma4_sopra_ma30 > 0.14
                    and ma3_last > ma8_last
                    and ma3_last > ma78_last
                    and ma4_last > ma4_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma7_last > ma25_last
                ):
                    buy = "BUY 3D RIVOLUZIONARIO con 300 > 120 min ago e se ma69 < AND ma78_last > ma200_last - r 6329 a1"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    
                elif (
                    ma3_last > ma8_last

                    and ma69_last < ma69_2_min_ago
                    and ma300_last < ma300_120_min_ago

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.11
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma25_sotto_ma300 < -0.15
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.035

                    and ma78_last > ma200_last

                    and ma2_last > ma3_last
                    and ma2_last > ma5_last
                ):
                    buy = f"BUY 3D RIVOLUZIONARIO con 300 < 120 min ago e se ma69 < AND ma78_last > ma200_last - r 6329 a2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    #  1 giu 2023 ma2 > ma3 !
                    #  7 ott 2025 anticipata ndecchia
                    # 15 ott 2025 ok !
                    # 15 ott 2025 aggiunte pg
                    # 17 ott 2025 ok !
                    # 17 ott 2025 aggiunte dev che sono comparse dopo che ho aggiunto le parentesi graffe.(valori leggermente piu' alti)

                    
                elif (
                    ma3_last > ma18_last
                    and ma450_last > ma450_480_min_ago


                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago < -1.00
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma39_sotto_ma100 > -0.15


                    and ma78_last < ma200_last
                    and deviation_ma25_sotto_ma300 < -0.20

                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.15
                    
                    and deviation_ma5_sotto_ma200 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 3 - NOTTE - con 3-20 se ma78 < ma200 + DNAM + continua a scendere - r 6356 B1x"
                    action = "buy"
                    percentage = 80
                    


                elif (
                    ma3_last > ma18_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80


                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13


                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago < -1.00
                    
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 3 - CONTINUA A SCENDERE DNA con 3-18 - r 6356 B1y"
                    action = "buy"
                    percentage = 80
                    
                    
                    # 10 dic 2023 aggiunta and ma2_last > ma2_2_min_ago
                    # 10 dic 2023 aggiunta and macd_differenza_2_min_ago > -3
                    #  5 nov 2024 + zia amalia
                    #  1 dic 2024 modificato DNAM
                    # 27 gen 2025 se GIORNO aggiunta and deviation_ma25_sotto_ma300 < -0.49
                    # 17 feb 2025 se deviation_ma300_sopra_ma450 < -0.22 allora aggiungo continua a scendere circello
                    # 26 feb 2025 contiuna a scendere - vediamo -
                    # 26 feb 2025 tolto delta_300_200 < delta_300_200_30_min perche' 30 minuti sono pochi. seembra giorno ma e' notte !
                    #  3 mar 2025 continua a scendere DNA
                


                elif (
                    ma3_last > ma20_last
                    and ma450_last > ma450_480_min_ago


                    and delta_300_200 > delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -1.20


                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.60              
                    and deviation_ma50_sotto_ma300 < -0.70
                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.10   
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma5_sotto_ma200 < -0.45
                    and deviation_ma5_sotto_ma300 < -0.65
                    and deviation_ma5_sotto_ma450 < -1.00

                    and ma78_last < ma200_last
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 3 - NOTTE - RIVOLUZIONARIO con 3-20 se ma78 < ma200 + DNAM - r 6356 B2x"
                    action = "buy"
                    percentage = 80

                    #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago



                elif (
                    ma3_last > ma18_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80


                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13


                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10
                    and macd_differenza_2_min_ago > -2.50

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -3
                ):
                    buy = "BUY 3 - NOTTE - RIVOLUZIONARIO con 3-20 se ma78 < ma200 + DNAM - r 6356 B2y"
                    action = "buy"
                    percentage = 80
                    
                    
                    # 10 dic 2023 aggiunta and ma2_last > ma2_2_min_ago
                    # 10 dic 2023 aggiunta and macd_differenza_2_min_ago > -3
                    #  5 nov 2024 + zia amalia
                    #  1 dic 2024 modificato DNAM
                    # 27 gen 2025 se NOTTE aggiunta and deviation_ma25_sotto_ma300 < -1.20
                    #  3 mar 2025 aggiunta and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    
                    
                # BUY 3 importata da RCCR - AUDI CHE NON E' UN CROLLO ! con 5-16

                elif (
                    ma3_last > ma11_last
                    and (ma450_last > ma450_300_min_ago or delta_1_69_39 < delta_2_69_39)

                    and deviation_buy_crollo_1 < -0.60
                    and deviation_buy_crollo_1 > -2.00
                    
                    and ma78_last < ma200_last

                    and deviation_ma39 < -0.23
                    and deviation_ma3_sotto_ma50 < -0.36
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 
                    and deviation_ma25_sotto_ma300 < -0.93 
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    
                    and macd_differenza_2_min_ago > -18.00
                    
                ):
                    buy = f"BUY 3 importata da RCCR - AUDI CHE NON E' UN CROLLO ! con 3-18 con DOPPIO DELTA 69-39 GIORNO - r 6388 A1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !   
                    # 15 nov 2022 AGGIUNTA 3-10 vedi 8 nov ore 21:23
                    # 12 set 2023 dev sell 5-13 da 5-16 con aggiunta di macd > macd 2 min ago
                    # 20 mar 2025 aggiunta se ma450_last > ma450_300_min_ago ok cosi'
                    # 24 ott 2024 aggiunta con dev sell successivo preso da pg
                    # 24 ott 2025 aggiunte pg


                

                elif (
                    ma3_last > ma18_last
                    
                    and ma450_last < ma450_300_min_ago
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma200_sotto_ma300 < -0.32
                    and deviation_ma3_sotto_ma50 < -0.28
                    
                    and ma78_last < ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02

                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -3.25
                ):
                    buy = "BUY 3 con 3-18 con distanza al ribasso se ma450_last < ma450_300_min_ago  - r 6388 A2"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !   
                    # 15 nov 2022 AGGIUNTA 3-10 vedi 8 nov ore 21:23
                    # 12 set 2023 dev sell 5-13 da 5-16 con aggiunta di macd > macd 2 min ago
                    # 20 mar 2025 aggiunta distanza al ribasso se ma450_last < ma450_300_min_ago


                    
                elif (
                    
                    deviation_buy_crollo_1 < -0.60
                    and deviation_buy_crollo_1 > -1.50
                    
                    and delta_1_69_39 > delta_2_69_39
                    
                    and ma5_last > ma33_last
                    and deviation_ma3_sopra_ma10 > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                    and ma78_last < ma200_last
                    
                ):
                    buy = "BUY 3 importata da RCCR - AUDI CHE NON E' UN CROLLO ! con 5-33 and 3-10 CON DOPPIO DELTA 69-39 NOTTE - r 6388 B"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !   
                    # 15 nov 2022 AGGIUNTA 3-10 vedi 8 nov ore 21:23
                    
                    
                    
                    
                    
                # BUY 3 FORTE RIBASSO che NON E' UN CROLLO ! (compare stammi vicino!) da BUY2 RCCR
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -0.60
                    and deviation_buy_crollo_1 > -1.50
                    and deviation_bellissima > 0.17
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
             
                    
                ):
                    buy = "BUY 3 FORTE RIBASSO che NON E' UN CROLLO ! and deviation_bellissima > 0.17  da BUY2 RCCR - r 6417"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    
                    
                    
                    
                    
                # BUY 3 NUOVO che ci riprova TORNANDO ALLE ORIGINI con ma200< and ma300<

                elif (
                    ma3_last > ma10_last

                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and ma100_last > ma100_60_min_ago

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2
                    

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.15
                    and deviation_ma300_sopra_ma450 > -0.15

                    and ma200_last > ma200_60_min_ago

                    
                    and ma3_last > ma5_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 3 con ma450_last > ma450_720_min_ago e con ma200> - GIORNO - r 6447 A1 x1 X"
                    action = "buy"
                    percentage = 90

                    # 12 mag 2025 se 100> ok cosi'.
                    #  8 ott 2025 se CV giorno OK COSI'



                elif (
                    ma3_last > ma10_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.50)

                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < - 0.20

                    
                    and ma100_last > ma100_60_min_ago
                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2
                    

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.15
                    and deviation_ma300_sopra_ma450 > -0.15

                    and ma200_last > ma200_60_min_ago

                    
                    and ma3_last > ma5_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 3 con ma450_last > ma450_720_min_ago e con ma200> - GIORNO - r 6447 A1 x1 Y - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 90

                    # 12 mag 2025 se 100> ok cosi'.
                    #  8 ott 2025 se CV notte INTERVIENE CM GIORNO or deviation 25-300 < -0.50
                    #  8 ott 2025 aggiungo le parentesi graffe su una riga
                    #  8 ott 2025 aggiunto and deviation_ma39 < -0.05
                    #  8 ott 2025 aggiunto and deviation_ma3_sotto_ma50 < -0.10
                    #  8 ott 2025 aggiunto and deviation_ma5_sopra_o_sotto_ma100 < - 0.20






                elif (
                    ma3_last > ma13_last

                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago
                    and (ma100_last < ma100_60_min_ago or ma20_last < ma50_last)
                    
                    and deviation_ma39 < 0.01 
                    and deviation_ma3_sotto_ma50 < -0.05
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.11 
                    and deviation_ma25_sotto_ma300 < -0.14 
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.01

                    and (ma450_last > ma450_360_min_ago or ma450_last > ma450_720_min_ago)
                    and (ma200_last > ma200_60_min_ago or delta_DNA_1 < delta_DNA_2)
                    
                    and deviation_ma300_sopra_ma450 < 0.40
                    and deviation_ma300_sopra_ma450 > -0.40

                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 3 CON CV GIORNO e con ma450_last > ma450_720_min_ago e con ma200> - GIORNO - r 6447 A1 x2 X - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 cancellato and ma2_last > ma2_2_min_ago e anticipato ndecchiecella
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 28 feb 2025 GIORNO !
                    # 12 mag 2025 se 100< aggiungo and deviation_ma3_sotto_ma50 < -0.05
                    # 18 OTT 2025 SE and delta_CV_300_25_last < delta_CV_300_25_45_min_ago (GIORNO) OK COSI'
                    # 18 ott 2025 aggiunte pg
                    # 21 ott 2025 aggiunte le dev



                elif (
                    ma3_last > ma13_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07
                    and ma8_last >= ma8_2_min_ago


                    and (ma100_last < ma100_60_min_ago or ma20_last < ma50_last)
                    and deviation_ma3_sotto_ma50 < -0.05

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2
                    

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25

                    and ma200_last > ma200_60_min_ago

                    and ma3_last > ma7_last
                    
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 3 CON CV NOTTE E CM GIORNO e con ma450_last > ma450_720_min_ago e con ma200> - GIORNO - r 6447 A1 x2 Y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 cancellato and ma2_last > ma2_2_min_ago e anticipato ndecchiecella
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 28 feb 2025 GIORNO !
                    # 12 mag 2025 se 100< aggiungo and deviation_ma3_sotto_ma50 < -0.05
                    # 18 OTT 2025 SE CV NOTTE INTERVIENE CM E ANCHE ma100 SCENDE PIU' DOLCEMENTE
                    # 18 ott 2025 aggiunte pg


                elif (
                    ma3_last > ma13_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < - 0.20
                    and deviation_ma25_sotto_ma300 < -1.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.11
                    and ma8_last >= ma8_2_min_ago


                    and (ma100_last < ma100_60_min_ago or ma20_last < ma50_last)
                    
                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2
                    

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.25
                    and deviation_ma300_sopra_ma450 > -0.25

                    and ma200_last > ma200_60_min_ago

                    and ma3_last > ma7_last
                    
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 3 con CV NOTTE E  DEVIATION PROFONDE e con ma450_last > ma450_720_min_ago e con ma200> - GIORNO - r 6447 A1 x2 Z - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 cancellato and ma2_last > ma2_2_min_ago e anticipato ndecchiecella
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 28 feb 2025 GIORNO !
                    # 12 mag 2025 se 100< aggiungo and deviation_ma3_sotto_ma50 < -0.05
                    # 18 ott 2025 aggiunte pg








                elif (
                    ma3_last > ma11_last
                    and deviation_ma300_sopra_ma450 > -0.20

                    and deviation_ma39 < -0.122
                    and deviation_ma3_sotto_ma50 < -0.149 
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.155
                    and deviation_ma25_sotto_ma300 < 0.096
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05


                    and (ma450_last > ma450_360_min_ago or ma450_last > ma450_720_min_ago or ma450_last > ma450_720_min_ago or ma200_last > ma200_60_min_ago)
                    and delta_DNA_1 > delta_DNA_2
                    
                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 3 con ma450_last > ma450_720_min_ago e con ma200> + DNA NOTTE - r 6447 A1y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 cancellato and ma2_last > ma2_2_min_ago e anticipato ndecchiecella
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 28 feb 2025 aggiunta DNA NOTTE
                    # 21 mag 2025 e' andata bene
                    # 28 mag 2025 aggiunto and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    # 25 ott 2025 aggiunte pg
                    # 25 ott 2025 aggiunte dev da pg di un sell successivo



                elif (
                    ma3_last > ma13_last

                    and (ma3_last < ma20_last or ma20_last < ma20_2_min_ago or ma33_last < ma33_3_min_ago)
                    and ma5_last > ma150_last
                    and ma100_last > ma200_last
                    
                    and delta_1 < delta_2

                    and ma450_last < ma450_720_min_ago

                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.05

                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -6.50
                   
                ):
                    buy = f"BUY 3 {ma450_last} {ma450_720_min_ago} con ma5_last > ma150_last ma RITRACCIA E ma450<720 min MA GIORNO - r 6447 A2x"
                    action = "buy"
                    percentage = 90

                    # 27 mar 2025 se ma5_last > ma150_last ritracciando compra con deviation_ma39 < -0.12
                    # 11 apr 2025 correzione or e aggiunta f


                elif (
                    ma3_last > ma13_last

                    and ma5_last < ma39_last
                    and deviation_ma3_sotto_ma50 < -0.22

                    and ma450_last < ma450_720_min_ago

                    and delta_1 < delta_2
                    and ma100_last > ma200_last
                    
                    and ma5_last > ma5_2_min_ago
                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -2.50
                   
                ):
                    buy = "BUY 3 con ma450_last < ma450_720_min_ago MA con ma200> e GIORNO + distanza al ribasso - r 6447 A2y"
                    action = "buy"
                    percentage = 90
                    
                    # compare prega per me !
                    # se ma200< MA 100 e' andata sopra 200 ! si torna alle origini ! 8-50 ! (con ma2 > ma2 2 min ago)
                    # deviation_buy2 = ma8_last / ma50_last
                    # 20 set 2024 questa condizione si deve attivare SOLO SE and ma200_last > ma200_60_min_ago
                    # 20 set 2024 per evitare di cancellarla. e vafanculo.

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 20 mar 2025 se 5<39 allora compra con distanza al ribasso



                # BUY 3 NUOVO che ci riprova TORNANDO ALLE ORIGINI MA on ma200 < da ALMENO 5 ore ! and ma300<

                elif (
                    deviation_buy2 > 0.01

                    and ma100_last > ma200_last
                    and ma200_last > ma300_last

                    and deviation_ma3_sopra_ma28 > 0.01
                    
                    and ma450_last < ma450_300_min_ago
                    and ma300_last < ma300_60_min_ago

                    
                    and ma2_last > ma2_2_min_ago
                    
                    and ma3_last > ma13_last
                    and deviation_buy_ma3_sopra_ma20 > 0.01
                    and deviation_ma4_sopra_ma25 > 0.01
                 
                ):
               
                    buy = "BUY 3 che ci riprova MA SOLO SE ma450 scende da almeno 5 ore ! cazzo E 200 > 300 - r 6447 bx"
                    action = "buy"
                    percentage = 90

                    # 15 ott 2024 se 200>300 anticipato ndecchiecella




                elif (
                    ma3_last > ma13_last

                    and ma450_last < ma450_300_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma300_last

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.156

                    and deviation_ma39 < -0.21
                    and deviation_ma3_sotto_ma50 < -0.22
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma25_sotto_ma300 < -0.49
                    
                    and ma100_last > ma200_last
                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -18.50
                ):
               
                    buy = "BUY 3 con ma450 che scende da almeno 5 ore ! + osso cazzo - r 6447 BY"
                    action = "buy"
                    percentage = 90

                    # compare prega per me !
                    # se ma200< MA 100 e' andata sopra 200 ! si torna alle origini ! 8-50 ! (con ma2 > ma2 2 min ago)
                    # deviation_buy2 = ma8_last / ma50_last
                    # 20 set 2024 questa condizione si deve attivare SOLO SE and ma200_last > ma200_60_min_ago
                    # 20 set 2024 per evitare di cancellarla. e vafanculo.
                    # 27 mag 2025 osso ! dopo parentesi graffe !
                    #  7 ago 2025 aggiunta and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    #  7 ago 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.156



                    
                # BUY 3 nuovo RIALZO IMPROVVISO ma trend gia' in rialzo da 120 min and 0.27 sopra ultimo sell se 300>120 min e 100 sopra 300> 0.40

                elif (    
                    ma3_last > ma20_last


                    and ma39_last > ma50_last
                    and ma200_last > ma200_60_min_ago
                    



                    and delta_1 < delta_2

                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 > 0.40

                    and ma300_last > ma300_120_min_ago
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma150_last > ma150_60_min_ago
                    and ma2_last >= ma2_2_min_ago
              
                ):
             
                    buy = "BUY 3 RIALZO con 300>120 min e GIORNO e 100 sopra 300> 0.40 - r 6470 AX"
                    action = "buy"
                    percentage = 70

                    # 21 gen 2025 se delta_1 < delta_2 anticipato BUY

                    # 26 feb 2025 sempre con ma200_last > ma200_60_min_ago
                    # 26 feb 2025 se 39 > 50 ok cosi'- nessun problema !




                elif (    
                    ma3_last > ma20_last

                    and (ma39_last < ma50_last or ma20_last < ma50_last)
                    and ma39_last < ma39_10_min_ago
                    and ma200_last > ma200_60_min_ago
                    
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05

                    and ma300_last > ma300_120_min_ago
                    and delta_1 < delta_2
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 > 0.40
                    and ma150_last > ma150_60_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > 0.72
                    
                    and deviation_ma3_sopra_ma10 > 0.01

                    and macd_differenza_2_min_ago > -6.25
                ):
             
                    buy = f"BUY 3 {ma300_last} {ma300_120_min_ago} con 300> MA RITRACCIAMENTO E 5-100 < -0.05 - r 6470 AY"
                    action = "buy"
                    percentage = 70

                    # 21 gen 2025 se delta_1 < delta_2 anticipato BUY

                    # 26 feb 2025 sempre con ma200_last > ma200_60_min_ago
                    # 26 feb 2025 MA se 39 < 50 allora :
                    # 26 feb 2025 RITRACCIAMENTO !
                    # 26 feb 2025 and ma39_last < ma39_10_min_ago
                    # 26 feb 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > 0.72
                    # 26 feb 2025 and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    # 11 apr 2025 correzione or e aggiunta f


                elif (
                    
                    ma3_last > ma20_last
                    and delta_1 > delta_2
                    and ma100_last > ma200_last
                    and deviation_ma100_sopra_ma300 > 0.40
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_buy > 0.27
                    and deviation_ma3_sopra_ma10 > 0.10
                    
                    and ma150_last > ma150_60_min_ago
                    and ma2_last >= ma2_2_min_ago
              
                ):
             
                    buy = "BUY 3 RIALZO con 300>120 min and 0.27 sopra ultimo sell SE NOTTE e 100 sopra 300> 0.40 - r 6470 B"
                    action = "buy"
                    percentage = 70
                    
                    # 31 lug 2023 aggiunta and deviation_ma3_sopra_ma10 > 0.10
                    # 21 gen 2025 SE delta_1 > delta_2 allora and deviation_buy > 0.27 sopra ultimo sell




              
                  
                
                elif (
                    ma300_last < ma300_301_min_ago

                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and ma78_last < ma78_120_min_ago

                    and ma20_last <= ma20_2_min_ago
                    and ma50_last <= ma50_2_min_ago
                    
                    and delta_150_100 <= delta_150_100_60_min
                
                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.02
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.03
                    and deviation_ma25_sotto_ma300 < -0.04
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07

                    and deviation_ma100_sopra_ma300 < 0.40
                    and deviation_ma5_sotto_ma200 > -0.70
                
                    and ma2_last > ma2_2_min_ago 
                ):
                    buy = f"""BUY 3 del 25 set 2025 da un sell ! - r 6475 a - deviation_ma39 {deviation_ma39:.2f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 

                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 80

                    # 25 set 2025 ti ricordo che deviation_sell = ma3_last/last_trade_price
                    # 25 set 2025 aggiunte parentesi graffe
                    # 13 ott 2025 aggiunte parentesi graffe su una riga sola. (in colonna non hanno funzionato)
                    # 13 ott 2025 aumentata intanto di una ndecchiecella la profondita' di acquisto
                    # 14 ott 2025 se delta_CV_300_25_last < delta_CV_300_25_45_min_ago
                    # 14 ott 2025 le parentesi graffe hanno funzionato perfettamente anche con :.2f


                elif (
                    ma300_last < ma300_301_min_ago

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.50)

                    and ma78_last < ma78_120_min_ago

                    and ma20_last <= ma20_2_min_ago
                    and ma50_last <= ma50_2_min_ago
                    
                    and delta_150_100 <= delta_150_100_60_min
                
                    and deviation_ma39 < -0.38
                    and deviation_ma3_sotto_ma50 < -0.42
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and deviation_ma25_sotto_ma300 < -0.44
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05

                    and deviation_ma100_sopra_ma300 < 0.40
                    and deviation_ma5_sotto_ma200 > -0.70
                
                    and ma2_last > ma2_2_min_ago 
                ):
                    buy = f"""BUY 3 del 25 set 2025 da un sell ! - r 6475 b - deviation_ma39 {deviation_ma39:.2f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 

                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 80

                    # 25 set 2025 ti ricordo che deviation_sell = ma3_last/last_trade_price
                    # 25 set 2025 aggiunte parentesi graffe
                    # 13 ott 2025 aggiunte parentesi graffe su una riga sola. (in colonna non hanno funzionato)
                    # 13 ott 2025 aumentata intanto di una ndecchiecella la profondita' di acquisto
                    # 14 ott 2025 se delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    # 14 ott 2025 le parentesi graffe hanno funzionato perfettamente anche con :.2f




                # BUY 3 RIALZO IMPROVVISO ! con ma200 > and ma100_last > ma200_last

                elif (
                    
                    ma200_last > ma200_20_min_ago
                    and ma78_last > ma150_last
                    and deviation_rialzo_improvviso_sopra > 0.28
                    and deviation_rialzo_improvviso_1 > 0.28
                    and deviation_rialzo_improvviso_2 > 0.185
                    and deviation_rialzo_improvviso_3 > 0.185
                    and deviation_range_1 < 0.21
                    and deviation_range_1 > -0.21
                    and deviation_range_2 < 0.21
                    and deviation_range_2 > -0.21
                    and deviation_range_x < 0.21
                    and deviation_range_x > -0.21
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.01
                ):
             
                    buy = "BUY 3 RIALZO IMPROVVISO ! con ma200 > and 78>150 (solo per il buy 2 e per il buy 3) - r 6479"
                    action = "buy"
                    percentage = 80
                    
                    #  8 gen 2024 78>150 al posto di 100>200
                    #  8 gen 2024 and deviation_rialzo_improvviso_sopra > 0.24 da 0.47
                    #  9 gen 2024 and deviation_rialzo_improvviso_sopra > 0.28 da 0.24
                    #  9 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.088
                    # 25 set 2025 ti ricordo chedeviation_sell = ma3_last/last_trade_price

                
                    
                # BUY 3 con ma200> piccola CORREZIONE in alto FIAT che NON E' un forte ribasso e NON E' un crollo ! ALTRA RIGA RCCR che e' andata bene.
                
                elif (    
                    
                    ma5_last > ma150_last
                    and ma2_differenza_2_min_ago > 5
                    
                    and deviation_ma100_sopra_ma300 > 0.50
                    and deviation_ma300_sopra_ma450 > 0.40
                    and deviation_ma3_sopra_ma18 > 0.14
                  
                    and ma200_last > ma200_20_min_ago
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.113
                    and deviation_ma5_sopra_ma28 > -0.02
                ):    
                    
                    buy = "BUY 3 correzione in alto con 200 > - riga 1384 RCCR portata nel MADDOG and ma2_differenza_2_min_ago > 5 - r 6480 A1"
                    action = "buy"
                    percentage = 80
                    
                    # 30 set importato r 1384 RCCR su BUY 3 MADDOG
                    # 30 set 2022 aggiunta 3-10
                    # 30 set 2022 aggiunta 5.28
                    #  2 ott 2022 3-10 0.10 !
                    #  4 dic 2023 aggiunta and ma2_differenza_2_min_ago > 5
                elif (    
                    
                    ma5_last > ma150_last
                    and deviation_ma100_sopra_ma300 > 0.50
                    and deviation_ma300_sopra_ma450 < 0.40
                    and deviation_ma3_sopra_ma18 > 0.10
                  
                    and ma200_last > ma200_20_min_ago
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.113
                    and deviation_ma5_sopra_ma28 > -0.02
                ):    
                    
                    buy = "BUY 3 correzione in alto con 200 > - riga 1384 RCCR portata nel MADDOG - r 6480 A2"
                    action = "buy"
                    percentage = 80
                    
                    # 30 set importato r 1384 RCCR su BUY 3 MADDOG
                    # 30 set 2022 aggiunta 3-10
                    # 30 set 2022 aggiunta 5.28
                    #  2 ott 2022 3-10 0.10 !

                 
                elif (      
                    ma5_last > ma150_last
                    and (ma3_prev < ma80_prev and ma3_last > ma80_last)
                    and deviation_ma100_sopra_ma300 > 0.50
                    
                    and ma200_last > ma200_20_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.113
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma2_last > ma2_2_min_ago
                ):    
                    
                    buy = "BUY 3 con incrocio al rialzo 3-80 mentre TUTTO SALE - r 6480 A3"
                    action = "buy"
                    percentage = 80
                    
                    # 30 set importato r 1384 RCCR su BUY 3 MADDOG
                    # 30 set 2022 aggiunta 3-10
                    # 30 set 2022 aggiunta 5.28
                    #  2 ott 2022 3-10 0.10 !
                    
                    
                    
                    
                # BUY 3 con ma200> piccola CORREZIONE in basso FIAT che NON E' un forte ribasso e NON E' un crollo ! ALTRA RIGA RCCR che e' andata bene.
                
                
                elif (    
                    ma3_last > ma28_last
                    
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_20_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.08
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):    
                    
                    buy = "BUY 3 correzione in basso con 200 > - riga 1384 RCCR portata nel MADDOG ma3_last > ma28_last and macd > macd_2_min_ago con 3-10 > 0.08 - r 6480 B1"
                    action = "buy"
                    percentage = 80
                    
                    # 30 set importato r 1384 RCCR su BUY 3 MADDOG
                    # 30 set 2022 aggiunta 3-10
                    # 30 set 2022 aggiunta 5.28
                    #  2 ott 2022 3-10 0.10 !
                    #  2 nov 2023 tolto 5-28
                    #  2 nov 2023 aggiunto macd > macd_2_min_ago
                    #  2 nov 2022 3-10 0.08 ! se c'e' la presenza del macd >



                elif (    
                    
                    ma200_last > ma200_20_min_ago
                    and ma39_last > ma39_15_min_ago

                    and deviation_ma100_sopra_ma300 < 0.50
                    
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.057
                    and deviation_ma5_sopra_ma28 > 0.057
                ):    
                    
                    buy = "BUY 3 con 39 > 39 15 min ago correzione in basso con 200 > - riga 1384 RCCR portata nel MADDOG - r 6480 B2 x"
                    action = "buy"
                    percentage = 80

                    #  6 mar 2024 se 39 > 39 15 min ago ok cosi'
                    

                elif (    
                    
                    ma200_last > ma200_20_min_ago
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192

                    and deviation_ma100_sopra_ma300 < 0.50
                    
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.057
                    and deviation_ma5_sopra_ma28 > 0.057
                ):    
                    
                    buy = "BUY 3 con 39 < 39 15 min ago PUGNO FANTASMA DI ALI' dev39 > 0.192 con 200 > - riga 1384 RCCR portata nel MADDOG - r 6480 B2 y"
                    action = "buy"
                    percentage = 80

                    #  6 mar 2024 se 39 < 39 15 min ago PUGNO FANTASMA DI MOHAMMAD ALI' ( and deviation_ma39 > 0.192 )


                elif (    
                    
                    ma200_last > ma200_20_min_ago
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.24

                    and deviation_ma100_sopra_ma300 < 0.50
                    
                    and ma3_last > ma28_last
                    and ma2_last > ma2_2_min_ago
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.057
                    and deviation_ma5_sopra_ma28 > 0.057
                ):    
                    
                    buy = "BUY 3 con 39 < 39 15 min ago PRENDE IL COLTELLO CON IL PIEDE 5-100 < -0.22 e con 200 > - r 6480 B2 z"
                    action = "buy"
                    percentage = 80
                    
                    # 30 set importato r 1384 RCCR su BUY 3 MADDOG
                    # 30 set 2022 aggiunta 3-10
                    # 30 set 2022 aggiunta 5.28
                    # 18 nov 2022 3-10 = 0.057
                    # 18 nov 2022 5-28 = 0.027
                    #  5 dic 5-28 0.057 da 0.027
                    
                    #  6 mar 2024 se 39 < 39 15 min ago PRENDI IL COLTELLO CON IL PIEDE ( dev 5-100 < -0.22 )
                    
                    
                    
                    
                    
                # BUY 1 migliore che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-59 - r 1043 B
                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):
                    buy = "BUY 3 importata con dist 5-300 E dev 10-200 < -0.24 E dev 4-18 and dev_ma3_sopra_ma16 > -0.12 AND dev ma2 e diff macd - r 6490 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 80
                  
                    
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):
                    buy = "BUY 3 con dist 5-300 E dev 10-200 < -0.24 E dev 4-18 E diff macd - r 6490 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 80

                

                elif (    
                    ma3_last > ma18_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.02

                    and ma450_last < ma450_360_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 3 se CONTINUA A SCENDERE e diff macd - r 6490 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 80

                    # 27 feb 2025 continua a scendere


                    

                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):
                    buy = "BUY 3 importata con dist 5-300 E dev 10-200 < -0.24 E dev 4-18 and dev_ma3_sopra_ma16 > -0.12 AND dev ma2 e diff macd - r 6490 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):
                    buy = "BUY 3 importata con dist 5-300 E dev 10-200 < -0.24 E dev 4-18 and dev_ma3_sopra_ma16 > -0.12 AND dev ma2 e diff macd - r 6490 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 80
                    
                    #  8 lug 2023 4-18
                    # 11 ago 2023 3-18
                    # IMPORTATA DA RCCR il 13 dic 2023
                    # 29 dic 2023 percentage a 80 da 50
                    # 29 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    # 29 dic 2023 aggiunta and macd_differenza_2_min_ago > 1.25


                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.30
                    and ma3_last > ma54_last
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):
                    buy = "BUY 3 importata con dist 5-300 E dev 10-200 < -0.24 E dev 4-18 and dev_ma3_sopra_ma16 > -0.12 AND dev ma2 e diff macd - r 6490 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma3_last > ma39_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):
                    buy = "BUY 3 importata con dist 5-300 E dev 10-200 < -0.24 E dev 4-18 and dev_ma3_sopra_ma16 > -0.12 AND dev ma2 e diff macd - r 6490 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80



                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma3_last > ma39_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    
                    and ma450_last < ma450_360_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                ):
                    buy = "BUY 3 importata con dist 5-300 E dev 10-200 < -0.24 E dev 4-18 and dev_ma3_sopra_ma16 > -0.12 AND dev ma2 e diff macd - r 6490 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 80
                    
                    #  8 lug 2023 4-18
                    # 11 ago 2023 3-18
                    # IMPORTATA DA RCCR il 13 dic 2023
                    # 29 dic 2023 percentage a 80 da 50
                    # 29 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    # 29 dic 2023 aggiunta and macd_differenza_2_min_ago > 1.25





                
                # BUY 3 CON IL TURBO ! (compare stammi vicino!)   
                
                elif (    
                    ma200_last > ma200_120_min_ago
                    and deviation > -0.30
                    and ma200_last > ma300_last
                    and ma20_last > ma200_last
                    
                    and deviation_ma3_sopra_ma10 > 0.145
                    and deviation_bellissima > 0.05
                    and (ma4_prev < ma25_prev and ma4_last > ma25_last)
                    and ma25_last > ma25_2_min_ago
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 CON IL TURBO - r 6500"
                    action = "buy"
                    percentage = 80
                    
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    
                    
                    
                    
                
                ################################################################### condizioni che mancavano !!!
                
                # ------------------------------------------------------------ BUY 3 ritracciamento in alto !

                elif (    
                    ma3_last > ma18_last

                    and (deviation_ma100_sopra_o_sotto_ma100_300_min_ago > 1.25 or deviation_ma100_sopra_ma300 > 0.20)
                    and (ma20_last < ma50_last or ma50_last < ma100_last or ma39_last < ma39_20_min_ago)
                    
                    and deviation_ma50_sotto_ma100 < -0.15
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.22
                    and deviation_ma100_sopra_ma200 < -0.15

                    and ma200_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.05
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > -0.07
                    
                    and macd_differenza_2_min_ago > -18.50
                
                ):
                    buy = "BUY 3 RITRACCIAMENTO IN ALTO ! - r 6505"
                    action = "buy"
                    percentage = 80

                    # 21 gen 2025 anticipata ndecchia con 300 > 300 120 min ago !
                    # 28 gen 2025 aggiunto and delta_300_200 > delta_300_200_60_min NOTTE
                    # 28 gen 2025 and deviation_ma3_sopra_ma10 > 0.02 da > 0.01 ( ha comprato prestissimo quasi attaccato al sell precedente.)
                    # 15 apr 2025 importata da BUY 2 e modificata
                    #  9 mag 2025 RITRACCIAMENTO IN ALTO !


                elif (
                    
                    ma3_last > ma28_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.33

                    and ma39_last < ma100_last
                    and ma10_last < ma20_last
                    and deviation_ma5_sotto_ma300 > -0.57
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 12
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd > -11
                    and macd_differenza_2_min_ago > 1.00
                    
                ):
                    buy = "BUY 3 29 > 180 min di ribasso CON ma10<ma20 con 3-28 - r 6509"
                    action = "buy"
                    percentage = 90

                    # 22 set 2024 aggiunta questa condizione + prendi il coltello con il piede






                elif (    
                    ma3_last > ma20_last
                    and ma20_last > ma50_last

                    and ma100_last > ma100_60_min_ago

                    and ma50_last > ma59_last
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and ma39_last > ma39_30_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                    and ma2_last > ma5_last 
                ):  
                
                    buy = "BUY 3 con 300>450 and 20>50 and macd > -24 and macd_differenza_2_min_ago > 0.30 - r 6510 A1"
                    action = "buy"
                    percentage = 80
                    
                    # 29 dic 2023 3-20 da 3-28 se 50>59
                    # 22 set 20234 questa la faccio entrare in azione soltanto se 100> 100 60 min
                    # 15 apr 2025 va bene solo se 20>50


                elif (    
                    ma3_last > ma20_last
                    and ma39_last > ma39_2_min_ago
                    and ma50_last > ma59_last
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and ma39_last < ma39_30_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                    and ma2_last > ma5_last 
                ):  
                
                    buy = "BUY 3 con 300 > 450 and 3-20 and macd > -24 and macd_differenza_2_min_ago > 0.30 - r 6510 A2 x"
                    action = "buy"
                    percentage = 80
                    
                    # 29 dic 2023 3-20 da 3-28 se 50>59
                
                
                elif (    
                    ma3_last > ma20_last
                    and ma39_last < ma39_2_min_ago
                    and deviation_ma39 > 0.33
                  
                    and ma50_last > ma59_last
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and ma39_last < ma39_30_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                    and ma2_last > ma5_last 
                ):  
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-20 and macd > -24 and macd_differenza_2_min_ago > 0.30 - r 6510 A2 y"
                    action = "buy"
                    percentage = 80
                    
                    # 29 dic 2023 3-20 da 3-28 se 50>59
                    #  9 gen 2024 cor cazzo che compri mentre ma 39 scende da 30 min e ma 39 scende anche da 2 min ! cioe' compri con 3-39 > 0.33 ! PUGNO FANTASMA DI ALI'
              




                elif (    
                    ma3_last > ma25_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                ):    
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-28 E macd > -24 and macd_diff_2_min_ago > 0.30 - r 6510 B1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 80



                elif (    
                    ma3_last > ma28_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                ):    
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-28 E macd > -24 and macd_diff_2_min_ago > 0.30 - r 6510 B1 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                ):    
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-28 E macd > -24 and macd_diff_2_min_ago > 0.30 - r 6510 B1 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 80


                # 29 set 2024 r 6510 B1 NUOVA ERA A3 SOFT cancellata

                

                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                ):    
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-28 E macd > -24 and macd_diff_2_min_ago > 0.30 - r 6510 B1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                ):    
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-28 E macd > -24 and macd_diff_2_min_ago > 0.30 - r 6510 B1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 80

                elif (    
                    ma3_last > ma28_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                ):    
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-28 E macd > -24 and macd_diff_2_min_ago > 0.30 - r 6510 B1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 80

                
                elif (    
                    ma3_last > ma28_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd > -24.0
                    and macd_differenza_2_min_ago > 0.30
                ):    
                
                    buy = "BUY 3 laterale IMPORTATA dal BUY 2 con 300 > 450 and 3-28 E macd > -24 and macd_diff_2_min_ago > 0.30 - r 6510 B1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 80

              


              
                  
                elif (    
                    ma3_last > ma10_last

                    and ma100_last < ma100_30_min_ago
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.30
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.69
                    and deviation_ma5_sotto_ma200 < -1.30
                    and deviation_ma5_sotto_ma300 < -1.80


                    and ma50_last <= ma59_last
                    
                    and ma300_last > ma300_301_min_ago
                    and ma450_last > ma450_480_min_ago
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > -40.0
                    and macd_differenza_2_min_ago > -1.30
                    and ma2_last > ma5_last 
                ):  
                
                    buy = "BUY 3 laterale SE CROLLA con 300> e 450> and 3-10 and macd > -40 AND zia amalia grafana - r 6510 B2"
                    action = "buy"
                    percentage = 80

                    # sembra che non legga and macd >= macd_2_min_ago (forse se e' poca la differenza)
                    # 18 nov 2023 aggiunta anche and ma2_differenza_2_min_ago > 3
                    # 23 dic 2023 and ma2_differenza_2_min_ago a 8 da 3      
                    # 23 dic 2023 and macd_differenza_2_min_ago a 0.30 da 0.20
                    # 23 dic 2023 aggiunta and ma2_last > ma5_last

                
                # BUY 3 primo modo che ci riprova DURANTE IL CROLLO !

                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma2_last > ma7_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                ):
                    buy = "BUY 3 che ci riprova DURANTE IL CROLLO - modo 1 2-7 - r 6520"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # 15 nov 2022 aggiunta 3-10 and 5-28 (STIAMO AL BUY 3!) vedi 8 nov ore 19:02 !
                    
                    
               
                # BUY 3 secondo modo che ci riprova DURANTE IL CROLLO !
                
                elif (
                    ma3_last > ma16_last

                    and deviation_buy_crollo_1 < -1.70
                    and deviation_buy_crollo_1 > -2.29
                    and deviation_buy_crollo_2 > 0.05

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 3 che ci riprova DURANTE IL CROLLO - modo 2 - r 6538"
                    action = "buy"
                    percentage = 90
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_buy_crollo_2 = ma3_last / ma13_last
                    # 11 mar 2025 anticipata ndecchiecella togliendo sovrastrutture
                    
                    
                # BUY 3 che ci riprova DURANTE IL CROLLO - modo 3
                
                elif (
                    
                    ma5_last > ma20_last
                    
                    and deviation_ma5_sotto_ma300 < -2.40
                    and deviation_ma100_laterale < -1.90
                    and deviation_ma28_sotto_ma100 < -0.80
                    
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma2_last > ma2_2_min_ago
                    
                ):
                    buy = "BUY 3 che ci riprova DURANTE IL CROLLO - modo 3 - r 6569"
                    action = "buy"
                    percentage = 90
                    
                    # and deviation_ma100_laterale < -1.90 e' 5 sotto 100 (NON TI PREOCCUPARE)
                    # QUESTA CONDIZIONE E' STATA CREATA DOPO AVER VISTO UN CROLLO DOPO IL BUY 2 ma il BUY 3 non entrava in azione !
                    
                    
                    
                    
                # BUY 3 29 ago 2022 > 120 min di ribasso

                elif (
                    
                    ma3_last > ma18_last
                    and ma25_last > ma25_60_min_ago
                    and deviation_ma5_sotto_ma300 > -0.40
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_30_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma39 < -0.14
                    and deviation_ma3_sotto_ma50 < -0.22
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.30
                ):
                    buy = "BUY 3 29 ago 2022 > 120 min di ribasso AND 3>18 - r 6570 Ax"
                    action = "buy"
                    percentage = 90

                    # 31 gen 2025 se and ma25_last > ma25_60_min_ago anticipato ndecchiecella
                    # 14 apr 2025 aggiunta and deviation_ma39 < -0.14
                    # 14 apr 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.22
                    # 14 apr 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13


                elif (    
                    ma3_last > ma18_last

                    and ma50_last > ma100_last
                    and deviation_ma3_sotto_ma50 < -0.10

                    and deviation_ma5_sotto_ma300 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_30_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 3 29 ago 2022 > 120 min di ribasso AND 3>18 - r 6570 Ay1"
                    action = "buy"
                    percentage = 90

                    #  8 mag 2025 nelle varie oscillazioni 50 sta, in questa circostanza, sopra 100 e compra con deviation_ma3_sotto_ma50 < -0.10



                elif (    
                    ma3_last > ma15_last

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07

                    and ma25_last < ma25_60_min_ago
                    and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago

                    and deviation_ma3_sotto_ma50 < -0.13

                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_30_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 3 29 ago 2022 > 120 min di ribasso AND 3>18 - r 6570 Ay2 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    
                    action = "buy"
                    percentage = 90
                    
                    # 14 set 2022 18-78 da 18-100
                    #  8 nov 2022 300 con 120 min faceva arrivare tardi il buy. 
                    #  8 nov 2022 cosi' ho ridotto a 30 min. (non era la 18-78 che faceva arrivare tardi il buy)
                    # 17 mar 2023 aggiunta 3-16 >0.12
                    # 14 set 2023 8-78 da 18-78
                    # 31 gen 2025 se and ma25_last < ma25_60_min_ago ok cosi'
                    # 15 apr 2025 anticipato ndecchiecella 
                    # 26 apr 2025 3-18 da 5-54 perche' da questo buy un po' piu' basso e' dipeso il rialzo successivo
                    # 26 apr 2026 questa ci deve stare si tratta di aggiungere un po' di distanza al ribasso
                    # 12 mag 2025 e' andata benissimo
                    # 12 mag 2025 aggiunto, comunque, and deviation_ma3_sotto_ma50 < -0.13
                    # 23 set 2025 aggiunto and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago
                    #  8 ott 2025 e' andata bene
                    #  8 ho aggiunto parentesi graffa sulla stessa riga
                    # 15 ott 2025 ha funzionato. ho aggiunto, quindi, altre parentesi graffe
                    # 15 ott 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07



                    
                # BUY 3 29 ago 2022 > 120 min di ribasso
                
                elif (
                    
                    ma4_last > ma28_last
                    and ma2_last < ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    and macd_differenza_2_min_ago > 1
                    and ma2_differenza_2_min_ago > 11

                    
                    and deviation_ma5_sotto_ma300 < -0.40
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.001
                    
                ):
                    buy = "BUY 3 29 ago 2022 > 120 min di ribasso AND 5 > 28 AND 5-28 > 0.10 and 3-16 > 0.02 and macd > macd 2 min ago and ma2_differenza_2_min_ago > 11 - r 6570 B"
                    action = "buy"
                    percentage = 90
                    
                    # 14 set 2022 18-78 da 18-100
                    # 11 ott 2022 mentre scende dopo 2 ore se accelera al ribasso (5 si allontana da 300) interviene prima con 8-59 !
                    # 19 ottobre 2022 5-28 0.11 da 0.08
                    # 16 mar 2023 3-16 a > 0.02
                    # 21 agosto 2023 5-28 0.10 da 0.11
                    # 21 agosto 2023 8-39 da 8-59
                    # 21 agosto 2023 and macd > macd 2 min ago
                    #  1 set sembra che macd> macd 2 min ago non prende se sta nella stessa unita' per es 7.75 - 5-44 allora mi sono inventato differenza macd che deve essere > 1
                    # 27 ott 2023 5-28 da 8-39
                    #  3 nov 2023 4-28 da 5-28 
                    #  3 nov 2023 aggiunta and ma2_differenza_2_min_ago > 11
                    
                    # 16 nov 2023 NON HA PRESO LA DIFFERENZA ma2 allora ho portato sopra. vediamo
                    # 16 nov 2023 aggiunta and deviation_ma3_sopra_ma10 > 0.018 (anche perche' non ha preso la differenza ma2)
              
                



                # BUY 3 migliore che considera distanza 5-100

                elif (    
                    ma3_last > ma18_last
                    and ma450_last > ma450_480_min_ago

                    and delta_1 < delta_2
                    and delta_300_200 < delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -0.40

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                  
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 3 GIORNO - GIORNO - che considera distanza 10-200 - r 6571 A1"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma5 sta sotto la ma100 almeno di -0.30
                    #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago



                elif (    
                    ma3_last > ma18_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and ma300_last < ma300_60_min_ago
                    and delta_300_200 < delta_300_200_30_min

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01

                    and macd_differenza_2_min_ago > -2.50
                     
                ):
                    buy = "BUY 3 CONTINUA A SCENDERE DNA - r 6571 A2"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma5 sta sotto la ma100 almeno di -0.30
                    #  3 mar 2025 aggiunta CONTINUA A SCENDERE DNA





                elif (    
                    ma3_last > ma28_last
                    and delta_1 < delta_2
                    and delta_300_200 > delta_300_200_30_min
                    and deviation_ma25_sotto_ma300 < -1.20


                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 3 GIORNO-NOTTE - che considera distanza 10-200 - r 6571 B"
                    action = "buy"
                    percentage = 80
                    
                    # importante : ma5 sta sotto la ma100 almeno di -0.30
                    # 27 gen 2025 giorno - notte

                
                # BUY 3 29 ago 2022 > 180 min di ribasso


                
                
                elif (    
                    ma3_last > ma15_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15


                    and ma78_last < ma150_last

                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.08

                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.03
                    
                    
                    and ma2_last >= ma10_last
                    and macd_differenza_2_min_ago > -2.50
                 
                ):
                    buy = "BUY 3 modificato importando un vecchio pensiero laterale - CONTINUA A SCENDERE ! - r 6572 A1 xa"
                    action = "buy"
                    percentage = 90

                    #  8 ott 2024 se GIORNO se cioe' all' appuntamento con il BUY 3 la ma100 si avvicina alla BUY 2 allora anticipo ndechiecella
                    # 24 nov 2024 modificato importando un vecchio pensiero laterale.
                    # 27 feb 2025 CONTINUA A SCENDERE



                elif (    
                    ma3_last > ma20_last
                    and delta_1 > delta_2

                    and deviation_ma200_sotto_ma300 > -0.10

                    and ma39_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.30

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma3_sopra_ma10 > 0.01
                    and ma3_last >= ma8_last

                    and macd_differenza_2_min_ago > -2.50
                    
                ):
                    buy = "BUY 3 con ma200 ancora vicina a ma300 e > 180 min di ribasso E NOTTE + distanza al ribasso - r 6572 A1 xb"
                    action = "buy"
                    percentage = 90

                    # 21 mar 2025 aggiunta distanza al ribasso


                # 21 settembre 2024 cancellata r 6572 A1 Y1
                

              
                
                elif (    
                    ma3_last > ma18_last
                    and ma450_last > ma450_720_min_ago

                    and ma39_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.28

                    and ma10_last < ma20_last

                    and deviation_ma25_sotto_ma300 < -0.39
                    and deviation_ma50_sotto_ma300 < -0.36

                    and deviation_ma5_sotto_ma300 > -0.60
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    
                    and ma2_last > ma5_last
                   
                    and macd_differenza_2_min_ago > -2.50
                    
                ):
                    buy = "BUY 3 > 180 min di ribasso CON 10<20 e 3-18 + zia amalia + distanza verso il basso - r 6572 A1 Y2"
                    action = "buy"
                    percentage = 80
                    
                    # 13 feb 2023 3-10 > 0.02
                    #  1 ago 2023 5-200 invece di 10-100
                    # 24 ago 2023 and macd > macd_2_min_ago
                    # 24 ago 2023 and macd > 5
                    # 16 set 2023 5-78 invece di 5-200
                    # 17 set 2023 5-54 invece di 5-78
                    # 28 set 2023 5-39 invece di 5-54 (5 sotto 300> -0.45 significa che non e' piu' una fase di crollo !)
                    # 28 set 2023 and macd > 4
                    # 28 set 2023 4-39 da 5-39
                    # 15 ott 2023 4-28 da 4-39
                    # 15 ott 2023 and macd_differenza_2_min_ago > 0.25
                    #  4 nov 2023 and ma2_differenza_2_min_ago > 7
                    #  7 nov 2023 and deviation_ma5_sopra_ma28 > 0.01 da 0.02
                    #  7 nov 2023 tolto macd > macd 2 min ago perche' ho gia' tante differenze positive ! vedi 7 nov 2023 ore 5:49
                    # 10 dic 2023 3-28 da 4-28
                    # 13 dic 2023 and macd_differenza_2_min_ago > 1.00
                    # 26 dic 2023 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 26 dic 2023 and ma2_differenza_2_min_ago > 12 da 7 se BUY 3 con 10<20 e SOPRATTUTTO ma300_last < ma300_180_min_ago
                    # 13 gen 2024 aggiunto 2>5
                    # 16 set 2024 3-22 da 3-28
                    # 21 mar 2025 aggiunta distanza verso il basso

                
                
                elif (    
                    ma3_last > ma15_last


                    and ma78_last < ma150_last
                    
                    and deviation_ma300_sopra_ma450 < -0.22
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.06
                    
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.22

                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last


                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.42
                    and deviation_ma5_sotto_ma450 < -0.64
                    
                    and macd > -18.50
                ):
                    buy = "BUY 3 29 ago 2022 > 180 min di ribasso con 3-18 - r 6572 A2X"
                    action = "buy"
                    percentage = 90
                    
                    # 13 nov 2023 aggiunta and ma50_differenza_ma59 >= -5
                    # 13 nov 2023 se 50 sta vicina alla 59 (anche un poco sotto) allora compra prima
                    # 13 nov 2023 and deviation_ma5_sopra_ma28 > 0.01 da > 0.02
                    # 13 nov 2023 5-39 da 5-54 posso farlo perche' il sell e' molto piu' reattivo ! RICORDA dev 39 < 0.13 !
                    # 13 dic 2023 4-18 da 5-39
                    # 13 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02 = 8 pts
                    # 26 mar 2026 and macd > -18.50
                    # 26 mar 2026 3-15 da 3-18
                    #  4 mar 2025 compra piu' giu'
                 
                elif (
                    ma3_last > ma20_last

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago

                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma300_sopra_ma450 < -0.22
                    and deviation_ma39_di_adesso_diviso_ma39_di_180_min_ago < -1.00
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15


                    and deviation_ma78_sopra_o_sotto_ma78_30_min_ago > -0.10
                    
                    and deviation_ma5_sotto_ma300 < -0.22
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and macd > -70
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 3 > 180 min di ribasso + continua a scendere circello - r 6572 A2Y1"
                    action = "buy"
                    percentage = 80
                    
                    # 30 nov 2023 ma 78 scende di pochissimo o sale COMPRA PRIMA

              
                elif (
                    ma3_last > ma18_last
                    and deviation_ma78_sopra_o_sotto_ma78_30_min_ago > -0.16
                    
                    and deviation_ma5_sotto_ma300 < -0.42
                    and deviation_ma39 < -0.01

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma50_differenza_ma59 < -5

                    and macd_differenza_2_min_ago > -5.00
                ):
                    buy = f"BUY 3 {deviation_ma39} {deviation_ma3_sotto_ma50} {deviation_ma5_sopra_o_sotto_ma100} {deviation_ma25_sotto_ma300} {deviation_ma100_sopra_o_sotto_ma100_10_min_ago} 29 ago 2022 > 180 min di ribasso - r 6572 A2Y2"
                    action = "buy"
                    percentage = 80

                    # 30 apr 2025 anticipato ndecchiecella
                    # 30 apr 2025 aggiunto finalmente and deviation_ma39 < -0.01
                    # 30 apr 2025 tolto and ma10_last > ma78_last

                    # 30 APR 2025 ATTENZIONE ! DATA STORICA ! nei punti piu' importanti ho messo :
                    # {deviation_ma39} 
                    # {deviation_ma3_sotto_ma50} 
                    # {deviation_ma5_sopra_o_sotto_ma100} 
                    # {deviation_ma25_sotto_ma300} 
                    # {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}

                    # GRAZIE COMPARE MIO !
                    
                   

              
              
                elif (
                    deviation_ma78_sopra_o_sotto_ma78_30_min_ago < -0.10
                    and deviation_ma39 < -0.30
                    and ma3_last > ma28_last
                    
                    and ma50_differenza_ma59 < -5
                    
                    and deviation_ma5_sotto_ma300 < -0.52
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 5
                    and macd > macd_2_min_ago
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 3 con ma78 TREND CHIARAMENTE RIBASSISTA 29 ago 2022 > 180 min di ribasso con macd diff > 1.25 - r 6572 A2 Y3"
                    action = "buy"
                    percentage = 80
                    
                    # 13 feb 2023 3-10 > 0.02
                    #  1 ago 2023 5-200 invece di 10-100
                    # 24 ago 2023 and macd > macd_2_min_ago
                    # 24 ago 2023 and macd > 5
                    # 16 set 2023 5-78 invece di 5-200
                    # 13 nov 2023 non ha preso macd > !!! allora l' ho messo anche sopra
                    # 13 nov 2023 5-39 da 5-54 posso farlo perche' il sell e' molto piu' reattivo ! RICORDA dev 39 < 0.13 !
                    # 30 nov 2023 ma78 e' proprio discendente. continuava a comprare inutilmente. IL TITOLO SEMBRA AVER INTRAPRESO UN VERO E PRORIO TREND RIBASSISTA !
                    # 12 set 2024 aggiunta and macd_differenza_2_min_ago > 1.25
                    
                    # 16 set 2024 aggiunto and deviation_ma39 < -0.30
                    # 16 set 2024 forse da cancellare
                  
                
                
                elif (    
                    ma3_last > ma18_last

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sotto_ma300 < -0.17
                    and deviation_ma5_sotto_ma300 > -0.42
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and macd_differenza_2_min_ago > -18.50
                     
                ):
                    buy = "BUY 3 29 ago 2022 > 180 min di ribasso con 3-18 - r 6572 A3"
                    action = "buy"
                    percentage = 90
                    
                    # 13 feb 2023 3-10 > 0.02
                    #  1 ago 2023 5-200 invece di 10-100
                    # 24 ago 2023 and macd > macd_2_min_ago
                    # 24 ago 2023 and macd > 5
                    # 16 set 2023 5-78 invece di 5-200
                    #  7 apr 2025 se ma300_last < ma300_180_min_ago aggiungo and deviation_ma39 < -0.17 and deviation_ma3_sotto_ma50 < -0.25


              
                
                elif (    
                    ma5_last > ma18_last

                    and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.156
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18
                    and macd > -100
                    
                ):
                    buy = "BUY 3 29 ago 2022 > 180 min di ribasso con CM GIORNO ! - r 6572 A originario"
                    action = "buy"
                    percentage = 90
                    
                    # 13 feb 2023 3-10 > 0.02
                    #  1 ago 2023 5-200 invece di 10-100
                    # 24 ago 2023 and macd > macd_2_min_ago
                    # 24 ago 2023 and macd > 5
                    # 16 set 2023 5-78 invece di 5-200
                    #  8 ago 2025 modificato aggiungendo parti dalle condizioni migliori
                    # 24 set 2025 aggiunta and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago


                    
                # BUY 3 29 ago 2022 > 180 min di ribasso

                elif (    
                    ma3_last > ma20_last
                    and delta_1 < delta_2
                   
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma3_sotto_ma50 < -0.25

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.005
                    and deviation_ma3_sopra_ma16 > -0.077
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 3 GIORNO > 180 min di ribasso - r 6572 Bx A"
                    action = "buy"
                    percentage = 90
                    
                    # 11 ott 2022 mentre scende dopo 3 ore accelera al ribasso (5 si allontana da 300)
                    # 10 ott 2023 and macd > macd 2 min ago
                    # 18 dic 2023 SE ma50_last > ma59_last compra con 8-50
                    #  2 mar 2025 ho voluto tenerla - ma avrei potuto modificare con COMINCIA A SCENDERE !
                    #  2 mar 2025 intanto ho anticipato di una ndecchiecella
                    # 11 mar 2025 anticipata ndecchiecella e aggiunta GIORNO
                    #  2 apr 2025 and deviation_ma3_sotto_ma50 < -0.25 cazzo




                # oggi 29 mag 2025 cancellata r 6572 Bx B

                

                
                elif (    
                    ma3_last > ma20_last
                    and (ma450_last < ma450_300_min_ago or ma100_last < ma450_last)
                    and (deviation_ma50_sotto_ma100 > -0.15 and deviation_ma3_sotto_ma50 < -0.50)
                    
                    and ma50_last <= ma59_last
                    and deviation_ma5_sotto_ma300 < -0.40
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18
                ):
                    buy = "BUY 3 > 180 min di ribasso con ma50 < ma59 con dev_ma50_sotto_ma100 > -0.15 and dev 3-50 < -0.50 - r 6572 B y1"
                    action = "buy"
                    percentage = 90

                    #  7 mag 2025 se ma450_last < ma450_300_min_ago or ma100_last < ma450_last con 50 che si avvicina a 100



                elif (    
                    ma3_last > ma20_last
                    and (ma450_last < ma450_300_min_ago or ma100_last < ma450_last)
                    and (deviation_ma50_sotto_ma100 < -0.45 and deviation_ma3_sotto_ma50 < -0.30)
                    
                    and ma50_last <= ma59_last
                    and deviation_ma5_sotto_ma300 < -0.40
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18
                ):
                    buy = "BUY 3 > 180 min di ribasso con ma50 < ma59 con dev_ma50_sotto_ma100 < -0.45 and dev 3-50 < -0.30 - r 6572 B y2"
                    action = "buy"
                    percentage = 90
                    
                    # 11 ott 2022 mentre scende dopo 3 ore se accelera al ribasso (5 si allontana da 300)
                    # 10 ott 2023 and macd > macd 2 min ago
                    # 18 dic 2023 con ma50 <= ma59 ok cosi'
                    #  7 mag 2025 se ma450_last < ma450_300_min_ago or ma100_last < ma450_last con 50 lontana da 100
                    
                




                elif (    
                    ma3_last > ma11_last

                    and deviation_ma39 < -0.33
                    and deviation_ma3_sotto_ma50 < -0.44
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.82
                    and deviation_ma25_sotto_ma300 < -1.48
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.186

                    and ma100_last < ma200_last
                    and ma100_last < ma300_last
                ):
                    buy = "BUY 3 > grande ribasso 29 mag 2025 aggiunta da un sell con parentesi graffe - grazie compa ! - r 6573"
                    action = "buy"
                    percentage = 90

                    # 27 giu 2025 deviation_ma100_sopra_o_sotto_ma100_10_min_ago a -0.186 da -0.176
                    # 28 giu 2025 mi piace.



                # BUY 3 del 2 ottobre 2023 NON COMPRAVA !

                elif (    
                    ma3_last > ma18_last

                    and ma450_last > ma450_480_min_ago
                    and ma78_last > ma150_last
                    
                    and ma300_last > ma450_last

                    and ma20_last > ma50_last
                    and deviation_ma3_sotto_ma50 < -0.07
                    
                    and deviation_ma250_sopra_ma300 < 0.25
                    and deviation_ma250_sopra_ma300 > -0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -18.00
                ):
                    buy = "BUY 3 con 3-18 - NON COMPRAVA ! - con 450 > 450 480 min E 78 > 150 - MEDIE LUNGHE ANCORA VICINE - r 6574 a1 XX 1A"
                    action = "buy"
                    percentage = 70

                    # 25 mar 2025 con ma78_last > ma150_last





                elif (    
                    ma3_last > ma13_last
                    and ma20_last < ma50_last

                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and ma78_last > ma150_last
                    and ma300_last > ma450_last
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.25
                    and deviation_ma250_sopra_ma300 > -0.25


                    and deviation_ma39 < -0.07
                    and deviation_ma3_sotto_ma50 < -0.07
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -18.00
                ):
                    buy = f"BUY 3 con 3-18 - NON COMPRAVA ! - con 450 > 450 480 min - MEDIE LUNGHE VICINE e 20<50 e 3-39 < -0.07 - r 6574 a1 XX 1B x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 25 mar 2025 con ma78_last > ma150_last
                    # se 20<50 dev 3-39 < -0.10
                    # 24 ott 2025 aggiungo pg innanzitutto !
                    # 24 ott 2025 cv giorno ok cosi'



                elif (    
                    ma3_last > ma13_last
                    and ma20_last < ma50_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07
                    and ma8_last >= ma8_2_min_ago


                    and ma78_last > ma150_last
                    and ma300_last > ma450_last
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.25
                    and deviation_ma250_sopra_ma300 > -0.25


                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.01
                    
                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -18.00
                ):
                    buy = f"BUY 3 con 3-18 - NON COMPRAVA ! - con 450 > 450 480 min - MEDIE LUNGHE VICINE e 20<50 e 3-39 < -0.07 - r 6574 a1 XX 1B y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 25 mar 2025 con ma78_last > ma150_last
                    # se 20<50 dev 3-39 < -0.10
                    # 24 ott 2025 aggiungo pg innanzitutto !
                    # 24 ott 2025 cv notte +cm +ma8 +ma100


                elif (    
                    ma3_last > ma13_last
                    and ma20_last < ma50_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and deviation_ma39 < -0.181
                    and deviation_ma3_sotto_ma50 < -0.272

                    and ma78_last > ma150_last
                    and ma300_last > ma450_last
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.30
                    and deviation_ma250_sopra_ma300 > -0.30

                    and ma2_last > ma5_last
                    and macd_differenza_2_min_ago > -18.00
                ):
                    buy = f"BUY 3 con 3-18 - NON COMPRAVA ! - con 450 > 450 480 min - MEDIE LUNGHE VICINE e 20<50 e 3-39 < -0.07 - r 6574 a1 XX 1B z - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 25 mar 2025 con ma78_last > ma150_last
                    # se 20<50 dev 3-39 < -0.10
                    # 24 ott 2025 aggiungo pg innanzitutto !
                    # 24 ott 2025 cv notte + dev profonde no ma100






                elif (    
                    ma3_last > ma18_last

                    and ma450_last > ma450_480_min_ago
                    and ma78_last < ma150_last

                    and deviation_ma100_sopra_ma200 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.70
                    and deviation_ma50_sotto_ma100 < -0.25
                    and deviation_ma3_sotto_ma50 < -0.30

                    and ma300_last > ma450_last
                    
                    and deviation_ma3_sotto_ma50 < -0.07
                    
                    and deviation_ma250_sopra_ma300 < 0.20
                    and deviation_ma250_sopra_ma300 > -0.20
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -5.00
                ):
                    buy = "BUY 3 con 3-18 - NON COMPRAVA ! - con 450 > 450 480 min MA 78 < 150 - MEDIE LUNGHE ANCORA VICINE - r 6574 a1 XX 2"
                    action = "buy"
                    percentage = 70

                    # 10 nov 2024 anticipato ndecchiecella.
                    # 13 mar 2025 tolta ma2 > ma2 2 min ago
                    # 13 mar 2025 tolta macd > -50
                    # 13 mar 2025 aggiunta macd_differenza_2_min_ago > 1.50
                    # 24 mar 2025 tolta and ma100_last > ma100_60_min_ago
                    # 24 mar 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.15
                    # 24 mar 2025 macd diff > -5.00 da > -2.50
                    # 24 mar 2025 and deviation_ma3_sotto_ma50 < -0.07
                    # 25 mar 2025 con ma78_last < ma150_last



                
                # 24 nov 2024 cancellata r 6574 a1xy
                
                
                elif (    
                    ma3_last > ma28_last
                    and ma450_last > ma450_60_min_ago
                    and ma300_last > ma450_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.33

                    and deviation_ma250_sopra_ma300 < 0.15
                    and deviation_ma250_sopra_ma300 > -0.15
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma5_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 6
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 3 del 2 ottobre 2023 NON COMPRAVA ! con 450 > 450 60 min MA LATERALE and ma2_differenza_2_min_ago > 7 - r 6574 a1 y"
                    action = "buy"
                    percentage = 70

                    # 23 set 2024 se anche 300 > 450 compra anche quando cade il coltello. ma lo prendi con il piede.




                elif (    
                    ma3_last > ma13_last
                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and ma450_last > ma450_60_min_ago
                    and ma300_last > ma450_last
                    and ma200_last > ma450_last
                    
                    and deviation_ma250_sopra_ma300 > -0.15
                    
                    and ma2_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -28.50
                ):
                    buy = f"BUY 3 del 2 ottobre 2023 NON COMPRAVA ! CV GIORNO con 450 > 450 60 min - r 6574 A2 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 60
                    
                    #  2 ottobre 2023 aggiunta perche' BUY 3 NON ENTRAVA IN AZIONE
                    # 25 ottobre 2023 and deviation_ma5_sopra_o_sotto_ma100 > -0.15 da > -0.11
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 < 0.35 da < 0.30
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 > -0.35 da > -0.30
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago > 7
                    #  9 set 2024 anticipata ndecchiecella
                    #  3 giu 2025 anticipata ndecchiecella
                    # 18 ago 2025 anticipata ndecchiecella - vai compa !
                    #  8 ott 2025 anticipate ndecchiecella
                    #  8 ott 2025 forse in futuro aggiungere and delta_50_25_last < delta_50_25_30_min_ago
                    # 21 ott 2025 piccolissima modifica and deviation_ma250_sopra_ma300 a -0.15 da -0.13
                    # 21 ott 2025 aggiunte pg - vedi in particolare 5-100
                    # 24 OTT 2025 CV GIORNO OK COSI



                elif (    
                    ma3_last > ma13_last
                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago

                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    and ma8_last > ma8_2_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.045

                    and ma450_last > ma450_60_min_ago
                    and ma300_last > ma450_last
                    and ma200_last > ma450_last
                    
                    and deviation_ma250_sopra_ma300 > -0.15
                    
                    and ma2_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -28.50
                ):
                    buy = f"BUY 3 del 2 ottobre 2023 NON COMPRAVA ! con 450 > 450 60 min - r 6574 A2 y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 60
                    
                    #  2 ottobre 2023 aggiunta perche' BUY 3 NON ENTRAVA IN AZIONE
                    # 25 ottobre 2023 and deviation_ma5_sopra_o_sotto_ma100 > -0.15 da > -0.11
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 < 0.35 da < 0.30
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 > -0.35 da > -0.30
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago > 7
                    #  9 set 2024 anticipata ndecchiecella
                    #  3 giu 2025 anticipata ndecchiecella
                    # 18 ago 2025 anticipata ndecchiecella - vai compa !
                    #  8 ott 2025 anticipate ndecchiecella
                    #  8 ott 2025 forse in futuro aggiungere and delta_50_25_last < delta_50_25_30_min_ago
                    # 21 ott 2025 piccolissima modifica and deviation_ma250_sopra_ma300 a -0.15 da -0.13
                    # 21 ott 2025 aggiunte pg - vedi in particolare 5-100
                    # 24 OTT 2025 CV NOTTE CM GIORNO and ma8_last > ma8_2_min_ago and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.045


                elif (    
                    ma3_last > ma13_last
                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.11
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.33


                    and ma450_last > ma450_60_min_ago
                    and ma300_last > ma450_last
                    and ma200_last > ma450_last
                    
                    and deviation_ma250_sopra_ma300 > -0.15
                    
                    and ma2_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -28.50
                ):
                    buy = f"BUY 3 del 2 ottobre 2023 NON COMPRAVA ! con 450 > 450 60 min - r 6574 A2y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 60
                    
                    #  2 ottobre 2023 aggiunta perche' BUY 3 NON ENTRAVA IN AZIONE
                    # 25 ottobre 2023 and deviation_ma5_sopra_o_sotto_ma100 > -0.15 da > -0.11
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 < 0.35 da < 0.30
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 > -0.35 da > -0.30
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago > 7
                    #  9 set 2024 anticipata ndecchiecella
                    #  3 giu 2025 anticipata ndecchiecella
                    # 18 ago 2025 anticipata ndecchiecella - vai compa !
                    #  8 ott 2025 anticipate ndecchiecella
                    #  8 ott 2025 forse in futuro aggiungere and delta_50_25_last < delta_50_25_30_min_ago
                    # 21 ott 2025 piccolissima modifica and deviation_ma250_sopra_ma300 a -0.15 da -0.13
                    # 21 ott 2025 aggiunte pg - vedi in particolare 5-100
                    # 24 OTT 2025 CV NOTTE and dev profonde NO deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.045


                elif (
                    
                    ma4_last > ma30_last
                    and ma100_last < ma100_30_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.33
                    
                    and deviation_ma250_sopra_ma300 < 0.12
                    and deviation_ma250_sopra_ma300 > -0.12
                    
                    
                    and ma450_last > ma450_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma5_sopra_ma28 > 0.02
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma2_last > ma5_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 6
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 3 del 2 ottobre 2023 NON COMPRAVA ! con 450 > 450 60 min MA LATERALE and ma2_differenza_2_min_ago > 7 - r 6574 b"
                    action = "buy"
                    percentage = 60
                    
                    #  2 ottobre 2023 aggiunta perche' BUY 3 NON ENTRAVA IN AZIONE
                    # 25 ottobre 2023 and deviation_ma5_sopra_o_sotto_ma100 > -0.15 da > -0.11
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 < 0.35 da < 0.30
                    # 25 ottobre 2023 and deviation_ma100_sopra_ma300 > -0.35 da > -0.30
                    #  7 dic 2023 aggiunta and ma2_differenza_2_min_ago > 7
                    # 26 feb 2024 se 100 scende da 30 minuti allora deve prendere il coltello con il piede
              
                


                # BUY 3 ultima condizione che mancava ! ma tutte negative MA BUY con 8 > 125
                 
                elif ( 
                    ma3_last > ma15_last

                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago
                    and (ma8_last > ma150_last or delta_50_25_last < delta_50_25_30_min_ago)
                    
                    and ma100_last < ma100_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):    
                    buy = f"BUY 3 ULTIMA CONDIZIONE che mancava ! ma tutte negative MA BUY con 8-150 e 5-28 > 0.10 and macd > macd_2_min_ago - r 6598 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 80
                    
                    # BUY 3 ULTIMA CONDIZIONE che mancava con 8-150
                    # 19 ott 2022 aggiunto 5-28 > 0.10
                    #  6 ott 2023 aggiunto and macd > macd_2_min_ago
                    #  8 ott 2025 aggiunta CM
                    #  8 ott 2025 aggiunta or delta_50_25_last < delta_50_25_30_min_ago
                    #  8 ott 2025 aggiunte parentesi graffe 
                    
                    
                # BUY 3 IN ALTO con ma69 > and deviation_bellissima > 0.12 (PER SPEZZARE LA CATENA - effetti laterali) IMPORTATA DA BUY 4 RCCR   
                
                elif (
                    ma50_last >= ma50_2_min_ago
                    and deviation_ma100_sopra_ma300 > 0.25
                    and ma300_last > ma300_301_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.117
                    
                    and deviation_bellissima > 0.05
                    and deviation_buy3 > 0.05
                    and deviation_ma7_sopra_ma40 > 0.05
               
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
             
                ):
                    buy = "BUY 3 IN ALTO 78>100 E con ma69 > and dev_bellissima > 0.12 IMPORTATA DA BUY 4 RCCR - r 6599 A1x"
                    action = "buy"
                    percentage = 50
                    
                    # 28 set aggiunta 3-10
                    #  2 ott 2022 dev bellissima 0.10 da 0.12
                    # 26 ott 2022 5-28 a 0.117 vedi 25 ottobre ore 21:16
                    
                    
                    
                    
                # deviation_ma5_sopra_o_sotto_ma100    
                # BUY 3 IN MEZZO (effetti laterali) con ma69 > and deviation_bellissima > 0.12 IMPORTATA DA BUY 4 RCCR

                elif (    
                    ma3_last > ma30_last
                    and ma39_last > ma39_15_min_ago
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A1 SOFT a"
                    action = "buy"
                    percentage = 60



                elif (    
                    ma3_last > ma30_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma39 > 0.192
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A1 SOFT b"
                    action = "buy"
                    percentage = 60


                elif (    
                    ma3_last > ma30_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and ma450_last > ma450_360_min_ago
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A1 SOFT c1"
                    action = "buy"
                    percentage = 60


                elif (    
                    ma3_last > ma30_last
                    and ma39_last < ma39_15_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and ma450_last < ma450_360_min_ago
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A1 SOFT c2"
                    action = "buy"
                    percentage = 60
                  

                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 60
                  

                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 60

                



                elif (
                    ma3_last > ma18_last
                    and ma450_last > ma450_360_min_ago
                    and (ma20_last < ma50_last or ma100_last < ma100_60_min_ago or delta_DNA_1 > delta_DNA_2)

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                    and deviation_ma3_sotto_ma50 < -0.13

                    and ma300_last > ma450_last
                    and ma100_last > ma100_180_min_ago
                    
                    and deviation_ma5_sotto_ma200 > -0.70
                    and deviation_ma100_sopra_ma300 < 0.40

                    and deviation_ma3_sopra_ma10 > 0.01
                    and ma3_last > ma13_last 
                    
                    and macd_differenza_2_min_ago > -12.50
                ):  
                
                    buy = "BUY 3 ma300_last > ma450_last - NOTTE - ritracciamento - r 6599 A1 Y A1 NUOVA ERA A3 SOFT x"
                    action = "buy"
                    percentage = 70

                    # 28 feb 2025 DOPO UN LUNGO RIALZO se comincia a curvare verso il basso ALLORA deviation_ma3_sotto_ma50 < -0.03
                    # 19 apr 2025 se 20<50 ritracciamento
                    # 19 apr 2025 se ritracciamento aggiunto and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                    # 10 mag 2025 aggiunta or ma100_last < ma100_60_min_ago
                    # 10 mag 2025 and deviation_ma3_sotto_ma50 a -0.13 da -0.03



                elif (    
                    ma3_last > ma18_last
                    and ma450_last > ma450_480_min_ago
                    and ma100_last > ma450_last

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma20_last > ma50_last
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>18 con 450>450 480 min and 100>450 and ma20_last > ma50_last - r 6599 A1 Y A1 NUOVA ERA A3 SOFTy"
                    action = "buy"
                    percentage = 80

                    # 14 apr 2025 anticipata ndecchiecella
                    # 19 apr anticipata ndecchiecella

                 

                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 60


                elif (    
                    ma3_last > ma30_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 60

          

                elif (    
                    ma3_last > ma30_last
                    
                    and ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70

                
                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma10_last > ma30_last
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 3 con 3>30 con 450 > 450 480 min and ma10_last > ma30_last CONSIDERATA LATERALE - r 6599 A1 Y A1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 80
                    
                    #  2 ottobre 2023 and deviation_ma5_sopra_o_sotto_ma100 > -0.15 da > -0.10 questa anticipata ndecchiecella e creata altra condizione sempre da questa
                    # 24 dic 2023 and ma10_last > ma20_last al posto di macd > macd 2 min ago



                # 24 nov 2024 cancellata r 6599 A1 Y A2
                
                
                elif (
                    
                    ma4_last > ma16_last
                    and ma50_last > ma59_last
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    
                    and deviation_ma100_sopra_ma300 < 0.25
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.10
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                   
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 3 con 450 > 450 480 min MA CONSIDERATA ANCORA LATERALE SE 50>59 and deviation_ma3_sopra_ma10 > 0.05 - r 6599 A1yA3x"
                    action = "buy"
                    percentage = 60
                    
                    # 28 set aggiunta 3-10
                    #  2 ott 2022 dev bellissima 0.05 da 0.12
                    # 17 gen 2023 dev bellissima 0.045 da 0.05
                    # 17 gen 2023 buy3 0.045 da 0.05
                    # 26 feb 2023 buy3 0.02 da 0.05
                    # 17 gen 2023 dev bellissima 0.02 da 0.045
                    # 31 lug anticipata (ma450_last > ma450_480_min_ago !)
                    # 11 ago 2023 4-30 da 4-50
                    # 13 set 2023 5-28 a -0.01 da 0.01 ( cioe' un po' prima se ma450 sale da 480 min! )
                    # 17 ott 2023 and deviation_ma100_sopra_ma300 > -0.30 da > -0.30
                    # 31 ott 2023 se 50>59 3-10 0.05


              
                
                elif (    
                    ma3_last > ma13_last
                    and ma50_last < ma50_2_min_ago

                    and delta_1 > delta_2
                    
                    and ma3_last > ma20_last

                    and ma39_last < ma100_last
                    and deviation_ma300_sopra_ma450 < -0.03

                    and deviation_ma25_sotto_ma300 < -1.20
                    and deviation_ma50_sopra_o_sotto_ma300 < -0.70
                    
                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.04
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.33
                    and deviation_ma5_sotto_ma450 < -0.35

                    and ma450_last > ma450_480_min_ago
                    
                    and ma50_last < ma59_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd > -60
                ):
                    buy = "BUY 3 con 450 > 450 480 min MA CONSIDERATA ANCORA LATERALE SE 50<59 - r 6599 A1 Y A3 Y"
                    action = "buy"
                    percentage = 80
                    
                    # 28 set aggiunta 3-10
                    #  2 ott 2022 dev bellissima 0.05 da 0.12
                    # 17 gen 2023 dev bellissima 0.045 da 0.05
                    # 17 gen 2023 buy3 0.045 da 0.05
                    # 26 feb 2023 buy3 0.02 da 0.05
                    # 17 gen 2023 dev bellissima 0.02 da 0.045
                    # 31 lug anticipata (ma450_last > ma450_480_min_ago !)
                    # 11 ago 2023 4-30 da 4-50
                    # 13 set 2023 5-28 a -0.01 da 0.01 ( cioe' un po' prima se ma450 sale da 480 min! )
                    # 17 ott 2023 and deviation_ma100_sopra_ma300 > -0.30 da > -0.30
                    # 31 ott 2023 se 50<59 3-10 0.077 ! ( comprava continuamente durante il ribasso !
                    #  9 dic 2024 aggiunta DNAM
                    #  6 gen 2024 anticipata ndecchiecella
                    #  4 feb 2025 modificata. se delta_1 > delta_2 il pesce va pescato nell' acqua piu' profonda.





          
              
                  
                    
                elif (
                    ma10_last >= ma10_2_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                  
                    and ma450_last < ma450_480_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                    and deviation_ma3_sopra_ma18 > -0.01

                    and deviation_ma100_sopra_ma300 < 0.25
                    and deviation_ma100_sopra_ma300 > -0.25
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 3 IN MEZZO (effetti laterali) 78>100 E con ma69 > IMPORTATA DA BUY 4 RCCR - r 6599 A1 YB"
                    action = "buy"
                    percentage = 50
                    
                    # 28 set aggiunta 3-10
                    #  2 ott 2022 dev bellissima 0.05 da 0.12
                    # 17 gen 2023 dev bellissima 0.045 da 0.05
                    # 17 gen 2023 buy3 0.045 da 0.05
                    # 26 feb 2023 buy3 0.02 da 0.05
                    # 17 gen 2023 dev bellissima 0.02 da 0.045
                    #  9 mag 2023 aggiunta 3-18> 0.13 se 450 < 450 480 min ago
                    # 17 mag 2023 riduzione generale dei valori per anticipare se 100 sta vicina alla 300 con aggiunta di macd > macd 2 min ago
                    
                    
                
                elif (
                    ma3_last > ma13_last
                    and ma20_last > ma50_last

                    and ma300_last > ma300_301_min_ago
                    and ma50_last >= ma50_2_min_ago
                    and deviation_ma100_sopra_ma300 < -0.25
                    and deviation_ma5_sotto_ma300 > -1.80
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 3 con ma300_last > ma300_301_min_ago and 20>50 MA 100-300 < -0.25 - importata da RCCR - r 6599 A1 z1 X"
                    action = "buy"
                    percentage = 50

                    #  1 dic 2024 anticipata
                    # 14 apr 2015 and ma20_last > ma50_last



                elif (
                    ma3_last > ma13_last
                    and ma20_last < ma50_last

                    and ma300_last > ma300_301_min_ago
                    and ma50_last >= ma50_2_min_ago

                    and deviation_ma100_sopra_ma300 < -0.25
                    and deviation_ma5_sotto_ma300 > -1.80

                    and deviation_ma39 < -0.04
                    and deviation_ma3_sotto_ma50 < -0.04

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 3 con ma300_last > ma300_301_min_ago MA 20<50 AND 100-300 < -0.25 - importata da RCCR - r 6599 A1 z1 Y"
                    action = "buy"
                    percentage = 50

                    #  1 dic 2024 anticipata

                    # 14 apr 2015 and ma20_last < ma50_last
                    # 14 apr 2015 and deviation_ma39 < -0.04
                    # 14 apr 2015 and deviation_ma3_sotto_ma50 < -0.04


                
                # BUY 3 IN BASSO con ma69 > and deviation_bellissima > 0.12 IMPORTATA DA BUY 4 RCCR   
                
                elif (
                    ma50_last >= ma50_2_min_ago
                    and deviation_ma100_sopra_ma300 < -0.25
                    and deviation_ma5_sotto_ma300 < -1.80
                    and deviation_ma39 > 0.33
                    
                    and ma300_last > ma300_301_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and deviation_bellissima > 0.03
                    and deviation_buy3 > 0.03
                    and deviation_ma7_sopra_ma40 > 0.03
               
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd > macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.20
                ):
                    buy = "BUY 3 IN BASSO con ma300_last > ma300_301_min_ago E con dev_bellissima > 0.04 IMPORTATA DA BUY 4 RCCR - r 6599 A1 z2"
                    action = "buy"
                    percentage = 50
                    
                    # 28 set 2022 aggiunta 3-10
                    #  2 ott 2022 dev bellissima 0.10 da 0.12
                    
                    # 14 set 2023 bellissima a 0.04 da 0.05
                    # 14 set 2023 buy3 a 0.04 da 0.05
                    # 14 set 2023 7-40 a 0.04 da 0.05
                    # 27 set 2023 dev bel a 0.03 da 0.04
                    # 27 set 2023 dev buy 3 a 0.03 da 0.04
                    # 27 set 2023 dev 7 sopra 40 a 0.03 da 0.04
                    # 11 gen 2024 durante il crollo il BUY 3 DEVE STARE ALMENO DI 0.33% SOPRA LA ma39 - PUGNO FANTASMA DI MOHAMMAD ALI


                
                    
                # BUY 3 con ma69 > and deviation_bellissima > 0.12 (PER SPEZZARE LA CATENA - effetti laterali) IMPORTATA DA BUY 4 RCCR

                elif (
                    ma3_last > ma18_last
                    and ma39_last > ma100_last

                    and ma100_last > ma300_last

                    and ma300_last < ma300_301_min_ago
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.017
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.03

                    and deviation_ma39 < -0.015
                    and deviation_ma3_sotto_ma50 < -0.015

                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 3 con 100>300 and macd_differenza_2_min_ago > -2.50 and 39>100 - r 6599 A2 x1x"
                    action = "buy"
                    percentage = 70

                    #  8 ott 2024 se i minimi crescono allora anticipo ndecchia !
                    # 22 feb 2025 anticipata ndecchiecella
                    # 12 mar 2025 anticipata ndecchiecella
                    # 14 apr 2025 se 39>100 ok cosi'


                elif (
                    ma3_last > ma18_last
                    and ma39_last < ma100_last
                    and deviation_ma5_sotto_ma300 < -0.01

                    and ma100_last > ma300_last

                    and ma300_last < ma300_301_min_ago
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.017
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.03

                    and deviation_ma39 < -0.015
                    and deviation_ma3_sotto_ma50 < -0.015

                    and macd_differenza_2_min_ago > -8.50
                ):
                    buy = "BUY 3 con 100>300 and macd_differenza_2_min_ago > -8.50 E dev 5-300 < -0.01 se 39<100 - RITRACCIAMENTO - r 6599 A2 x1y"
                    action = "buy"
                    percentage = 70

                    #  8 ott 2024 se i minimi crescono allora anticipo ndecchia !
                    # 22 feb 2025 anticipata ndecchiecella
                    # 12 mar 2012 anticipata ndecchiecella
                    # 14 apr 2025 se 39<100 allora and deviation_ma5_sotto_ma300 < -0.01





                
                elif (
                    ma3_last > ma13_last
                    and ma300_last < ma300_301_min_ago

                    and deviation_ma39 < -0.123
                    and deviation_ma3_sotto_ma50 < -0.127
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.42
                    and deviation_ma25_sotto_ma300 < -0.20
                    
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago < -0.015
                   
                    and ma100_last > ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 3 con 100>300 e macd_diff_2_min_ago > -18.50 and 3-50 < -0.13 con aggiunta risultati parentesi graffe  - r 6599 A2x2"
                    action = "buy"
                    percentage = 80
                    
                    # 28 set aggiunta 3-10
                    # 18 dic 2023 aggiunta and ma2_differenza_2_min_ago > 0.02
                    # 18 dic 2023 aggiunta and macd_differenza_2_min_ago > 1.10
                    # 27 mar 2025 anticipata ndecchiecella togliendo sovrastrutture
                    # 12 mag 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.13
                    # 13 mag 2025 aggiunta risultati parentesi graffe.



                # oggi 14 apr 2025 cancellata riga 6599 A2y

                
                    
                # BUY 3 con ma69 > and deviation_bellissima > 0.12 (PER SPEZZARE LA CATENA - effetti laterali) IMPORTATA DA BUY 4 RCCR   
                
                elif (
                    ma69_last >= ma69_2_min_ago
                    and ma78_last < ma100_last
                    and deviation_ma5_sopra_ma28 > 0.30
                    
                    and deviation_bellissima > 0.12
                    and deviation_buy3 > 0.13
                    and deviation_ma7_sopra_ma40 > 0.09
               
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
             
                ):
                    buy = "BUY 3 78<100 E con ma69 > and deviation_bellissima > 0.12 (PER SPEZZARE LA CATENA - effetti laterali) IMPORTATA DA BUY 4 RCCR - r 6599 B"
                    action = "buy"
                    percentage = 50
                    
                    
                # CONDIZIONE IPERVENDUTO DNA
                #    
                elif (     

                    ma3_last > ma15_last
                    and ma2_last >= ma10_last
                    and deviation_ma39 <= -0.30
                    and ma3_last < ma39_last
                    and ma100_last < ma100_60_min_ago
                    and ma100_last < ma100_120_min_ago

                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015

                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.60

                    and deviation_ma3_sopra_ma10 > 0.015
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma3_sopra_ma18 > -0.04

                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 11
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25

                ):    
                    buy = "BUY 3 condizione DNA IPERVENDUTO 3-39 con 3-10 E 300 vicina 450 e 3-16 > 0.01 + > E ma2_diff_2_min_ago > 3 E dev ma2 e MACD > -20 - r 6620"
                    action = "buy"
                    percentage = 90

                    # 15 nov 2023 se compra quando 3<39 allora riduco dev 3-16 
                    # 16 nov 2023 AGGIUNTO SOLO SU QUESTA CONDIZIONE E DOPO ATTENTA ANALISI STATISTICA and macd > 8
                    #  5 dic 2023 aggiunta and ma2_differenza_ma5 > 26 vedi 4 dic 2023 ore 16:45
                    #  5 dic 2023 macd >-8 da >8
                    # 12 dic 2023 macd a -10 da -8
                    # 29 dicembre 2023 entra in gioco CONDIZIONE DNA - IPERVENDUTO 3-39 < -0.30
                    # 19 feb 2024 aggiunta 
                    # 
                    # 
                elif (    
                    ma3_last > ma39_last
                    and ma100_last > ma100_10_min_ago
                    
                    and ma10_last < ma20_last
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.12
                    and deviation_ma250_sopra_ma300 > -0.12
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                    and macd > -11
                ): 
                
                    buy = "BUY 3 laterale 3-39 importata da buy 2 con 300 > 450 and dev 3-10 > 0.03 MA CON ma10<ma20 and 3-16 > 0.07 E dev ma2 e diff macd - r 6622 A1"
                    action = "buy"
                    percentage = 80
                    
                    # 19 set 2022 aggiunta 3-10 > 0.07
                    #  3 ott 2022 3-10 0.113 da 0.07
                    #  4 mag 2023 3-10 0.07 da 0.113 con 300>450
                    # 23 mag 2023 3-39 da 8-59 con 300>450 e 100 attaccata alla 300
                    # 11 ago 2023 anticipata ndecchiecella
                    # 31 ott 2023 3-39 da 5-39
                    # 31 ott 2023 and deviation_ma3_sopra_ma10 > 0.03 da > 0.07
                    # 27 dic 2023 se ma10 < ma20 aggiunta dev ma2 e diff macd


                    
                    
                elif (    
                    ma5_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma39 <= -0.30
                    
                    and ma10_last < ma20_last
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.12
                    and deviation_ma250_sopra_ma300 > -0.12
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 1.25
                    and macd > -11
                ): 
                
                    buy = "BUY 3 laterale 5-54 importata da buy 2 con 300 > 450 and dev 3-10 > 0.03 MA CON ma10<ma20 and 3-16 > 0.07 E dev ma2 e diff macd - r 6622 A2"
                    action = "buy"
                    percentage = 80
                    
                    # 19 set 2022 aggiunta 3-10 > 0.07
                    #  3 ott 2022 3-10 0.113 da 0.07
                    #  4 mag 2023 3-10 0.07 da 0.113 con 300>450
                    # 23 mag 2023 3-39 da 8-59 con 300>450 e 100 attaccata alla 300
                    # 11 ago 2023 anticipata ndecchiecella
                    # 31 ott 2023 3-39 da 5-39
                    # 31 ott 2023 and deviation_ma3_sopra_ma10 > 0.03 da > 0.07
                    # 27 dic 2023 se ma10 < ma20 aggiunta dev ma2 e diff macd
                    # 20 feb 2024 prendi il coltello che cade con il piede ! grazie compa





                
                # BUY 3 CORREZIONE FIAT

                elif (
                    ma5_last > ma20_last
                    and ma450_last > ma450_300_min_ago 

                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30

                    and deviation > -0.70
                    
                    and deviation_buy_crollo_1 < -0.29
                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.40

                    and deviation_buy_ma5_sopra_ma20 > -0.10
                    and deviation_ma5_sotto_ma200 > -1.00
                    
                ):
                    buy = "BUY 3 CORREZIONE FIAT - che non e' un forte ribasso e non e' un crollo - con 450> - r 6623 A"
                    action = "buy"
                    percentage = 80

                    #  7 mag 2025 aggiunta questa con 450>
                    # 12 mag 2025 and deviation_ma3_sotto_ma50 a -0.40 da -0.30


                elif (
                    ma3_last > ma18_last

                    and (ma450_last < ma450_300_min_ago or ma100_last < ma450_last)
                    and (deviation_ma50_sotto_ma100 < -0.45 and deviation_ma3_sotto_ma50 < -0.30)

                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30

                    and deviation > -0.70
                    
                    and deviation_buy_crollo_1 < -0.29
                    and deviation_ma39 < -0.05
                    
                    and deviation_ma5_sotto_ma200 > -1.50
                    
                ):
                    buy = "BUY 3 CORREZIONE FIAT con 450< and dev 50-100 < -0.45 and dev 3-50 <-0.30 - r 6623 BX"
                    action = "buy"
                    percentage = 80

                    #  7 mag 2025 COMPRA SE 50<100 DI MOLTO e ANCHE 3<50 DI MOLTO (e va bene cosi')



                elif (
                    ma3_last > ma18_last

                    and (ma450_last < ma450_300_min_ago or ma100_last < ma450_last)
                    and (deviation_ma50_sotto_ma100 > -0.15 and deviation_ma3_sotto_ma50 < -0.50)

                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma10_sopra_ma200 < -0.30

                    and deviation > -0.70
                    
                    and deviation_buy_crollo_1 < -0.29
                    and deviation_ma39 < -0.05
                    
                    and deviation_ma5_sotto_ma200 > -1.50
                    
                ):
                    buy = "BUY 3 CORREZIONE FIAT con 450< and dev 50-100 > -0.15 MA dev 3-50 < -0.50 - r 6623 BY"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # ma5 non deve allontanarsi troppo dalla ma200 !
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    
                    # > estate 5-20 0.15 da 0.12 e dev correzione  0.02 da 0.015
                    # 19 gen 2025 deviation_correzione > -0.02 da > 0.02
                    # 19 gen 2025 deviation_buy_ma5_sopra_ma20 > -0.10 da 0.15 ( ho anticipato il buy)
                    #  3 feb 2025 aggiunta and deviation_ma5_sotto_ma300 < -0.40
                    #  3 feb 2025 aggiunta and deviation_ma10_sopra_ma200 < -0.30
                    # 29 apr 2029 aggiunta and deviation_ma39 < -0.05

                    #  7 mag 2025 COMPRA ANCHE SE 50<100 NON DI MOLTO MA 3<50 (deve essere) DI MOLTO ! (ro cano vuole l' osso !)
                    #  7 mag 2025 questo e' un modo per evitare BUY non appena comincia a scendere ! cazzo ! 


         
            # ########################################################################################################## COMPRA sessione 4
            
            # ---------------------------------------------------------------------------------------------------------- deviation piu' alte se ma 78 < !
            
            # ########################################### se 300 < il buy 4 deve stare sopra ma100

            elif self.session == 4:
                
                if (
                    ma59_last >= ma59_2_min_ago
                    and delta_450_300 < delta_450_300_60_min
                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma200_last
                    
                    and ma10_last > ma100_last
                    
                    and deviation_ma5_sopra_ma28 > 0.10
                    and deviation_buy3 > 0.04
                    and deviation_ma7_sopra_ma40 > 0.05
                    
                    and ma3_last > ma13_last
                    
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma7_last > ma25_last
                    
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 4A GIORNO con ma 78> e 300> E ma100>ma200 con macd > macd 2 min ago - r 6668 A1x"
                    action = "buy"
                    percentage = 70
          
                    # se al BUY 4 ha ma100 < ma200 evidentemente c'e' qualche cosa di strano 
                    # il trend, evidentemente, e' LATERALE.
                    # E ALLORA AGGIUNGO UN BEL 6-30 > 0.15 - TREND LATERALE
                    # 28 ott 2022 dev buy 3 0.10 da 0.11
                    
                    # 20 FEB 2023 GIORNO dev buy 3 0.07 da 0.10
                    # 20 FEB 2023 GIORNO 7-40 0.07 da 0.10
                    # 14 ott 2023 59 >59 2 min ago da 69 > 69 2 min ago
                    # 14 ott 2023 dev_buy3 > 0.06 da 0.07
                    # 14 ott 2023 10-100 da 13-100
                    # 21 ott 2023 and macd > macd_2_min_ago



                
                elif (
                    ma3_last > ma11_last

                    and (ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last)
                    and (ma300_last > ma450_last or ma100_last > ma300_last)
                    and ma20_last < ma50_last

                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_301_min_ago

                    and ma3_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15

                    and deviation_ma39 < -0.30
                    and deviation_ma3_sotto_ma50 < -0.30

                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    
                    and ma3_last > ma9_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 4 ma450_last {ma450_last:.2f} ma450_720_min_ago {ma450_720_min_ago:.2f} GIORNO con 300> E ma100>ma200 quando ritraccia vedi 20<50 - r 6668 A1 Y1 Xx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70
                    
                    # 21 ott 2023 and macd < macd_2_min_ago - SE MACD DISCENDENTE IL BUY LO FACCIO PIU' ALTO ! - C'E' MA NON SI VEDE
                    # 15 nov 2022 aggiunta and ma2_differenza_2_min_ago > 5 ( ma2 > ma2 min non l' ha letta !) ( allora metto un rafforzativo )
                    # 23 mar 2025 aggiunta and delta_1 < delta_2
                    # 24 mar and macd_differenza_2_min_ago > -5.00 da -2.50
                    # 28 mar 2025 se ritraccia
                    # 29 mar 2025 se ritraccia con 450 >
                    # 30 mar 2025 ho aumentato 3-39 e 3-50
                    #  3 apr 2025 and deviation_ma39 < -0.07 da 0.06
                    #  3 apr 2025 and deviation_ma3_sotto_ma50 < -0.09 da 0.08
                    #  4 apr 2025 and ma5_last > ma300_last or delta_DNA_1 < delta_DNA_2 or ma100_last > ma200_last or ma200_last > ma300_last

                    #  4 apr 2025 RIPETO : e' un ritracciamento se ma5_last > ma300_last
                    #  4 apr 2025 RIPETO : e' un ritracciamento se delta_DNA_1 < delta_DNA_2
                    #  4 apr 2025 RIPETO : e' un ritracciamento se ma100_last > ma200_last
                    #  4 apr 2025 RIPETO : e' un ritracciamento se ma200_last > ma300_last
                    #  7 apr 2025 and deviation_ma39 < -0.30 da 0.07
                    #  7 apr 2025 and deviation_ma3_sotto_ma50 < -0.30 da 0.09
                    #  8 apr 2025 se ritraccia 3 DEVE STARE SOTTO 100 non c'e' niente da fare !
                    #  8 apr 2025 aggiunto le basi del ritracciamento
                    # 11 apr 2025 correzione or e aggiunta f
                    # 20 ott 2025 aggiunte pg


                elif (
                    ma3_last > ma11_last

                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma200_last
                    and (ma300_last > ma450_last or ma100_last > ma300_last)
                    and ma20_last < ma50_last

                    and ma450_last < ma450_720_min_ago
                    
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma5_sotto_ma200 < -0.15
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.10
                    
                    and ma3_last > ma9_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 4 {ma450_last} {ma450_720_min_ago} con 450< MA 300> e RITRACCIAMENTO - r 6668 A1 Y1 Xy"
                    action = "buy"
                    percentage = 70
                    
                    # 21 ott 2023 and macd < macd_2_min_ago - SE MACD DISCENDENTE IL BUY LO FACCIO PIU' ALTO ! - C'E' MA NON SI VEDE
                    # 15 nov 2022 aggiunta and ma2_differenza_2_min_ago > 5 ( ma2 > ma2 min non l' ha letta !) ( allora metto un rafforzativo )
                    # 23 mar 2025 aggiunta and delta_1 < delta_2
                    # 24 mar and macd_differenza_2_min_ago > -5.00 da -2.50
                    # 28 mar 2025 se ritraccia
                    # se ritraccia con 450 <
                    # 11 apr 2025 correzione or e aggiunta f


                

                elif (
                    ma3_last > ma13_last

                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma200_last

                    and ma20_last < ma50_last
                    and (ma3_last < ma20_last or ma20_last < ma20_2_min_ago or ma33_last < ma33_3_min_ago)
                    and ma5_last > ma150_last

                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.05

                    and delta_1 > delta_2
                    
                    and ma3_last > ma9_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 4 {ma300_last} {ma300_301_min_ago} NOTTE con 300> E ritracciamento - r 6668 A1 Y1 Y"
                    action = "buy"
                    percentage = 70
                    
                    # 21 ott 2023 and macd < macd_2_min_ago - SE MACD DISCENDENTE IL BUY LO FACCIO PIU' ALTO ! - C'E' MA NON SI VEDE
                    # 15 nov 2022 aggiunta and ma2_differenza_2_min_ago > 5 ( ma2 > ma2 min non l' ha letta !) ( allora metto un rafforzativo )
                    # 23 mar 2025 aggiunta se delta_1 > delta_2 allora deviation_ma3_sotto_ma50 < -0.04
                    # 24 mar 2025 deviation_ma3_sotto_ma50 < -0.05 da -0.04
                    # 27 mar 2025 con ma5 ancora sopra ma150 ma se ritraccia (vedi ma20 e ma33) allora compra con deviation_ma39 < -0.12
                    # 11 apr 2025 correzione or e aggiunta f


                
                elif (
                    ma3_last > ma13_last
                    and ma20_last > ma50_last

                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma450_last
                    
                    and delta_450_300 < delta_450_300_60_min

                    and deviation_ma3_sotto_ma50 < -0.04

                    and ma3_last > ma9_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 4 GIORNO con 300> E ma100>ma450 - r 6668 A1 Y2x"
                    action = "buy"
                    percentage = 70





                elif (
                    ma3_last > ma13_last


                    and deviation_ma39 < -0.123
                    and deviation_ma3_sotto_ma50 < -0.127
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.42
                    and deviation_ma25_sotto_ma300 < -0.20
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.06

                   
                    and ma20_last < ma50_last
                    
                    and deviation_ma100_sopra_o_sotto_ma100_300_min_ago < 1.00
                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma450_last

                    and deviation_ma5_sotto_ma200 < -0.15
                    and delta_450_300 < delta_450_300_60_min

                    and ma3_last > ma9_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 4 deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago} GIORNO con 300> E ma100>ma450 durante un ritracciamento in basso - r 6668 A1 Y2 yX"
                    action = "buy"
                    percentage = 70
                    
                    # 21 ott 2023 and macd < macd_2_min_ago - SE MACD DISCENDENTE IL BUY LO FACCIO PIU' ALTO ! - C'E' MA NON SI VEDE
                    # 15 nov 2022 aggiunta and ma2_differenza_2_min_ago > 5 ( ma2 > ma2 min non l' ha letta !) ( allora metto un rafforzativo )
                    # 23 mar 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.04
                    # 30 mar 2025 durante il ritracciamento
                    #  7 mag 2025 e' andata benissimo vediamo i valori !
                    # 13 mag 2025 CHE MERAVIGLIA ! sono usciti i valori ! GRAZIE COMPA per sempre !






                elif (    
                    ma3_last > ma18_last

                    and (deviation_ma100_sopra_o_sotto_ma100_300_min_ago > 1.00 or deviation_ma100_sopra_ma300 > 0.20)
                    and (ma20_last < ma50_last or ma50_last < ma100_last or ma39_last < ma39_20_min_ago)
                    
                    and deviation_ma50_sotto_ma100 < -0.15
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.22
                    and deviation_ma100_sopra_ma200 < -0.15

                    and ma200_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -0.05
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > -0.07
                    
                    and macd_differenza_2_min_ago > -18.50
                
                ):
                    buy = "BUY 4 RITRACCIAMENTO IN ALTO ! - r 6668 A1 Y2 yY"
                    action = "buy"
                    percentage = 80

                    # 21 gen 2025 anticipata ndecchia con 300 > 300 120 min ago !
                    # 28 gen 2025 aggiunto and delta_300_200 > delta_300_200_60_min NOTTE
                    # 28 gen 2025 and deviation_ma3_sopra_ma10 > 0.02 da > 0.01 ( ha comprato prestissimo quasi attaccato al sell precedente.)
                    # 15 apr 2025 importata da BUY 2 e modificata
                    #  9 mag 2025 RITRACCIAMENTO IN ALTO !



                elif (
                    ma3_last > ma13_last
                    
                    and ma39_last >= ma100_last
                    and deviation_ma25_sotto_ma300 < -0.17
                    and deviation_ma50_sotto_ma300 < -0.20
                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                    and deviation_ma5_sotto_ma200 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.27
                    and deviation_ma5_sotto_ma450 < -0.32

                    and delta_450_300 > delta_450_300_60_min

                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma200_last
                   
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and macd > -50
                    and macd_differenza_2_min_ago > -1.25
                ):
                    buy = "BUY 4 con ma300_last > 5 ore MA NOTTE ! e con 50> e 300> E 100 > 200 and DNAM - r 6668 A2 x"
                    action = "buy"
                    percentage = 70
          
                    # se al BUY 4 ha ma100 < ma200 evidentemente c'e' qualche cosa di strano 
                    # il trend, evidentemente, e' LATERALE.
                    # E ALLORA AGGIUNGO UN BEL 6-30 > 0.15 - TREND LATERALE
                    # 28 ott 2022 dev buy 3 a 0.08 da 0.11
                    # 10 nov 2023 aggiunta FINALMENTE and deviation_ma3_sopra_ma16 > 0.045

                    #  6 mar 2024 anticipato ndecchiecella
                    #  9 dic 2024 aggiunta DNAM
                    #  9 dic 2024 tolta ma2 > ma2 2 min ago

                     
                elif (
                    ma3_last > ma13_last
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.17
                    and deviation_ma50_sotto_ma300 < -0.20
                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                    and deviation_ma5_sotto_ma200 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.27
                    and deviation_ma5_sotto_ma450 < -0.32

                    and delta_450_300 > delta_450_300_60_min
                    
                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma200_last
                   
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd > -50
                    and macd_differenza_2_min_ago > -1.25
                ):
                    buy = "BUY 4 con ma300_last > 5 ore MA NOTTE ! e con 50> e 300> E 100 > 200 and DNAM - r 6668 A2 y"
                    action = "buy"
                    percentage = 70
          
                    # se al BUY 4 ha ma100 < ma200 evidentemente c'e' qualche cosa di strano 
                    # il trend, evidentemente, e' LATERALE.
                    # E ALLORA AGGIUNGO UN BEL 6-30 > 0.15 - TREND LATERALE
                    # 28 ott 2022 dev buy 3 a 0.08 da 0.11
                    # 10 nov 2023 aggiunta FINALMENTE and deviation_ma3_sopra_ma16 > 0.045

                    #  6 mar 2024 anticipato ndecchiecella
                    #  9 dic 2024 aggiunta DNAM
                    #  9 dic 2024 tolta ma2 > ma2 2 min ago
                    
                  
                  
                    
                    
                elif (
                    ma69_last >= ma69_2_min_ago
                    and ma300_last < ma300_301_min_ago
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.13
                    
                    and ma100_last > ma200_last
                    and deviation_buy3 > 0.11
                    and ma3_last > ma13_last
                    and deviation_ma7_sopra_ma40 > 0.11
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                    and ma7_last > ma25_last
                    
                    and ma13_last > ma100_last
                    and deviation_ma5_sopra_ma28 > 0.05
                ):
                    buy = "BUY 4A con ma 78> e 300> E ma100>ma200 - r 6668 B"
                    action = "buy"
                    percentage = 70
          
                    # se al BUY 4 ha ma100 < ma200 evidentemente c'e' qualche cosa di strano 
                    # il trend, evidentemente, e' LATERALE.
                    # E ALLORA AGGIUNGO UN BEL 6-30 > 0.15 - TREND LATERALE




             
                
                
                elif (    
                    ma3_last > ma18_last

                    and deviation_ma3_sotto_ma50 < -0.30

                    and ma450_last < ma450_120_min_ago
                    and ma200_last < ma300_last
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.22
                    and deviation_ma50_sotto_ma300 < -0.22

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma5_sotto_ma200 < -0.13
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma5_sotto_ma450 < -0.21
                    and deviation_ma300_sopra_ma450 < -0.072

                    and ma50_last < ma50_2_min_ago

                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -8.50
                    
                ):
                    buy = "BUY 4 ma450_last < ma450_120_min_ago con DNAM + distanza al ribasso - r 6669"
                    action = "buy"
                    percentage = 80

                    # 7 apr 2025 nuova condizione



                elif (
                    ma3_last > ma18_last

                    and ma39_last < ma100_last
                    and deviation_ma100_sopra_ma300 < -0.69
                    and deviation_ma25_sotto_ma300 < -0.90

                    and deviation_ma300_sopra_ma450 < -0.30
                    and deviation_ma50_sotto_ma300 < -0.27

                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.22

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma5_sotto_ma200 < -0.69
                    and deviation_ma5_sotto_ma300 < -0.79
                    and deviation_ma5_sotto_ma450 < -0.89

                    and ma78_last < ma150_last
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sotto_ma300 < -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.05
                    
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and macd >= -70
                    and macd_differenza_2_min_ago > -2.50
                    
                ):
                    buy = "BUY 4 feb 2024 > 180 min di ribasso 78<150 + osso - r 6670"
                    action = "buy"
                    percentage = 90
                    
                    # modificato il 3 set 2024 non ho scritto caratteri strani
                    #  3 feb 2025 e' andata bene
                    # 25 feb 2025 e' andata male !
                    # 26 feb 2025 aggiunto osso 

                
                # BUY 4 di emergenza CROLLO FERRARI - modo 1
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma3_last > ma28_last
                ):
                    buy = "BUY 4 di emergenza CROLLO FERRARI - modo 1 - 3-28 - r 6690"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # SALTA IL BUY 2 allora ho fatto il BUY 3 di emergenza (se <-2.30 si attiva 8-25)
                    
                    
                    
                
                
                # BUY 4 di emergenza CROLLO FERRARI - modo 2 

                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -1.61
                    and deviation_buy_crollo_1 > -2.29
                    and deviation_buy_crollo_2 > 0.11
                    and ma8_last > ma50_last
                ):
                    buy = "BUY 4 di emergenza CROLLO FERRARI - modo 2 - r 6710"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_buy_crollo_2 = ma3_last / ma13_last
                    # SALTA IL BUY 2 allora ho fatto il BUY 3 di emergenza (se <-1.61 si attiva 8-50)
                    
                    
                    
                    
                elif (
                    deviation_ma4_sopra_ma30 > 0.09
                    and ma8_last >= ma59_last
                    and delta_450_300 < delta_450_300_60_min
                    
                    and ma300_last > ma300_120_min_ago
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.13
                    and deviation_bellissima >= 0.02
                    
                    
                    and delta_buy3_incrocio_ma3_ma8 >= 0.06
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 4B GIORNO - importato da BUY 3 RCCR se ma39 > ma59 con 300> e 100> - r 6736 A1x"
                    action = "buy"
                    percentage = 70
                    
                    # 25 ottobre 2022 4-30 a 0.09 da 0.10
                    # 25 ottobre 2022 dev bellissima a 0.02 da 0.03
                    # aggiunta 3-10 e 5-28
                    # 20 feb 2023 8-59 da 39-59 GIORNO
                    
             
                elif (
                    deviation_ma4_sopra_ma30 > 0.09
                    and ma18_last >= ma59_last
                    and delta_450_300 < delta_450_300_60_min
                    
                    and ma300_last > ma300_120_min_ago
                    and ma100_last > ma100_60_min_ago
                    
                    and deviation > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.10
                    and deviation_ma5_sopra_ma28 > 0.13
           
                    and ma3_last > ma8_last
                    and ma3_last >= ma69_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma5_last >= ma15_last
                    and ma5_last >= ma25_last
                ):    
                    buy = "BUY 4 NOTTE - importato da BUY 3 RCCR se ma39 > ma59 con 300> e 100> - r 6736 A1y"
                    action = "buy"
                    percentage = 70
                    
                    # 25 ottobre 2022 4-30 a 0.09 da 0.10
                    # 25 ottobre 2022 dev bellissima a 0.02 da 0.03
                    # aggiunta 3-10 e 5-28
                    # 20 feb 2023 18-59 da 39-59 NOTTE
                    
                    
                    
                elif (
                    deviation_ma4_sopra_ma30 > 0.01
                    and ma39_last > ma100_last
                    
                    and ma300_last > ma300_120_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation > -0.30
                
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):    
                    buy = "BUY 4 importato da BUY 3 RCCR con 4-30 con 300 > e 100 < - r 6736 A1 Z1"
                    action = "buy"
                    percentage = 70

                    #  5 mar 2024 se 39 > 100 ok cosi'


                    
                
                elif (    
                    ma3_last > ma15_last

                    and ma3_last > ma20_last
                    and ma100_last > ma100_300_min_ago
                    and ma100_last < ma100_120_min_ago

                    and ma300_last > ma300_120_min_ago
                    and ma78_last < ma150_last
                    

                    and deviation_ma25_sotto_ma300 < -0.35
                    and deviation_ma50_sotto_ma300 < -0.35
                    and deviation_ma39 < 0.07
                    and deviation_ma3_sotto_ma50 < 0.03
                    and deviation_ma5_sopra_o_sotto_ma100 < 0.01
                    and deviation_ma5_sotto_ma200 < -0.15
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma5_sotto_ma450 < -0.25

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    

                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma450_last > ma450_120_min_ago
                    
                    and ma39_last < ma100_last
                    and ma100_last < ma100_60_min_ago
                    
                    and ma3_last > ma8_last
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > -60
                    and macd_differenza_2_min_ago > -1.5
                    
                ):    
                    buy = "BUY 4 con 3-15 se ma450> 12 ore e con 300>450 E 100 < con aggiunta osso e cuspide - r 6736 A1 Z2 X"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se 39 < 100 pugno fantasma
                    # 28 gen 2025 bella l' idea del pugno fantasma ma con 300>450 e 450 > 12 ore devi pungere come un' ape !
                    # 28 gen 2025 tolto ma2 > ma2 2 min ago
                    # 28 gen 2024 tolto macd > macd 2 min ago e sostituito con macd > -60
                    # 16 feb 2025 aggiunto osso e cuspide che gia' c' era in forma embrionale




                elif (    
                    ma3_last > ma20_last
                    and ma450_last > ma450_480_min_ago

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.52

                    and ma450_last < ma450_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma100_last < ma100_60_min_ago
                    and ma39_last < ma100_last

                    and deviation > -0.30
                
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last

                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 4 importato da BUY 3 RCCR con 4-30 con 300 > e 100 < - r 6736 A1 Z2y1"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se 39 < 100 pugno fantasma
                    #  2 ott 2024 con 450 < cano staf cioe' aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago



                elif (    
                    ma3_last > ma20_last
                    and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)

                    and deviation_ma200_sotto_ma300 < -1.40
                    and ma100_last < ma450_last
                    and ma39_last < ma100_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75

                    and deviation_ma25_sotto_ma300 < -2.30
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma100_sopra_ma300 < -2.00
                    and deviation_ma300_sopra_ma450 < -0.80

                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.45
                    and deviation_ma5_sotto_ma200 < -1.20
                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma5_sotto_ma450 < -3.00

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.10
                    
                    and ma100_last < ma100_60_min_ago
                    and ma39_last < ma100_last

                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 4 CONTINUA A SCENDERE DNA - r 6736 A1 Z2y2"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se 39 < 100 pugno fantasma
                    #  2 ott 2024 con 450 < cano staf cioe' aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.52
                    #  3 mar 2025 aggiunta and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
                    #  3 mar 2025 aggiunta continua a scendere DNA


                    
                elif (
                    deviation_ma4_sopra_ma30 > 0.01
                    and ma39_last < ma100_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30

                    and ma300_last > ma300_120_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and deviation > -0.30
                
                    and ma3_last > ma8_last
                    and ma5_last >= ma15_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):    
                    buy = "BUY 4B importato da BUY 3 RCCR con 4-30 con 300 > e 100 < - r 6736 A1 Z3"
                    action = "buy"
                    percentage = 70
                    
                    # 28 apr 2023 aggiunta macd > macd 2 min ago
                    # 24 ago 2023 tolta and ma4_last >= ma4_2_min_ago
                    # 24 ago 2023 tolta deviation_bellissima >= 0.03
                    # 24 ago 2023 5-48 da 39-48
              
                    #  6 feb 2024 anticipato buy
                    #  5 mar 2024 se 39 < 100 prendi il coltello con il piede


                elif (
                    ma3_last > ma20_last
                    and ma100_last > ma100_60_min_ago
                    
                    and ma2_differenza_2_min_ago > 5
                    and ma50_last > ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    
                    and macd > -50
                    and macd_differenza_2_min_ago > -1.25
                    
                ):    
                    buy = "BUY 4B importato da BUY 3 RCCR con 3-20 con 300 > and ma50_last > ma59_last and ma2_differenza_2_min_ago > 5 - r 6737 A1"
                    action = "buy"
                    percentage = 70


                # 24 nov 2024 cancellata r 6737 A2
                
              
                
                elif (
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma50_last < ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 importato da BUY 3 RCCR con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70

                elif (
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma50_last < ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 importato da BUY 3 RCCR con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 70

                elif (
                    ma3_last > ma30_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma50_last < ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 importato da BUY 3 RCCR con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 70




                elif (
                    ma3_last > ma30_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma50_last < ma59_last

                    and ma250_last > ma300_last
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 MA 250>300 e con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 70



                elif (
                    ma3_last > ma30_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma50_last < ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 importato da BUY 3 RCCR con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70

                elif (
                    ma3_last > ma30_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma50_last < ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 importato da BUY 3 RCCR con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70

                elif (
                    ma3_last > ma30_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma50_last < ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 importato da BUY 3 RCCR con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70

                
                elif (
                    ma3_last > ma30_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma50_last < ma59_last
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and deviation > -0.30
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                    
                ):    
                    buy = "BUY 4B CON 50<59 importato da BUY 3 RCCR con 3-30 e 300> e ma2_diff_2_min_ago > 8 - r 6737 B NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    # 31 ott 2023 3-30 da 5-48 aggiunta per anticipare la precedente ( che resta comunque perche' prevede la ma100 < )
                    # 27 nov 2023 se sta scendendo da molto tempo E SE se ma50_last < ma59_last la differenza prezzo deve essere > 3 ! cazzo
                    # 24 dic 2023 and ma2_differenza_2_min_ago a 8 da 3

                
                # condizione ipervenduto DNA
                
                    
                elif ( 
                    ma3_last > ma13_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma300_sopra_ma450 < -0.22
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015

                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.20

                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.09

                    and ma2_last >= ma10_last
                    and macd_differenza_2_min_ago > -18.50

                ):    
                    buy = "BUY 4 DNA IPERVENDUTO 3-39 con 3-10 E 300 vicina 450 e 3-16 > - r 6738 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 90

                    # 15 nov 2023 se compra quando 3<39 allora riduco dev 3-16 
                    # 16 nov 2023 AGGIUNTO SOLO SU QUESTA CONDIZIONE E DOPO ATTENTA ANALISI STATISTICA and macd > 8
                    #  5 dic 2023 aggiunta and ma2_differenza_ma5 > 26 vedi 4 dic 2023 ore 16:45
                    #  5 dic 2023 macd >-8 da >8
                    # 12 dic 2023 macd a -10 da -8
                    # 29 dicembre 2023 entra in gioco CONDIZIONE DNA - IPERVENDUTO 3-39 < -0.30
                    # 19 feb 2024 aggiunta 
                    #  4 feb 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13 e tolte sovrastrutture
                    # 15 ott 2025 aggiunte parentesi graffe
                    # 15 ott 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago a -0.09 da - 0.13


                elif (    
                    ma3_last > ma39_last
                    and ma100_last > ma100_10_min_ago
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.12
                    and deviation_ma250_sopra_ma300 > -0.12
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                ): 
                
                    buy = "BUY 4 importato da BUY 3 laterale 3-39 importata da buy 2 con 300 > 450 and dev 3-10 > 0.03 - r 6739a"
                    action = "buy"
                    percentage = 80
                    
                    # importato da BUY 3 il 20 dic 2023


                elif (    
                    ma3_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma39 <= -0.30
                    
                    and ma300_last > ma450_last
                    and ma300_last > ma300_120_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.12
                    and deviation_ma250_sopra_ma300 > -0.12
                    
                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30
                    
                    and deviation_ma3_sopra_ma10 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -11
                    and macd_differenza_2_min_ago > 0.25
                ): 
                
                    buy = "BUY 4 importato da BUY 3 laterale 3-39 importata da buy 2 con 300 > 450 and dev 3-10 > 0.03 - r 6739b"
                    action = "buy"
                    percentage = 80
                    
                    # importato da BUY 3 il 20 dic 2023
                    # 20 feb 2024 se deve comprare con 100< allora al cane devi dare un osso cioe' and deviation_ma39 deve essere <= -0.30
                    # 20 feb 2024 prendi il coltello che cade con il piede

                elif (
                    
                    ma4_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                   
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                   
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 4 importata da RCCR BUY3 r 6599 A1yA2 - ANDATA BENISSIMO - con 450 > 450 480 min MA CONSIDERATA ANCORA LATERALE - r 6740 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 60

                elif (
                    
                    ma4_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                   
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                   
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 4 importata da RCCR BUY3 r 6599 A1yA2 - ANDATA BENISSIMO - con 450 > 450 480 min MA CONSIDERATA ANCORA LATERALE - r 6740 NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 60
                    
                    # questa condizione importata da RCCR e' arrivata un po' prima.




                elif (    
                    ma3_last > ma13_last
                    and ma100_last > ma100_120_min_ago

                    and (ma450_last > ma450_360_min_ago or ma450_last > ma450_480_min_ago or ma450_last > ma450_720_min_ago)
                    and delta_DNA_1 < delta_DNA_2

                    and deviation_ma300_sopra_ma450 < 0.30
                    and deviation_ma300_sopra_ma450 > -0.30

                    and deviation_ma100_sopra_ma300 < 0.30
                    and deviation_ma100_sopra_ma300 > -0.30

                    and deviation_ma39 < 0.10
                    and deviation_ma3_sotto_ma50 < 0.10
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.03

                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 4 con 450 > 450 720 min MA CONSIDERATA ANCORA LATERALE - GIORNO - r 6740 NUOVA ERA A3 SOFT 1xx - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 70

                    # 16 mag 2025 se anche ma100_last > ma100_120_min_ago ok cosi
                    # 21 ott 2025 aggiunte pg
                    # 21 ott 2025 aggiunte deviation




                elif (    
                    ma3_last > ma16_last
                    and ma100_last < ma100_120_min_ago

                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    and deviation_ma25_sotto_ma300 < -0.50

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2

                    and ma450_last > ma450_480_min_ago
                    and ma450_last > ma450_720_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 4 con 450 > 450 720 min - GIORNO ma 100 scende da 2 ore  - r 6740 NUOVA ERA A3 SOFT 1xy1"
                    action = "buy"
                    percentage = 70

                    # 16 mag 2025 MA ma100_last < ma100_120_min_ago
                     
                    


                elif (    
                    ma3_last > ma16_last
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma25_sotto_ma300 < -0.20
                    and deviation_ma25_sotto_ma300 > -0.50

                    and deviation_ma39 < -0.18
                    and deviation_ma3_sotto_ma50 < -0.18
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    
                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2

                    and ma450_last > ma450_480_min_ago
                    and ma450_last > ma450_720_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 4 con 450 > 450 720 min - GIORNO ma 100 scende da 2 ore ! - r 6740 NUOVA ERA A3 SOFT 1xy2"
                    action = "buy"
                    percentage = 70

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 16 mag 2025 MA ma100_last < ma100_120_min_ago




                elif (    
                    ma3_last > ma20_last

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 > delta_DNA_2
                    and deviation_ma3_sotto_ma50 < -0.25

                    and ma450_last > ma450_480_min_ago
                    and ma450_last > ma450_720_min_ago

                    and deviation_ma300_sopra_ma450 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.10

                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 4 con 450 > 450 720 min MA CONSIDERATA ANCORA LATERALE + DNA - NOTTE - r 6740 NUOVA ERA A3 SOFT 1y"
                    action = "buy"
                    percentage = 70

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 tolta and ma2_last >= ma2_2_min_ago
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 28 feb 2025 aggiunta DNA - NOTTE


                
                elif (    
                    ma4_last > ma20_last
                    and ma450_last < ma450_720_min_ago

                    and ma450_last > ma450_480_min_ago
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                   
                    
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                   
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 4 - ANDATA BENISSIMO - con 450 < 450 720 min MA CONSIDERATA ANCORA LATERALE - r 6740 NUOVA ERA A3 SOFT 2"
                    action = "buy"
                    percentage = 70
                    
                    # questa condizione importata da RCCR e' arrivata un po' prima.
                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIBASSO



                elif (
                    
                    ma4_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                   
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                   
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 4 - ANDATA BENISSIMO - con 450 > 450 480 min MA CONSIDERATA ANCORA LATERALE - r 6740 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 60
                    
                    # questa condizione importata da RCCR e' arrivata un po' prima.


                elif (
                    
                    ma4_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and ma3_last > ma54_last
                   
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                   
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 4 importata da RCCR BUY3 r 6599 A1yA2 - ANDATA BENISSIMO - con 450 > 450 480 min MA CONSIDERATA ANCORA LATERALE - r 6740 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 60
                    
                    # questa condizione importata da RCCR e' arrivata un po' prima.

                
                elif (
                    
                    ma4_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and ma3_last > ma39_last
                   
                    and ma450_last > ma450_480_min_ago
                    
                    and deviation_ma100_sopra_ma300 < 0.27
                    and deviation_ma100_sopra_ma300 > -0.27
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > -0.02
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                   
                    and ma2_last > ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 4 importata da RCCR BUY3 r 6599 A1yA2 - ANDATA BENISSIMO - con 450 > 450 480 min MA CONSIDERATA ANCORA LATERALE - r 6740 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 60
                    
                    # questa condizione importata da RCCR e' arrivata un po' prima.


                
                elif (
                    ma3_last > ma15_last
                    and ma450_last > ma450_480_min_ago
                    and ma300_last < ma300_120_min_ago
                    and ma100_last > ma100_60_min_ago
                    and deviation > -0.30
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -2.50
                       
                ):    
                    buy = "BUY 4 importato da BUY 3 RCCR con 300 < E 450 < 450 480 min ago - r 6756 Bx"
                    action = "buy"
                    percentage = 70
                    
                    #  5 set 2023 anticipata ndecchiecella
                    # 11 mar 2025 SE 450< massimo 3 BUY
              

                
                elif (
                    ma3_last > ma15_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma39_sotto_ma100 > -0.15

                    and ma78_last < ma150_last
                    and deviation_ma39 > -0.30
                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 < 0.08
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -2.50
                    and ma2_last >= ma10_last


                ):    
                    buy = "BUY 4 modificato importando un vecchio pensiero laterale da RCCR + circello - r 6756 BY 1"
                    action = "buy"
                    percentage = 70
                    
                    # 29 dic 2023 se 20>39 anticipa ndecchiecella 
                    # 29 dic 2023 deviation_ma4_sopra_ma30 > 0.12 da 0.15
                    # deviation = ma5_last / last_trade_price
                    # 18 gen 2024 10-39 da and ma10_last >= ma39_last
                    # 27 gen 2024 aggiunta 2>5 (e' necessaria !) vedi 27 gen 2024 ore 9:51
                    # 12 set 2024 aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    # 24 nov 2024 modificao importando un vecchio pensiero laterale da RCCR
                    # 22 feb 2025 aggiunta continua a scendere circello

                
                elif (
                    ma3_last >= ma18_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.02

                    and ma300_last < ma300_120_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    
                    and ma20_last < ma39_last
                    and ma2_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -2.50
                ):    
                    buy = "BUY 4 continua a scendere - RCCR con 300< AND and diff macd - r 6756 By2"
                    action = "buy"
                    percentage = 70
                    
                    #  5 set 2023 anticipata ndecchiecella
                    
                    
                    
                elif (
                    ma20_last >= ma20_2_min_ago
                    and ma300_last > ma450_last
                    and ma300_last > ma300_60_min_ago
                    and ma100_last < ma200_last
                    and deviation_bellissima > 0.15
                    and deviation_buy3 > 0.10
                    and ma3_last > ma13_last
                    and deviation_ma7_sopra_ma40 > 0.11
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma2_last > ma2_2_min_ago
                    and ma7_last > ma25_last
                    
                    and ma13_last > ma100_last
                    and deviation_ma5_sopra_ma28 > 0.05
                ):
                    buy = "BUY 4 con ma 78 > TREND LATERALE con 6-30 > 0.15 CON 300>450 - r 6780 A"
                    action = "buy"
                    percentage = 70
                    
                    # 25 gen se 300 > 450 compra prima
                    
                    
                
                    
               
                ##############################################################################################
                
                
                elif (
                    ma3_last > ma11_last
                    and delta_DNA_1 > delta_DNA_2
                    and deviation_ma300_sopra_ma450 > -0.15


                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.145
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    and deviation_ma25_sotto_ma300 < 0.10
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.017

                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                    and (ma450_last > ma450_720_min_ago or ma450_last > ma450_360_min_ago or ma200_last > ma200_60_min_ago)
                    
                    and ma3_last > ma7_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 4 con ma450_last > ma450_720_min_ago e con ma200> MA DNA NOTTE E CM GIORNO - r 6800 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 cancellato and ma2_last > ma2_2_min_ago e anticipato ndecchiecella
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 28 feb 2025 aggiunta DNA NOTTE
                    # 21 mag 2025 e' andata bene sul BUY 3 e pe ro 2 botte e' stata portata anche qui.
                    # 28 giu 2025 se delta_DNA_1 > delta_DNA_2 aggiungo deviation_ma5_sopra_o_sotto_ma100 < -0.10

                    #  10 ago 2025 INCOMINCIAMO A FARE SUL SERIO. aggiunta and delta_CM_300_25_last < delta_CM_300_225_2_min_ago
                    # 23 ott 2025 aggiunte pg
                    # 25 ott 2025 aggiunte dev da pg




                # BUY 4A con ma 78> e 300< ma 100>200

                elif (
                    ma3_last > ma11_last
                    and (ma300_last < ma300_60_min_ago or ma300_last < ma300_120_min_ago)

                    and deviation_ma39 < -0.22
                    and deviation_ma3_sotto_ma50 < -0.35
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.55
                    and deviation_ma25_sotto_ma300 < -0.75
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or delta_50_25_last <= delta_50_25_30_min_ago)
                    
                    and ma3_last > ma9_last
                    
                ):
                    buy = f"BUY 4 con 300< ma 100>200 - r 6808 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 23 ott 2025 aggiunte pg
                    # 24 ott 2025 modificato con dev pg per anticipare ndecchiecella



                elif (
                    ma3_last > ma13_last
                    and (ma300_last < ma300_60_min_ago or ma300_last < ma300_120_min_ago)

                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05

                    and (ma100_last > ma200_last or ma78_last >= ma78_2_min_ago)
                    
                    and (deviation_ma4_sopra_ma100 > 0.01 or ma4_last > ma50_last)
                    
                    and ma3_last > ma9_last
                    
                ):
                    buy = f"BUY 4 con 300< ma 100>200 - r 6808 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 23 ott 2025 aggiunte pg
                



               
                elif (
                    ma3_last > ma13_last

                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma300_last > ma300_360_min_ago

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.055
                    and ma8_last > ma8_2_min_ago
                ):
                    buy = f"BUY 4 23 ott 2025 > 180 min di ribasso con deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.055 - r 6820 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 23 ott 2025 aggiunte pg


                elif (   
                    ma3_last > ma13_last

                    and ma39_last < ma100_last
                    and ma10_last < ma20_last
                    and deviation_ma5_sotto_ma300 > -0.60

                    and deviation_ma300_sopra_ma450 > -0.07
                    and deviation_ma200_sotto_ma300 > -0.07
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > -18.00
                    
                ):
                    buy = f"BUY 4 > 180 min di ribasso CON ma10<ma20 con 3-28 MA LE MEDIE LUNGHE SONO VICINISSIME - r 6830 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    #  3 giu 2025 aggiunta ma modificata 300 vicinissima alla 450 e 200 vicinissima alla 300 anche se sembra che cominci un ribasso. 
                    #  3 giu 2025 e' andata benissimo sul RCCR e io ho aggiunto questa piccola ma importante modifica
                    # 23 ott 2025 aggiunte pg



                elif (
                    ma3_last > ma13_last

                    and ma300_last < ma300_120_min_ago
                    and ma300_last < ma300_60_min_ago
                    and ma100_last < ma200_last

                    and delta_DNA_1 <= delta_DNA_2

                    and ma8_last >= ma8_2_min_ago 

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.25
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma25_sotto_ma300 < -1.40
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and ma100_last < ma100_10_min_ago
                    
                    
                    and macd_differenza_2_min_ago > -18.00
                ):
                    buy = f"BUY 4 con 300< e 100<200 MA GIORNO E ma100 comincia a perdere di meno ma sembra un RITRACCIAMENTO - r 6836 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    #  6 apr 205 tolte sovrastrutture 
                    # 14 apr 2025 aggiunta 3-39 < -0.04
                    # 14 apr 2025 aggiunta 3-50 < -0.04
                    #  6 mag 2025 deviation_ma3_sotto_ma50 a -0.25 da -0.04
                    # 17 ott 2025 aggiunte dev pg
                    # 17 ott 2025 aggiunte pg
                    
                    #####################################################################
                    
                elif (
                    ma20_last >= ma20_2_min_ago
                    and ma200_last > ma200_301_min_ago
                    and ma300_last > ma300_60_min_ago
                    and deviation_ma250_sopra_ma300 > 0.03
                    
                    and ma78_last > ma78_60_min_ago
                    
                    and ma3_last > ma8_last
                    and deviation_buy3 > -0.005
                    and deviation_ma5_sopra_ma28 > 0.03
                    and deviation_ma4_sopra_ma30 > 0.05
                    and delta_buy3_incrocio_ma3_ma8 > 0.03
                    and ma3_last > ma50_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd_differenza_2_min_ago > 3
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 A1x"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # deviation_ma4_sopra_ma100 > 0.25 arrivati al buy 4 DEVE AVERE UNA CERTA FORZA !
                    # ma se 250 > 300 ! serve una forza minore
                    # 6 apr 2023 ma20 2 min ago da ma28 min ago
                    # 6 apr 2023 3-50 da 3-78
                    # 6 apr 2023 8-100 da 13-100
                    
                    
                
                    
                    
                    
                    
                    
                elif (
                    ma28_last >= ma28_2_min_ago
                    and ma200_last < ma200_301_min_ago
                    and ma300_last > ma300_60_min_ago
                    and deviation_ma250_sopra_ma300 > 0.04
                  
                    and deviation_buy3 > 0.01
                    and delta_buy3_incrocio_ma3_ma8 > 0.04
                    and deviation_ma4_sopra_ma30 > 0.08
                    
                    and ma3_last > ma8_last
                    and ma3_last > ma78_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma7_last > ma25_last
                    
                    and ma13_last > ma100_last
                    and deviation_ma5_sopra_ma28 > 0.05
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 A2"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # deviation_ma4_sopra_ma100 > 0.25 arrivati al buy 4 DEVE AVERE UNA CERTA FORZA !
                    # ma se 250 > 300 ! serve una forza minore


              

                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma4_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.28
                    
                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_300_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.10
                    and deviation_ma250_sopra_ma300 > -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last > ma8_last
                    and delta_buy3_incrocio_ma3_ma8 > 0.01
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 B1x NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70
                  

                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma4_last > ma39_last
                  
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma5_last > ma50_last
                    
                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_300_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.10
                    and deviation_ma250_sopra_ma300 > -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last > ma8_last
                    and delta_buy3_incrocio_ma3_ma8 > 0.01
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 B1x NUOVA ERA A2 SOFT"
                    action = "buy"
                    percentage = 70

                  

                elif (
                    ma3_last > ma8_last
                    and ma50_last < ma50_2_min_ago
                    and delta_DNA_1 < delta_DNA_2
                    
                    and delta_50_39 < delta_50_39_30_min
                    and delta_450_300 < delta_450_300_60_min

                    and ma10_last < ma30_last
                
                    and deviation_ma39 < 0.07
                    and deviation_sell < -0.01
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    and ma5_last <= ma100_last
                    and deviation_ma100_sopra_ma300 > 0.20
                    
                
                    and deviation_ma3_sotto_ma150 > -1.20
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma3_sopra_ma10 > 0.01
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 4 con delta DNA 1 < DNA 2 - GIORNO - r 6859 B1x NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 70

                    # 15 set 2024 aggiunto and deviation_ma39 > 0.10 MA forse la condizione e' da cancellare
                    # 26 mag 2025 modificata per non cancellare. mi dispiacerebbe.




                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma4_last > ma39_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_300_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.10
                    and deviation_ma250_sopra_ma300 > -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last > ma8_last
                    and delta_buy3_incrocio_ma3_ma8 > 0.01
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 B1x NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70

                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma4_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and ma3_last > ma54_last
                    
                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_300_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.10
                    and deviation_ma250_sopra_ma300 > -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last > ma8_last
                    and delta_buy3_incrocio_ma3_ma8 > 0.01
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 B1x NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70

                
                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma4_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and ma3_last > ma39_last
                    
                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_300_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.10
                    and deviation_ma250_sopra_ma300 > -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last > ma8_last
                    and delta_buy3_incrocio_ma3_ma8 > 0.01
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 B1x NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # deviation_ma4_sopra_ma100 > 0.25 arrivati al buy 4 DEVE AVERE UNA CERTA FORZA !
                    # ma se 250 > 300 ! serve una forza minore
                    # 16 set 2023 anticipato ndecchiecella
                    # 28 set 2023 con ma5 > ma5 2 min ago da ma28 > ma28 2 min ago
                    # 28 set 2023 tolto 5-54
                    # 12 dic 2023 4-39 con aggiunta 3-10 and 3-16




              

                
                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma3_last > ma20_last
                    and ma20_last < ma20_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma5_30_min_ago < -0.40
                    
                    and ma50_last > ma50_50_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.02
                    and deviation_ma3_sopra_ma16 > 0.03
                    
                    and ma3_last > ma8_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and macd > macd_2_min_ago
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 4 nuovo durante una correzione ma tutte le ma continuano ad essere crescenti - r 6859 B1y"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # deviation_ma4_sopra_ma100 > 0.25 arrivati al buy 4 DEVE AVERE UNA CERTA FORZA !
                    # ma se 250 > 300 ! serve una forza minore
                    # 16 set 2023 anticipato ndecchiecella
                    # 28 set 2023 con ma5 > ma5 2 min ago da ma28 > ma28 2 min ago
                    # 28 set 2023 tolto 5-54
                    # 12 dic 2023 4-39 con aggiunta 3-10 and 3-16





                elif (
                    ma3_last > ma18_last
                    and ma450_last < ma450_300_min_ago
                    and ma20_last > ma50_last

                    
                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago > -0.015
                    
                    and (ma300_last > ma300_60_min_ago or delta_1 < delta_2)
                    
                    and deviation_ma250_sopra_ma300 < 0.25
                    and deviation_ma250_sopra_ma300 > -0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 4 situazione laterale con ma10_last > ma20_last and 3-50 < -0.13 - r 6859 B2 X1"
                    action = "buy"
                    percentage = 80

                    #  7 AGO 2025 SE 450 SCENDE DA 5 ORE IL BUY 4 DEVE AVERE 20>50 ha continuato a comprare durante il ribasso.



                elif (
                    ma3_last > ma13_last
                    and ma8_last >= ma8_2_min_ago
                    and (ma78_last < ma150_last or ma100_last < ma100_120_min_ago)

                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.083

                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    

                    and deviation_ma50_sopra_o_sotto_ma50_90_min_ago < -0.015
                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma450_last < ma450_300_min_ago
                    
                    and ma2_last >= ma10_last
                    and macd_differenza_2_min_ago > -28.50
               
                ):
                    buy = f"BUY 4 con 450_last < ma450_300_min_ago and 3-50 < -0.10 and deviation_ma5_sopra_o_sotto_ma100 < -0.20 - r 6859 B2 X2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    
                    action = "buy"
                    percentage = 80
                    
                    # 29 mag 2025 modificata profondamente
                    #  7 ott 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.083
                    #  7 ott 2025 aggiunta sulla stessa riga deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}
                    # 21 ott 2025 aggiunta and ma8_last >= ma8_2_min_ago
                    # 21 ott 2025 aggiunte pg




                elif (
                    ma5_last >= ma5_2_min_ago
                    and ma20_last <= ma20_2_min_ago
                    and ma450_last < ma450_300_min_ago
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation_ma250_sopra_ma300 < 0.12
                    and deviation_ma250_sopra_ma300 > -0.12
                    
                    and delta_buy3_incrocio_ma3_ma8 > 0.05
                    
                    and deviation_ma3_sopra_ma10 > 0.078
                    and deviation_ma3_sopra_ma16 > 0.10
                    and deviation_ma4_sopra_ma30 > 0.02
                    and ma7_last > ma25_last
                    
                    and ma3_last > ma8_last
                    and ma2_last > ma2_2_min_ago
                    
                ):
                    buy = "BUY 4 RIVOLUZIONARIO situazione laterale con ma20_last <= ma20_2_min_ago - r 6859 B2y"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # deviation_ma4_sopra_ma100 > 0.25 arrivati al buy 4 DEVE AVERE UNA CERTA FORZA !
                    # ma se 250 > 300 ! serve una forza minore
                    # 16 set 2023 anticipato ndecchiecella
                    # 28 set 2023 con ma5 > ma5 2 min ago da ma28 > ma28 2 min ago 
                    # 28 set 2023 tolto 5-54
                    # 28 set 2023 5-28 a 0.06 (con 450 < 450 300 min)
                    # 18 dic 2023 deviation_ma250_sopra_ma300 a 0.12 da 0.10
                    # 18 dic 2023 deviation_ma250_sopra_ma300 a -0.12 da -0.10

              

                
                elif (
                    ma78_last >= ma78_2_min_ago
                    and ma300_last > ma300_60_min_ago
                    and deviation_ma250_sopra_ma300 < -0.04
                    
                    and deviation_buy3 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.05
                    and deviation_ma4_sopra_ma30 > 0.14
                    
                    and delta_buy3_incrocio_ma3_ma8 > 0.05
                    
                    and ma3_last > ma8_last
                    and ma3_last > ma78_last
                    and ma4_last >= ma4_2_min_ago
                    and ma2_last > ma2_2_min_ago
                    and ma7_last > ma25_last
                    
                    and ma13_last > ma100_last
                    
                ):
                    buy = "BUY 4 RIVOLUZIONARIO con ma78 > - r 6859 C"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # deviation_ma4_sopra_ma100 > 0.25 arrivati al buy 4 DEVE AVERE UNA CERTA FORZA !





                    
                
                    
                elif (    
                    ma3_last > ma11_last

                    and ma100_last > ma100_60_min_ago

                    and ma100_last < ma200_last
                    and ma100_last < ma300_last

                    and deviation_ma39 < -0.33
                    and deviation_ma3_sotto_ma50 < -0.44
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.82
                    and deviation_ma25_sotto_ma300 < -1.48
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.186

                    
                ):
                    buy = "BUY 4 > grande ribasso 29 mag 2025 aggiunta da un sell con parentesi graffe - grazie compa ! MA ma100 > 1 ora - r 6870 a"
                    action = "buy"
                    percentage = 90

                    # 28 giu 2025 aggiunta al BUY 4



                elif (    
                    ma3_last > ma11_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -1.58)

                    and ma100_last < ma200_last
                    and ma100_last < ma300_last

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and deviation_ma25_sotto_ma300 < -1.48
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.186

                    
                ):
                    buy = f"""BUY 4 > grande ribasso 29 mag 2025 aggiunta da un sell con parentesi graffe - grazie compa ! E 100 < 1 ORA + IL MIO CAPOLAVORO - r 6870 b
                    deviation_ma39 {deviation_ma39:.2f}
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 90
                    
                    # 28 giu 2025 aggiunta al BUY 4 
                    # 17 ago 2025 se 100< or cv notte AGGIUNTO IL MIO CAPOLAVORO
                    # 17 AGO 2025 AGGIUNTO VALORI DELLE DEVIATION
                    # 17 AGO 2025 25-300 era -1.57 io ho messo -1.58 (continuava a scendere ! per questo e' stato necessario CM )
                    # 17 AGO 2025 IMPORTANTE ! 3-10 <-0.10 and 3-50 < -0.30 ! SONO STATI DIMINUITI PERCHE' SE 25-300 CM GIORNO questi sono gia' scattati al rialzo.



                # 16 apr 2025 nuova condizione che mancava e che ci deve essere

                elif (
                    ma3_last > ma13_last

                    and (ma300_last < ma300_180_min_ago or ma100_last < ma450_last)
                    and deviation_ma50_sotto_ma100 < -0.22
                    
                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.50

                    and deviation_ma5_sotto_ma450 < -0.72
                    and deviation_ma5_sotto_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma100_sopra_ma300 < -0.25
                    and deviation_ma200_sotto_ma300 < -0.06
                    and deviation_ma300_sopra_ma450 < -0.15

                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
             
                ):
                    buy = "BUY 4 nuova condizione con distanza al ribasso se 50-10 < -0.50 and dev_ma3_sotto_ma50 < -0.50 - r 7000 a"
                    action = "buy"
                    percentage = 70

                    #  7 mag 2025 se deviation_ma50_sotto_ma100 < -0.22 and deviation_ma3_sotto_ma50 < -0.50



                elif (
                    ma3_last > ma13_last

                    and (ma300_last < ma300_180_min_ago or ma100_last < ma450_last)
                    and deviation_ma50_sotto_ma100 > -0.15
                    
                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.40

                    and deviation_ma25_sotto_ma300 < -0.50
                    and deviation_ma100_sopra_ma300 < -0.25
                    and deviation_ma5_sotto_ma450 < -0.72
                    and deviation_ma5_sotto_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.40
                    and deviation_ma200_sotto_ma300 < -0.06
                    and deviation_ma300_sopra_ma450 < -0.15

                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
             
                ):
                    buy = "BUY 4 nuova condizione con distanza al ribasso se 50-100 > -0.15 and dev_ma3_sotto_ma50 < -0.40 - r 7000 b"
                    action = "buy"
                    percentage = 70

                    #  7 mag 2025 se deviation_ma50_sotto_ma100 > -0.15 and deviation_ma3_sotto_ma50 < -0.40







                # BUY 4 se 11 > 200 e con ma69 > and deviation_bellissima > 0.12 (PER SPEZZARE LA CATENA - effetti laterali) IMPORTATA DA BUY 5



                elif (
                    ma3_last > ma11_last
                    and ma300_last > ma300_180_min_ago
                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and ma2_last > ma2_2_min_ago
                ):
                    buy = f"BUY 4 con ma300_last > ma300_180_min_ago and dev_bellissima > 0.03 - r 7008 A1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 25 ott 2025 cv gior o ok cosi'



                elif (
                    ma3_last > ma11_last

                    and ma300_last > ma300_180_min_ago
                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.05
                    and ma8_last >= ma8_2_min_ago
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = f"BUY 4 con ma300_last > ma300_180_min_ago and dev_bellissima > 0.03 - r 7008 A2 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 25 ott 2025 cv notte cm giorno ma8 e ma100




                elif (
                    ma3_last > ma11_last

                    and ma300_last > ma300_180_min_ago
                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago

                    and deviation_ma39 < -0.03
                    and deviation_ma3_sotto_ma50 < -0.06
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.12
                    and deviation_ma25_sotto_ma300 < -0.25
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = f"BUY 4 con ma300_last > ma300_180_min_ago and dev_bellissima > 0.03 - r 7008 A2 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80
                  
                    # 11 ago 2023 aggiunta se 300 sale da 3 ore
                    #  6 set 2023 and deviation_buy3 > 0.10 da 0.12
                    #  6 set 2023 and deviation_bellissima > 0.10 da 0.12
                    #  6 set 2023 and deviation_ma7_sopra_ma40 > 0.10 da 0.12
                    # 27 giu 2025 and deviation_buy3 a 0.08 da 0.10
                    # 27 giu 2025 and deviation_bellissima a 0.08 da 0.10
                    # 27 giu 2025 and deviation_ma7_sopra_ma40 a 0.08 da 0.10
                    # 28 giu 2025 and deviation_buy3 a 0.04 da 0.08
                    # 28 giu 2025 and deviation_bellissima a 0.04 da 0.08
                    # 28 giu 2025 and deviation_ma7_sopra_ma40 a 0.04 da 0.08
                    #  7 ago 2025 anticipata ndecchiecella
                    # 21 ott 2025 anticipata ndecchiecella (ma e' andata bene !)
                    # 21 ott 2025 aggiunte pg
                    # 25 ott 2025 cv notte dev profonde




                elif (
                    ma3_last > ma10_last
                    
                    and ma450_last < ma450_480_min_ago

                    and deviation_ma5_sotto_ma450 < -0.49
                    and delta_DNA_1 < delta_DNA_2
                    and deviation_ma200_sotto_ma300 > -0.10
                    and deviation_ma39 < -0.06
                    and deviation_ma3_sotto_ma50 < -0.09
                    
                    and ma78_last < ma150_last
                    and ma200_last < ma300_last
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                  
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50

                    and delta_CM_300_25_last <= delta_CM_300_25_2_min_ago
                    
                ):
                    buy = "BUY 4 25 set 2025 - r 7008 B"
                    action = "buy"
                    percentage = 80

                    # > estate 7-40 0.12 da 0.09 and dev bellissima 0.14 da 0.12
                    # 11 ago 2023 aggiunta se 300 scende da 3 ore
                    # 26 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    # 26 dic 2023 aggiunta and macd_differenza_2_min_ago > 0.50
                    # 30 apr 2025 se al BUY 4 ma50 sta sopra ma100 che cazzo mi spezzi la catena ! devi anticipare, invece !
                    #  8 mag 2025 questa la tengo anche se non e' andata bene.
                    # 23 set 2025 anticipata con CM
                    # 25 set 2025 modificata radicalmente


                # condizione villeneuve - and deviation_ma3_sotto_ma50 < -0.27

                elif (
                    ma3_last > ma13_last

                    and ma100_last > ma200_last
                    and deviation_ma3_sotto_ma50 < -0.27

                    and ma300_last < ma300_180_min_ago
                    
                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -15.00
             
                ):
                    buy = "BUY 4 se 100>200 con 3-50 < -0.27 - r 7020"
                    action = "buy"
                    percentage = 80

                    #  8 mag 2025 aggiunta condizione villeneuve - and deviation_ma3_sotto_ma50 < -0.27
                    #  8 mag 2025 nelle varie oscillazioni 100 si trova sopra 200 ma c'e' una correzione.

                    
                    
                # BUY 4 NUOVA (trend laterale) con ma8_last > ma100_last AND and ma300_last > ma300_120_min_ago
                
                
                elif (
                    ma69_last >= ma69_2_min_ago
                    and deviation_ma300_sopra_ma450 > 0.12
                    
                    and ma8_last > ma100_last
                    and ma100_last > ma300_last
                    and ma100_last > ma100_60_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma5_sopra_ma28 > 0.12
                    
                    and deviation_bellissima > 0.11
                    and deviation_buy3 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.09
               
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
             
                ):
                    buy = "BUY 4 NUOVA (trend laterale) 8 > 100 AND ma300_last > ma300_120_min_ago AND 5-28 > 0.10 e con ma69 > - r 7038 a"
                    action = "buy"
                    percentage = 70
                    
                elif (
                    ma69_last >= ma69_2_min_ago
                    and deviation_ma300_sopra_ma450 < 0.12
                    and deviation_ma300_sopra_ma450 > -0.12
                    
                    and ma8_last > ma100_last
                    and ma100_last > ma300_last
                    and ma100_last > ma100_60_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma5_sopra_ma28 > 0.12
                    
                    and deviation_bellissima > 0.11
                    and deviation_buy3 > 0.11
                    and deviation_ma7_sopra_ma40 > 0.09
               
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
             
                ):
                    buy = "BUY 4 NUOVA (trend laterale) 8 > 100 AND ma300_last > ma300_120_min_ago AND 5-28 > 0.11 e con ma69 > - r 7038 b"
                    action = "buy"
                    percentage = 70
                    
                    
                elif (
                    ma69_last >= ma69_2_min_ago
                    and deviation_ma300_sopra_ma450 < -0.12
                    
                    
                    and ma8_last > ma100_last
                    and ma100_last > ma300_last
                    and ma100_last > ma100_60_min_ago
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma5_sopra_ma28 > 0.12
                    
                    and deviation_bellissima > 0.11
                    and deviation_buy3 > 0.12
                    and deviation_ma7_sopra_ma40 > 0.09
               
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
             
                ):
                    buy = "BUY 4 NUOVA (trend laterale) 8 > 100 AND ma300_last > ma300_120_min_ago AND 5-28 > 0.12 e con ma69 > - r 7038 c"
                    action = "buy"
                    percentage = 70
                    
                    
                    
                    
                # BUY 4 29 ago 2022 > 120 min di ribasso - PENSIERO LATERALE
                
                elif (
                    
                    ma3_last > ma39_last
                    and ma100_last > ma100_30_min_ago

                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sotto_ma300 < -0.35
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma5_sopra_ma28 > 0.08
                    
                    and ma2_last >= ma2_2_min_ago
                    
                ):
                    buy = "BUY 4 29 ago 2022 > 120 min di ribasso - deviation_ma5_sotto_ma300 - r 7039 A"
                    action = "buy"
                    percentage = 90
                    
                    # vuoi comprare dopo 120 min di ribasso ? deve essere 5-300 < -0.35 ! voglio uno sconto ulteriore dello 0.35% ! PENSIERO LATERALE
                    #  5 nov 2024 100 deve essere > 30 min ago stiamo al buy 4 cazzo.

              
                # BUY 4 29 ago 2022 > 180 min di ribasso
                
                elif (
                    
                    ma3_last > ma39_last
                    and ma300_last > ma300_360_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma300_last > ma300_360_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 4 29 ago 2022 > 180 min di ribasso con aggiunta prendo il coltello con il piede - r 7039 B1"
                    action = "buy"
                    percentage = 90
                    
                    #  5 ott 2023 a 5-54 da 18-100
                    #  5 ott 2023 and macd > macd_2_min_ago
                    # 11 set 2024 aggiunto prendo coltello con il piede (ma non troppo in basso poiche' ma300>ma300 360 min ago)

                
                # BUY 4 29 ago 2022 > 180 min di ribasso
                
                
                elif (
                    ma3_last > ma20_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30

                    and ma450_last < ma450_480_min_ago
                    
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.025

                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma300_last < ma300_360_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 4 29 ago 2022 > 180 min di ribasso - r 7039 B2x"
                    action = "buy"
                    percentage = 90
                    
                    # 11 ott 2022 se ma300 < 360 min ago BUY 4 se deve comprare deve avere almeno 5-28 > 0.13 
                    # 31 lug 2023 ma8_last > ma54_last da 18-100
                    #  5 ott 2023 and deviation_ma5_sopra_o_sotto_ma100 > -0.05

                    # 10 set 2024 and macd_differenza_2_min_ago > -2 
                    # 10 set 2024 significa che la differenza del MACD di adesso E del MACD di 2 min ago NON E' TANTA cioe' STA SMETTENDO DI CROLLARE
                    #  3 mar 2025 tolta ma2 > ma2 2 min ago e me la tengo
                    # 12 mar 2025 se e' BUY 4 deve essere almeno and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.025

              
                # BUY 4 29 ago 2022 > 180 min di ribasso
                
                elif (
                    
                    ma5_last > ma33_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma300_last < ma300_360_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 > 0.07
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 4 29 ago 2022 > 180 min di ribasso CON 5-33 and dev_ma5_sopra_ma28 > 0.07- r 7039 B2y"
                    action = "buy"
                    percentage = 90
                    
                    # 11 ott 2022 se ma300 < 360 min ago BUY 4 se deve comprare deve avere almeno 5-28 > 0.13 
                    # 31 lug ma8_last > ma54_last da 18-100
                    #  5 ott 2023 and deviation_ma5_sopra_o_sotto_ma100 < -0.05 ( per comprare meglio, perche' la precedente 7039 B2 comprava tardi !) 
                    #  5 ott 2023 and macd >= macd_2_min_ago

                    
                elif (    
                    ma3_last > ma13_last
                    and ma50_last > ma100_last

                    and (ma450_last >= ma450_120_min_ago or ma300_last > ma300_360_min_ago)

                    and (ma3_prev < ma140_prev and ma3_last > ma140_last)
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 nuova condizione che mancava e che ci deve stare con incrocio 3-140 CON 50>100 - r 7040 Ax"
                    action = "buy"
                    percentage = 70

                    # 15 apr 2025 aggiunta questa nuova condizione ! BTC si e' impennato e non e' partita neanche una condizione !
                    # 15 apr 2025 e' andata benissimo su RCCR


                elif (    
                    ma3_last > ma13_last
                    and ma50_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.10

                    and (ma450_last >= ma450_120_min_ago or ma300_last > ma300_360_min_ago)

                    and (ma3_prev < ma140_prev and ma3_last > ma140_last)
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 nuova condizione che mancava e che ci deve stare con incrocio 3-140 CON 50<100 ritracciamento - r 7040 Ay"
                    action = "buy"
                    percentage = 70

                    # 15 apr 2025 aggiunta questa nuova condizione ! BTC si e' impennato e non e' partita neanche una condizione !
                    # 15 apr 2025 e' andata benissimo su RCCR
                    # 18 mag 2025 non e' andata bene e ho fatto questa modifica
                    # 18 mag 2025 se 50<100 ritracciamento 3-50 < -0.10



                elif (
                    ma3_last > ma15_last
                    and delta_1 < delta_2
                    and ma20_last > ma50_last
                    and ma39_last > ma50_last
                    
                    and ma300_last > ma300_360_min_ago
                    and ma200_last > ma200_360_min_ago
                    and deviation_ma200_sotto_ma300 > -0.05
                    
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -8.50
                ):    
                    buy = "BUY 5 nuova condizione che mancava e che ci deve stare con 300> e 200> CON 20>50 - r 7040 B1x"
                    action = "buy"
                    percentage = 80




                elif (
                    ma3_last > ma15_last
                    and delta_1 > delta_2
                    and (deviation_ma5_sopra_o_sotto_ma100 > 0.15 or deviation_ma5_sopra_o_sotto_ma100 < -0.05)

                    and ma20_last > ma50_last
                    and ma39_last > ma50_last
                    
                    and ma300_last > ma300_360_min_ago
                    and ma200_last > ma200_360_min_ago
                    and deviation_ma200_sotto_ma300 > -0.05
                    
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -8.50
                ):    
                    buy = "BUY 5 MANDRAKATA nuova condizione che mancava e che ci deve stare con 300> e 200> CON 20>50 - r 7040 B1y"
                    action = "buy"
                    percentage = 80
                    
                    # 15 apr 2025 aggiunta questa nuova condizione ! BTC si e' impennato e non e' partita neanche una condizione !
                    # 15 apr 2025 and deviation_ma200_sotto_ma300 > -0.05 per non farla comprare quando comincia il ribasso
                    # 15 apr 2025 and ma39_last > ma50_last per non farla comprare quando comincia il ribasso.
                    #  8 mag 2025 se 20>50 ok cosi'.
                    # 22 mag 2025 mandrakata. se 100 sta curvando verso il basso fino alla 200.
                    # 22 mag 2025 o scatta verso l' alto BUY con deviation_ma5_sopra_o_sotto_ma100 > 0.15
                    # 22 mag 2025 oscatta verso il basso BUY con deviation_ma5_sopra_o_sotto_ma100 < -0.05



                elif (
                    ma3_last > ma15_last

                    and ma20_last < ma50_last
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01

                    and ma39_last > ma50_last
                    
                    and ma300_last > ma300_360_min_ago
                    and ma200_last > ma200_360_min_ago
                    and deviation_ma200_sotto_ma300 > -0.05
                    
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -8.50
                ):    
                    buy = "BUY 5 nuova condizione che mancava e che ci deve stare con 300> e 200> CON 20<50 - r 7040 B2"
                    action = "buy"
                    percentage = 80

                    #  8 mag 2025 se 20<50 aggiungo 3-50 < -0.15 e 5-100 < -0.01






                elif (    
                    ma3_last > ma18_last

                    and delta_300_200 < delta_300_200_60_min
                    and deviation_ma200_sotto_ma300 > -0.13
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.20

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 5 >120 min di ribasso ma la situazione sta migliorando - r 7041 x"
                    action = "buy"
                    percentage = 90

                    #  8 ago 2025 ho aggiunto questa condizione perche' BUY 5 non aveva comprato e BUY 1 CONDIZIONE MIGLIORE aveva comprato tardissimo
                    #  8 ago 2025 stai tranquillo. vedi che 200 e' vicinissima alla 300 e 100 non scende tantissimo.
                    #  8 ago 2025 and delta_300_200 < delta_300_200_60_min



                elif (    
                    ma3_last > ma20_last
                    and ma100_last > ma100_60_min_ago

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176

                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 5 >120 min di ribasso ma DICE CHE la situazione sta migliorando E 100< - r 7041 Y1"
                    action = "buy"
                    percentage = 90

                    # 14 ago 2025 aggiunto se 100> ok cosi' (comprava durante un ribasso)



                elif (    
                    ma3_last > ma20_last
                    and ma450_last > ma450_480_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago


                    and delta_50_25_last < delta_50_25_30_min_ago

                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.35)

                    and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)


                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.01
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma25_sotto_ma300 < -0.01
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = f"BUY 5 > 120 min di ribasso ma DICE CHE la situazione sta migliorando MA 100< + IL MIO CAPOLAVORO - r 7041 Y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    
                    action = "buy"
                    percentage = 90
                    
                    #  9 feb 2024 IMPORTANTE ! solo BUY 5 NUOVA ERA A3 SOFT con ma100 > ma100 5 min ago !!!
                    # 26 feb 2024 piccola modifica per anticipare ndecchiecella
                    # 29 apr 2025 aggiunta questa che mancava dopo 50000 righe
                    #  6 ago 2025 aggiunta and (deviation_ma200_sotto_ma300 > -0.13 or delta_DNA_1 < delta_DNA_2)
                    #  6 ago 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.176
                    # 14 ago 2025 IL MIO CAPOLAVORO
                    # 30 set 2025 aggiunta and delta_50_25_last < delta_50_25_30_min_ago GIORNO
                    # 30 set 2025 aggiunte parentesi graffe
                    #  7 OTT 2025 AGGIUNTO :.3f NELLE PARENTESI GRAFFE ( che quando sono sulla stessa riga funzionano) (cioe' mi fanno vedere i valori)

                

                elif (
                    ma3_last > ma18_last
                    and ma300_last > ma300_180_min_ago

                    and deviation_ma7_sopra_ma40 > 0.01
                    and deviation_buy3 > 0.02
                    and deviation_bellissima > 0.03
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 5 con ma300_last > ma300_180_min_ago and dev_bellissima > 0.03 - r 7042"
                    action = "buy"
                    percentage = 70

                    #  7 ago 2025 ho portato questa condizione poiche' il BUY 5 NON SI E' ATTIVATO PROPRIO. d' altronde 300 > 3 ore !




                elif (
                    ma3_last > ma18_last
                    and (ma300_last > ma300_180_min_ago or ma300_last > ma450_last)
                    
                    and deviation_buy3 > 0.01
                    and deviation_bellissima > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 5 del 13 ottobre 2025 che mancava con ma300_last > ma300_180_min_ago and dev_bellissima > 0.02 - r 7043"
                    action = "buy"
                    percentage = 70
                    
                    # 13 ott 2025 aggiunta al BUY 5 



                elif (    
                    ma3_last > ma18_last

                    and ma39_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -1.20

                    and ma450_last < ma450_120_min_ago
                    and ma200_last < ma300_last
                    
                    
                    and deviation_ma25_sotto_ma300 < -0.22
                    and deviation_ma50_sotto_ma300 < -0.22

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma5_sotto_ma200 < -0.13
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma5_sotto_ma450 < -0.21
                    and deviation_ma300_sopra_ma450 < -0.072

                    and ma50_last < ma50_2_min_ago

                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 4 con ma450_last < ma450_120_min_ago con DNAM + distanza al ribasso vedi 3-50 < -1.20 ! - r 7045"
                    action = "buy"
                    percentage = 80

                    #  7 apr 2025 NUOVA CONDIZIONE cazzo vedi che bello quel 3-50 < -1.20 ! HA FUNZIONATO BENISIMO NEL BUY 5



                elif (

                    deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.69
                    and ma5_last < ma22_last

                    and deviation_correzione > 0.03
                    and deviation_ma100_sopra_ma300 > -0.30
                    and deviation_ma25_sotto_ma300 < -0.55

                    and deviation_ma5_sotto_ma300 < -0.39

                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 4 FIAT importata da buy 1 r 2575 DEVE STARE DISTANTE DALLA 300 ! - r 7050"
                    action = "buy"
                    percentage = 80

                    # questa e' andata benissimo su RCCR ! il 10 ottobre 2022 ! maddog dormiva !
                    # vedi RCCR r 1294
                    # 2 apr 2023 portata dal buy 1
                    
                    
                    
                # BUY 4 13 apr 2023 zia pina > 180 min di ribasso 78 < 150
                
                elif (    
                    ma3_last > ma15_last
                    

                    and ma100_last < ma100_30_min_ago
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.30
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.59
                    and deviation_ma5_sotto_ma200 < -1.30
                    and deviation_ma5_sotto_ma300 < -1.80


                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and ma78_last < ma150_last
                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.03
                    and deviation_ma3_sopra_ma18 > -0.05
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma8_last

                    and ma2_last >= ma2_2_min_ago
                    and macd > -40
                    and macd_differenza_2_min_ago > -1.25
                    
                ):
                    buy = "BUY 4 PENSIERO LATERALE 13 apr 2023 zia pina > 180 min di ribasso CON zia amalia grafana - r 7060 A"
                    action = "buy"
                    percentage = 90

                    # 14 nov 2024 aggiunta zia amalia grafana


                
                # IPERVENDUTO DNA 
                
                elif (    
                    ma3_last > ma15_last
                    and ma78_last < ma150_last
                    and deviation_ma39 <= -0.30
                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > 0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 10
                    and macd > -20
                    and macd_differenza_2_min_ago > 1.25
                    and ma2_last >= ma10_last
                ):
                    buy = "BUY 4 ENTRA DNA - IPERVENUTO - PENSIERO LATERALE 13 apr 2023 zia pina > 180 min di ribasso and 78<150 and 3-16 > 0.03 and macd > 2 min ago  - r 7060 B"
                    action = "buy"
                    percentage = 90
                    
                    # 7 feb 2023 deviation_ma5_sopra_ma28 > 0.10 da 0.13
                    # tolto 18>100 
                    # aggiunto PENSIERO LATERALE and deviation_ma5_sopra_ma59 < -0.09
                    # 18 mag 2023 aggiunta 3-16 > 0.03 
                    #  2 giu 2023 aggiunta 3-18 > 0.093
                    # 24 ago 2023 aggiunta and macd > macd_2_min_ago
                    # 27 set 2023 5.28 0.08 da 0.10
                    # 27 set 2023 and deviation_ma5_sopra_ma59 < -0.10 da -0.09

              
                
                # 22 set 2024 cancellata r 7063 NUOVA ERA A1 SOFT
                
                
                elif (    
                    ma5_last > ma54_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 4 con 5-54 importato da buy 5 rccr con 50>59 and macd > macd_2_min_ago - r 7063 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma5_last > ma54_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 4 con 5-54 importato da buy 5 rccr con 50>59 and macd > macd_2_min_ago - r 7063 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90



                    
                elif (    
                    ma3_last > ma18_last

                    and (ma20_last < ma50_last or ma39_last < ma100_last)
                    and (deviation_ma200_sotto_ma300 > -0.07 or deviation_ma25_sotto_ma300 < -0.22)
                    and deviation_ma5_sotto_ma300 < -0.01
                    
                    and ma450_last > ma450_120_min_ago

                    and deviation_ma39 < -0.05
                    and deviation_ma3_sotto_ma50 < -1.25
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02

                    and macd_differenza_2_min_ago > -18.50
                 
                ):
                    buy = f"BUY 4 {ma450_last} {ma450_120_min_ago} con ma300< e dev 5-300 < -0.01 - RITRACCIAMENTO - r 7063 NUOVA ERA A3 SOFT 1"
                    action = "buy"
                    percentage = 90
                    
                    #  4 feb 2025 se ma25_last > ma100_last ANTICIPATO ndecchiecella
                    # 26 mar 2025 and macd_differenza_2_min_ago > -18.50
                    # 30 mar 2025 se 20<50 allora deve essere deviation_ma39 < -0.05 and deviation_ma3_sotto_ma50 < -0.06
                    #  2 apr 2025 and deviation_ma3_sotto_ma50 < -0.25 da -0.05
                    #  7 apr 2025 and deviation_ma3_sotto_ma50 < -1.25
                    # 14 apr 2025 se 20<50 RITRACCIAMENTO
                    # 14 apr 2025 aggiunto and deviation_ma5_sotto_ma300 < -0.01
                    # 14 apr 2025 correzione or e aggiunta f

                elif (
                    ma3_last > ma18_last

                    and ma450_last > ma450_300_min_ago
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma200_sotto_ma300 < -0.32
                    and deviation_ma3_sotto_ma50 < -0.28

                    and ma25_last < ma100_last

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 4 con aggiunta distanza al ribasso se ma450_last > ma450_300_min_ago - r 7063 NUOVA ERA A3 SOFT 2A"
                    action = "buy"
                    percentage = 90



                elif (
                    ma3_last > ma18_last

                    and ma450_last < ma450_300_min_ago
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma200_sotto_ma300 < -0.32
                    and deviation_ma3_sotto_ma50 < -0.28

                    and ma25_last < ma100_last

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 4 con aggiunta distanza al ribasso se ma450_last < ma450_300_min_ago - r 7063 NUOVA ERA A3 SOFT 2B"
                    action = "buy"
                    percentage = 90

                    #  2 mar 2025 NON TOCCARLA MAI ! QUESTA SI E' ATTIVATA IN UN RIALZO SPAVENTOSO E IMPROVVISO DOPO ANNUNCIO DI TRUMP
                    #  2 mar 2025 puoi studiare anche un NUOVO rialzo improvviso tra le condizioni speciali !
                    # 20 mar 2025 aggiunta distanza al ribasso se ma450_last < ma450_300_min_ago

                  

                elif (    
                    ma3_last > ma39_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 4 con 5-54 importato da buy 5 rccr con 50>59 and macd > macd_2_min_ago - r 7063 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma5_last > ma54_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 4 con 5-54 importato da buy 5 rccr con 50>59 and macd > macd_2_min_ago - r 7063 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma5_last > ma54_last
                    
                    and ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 4 con 5-54 importato da buy 5 rccr con 50>59 and macd > macd_2_min_ago - r 7063 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > 0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    
                ):
                    buy = "BUY 4 con 5-54 importato da buy 5 rccr con 50>59 and macd > macd_2_min_ago - r 7063 NUOVA ERA A3 STONG"
                    action = "buy"
                    percentage = 90
                  
                    #  1 ago 2023 importato buy 4 da buy 5
                    # 27 set 2023 78-100 da 78-150
                    # 27 set 2023 5-54 da 8-59
                    # 29 ott 2023 50-59 da 78-100

              

                
                # 30 dic 2024 cancellata r 7064

                
                
                # BUY 4 se 100>200 non devi spezzare proprio un cazzo
                elif (
                    ma3_last > ma18_last

                    and ma20_last > ma50_last
                    and ma100_last > ma200_last
                    and ma100_last > ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    and (delta_450_200 < delta_450_200_60_min or delta_DNA_1 < delta_DNA_2)
                    
                    and ma3_last > ma13_last

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 4 con con 100>100 120 min ago E doppio delta GIORNO e 20>50 E 100 > 60 min - r 7065 A1 x1 x"
                    action = "buy"
                    percentage = 80

                    # 21 mar 2025 se ma39_last > ma39_30_min_ago ok
                    # 14 apr 2025 and macd_differenza_2_min_ago a -8.50 da -2.50
                    # 14 apr 2025 20>50 sostituisce and ma39_last > ma39_30_min_ago
                    # 28 apr 2025 aggiunta or delta_DNA_1 < delta_DNA_2
                    # 12 mag 2025 aggiunta ma100_last > ma100_60_min_ago


                elif (
                    ma3_last > ma18_last

                    and ma20_last > ma50_last
                    and ma100_last > ma200_last
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma3_sotto_ma50 < -0.05
                    and ma100_last > ma100_120_min_ago

                    and (delta_450_200 < delta_450_200_60_min or delta_DNA_1 < delta_DNA_2)
                    
                    and ma3_last > ma13_last

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 4 con con 100>100 120 min ago E doppio delta GIORNO e 20>50 MA 100 > 60 min and 3-50 < -0.05 - r 7065 A1 x1 y"
                    action = "buy"
                    percentage = 80

                    # 21 mar 2025 se ma39_last > ma39_30_min_ago ok
                    # 14 apr 2025 and macd_differenza_2_min_ago a -8.50 da -2.50
                    # 14 apr 2025 20>50 sostituisce and ma39_last > ma39_30_min_ago
                    # 28 apr 2025 aggiunta or delta_DNA_1 < delta_DNA_2
                    # 12 mag 2025 aggiunta ma100_last < ma100_60_min_ago and deviation_ma3_sotto_ma50 < -0.05



                elif (
                    ma3_last > ma20_last

                    and ma39_last < ma39_30_min_ago
                    and deviation_ma3_sotto_ma50 < -0.28

                    and ma100_last > ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                   
                    and delta_450_200 < delta_450_200_60_min
                    
                    and ma100_last > ma200_last
                    
                    and ma3_last > ma13_last

                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 4 con con 100>100 120 min ago E doppio delta GIORNO MA 39< 39 30 min ago + distanza al ribasso  - r 7065 A1 x2"
                    action = "buy"
                    percentage = 70

                    # 14 ott 2024 se 100> 100 60 min ago ok cosi'
                    # 20 gen 2025 anticipata ndecchiecella
                    # 16 feb 2025 macd a -70 da -60
                    # 12 mar 2025 and macd_differenza_2_min_ago > -2.50 invece di macd > -70
                    # 21 mar 2025 ma se ma39_last < ma39_30_min_ago allora distanza al ribasso 


                elif (
                    ma3_last > ma20_last
                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma25_sotto_ma300 < -0.15
                    and deviation_ma50_sotto_ma300 < -0.15
                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.01
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.12
                    and deviation_ma5_sotto_ma300 < -0.15
                    and deviation_ma5_sotto_ma450 < -0.08

                    and ma100_last > ma100_60_min_ago
                    and ma100_last > ma200_last
                    and delta_450_200 < delta_450_200_60_min
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma2_2_min_ago
                    and macd > -50
                    
                ):
                    buy = "BUY 4 con 100<100 120 min ago E doppio delta GIORNO e DNAM - r 7065 A1y"
                    action = "buy"
                    percentage = 70

                    # 14 ott 2024 se 100> 100 60 min ago ok cosi'
                    #  2 dic 2024 se ma100_last < ma100_120_min_ago allora interviene DNAM



                elif (
                    ma3_last > ma20_last
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma25_sotto_ma300 < -0.11

                    and delta_450_200 < delta_450_200_60_min
                    and ma25_last > ma300_last
                    and ma100_last > ma200_last
                    
                    and deviation_ma3_sopra_ma28 > -0.10
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma2_2_min_ago
                    and macd > -50
                    
                ):
                    buy = "BUY 4 con 100>200 MA ma100<ma100 60 min ago E doppio delta GIORNO e 25>300 (IL CANE VUOLE L' OSSO !) - r 7065 A2"
                    action = "buy"
                    percentage = 70

                    #  3 ott 2024 aggiunto doppio delta GIORNO  e anticipato.
                    #  7 ott 2024 anticipata ancora
                    # 14 ott 2024 MA SE ma100<ma100 60 min IL CANE VUOLE L' OSSO !



                elif (
                    ma59_last >= ma59_2_min_ago
                    and delta_450_200 > delta_450_200_60_min

                    and ma100_last > ma200_last
                    and ma8_last > ma200_last

                    and deviation_ma3_sopra_ma28 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last

                    and ma2_last > ma2_2_min_ago
             
                ):
                    buy = "BUY 4 con 100>200 MA doppio delta NOTTE - r 7065 b"
                    action = "buy"
                    percentage = 70

                    # deviation_bellissima = 6/30
                    # spezzare la catena dei buy - effetti laterali.
                    # non importa se compra con un + 0.10 piu' in alto. NON FA UNA GRANDE DIFFERENZA !
                    
                    # 20 set 2024 anticipata ndecchiecella 
                    # 21 set 2024 se 100 > 200 non devi spezzare proprio un cazzo ! - anticipata
                    #  3 ott 2024 aggiunto doppio delta

                
                elif ( 
                    delta_300_100 < delta_300_100_120_min
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    
                    and deviation_ma3_sopra_ma28 > -0.05
                   
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > -40
                ):
                    buy = "BUY 4 prende il coltello con il piede ma doppio delta giorno - riga 7070"
                    action = "buy"
                    percentage = 70

                    # 20 set 2024 prendi il coltello con il piede !
                    
                    
                    
                    
                
          
                #############################################################################################
                
                # se ma100 dopo 90 min e' orizzontale PARTE QUESTA CONDIZIONE QUA che e' andata benissimo !




                elif (   
                    ma3_last > ma13_last

                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.09
                    and deviation_ma25_sotto_ma300 < -0.15
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.037


                    and deviation_trend_ma100_90_min_ago < 0.055
                   
                    and (deviation_ma5_sotto_ma300 < -0.15 or deviation_ma5_sotto_ma200 < -0.15)

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                   
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 4 LATERALE > 180 min di ribasso - r 7075 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 28 mag 2025 anticipata ndecchiecella
                    #  9 ott 2025 per adesso la tengo. ma intanto metto parentesi graffe
                    # 14 ott 2025 aggiunto and delta_CV_300_25_last < delta_CV_300_25_45_min_ago
                    # 16 ott 2025 aggiunto :.3f a tutte le parentesi graffe ! stanno funzionando ! grazie sempre al mio compare !
                    # 16 ott 2025 modificate le deviation presenti con le deviation di un buy successivo che e' andato bene



                elif (   
                    ma3_last < ma13_last

                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    and (delta_CM_300_25_last <= delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.82)

                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma39 < -0.42
                    and deviation_ma3_sotto_ma50 < -0.56
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.53
                    
                    and (deviation_ma5_sotto_ma300 < -0.15 or deviation_ma5_sotto_ma200 < -0.15)

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                   
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 4 LATERALE > 180 min di ribasso 78<150 and 3-16 > 0.06 and macd > macd 2 min ago - r 7075 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 28 mag 2025 anticipata ndecchiecella
                    #  9 ott 2025 per adesso la tengo. ma intanto metto parentesi graffe
                    # 14 ott 2025 aggiunto and delta_CV_300_25_last > delta_CV_300_25_45_min_ago
                    # 16 ott 2025 delta_CM_300_25_last <= delta_CM_300_25_2_min_ago da delta_CM_300_25_last < delta_CM_300_25_2_min_ago
                    # 16 ott 2025 aumentati i valori delle deviation !




              
                # BUY 4A PAZZA DURANTE UNA piccola CORREZIONE che NON E' un forte ribasso e NON E' un crollo ! (compare stammi vicino!)
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.59
                    and deviation_ma5_sopra_ma25 > 0.21
                    
                    and deviation_correzione > 0.015
                    and deviation_buy_ma5_sopra_ma20 > 0.14
                    and deviation_ma5_sotto_ma200 > -1.00
                ):    
           
                    buy = "BUY 4A PAZZA DURANTE UNA piccola CORREZIONE che non e' un forte ribasso e non e' un crollo ! con deviation_correzione > 0.02 - r 7100"
                    action = "buy"
                    percentage = 70
                    
                    # capita a volte il buy 4. fai attenzione! (se BUY 4 sta sotto ma78 e' un caso particolare !)

                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # ma5 non deve allontanarsi troppo dalla ma200 !
                    
                    
                    
              
            ############################################################################################################  compra sessione 5 in poi
            
            #################################################### ATTENZIONE! HO MESSO and ma78_last > ma150_last (50>100 non e' stata sufficiente)
            
            #################################################### STIAMO AL BUY 5 PERDIO !
            
            
            

            # 12 set 2024 CANCELLATA r 7144 A1 X NUOVA ERA A1 SOFT

            
            else: 
                if (    
                    ma3_last > ma13_last
                    and ma10_last > ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con 3-20 and 450>= 450_120_min_ago e 5-28 > 0.02 e 50 > 450 and ma2_dif_ma5 > 8 - r 7144 A1 X NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 70

                
                elif (    
                    ma3_last > ma13_last
                    and ma10_last > ma30_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > 0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 X NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 70


                
                elif (    
                    ma3_last > ma13_last
                    and ma39_last > ma39_5_min_ago
                    and ma3_last > ma30_last
                    and ma100_last > ma100_5_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.005
                    and deviation_ma3_sopra_ma16 > 0.005
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.017
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago e 50 > 450 and ma2_differenza_ma5 > 5 - r 7144 A1 X NUOVA ERA A3 SOFT x"
                    action = "buy"
                    percentage = 70

                    # 02 SET 2024 RO CANO E' TORNATO



                elif (    
                    ma3_last > ma13_last

                    and (ma20_last < ma50_last or ma39_last < ma100_last)
                    and ma39_last < ma39_5_min_ago
                    and ma450_last >= ma450_120_min_ago

                    and deviation_ma39 < -0.13
                    and deviation_ma3_sotto_ma50 < -0.40
                    
                    and ma50_last > ma450_last
                    
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50

                    and deviation_ma3_sopra_ma10 > 0.005
                    
                    and macd_differenza_2_min_ago > -18.00
                ):
                    buy = f"BUY 5 {ma450_last} {ma450_120_min_ago} con 3-13 E 450_last > 450 2 ore MA RITRACCIA e con 3-50 < -0.40 - r 7144 A1 X NUOVA ERA A3 SOFT y"
                    action = "buy"
                    percentage = 70
                    
                    # 24 feb 2024 se ma39 < ma39 5 min ago sta ritracciando CAZZO
                    # 11 apr 2025 anticipato ndecchiecella
                    # 14 apr 2025 RITRACCIAMENTO
                    # 14 apr 2025 aumentata 3-50 e 3-39
                    # 14 apr 2025 correzione or e aggiunta f
                    #  7 mag 2025 dev 3-50 a -0.40 da -0.13


                # 24 nov 2024 cancellata r 7144 A1 X NUOVA ERA A3 SOFT z1
                

                elif (    
                    ma3_last > ma13_last
                    and deviation_ma39 < -0.15
                    and ma100_last > ma100_5_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.005
                    and deviation_ma3_sopra_ma16 > 0.005
                    
                    and ma2_last >= ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.017
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con dev_ma39 < -0.15 and 450_last >= 450_120_min_ago e 50 > 450  - r 7144 A1 X NUOVA ERA A3 SOFT z2"
                    action = "buy"
                    percentage = 70
                    
                    #  9 feb 2024 IMPORTANTE ! solo BUY 5 NUOVA ERA A3 SOFT con ma100> ma100 5 min ago !!!
                    # 24 feb 2024 tolto and ma3_last > ma30_last e aggiunto incrocio al rialzo 3-140

                   
                elif (    
                    ma3_last > ma13_last
                    and ma3_last > ma30_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > 0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 X NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70

                elif (    
                    ma3_last > ma13_last
                    and ma10_last > ma30_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > 0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 X NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70

                elif (    
                    ma3_last > ma13_last
                    and ma10_last > ma30_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > 0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 X NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70

                
                elif (    
                    ma3_last > ma13_last
                    and ma3_last > ma30_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and ma2_differenza_ma5 > 5
                    and macd_differenza_2_min_ago > 0.10
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > 0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 X NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    #  6 feb 2024 anticipato buy

              

              

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma10_last < ma30_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    and ma50_differenza_ma59 > -5
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.30
                    
                    and ma2_differenza_ma5 > 8
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma10_last < ma30_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    and ma50_differenza_ma59 > -5
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.30
                    
                    and ma2_differenza_ma5 > 8
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y1 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 70

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 
                    
                    and ma10_last < ma30_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    and ma50_differenza_ma59 > -5
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.30
                    
                    and ma2_differenza_ma5 > 8
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y1 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 70

                

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma10_last < ma30_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    and ma50_differenza_ma59 > -5
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.30
                    
                    and ma2_differenza_ma5 > 8
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70

                

                elif (    
                    ma3_last > ma20_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma10_last < ma30_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    and ma50_differenza_ma59 > -5
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.30
                    
                    and ma2_differenza_ma5 > 8
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma10_last < ma30_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    and ma50_differenza_ma59 > -5
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.30
                    
                    and ma2_differenza_ma5 > 8
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70



                # 8 set 2024 CANCELLATA r 7144 A1 Y1 NUOVA ERA A3 SOFT


                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma10_last < ma30_last
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    and ma50_differenza_ma59 > -5
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    
                    and macd_differenza_2_min_ago > 0.30
                    
                    and ma2_differenza_ma5 > 8
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    # 15 gen 2024 se 50 vicinissima anche un poco sotto alla 59 compra prima (ma450 sale da 2 ore)

              


                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20

                    and ma10_last < ma30_last
                    and ma50_differenza_ma59 < -5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 8
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y2 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70

                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last

                    and ma10_last < ma30_last
                    and ma50_differenza_ma59 < -5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    
                    
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y2 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 70

                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60

                    and ma10_last < ma30_last
                    and ma50_differenza_ma59 < -5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 8
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y2 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 70


                 
                elif (
                    ma3_last > ma8_last
                    and ma50_last < ma50_2_min_ago
                    and delta_DNA_1 < delta_DNA_2
                    
                    and delta_50_39 < delta_50_39_30_min
                    and delta_450_300 < delta_450_300_60_min

                    and ma10_last <= ma20_last
                
                
                    and deviation_ma39 < 0.07
                    and deviation_sell < -0.01
                    and deviation_ma3_sotto_ma50 < -0.08

                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    and ma5_last <= ma100_last
                    and deviation_ma100_sopra_ma300 > 0.20
                    
                
                    and deviation_ma3_sotto_ma150 > -1.20
                
                    and (ma10_last < ma30_last or ma20_last < ma50_last)
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 5 con delta DNA 1< DNA 2 - GIORNO - and 20<50 RITRACCIAMENTO - r 7144 A1 Y2 NUOVA ERA A3 SOFT xX 1 xX 1"
                    action = "buy"
                    percentage = 70

                    #  7 feb 2025 aggiunta 200>300
                    # 27 feb 2025 se ma10_last < ma30_last vuol dire che sta curcando verso il basso
                    # 27 feb 2025 con aggiunta di delta_1 < delta_2 (giorno) non faccio comprare !
                    # 28 feb 2025 GIORNO
                    # 16 apr 2025 and deviation_ma3_sotto_ma50 < -0.01
                    #  8 mag 2025 deviation_ma3_sotto_ma50 a -0.12 da -0.05
                    # 26 mag 2025 modificata 




                elif (    
                    ma3_last > ma18_last

                    and (ma10_last < ma30_last or ma20_last < ma50_last)
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.20

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 > delta_DNA_2

                    and ma200_last > ma300_last

                    and ma450_last >= ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma100_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and macd_differenza_2_min_ago > -18.25
                
                ):
                    buy = f"BUY 5 con 450_last >= 450_360_min_ago E ma200>ma300 - NOTTE - r 7144 A1 Y2 NUOVA ERA A3 SOFT xX 1 xX 2 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    
                    action = "buy"
                    percentage = 70

                    #  7 feb 2025 aggiunta 200>300
                    # 27 feb 2025 se ma10_last < ma30_last vuol dire che sta curcando verso il basso
                    # 27 feb 2025 con aggiunta di delta_1 < delta_2 (giorno) non faccio comprare !
                    # 28 feb 2025 GIORNO
                    # 16 apr 2025 se ritraccia allora and deviation_ma5_sopra_o_sotto_ma100 < -0.01 and deviation_ma3_sotto_ma50 < -0.05
                    #  8 mag 2025 deviation_ma3_sotto_ma50 a -0.20 da -0.05
                    # 13 ott 2025 aggiunte parentesi graffe



                elif (    
                    ma3_last > ma13_last

                    and (ma10_last < ma30_last or ma20_last < ma50_last)
                    and (delta_DNA_1 <= delta_DNA_2 or delta_50_25_last < delta_50_25_30_min_ago)


                    and deviation_ma39 < -0.127
                    and deviation_ma3_sotto_ma50 < -0.123
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.30
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.10
                    
                    and (ma200_last > ma300_last or ma100_last > ma450_last)
                    and (ma300_last > ma300_60_min_ago and ma450_last >= ma450_120_min_ago or ma450_last > ma450_360_min_ago)
                    
                    and ma2_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                
                ):
                    buy = f"BUY 5 con 450_last >= 450_360_min_ago E ma200>ma300 + DNA - GIORNO ma ritracciamento - r 7144 A1 Y2 NUOVA ERA A3 SOFT xX 1 xY 1 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 70

                    #  7 feb 2025 aggiunta 200>300
                    # 27 feb 2025 se ma10_last < ma30_last vuol dire che sta curcando verso il basso
                    # 27 feb 2025 con aggiunta di delta_1 < delta_2 (giorno) non faccio comprare !
                    # 28 feb 2025 aggiunta DNA - NOTTE
                    # 16 apr 2025 tolta and delta_1 < delta_2
                    # 16 apr 2025 se and delta_DNA_1 < delta_DNA_2 tolgo and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    # 16 apr 2025 se and delta_DNA_1 < delta_DNA_2 and deviation_ma3_sotto_ma50 a -0.05 da -0.22
                    #  3 giu 2025 se ritracciamento deviation_ma5_sopra_o_sotto_ma100 < -0.06
                    # 17 ott 2025 anticipata ndecchiecella
                    # 17 ott 2025 aggiunte pg


                elif (    
                    ma3_last > ma18_last

                    and (ma10_last < ma30_last or ma20_last < ma50_last)
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01

                    and ma450_last > ma450_360_min_ago

                    and delta_DNA_1 > delta_DNA_2
                    and deviation_ma3_sotto_ma50 < -0.22

                    and ma200_last > ma300_last


                    and ma450_last >= ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma100_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and ma3_last > ma13_last
                    and ma2_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -13.25
                
                ):
                    buy = "BUY 5 con 450_last >= 450_360_min_ago E ma200>ma300 + DNA - NOTTE - r 7144 A1 Y2 NUOVA ERA A3 SOFT xX 1 xY 2"
                    action = "buy"
                    percentage = 70

                    #  7 feb 2025 aggiunta 200>300
                    # 27 feb 2025 se ma10_last < ma30_last vuol dire che sta curcando verso il basso
                    # 27 feb 2025 con aggiunta di delta_1 < delta_2 (giorno) non faccio comprare !
                    # 28 feb 2025 aggiunta DNA - NOTTE
                    # 16 apr 2025 tolta and delta_1 < delta_2




                elif (    
                    ma3_last > ma20_last
                    
                    and deviation_ma200_sotto_ma300 < -0.17
                    and ma300_last < ma300_60_min_ago
                    and deviation_ma39 < -0.02

                    and ma450_last >= ma450_120_min_ago
                    and ma100_last > ma450_last
                    
                    and ma10_last < ma30_last
                   
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    
                    and ma3_last > ma13_last
                    and ma3_last > ma5_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd > -70
                    and macd_differenza_2_min_ago > -3.25
                
                ):
                    buy = "BUY 5 con 450_last >= 450_120_min_ago MA ma200<ma300 E ma39 > ma39 20 min ago ! - r 7144 A1 Y2 NUOVA ERA A3 SOFT xX 2"
                    action = "buy"
                    percentage = 70

                    #  7 feb 2025 aggiunta questa condizione. attenzione ! COMINCIA LA DISCESA !



                elif (    
                    ma3_last > ma20_last

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.085
                    and deviation_ma300_sopra_ma450 > -0.085

                    and ma39_last < ma39_20_min_ago
                    and deviation_ma39 < -0.17

                    and ma450_last >= ma450_120_min_ago
                    and ma100_last > ma450_last
                    
                    and ma10_last < ma30_last
                   
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    
                    and ma3_last > ma13_last
                    and ma3_last > ma5_last
                    
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -3.25
                
                ):
                    buy = "BUY 5 con 450_last >= 450_720_min_ago E ma100>ma450 MA ma39 < ma39 20 min ago ! - r 7144 A1 Y2 NUOVA ERA A3 SOFT XY 1"
                    action = "buy"
                    percentage = 70

                    # 29 gen 2025 INCOMINCIO A RISOLVERE IL PROBLEMA DEL TREND LATERALE dopo un grande RIALZO !
                    # 29 gen 2025 AGGIUNTA and ma450_last > ma450_720_min_ago
                    # 29 gen 2025 tolto and ma2_last > ma2_2_min_ago
                    # 30 gen 2025 IN QUEL CORRIDOIO 300-450 posso comprare prima




                elif (    
                    ma3_last > ma15_last

                    and (ma20_last < ma50_last or ma10_last < ma30_last or ma39_last < ma39_20_min_ago)
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma100_last > ma450_last

                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma39 < -0.17

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15

                    and ma450_last < ma450_720_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    
                    and ma2_last > ma10_last
                    and ma3_last > ma5_last
                    
                    and macd_differenza_2_min_ago > -6.25
                ):
                    buy = f"BUY 5 {ma450_last} {ma450_120_min_ago} con 450<720 MA 450> 120 min - RITRACCIA - r 7144 A1 Y2 NUOVA ERA A3 SOFT XY 2"
                    action = "buy"
                    percentage = 70
                    
                    # 14 ott 2024 anticipata con 450 che sale da 120 min NON FARTI TROPPI PROBLEMI. PROVACI.
                    # 29 ott 2024 se ma39_last < ma39_20_min_ago allora aggiungi UNA SPECIE DI OSSO (and deviation_ma39 < -0.17)

                    # 29 gen 2025 INCOMINCIO A RISOLVERE IL PROBLEMA DEL TREND LATERALE dopo un grande RIBASSO !
                    #  8 apr 2025 se 20<50 aggiungo le basi del ritracciamento
                    # 11 apr 2025 correzione or e aggiunta f



                elif (    
                    ma3_last > ma10_last
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.37
                    and deviation_ma50_sotto_ma300 < -0.27
                    and deviation_ma39 < -0.13
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    and deviation_ma5_sotto_ma450 < -0.51

                    and ma450_last >= ma450_120_min_ago
                    and ma100_last > ma450_last

                    and ma10_last < ma30_last
                  
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and macd_differenza_2_min_ago > -3.25
                
                ):
                    buy = "BUY 5 con 450_last >= 450_120_min_ago E ma100>ma450 MA 39<100 + DNAM - r 7144 A1 Y2 NUOVA ERA A3 SOFT y"
                    action = "buy"
                    percentage = 70
                    
                    #  7 feb 2024 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.021 da > 0.02
                    #  7 feb 2024 aggiunto and ma3_last > ma5_last
                    #  7 feb 2024 aggiunta and ma3_last >= ma3_2_min_ago
                    #  9 feb 2024 IMPORTANTE ! solo BUY 5 NUOVA ERA A3 SOFT con ma100> ma100 5 min ago !!!
                    #  6 ott 2024 ANTICIPATA ! anche ma100 > ma450 ! a chi cazzo aspetti !
                    #  8 dic 2024 aggiunta DNAM

                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50

                    and ma10_last < ma30_last
                    and ma50_differenza_ma59 < -5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 8
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y2 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70

                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22

                    and ma10_last < ma30_last
                    and ma50_differenza_ma59 < -5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 8
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y2 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70
                    

                elif (    
                    ma3_last > ma20_last
                    
                    and ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60

                    and ma10_last < ma30_last
                    and ma50_differenza_ma59 < -5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 8
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y2 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70

              
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60

                    and ma10_last < ma30_last
                    and ma50_differenza_ma59 < -5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    and deviation_ma5_sopra_ma28 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma2_differenza_2_min_ago > 8
                    and ma2_differenza_ma5 > 8
                    and macd_differenza_2_min_ago > 0.30
                ):
                    buy = "BUY 5 con 3-20 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7144 A1 Y2 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    # 6 giu 2022 5-28 a 0.12 da 0.15
                    # > estate anticipo buy 5-28 0.08 da 0.12
                    # 29 gen 2023 anticipato ndecchiecella questo BUY 5 !
                    # 20 feb 2023 aggiunta 3-10 >0.058
                    # 16 set 2023 tolto and deviation_buy3 > 0.05
                    # 16 set 2023 aggiunta and macd > macd_2_min_ago
                    # 28 set 2023 se 450 > 450 120 min ago anticipato ndechiecella
                    # 17 ott 2023 and deviation_ma3_sopra_ma18 > 0.077
                    # 17 ott 2023 50>450 da 100>450
                    # 31 ott 2023 3-39 da 5-50
                    #  1 dic 2023 5-28 a 0.02 da 0.05
                    #  5 dic 2023 and ma2_differenza_ma5 > 8
                    #  8 dic 2023 dev_ma5_sopra_ma28 a 0.02 da -0.02
                    # 18 dic 2023 3-20 da 3-39
                    # 20 dic 2023 tolto and macd > macd_2_min_ago
                    # 20 dic 2023 aggiunta and macd_differenza_2_min_ago > 0.30
                    # 20 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    # 15 gen 2024 5-28 > -0.02 da 0.02


                elif (    
                    ma3_last > ma10_last
                    and ma39_last > ma100_last

                    and (ma3_prev < ma425_prev and ma3_last > ma425_last)
                    and ma50_differenza_ma59 < -5
                    and ma10_last < ma30_last
                    
                    and ma2_differenza_ma5 > 5
                    
                    and ma450_last >= ma450_120_min_ago
                    and ma50_last > ma450_last
                   
                    and deviation_ma3_sopra_ma10 > 0.01
                  
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.01
                    and macd_differenza_2_min_ago > -1.30
                ):
                    buy = "BUY 5 con inrocio al rialzo 3-425 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 - r 7144 A1 Y3 X"
                    action = "buy"
                    percentage = 70

                    # 29 set 2024 anticipata cazzo
                    # 29 set 2024 tolta and ma2_last >= ma2_2_min_ago e vaffanculo.


                elif (    
                    ma3_last > ma10_last
                    and ma39_last < ma100_last

                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80

                    and (ma3_prev < ma425_prev and ma3_last > ma425_last)
                    and ma50_differenza_ma59 < -5
                    and ma10_last < ma30_last
                    
                    and ma2_differenza_ma5 > 5
                    
                    and ma450_last >= ma450_120_min_ago
                    
                   
                    and deviation_ma3_sopra_ma10 > 0.01
                  
                    
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.01
                    and macd_differenza_2_min_ago > -1.30
                ):
                    buy = "BUY 5 con inrocio al rialzo 3-425 and 450_last >= 450_120_min_ago and 5-28 > -0.02 CON 50 > 450 - r 7144 A1 Y3 Y"
                    action = "buy"
                    percentage = 70

                    # 29 set 2024 anticipata cazzo
                    # 29 set 2024 tolta and ma2_last >= ma2_2_min_ago e vaffanculo.
                    # 17 nov 2024 se 39<100 interviene zia amalia grafana



                elif (    
                    ma3_last > ma20_last

                    and ma39_last > ma39_30_min_ago
                    

                    and ma450_last < ma450_120_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma50_last < ma50_2_min_ago
                    
                    and ma10_last > ma20_last
                    and ma200_last > ma300_last

                    
                  
                    and deviation_ma100_sopra_ma300 < 0.40
                   
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma13_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > -3.50
                    
                ):
                    buy = "BUY 5 ma450_last < ma450_120_min_ago E 200>300 E 100>200 E 39>39 30 min ago - r 7144 A2 X1Aa 1"
                    action = "buy"
                    percentage = 70




                elif (    
                    ma3_last > ma20_last

                    and ma450_last < ma450_480_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.025
                    and ma39_last < ma39_30_min_ago
                    and deviation_ma39_sotto_ma100 < -0.27
                    
                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25

                    and ma450_last < ma450_120_min_ago
                    and ma50_last < ma50_2_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma13_last
                   
                    and macd_differenza_2_min_ago > -3.50
                    
                ):
                    buy = "BUY 5 con ma450_last < ma450_480_min_ago e ma39 < ma39 30 min ago + specie di osso - r 7144 A2 X1 AA 2"
                    action = "buy"
                    percentage = 80




                elif (    
                    ma3_last > ma20_last
                    and ma450_last < ma450_120_min_ago
                    
                    and ma39_last < ma100_last
                    
                    and deviation_ma25_sotto_ma300 < -0.27
                    and deviation_ma50_sotto_ma300 < -0.15
                    and deviation_ma39 < -0.03
                    and deviation_ma3_sotto_ma50 < -0.05
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    and deviation_ma5_sotto_ma200 < -0.25
                    and deviation_ma5_sotto_ma300 < -0.25
                    and deviation_ma5_sotto_ma450 < -0.55
                    
                    and ma50_last < ma50_2_min_ago

                    and ma200_last > ma300_last
                    
                    and deviation_ma100_sopra_ma300 < 0.40
                   
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma13_last
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -3.50
                    
                ):
                    buy = "BUY 5 con ma450_last<ma450 120_min E ma200>ma300 MA SE ma100<ma100 60 min ago IL CANE VUOLE L' OSSO ! - r 7144 A2 X1 AB"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se ma10 < ma20 
                    # 29 set 2024 anticipata di molto prima di cancellare
                    #  6 ott 2024 con 200>300 anticipata ancora NON FARTI TROPPI PROBLEMI !
                    #  8 ott 2024 SE ma100<ma100 60 min ago IL CANE VUOLE L' OSSO !
                    #  5 gen 2024 aggiunta DNAM



                elif (    
                    ma3_last > ma18_last

                    and deviation_ma3_sotto_ma50 < -1.00

                    and ma450_last < ma450_120_min_ago
                    and ma200_last < ma300_last
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.22
                    and deviation_ma50_sotto_ma300 < -0.22

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma5_sotto_ma200 < -0.13
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma5_sotto_ma450 < -0.21
                    and deviation_ma300_sopra_ma450 < -0.072

                    and ma50_last < ma50_2_min_ago

                    and deviation_ma100_sopra_ma300 < 0.25
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma8_last
                    
                    and macd_differenza_2_min_ago > -8.50
                    
                ):
                    buy = "BUY 5 ma450_last < ma450_120_min_ago con DNAM + distanza al ribasso - r 7144 A2 X1Bx"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se ma10 < ma20 
                    # 29 set 2024 anticipata di molto prima di cancellare
                    #  2 dic 2024 aggiunta DNAM
                    #  5 gen 2025 aggiunta and deviation_ma300_sopra_ma450 < -0.072
                    #  5 gen 2025 tolta ma2 > ma2 2 min ago
                    # 21 mar 2025 aggiunta distanza al ribasso
                    #  7 apr 2025 e' andata BENISSIMO !
                    #  7 apr 2025 ma ho portato 3-50 < -1.00 da -0.30 ( sul mercato era -1.63 !)



                elif (    
                    ma3_last > ma20_last
                    and ma10_last > ma20_last

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma25_sotto_ma300 < -0.11

                    and ma450_last < ma450_120_min_ago
                    and ma200_last < ma300_last
                    and ma50_last < ma50_2_min_ago

                    and ma100_last > ma200_last
                    and ma100_last > ma100_120_min_ago

                    and deviation_ma100_sopra_ma300 < 0.25
                    and deviation_ma39 < 0.05
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma13_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > -0.50
                    
                ):
                    buy = "BUY 5 ma450_last < ma450_120_min_ago MA ma100_last > ma200_last E 100>200 MA 100<100 10 min ago + OSSO - r 7144 A2 X1By"
                    action = "buy"
                    percentage = 70
                    
                    #  5 mar 2024 se ma10 < ma20 
                    # 29 set 2024 anticipata di molto prima di cancellare
                    # 14 ott 2024 se 100<100 10 min ago AGGIUNGO L' OSSO



                elif (    
                    ma3_last > ma30_last
                    and ma10_last < ma20_last
                    and deviation_ma5_sotto_ma200 < -0.30
                    and ma450_last < ma450_120_min_ago
                    
                    and ma39_last > ma100_last
                    and ma100_last > ma200_last
                    and ma100_last > ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.02
                    
                    and ma2_last > ma5_last
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018 
                    and ma3_last > ma3_2_min_ago
                    
                    and macd_differenza_2_min_ago > 0.20
                    and macd_differenza_2_min_ago > 0.50
                    
                ):
                    buy = "BUY 5 con ma450_last < ma450_120_min_ago e ma100_last > ma300_last E 100>200 and macd > macd_2_min_ago - r 7144 A2 X2"
                    action = "buy"
                    percentage = 70
                    
                    # 3-30 da 4-50 se 100>200
                    # 13 gen 2024 aggiunta 2 > 5
                    # 31 gen 2024 39>100 al posto di 50>59

                    #  5 mar 2024 se ma10 < ma20 con ma450 che scende deve essere anche and ma3_last > ma3_2_min_ago
                    #  5 mar 2024 qua potrai aggiugere se 39 < 39 15 min ago il pugno fantasma e prendere il coltello con il piede
                    #  2 ott 2024 al BUY 5 se 450 < aggiunto and deviation_ma5_sotto_ma200 < -0.30

                
                elif (    
                    ma4_last > ma50_last
                    and deviation_ma5_sotto_ma200 < -0.25
                    and ma450_last < ma450_120_min_ago
                    and ma100_last <= ma200_last
                    
                    and ma50_last > ma59_last
                    and ma100_last > ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last > ma2_2_min_ago
                    and macd_differenza_2_min_ago > 0.20
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 5 con ma450_last < ma450_120_min_ago CON ma100_last > ma300_last MA 100<200 and macd > macd_2_min_ago - r 7144 A2y"
                    action = "buy"
                    percentage = 70
                    
                    # 6 giu 2022 5-28 a 0.12 da 0.15
                    
                    # > estate anticipo buy 5-28 0.08 da 0.12
                    # 29 gen 2023 anticipato ndecchiecella questo BUY 5 !
                    # 20 feb 2023 aggiunta 3-10 >0.058
                    # 16 set 2023 tolto and deviation_buy3 > 0.05
                    # 16 set 2023 aggiunta and macd > macd_2_min_ago
                    # 28 set 2023 aggiunta 450 < 450 120 min ago
                    #  2 ott 2024 se 450< al BUY 5 AGGIUNTO and deviation_ma5_sotto_ma200 < -0.25



        
                elif (
                    ma50_last < ma50_2_min_ago

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.085
                    and deviation_ma300_sopra_ma450 > -0.085
                    
                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma300_last
                    and ma78_last > ma150_last
                    
                    and deviation_ma5_sopra_ma28 > 0.05
                    and deviation_ma7_sopra_ma40 > 0.06
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -2
                ):
                    buy = "BUY 5 con ma450 > 12 ore e 50>100 and ma28_last > ma28_30_min_ago CON ma100_last > ma300_last - r 7144 B1"
                    action = "buy"
                    percentage = 70

                    # 29 gen 2025 and ma450_last > ma450_720_min_ago (problema trend laterale dopo un grande RIALZO)
                    # 29 gen 2025 tolto and ma2_last > ma2_2_min_ago
                    # 30 gen 2025 IN QUEL CORRIDOIO 300-450 posso comprare prima


                elif (
                    ma3_last > ma13_last

                    and ma5_last > ma150_last
                    and (ma3_last < ma20_last or ma20_last < ma20_2_min_ago or ma33_last < ma33_3_min_ago)

                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.05

                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma300_last

                    and ma450_last < ma450_720_min_ago
                    and ma50_last < ma50_2_min_ago

                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 5 {ma450_last} {ma450_720_min_ago} con ma450 < 12 ore MA 300 > 6 ore e RITRACCIA - r 7144 B2"
                    action = "buy"
                    percentage = 70
                    
                    # 6 giu 2022 5-28 a 0.12 da 0.15
                    
                    # > estate anticipo buy 5-28 0.08 da 0.12
                    # 29 gen 2023 anticipato ndecchiecella questo BUY 5 !
                    # 20 feb 2023 aggiunta 3-10 >0.058
                    # 16 set 2023 tolto and deviation_buy3 > 0.05
                    # 16 set 2023 aggiunta and macd > macd_2_min_ago
                    # 28 set 2023 con ma50< ma50 2 min ago MA con ma300>ma300 301 min ago

                    # 29 gen 2025 and ma450_last > ma450_720_min_ago (problema trend laterale dopo un grande RIALZO)
                    # 21 mar 2025 anticipata
                    # 27 mar 2025 con ma5 ancora sopra ma150 ma se ritraccia (vedi ma20 e ma33) allora compra con deviation_ma39 < -0.12
                    # 11 apr 2025 correzione or e aggiunta f


                elif (
                    ma3_last > ma13_last

                    and ma20_last > ma40_last

                    and ma450_last > ma450_720_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    
                    and deviation_ma100_sopra_ma300 > -0.10
                    and deviation_ma300_sopra_ma450 > -0.11

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.02

                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -12.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_720_min_ago e con ma200> e MA 20<40- r 7145 AX 1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 28 giu 2025 aggiunta questa. 450 sale da 720 min scende  ma la 100 sta ancora vicina alla 300
                    # 10 ago 2025 con 100> 2 ore
                    # 14 ago 2025 se 100 > 1 ora ok cosi'
                    # 21 ott 2025 se ma20_last > ma40_last ok cosi'
                    # 21 ott 2025 AGGIUNGO PG



                elif (
                    ma3_last > ma13_last

                    and ma20_last < ma40_last

                    and deviation_ma39 < -0.50 
                    and deviation_ma3_sotto_ma50 < -0.58
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.80
                    
                    and ma450_last > ma450_720_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    
                    and deviation_ma100_sopra_ma300 > -0.10
                    and deviation_ma300_sopra_ma450 > -0.11

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.02

                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_720_min_ago e con ma200> MA 20<40 + deviation profonde - r 7145 AX 2x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 28 giu 2025 aggiunta questa. 450 sale da 720 min scende  ma la 100 sta ancora vicina alla 300
                    # 10 ago 2025 con 100> 2 ore
                    # 14 ago 2025 se 100 > 1 ora ok cosi'
                    # 21 ott 2025 se ma20_last < ma40_last aggiungo deviation profonde
                    # 21 ott 2025 AGGIUNGO PG



                elif (
                    ma3_last > ma13_last

                    and ma20_last < ma40_last

                    and deviation_ma39 < -0.10 
                    and deviation_ma3_sotto_ma50 < -0.10
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago
                    
                    and ma450_last > ma450_720_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma100_last > ma100_120_min_ago
                    
                    
                    and deviation_ma100_sopra_ma300 > -0.10
                    and deviation_ma300_sopra_ma450 > -0.11

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.02

                    
                    and ma3_last > ma7_last
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_720_min_ago e con ma200> MA 20<40 + CM GIORNO - r 7145 AX 2y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90

                    # 28 giu 2025 aggiunta questa. 450 sale da 720 min scende  ma la 100 sta ancora vicina alla 300
                    # 10 ago 2025 con 100> 2 ore
                    # 14 ago 2025 se 100 > 1 ora ok cosi'
                    # 21 ott 2025 se ma20_last < ma40_last aggiungo CM GIORNO !
                    # 21 ott 2025 AGGIUNGO PG




                elif (
                    ma3_last > ma13_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.35)

                    and ma100_last > ma100_120_min_ago

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma100_sopra_ma300 > -0.10
                    and deviation_ma300_sopra_ma450 > -0.11

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.02

                    and ma3_last > ma7_last
                    
                    and macd_differenza_2_min_ago > -12.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_720_min_ago e con ma200> + e 100 > 2 ore MA 100<1 ora + IL MIO CAPOLAVORO - r 7145 AY"
                    action = "buy"
                    percentage = 90

                    # 28 giu 2025 aggiunta questa. 450 sale da 720 min scende  ma la 100 sta ancora vicina alla 300
                    # 10 ago 2025 con 100> 2 ore
                    # 14 ago 2025 se ma100_last < ma100_60_min_ago or delta_CV_300_25 NOTTE aggiungo IL MIO CAPOLAVORO




                elif (
                    ma3_last > ma13_last

                    and ma100_last < ma100_120_min_ago
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma100_sopra_ma300 > -0.10
                    and deviation_ma300_sopra_ma450 > -0.11

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.02

                    and ma3_last > ma7_last
                    
                    and macd_differenza_2_min_ago > -12.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_720_min_ago e con ma200> MA 100 < ore and CM GIORNO - r 7145 b"
                    action = "buy"
                    percentage = 90

                    # 28 giu 2025 aggiunta questa. 450 sale da 720 min scende  ma la 100 sta ancora vicina alla 300
                    # 10 ago 2025 se 100< 2 ore allora CM deve eesere GIORNO


                   
                elif (     
                    ma3_last > ma13_last
                    and deviation_ma78_sopra_o_sotto_ma200 > -0.028
                    and ma2_differenza_2_min_ago > 3
                    
                    and ma100_last < ma100_120_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.37
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                    and macd_differenza_2_min_ago > 0.50
                    and macd > -40
                    and ma50_differenza_ma59 > -5
                    
                ):    
                    buy = "BUY 5 compare forever con 100<120 min ago E 100<60 min ago con 5-20 MA CON 300 vicina alla 450 + MACD > E ma50_diff_ma59 > -5 - r 7146"
                    action = "buy"
                    percentage = 90

                    #  10 ago 2025 importata da ro cano che ritorna perche' e' andata benissimo. mentre maddog non aveva comprato proprio.




                elif (
                    ma3_last > ma13_last

                    and (ma20_last < ma50_last or ma39_last < ma100_last)

                    and ma450_last > ma450_360_min_ago
                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma100_60_min_ago

                    and ma100_last > ma200_last
                    and ma300_last > ma450_last

                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40

                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    
                    and delta_1 > delta_2
                    
                    and ma3_last > ma9_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 5 {ma450_last} {ma450_720_min_ago} con 450> SE RITRACCIA - r 7150 a"
                    action = "buy"
                    percentage = 80
                    
                    # 21 ott 2023 and macd < macd_2_min_ago - SE MACD DISCENDENTE IL BUY LO FACCIO PIU' ALTO ! - C'E' MA NON SI VEDE
                    # 15 nov 2022 aggiunta and ma2_differenza_2_min_ago > 5 ( ma2 > ma2 min non l' ha letta !) ( allora metto un rafforzativo )
                    # 23 mar 2025 aggiunta se delta_1 > delta_2 allora deviation_ma3_sotto_ma50 < -0.04
                    # 24 mar 2025 aggiunta questa ! ma300 sale da 6 ore ! e ma100 > ma200 !
                    # 29 mar 2025 se ritraccia con 450 >
                    #  1 apr 2025 se ritraccia pesante
                    # 11 apr 2025 correzione or e aggiunta f

                    
                       
                elif (
                    ma3_last > ma13_last

                    and ma450_last < ma450_720_min_ago
                    and ma20_last < ma50_last
                    and delta_1 > delta_2
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.10

                    and ma300_last > ma300_301_min_ago
                    and ma100_last > ma200_last

                    and ma3_last > ma9_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 NOTTE con 300> E ma100>ma200 - SE RITRACCIA - r 7150 b"
                    action = "buy"
                    percentage = 70
                    
                    # 21 ott 2023 and macd < macd_2_min_ago - SE MACD DISCENDENTE IL BUY LO FACCIO PIU' ALTO ! - C'E' MA NON SI VEDE
                    # 15 nov 2022 aggiunta and ma2_differenza_2_min_ago > 5 ( ma2 > ma2 min non l' ha letta !) ( allora metto un rafforzativo )
                    # 23 mar 2025 aggiunta se delta_1 > delta_2 allora deviation_ma3_sotto_ma50 < -0.04
                    # 24 mar 2025 aggiunta questa ! ma300 sale da 6 ore ! e ma100 > ma200 !
                    # 29 mar 2025 se ritraccia con 450 <



                    

                
                elif (
                    ma8_last > ma8_2_min_ago

                    and ma100_last < ma100_30_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma450_last < ma450_10_min_ago
                    
                    and ma100_last < ma300_last
                    and ma100_last < ma200_last

                    and delta_1_69_39 > delta_2_69_39
                    
                    and deviation_ma39 < -0.03
                    and deviation_ma3_sotto_ma50 < -0.05
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.80
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.083

                    and deviation_ma100_sopra_ma200 > -0.70
                    and deviation_ma100_sopra_ma300 < 0.50

                    and ma3_last > ma6_last
                    and ma2_last > ma2_2_min_ago
              
                ):

                    buy = f"BUY 5 con 450 < and dev_sell < -0.025 ex CS - r 7170 - deviation_ma39 {deviation_ma39:.2f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    #  8 ott 2025 aggiunta questa da un sell con aggiunta dei dati preziosi delle parentesi graffe
                    #  9 OTT 2025 CHE BELLO ! POSSO CONOSCERE I VALORI DENTRO LE PARENTESI GRAFFE !
                    #  9 ott 2025 and deviation_ma25_sotto_ma300 < -0.80 ! e' questa che ha fatto la differenza !
                    #  9 ott 2025 ho messo :.2f nella SOLO nella prima parentesi graffa per vedere se funziona.
                    #  9 ott 2025 ho messo :.3f nella SOLO nella seconda parentesi graffa per vedere se funziona.
                    # 15 ott 2025 e' andata benissimo
                    # 15 ott 2025 madonna compa ! funziona :.2f e :.3f ! grazie compa !


                elif (
                    ma78_last < ma150_last
                    and ma5_last > ma200_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.23
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.057
                    and deviation_ma3_sopra_ma16 > 0.06
                    and deviation_ma5_sopra_ma28 < 0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 5 oggi 7 feb 2024 > 180 min di ribasso 78<150 and 3-16 > 0.06 and macd > macd 2 min ago - r 7200"
                    action = "buy"
                    percentage = 90

                    #  9 set 2024 e' un buy 5 e scende tutto ho aggiunto 5>200 MA FORSE VA CANCELLATA

                elif (
                    ma50_last >= ma50_2_min_ago
                    and ma100_last > ma125_last
                    and ma300_last > ma450_last
                    
                    and ma28_last < ma28_30_min_ago
                    and deviation_ma5_sopra_o_sotto_ma5_120_min_ago > 0.80
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30

                    and ma78_last > ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.077
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                ):
                    buy = "BUY 5 con ma50 > AND 50>100 and ma28_last < ma28_30_min_ago and 5-28 > 0.08 - r 7203 A1x"
                    action = "buy"
                    percentage = 70

                    # 23 set 2024 quando sale e ma28 scende FACCIO COMPRARE SOLO PRENDENDO IL COLTELLO CON IL PIEDE 



                    # 25 set 2024 cancellata r 7203 A1y

                elif (
                    ma50_last >= ma50_2_min_ago
                    and ma300_last > ma450_last
                    and ma100_last > ma100_120_min_ago

                    and ma28_last < ma28_30_min_ago

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma25_sotto_ma300 < -0.11


                    and ma3_last < ma28_last
                    and deviation_ma39 < 0.10
                    
                    and deviation_ma5_sotto_ma200 > -0.70
                    and deviation_ma100_sopra_ma300 < 0.40
                
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.05
                    and deviation_ma5_sopra_ma28 > -0.08
                    
                    and ma3_last > ma13_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > macd_2_min_ago
                    and macd > -50

                ):
                    buy = "BUY 5 con ma300 > ma450 AND ma28_last < ma28_30_min_ago + OSSO - r 7203 A2x"
                    action = "buy"
                    percentage = 70

                    # 14 ott 2024 gli ho dato un osso - prima di cancellare

                


                elif (
                    ma50_last >= ma50_2_min_ago
                    and ma300_last > ma450_last

                    and ma100_last < ma100_120_min_ago
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.37
                    and deviation_ma50_sotto_ma300 < -0.27
                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    and deviation_ma5_sotto_ma450 < -0.51
                    and deviation_ma300_sopra_ma450 < -0.072

                    and ma28_last < ma28_30_min_ago
                    and ma3_last < ma28_last
                    and deviation_ma39 < 0.10
                    
                    
                    and deviation_ma100_sopra_ma300 < 0.40
                
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.05
                    and deviation_ma5_sopra_ma28 > -0.08
                    
                    and ma3_last > ma13_last
                    
                    and macd > -50

                ):
                    buy = "BUY 5 con 300>450 AND ma28_last < ma28_30_min_ago + DNAM- r 7203 A2y"
                    action = "buy"
                    percentage = 70
                    
                    #  6 giu 2022 5-28 a 0.17 da 0.19
                    # 10 gen 2023 5-28 a 0.12 da 0.17
                    # 10 gen 2023 dev buy 3 a 0.06 da 0.07
                    # 10 gen 2023 dev 7-40 a 0.08 da 0.09
                    # aggiunta 3-10 a 0.05
                    # 26 feb 2023 se 300>450 buy 3 a 0.02 da 0.06
                    # 26 feb 2023 se 300>450 7 sopra 40 a 0.02 da 0.08
                    #  4 ott 2024 anticipata ndecchia prendendo ispirazione da un precedente sell CON 300 > 400 !
                    #  6 ott 2024 se 100 > 100 120 min ago ok come precedente
                    #  6 ott 2024 MA SE 100 < 100 120 min ago allora mi devi dare un osso (and deviation_ma5_sotto_ma450 < -0.33)



                elif (
                    ma50_last >= ma50_2_min_ago

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.085
                    and deviation_ma300_sopra_ma450 > -0.085

                    and ma100_last >= ma100_60_min_ago
                    and (ma3_prev < ma90_prev and ma3_last > ma90_last)
                    
                    and ma300_last < ma450_last
                    
                    and ma28_last < ma28_30_min_ago
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and ma3_last > ma13_last
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -1.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_720_min_ago e ma50> e 50>100 e ma28_last < ma28_30_min_ago - r 7203 B1 X"
                    action = "buy"
                    percentage = 70
                    
                    # 25 gen 2024 se ma100_last >= ma100_60_min_ago compra anche con 3-90
                    # 29 gen 2025 incomincio a risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 aggiunto and ma450_last > ma450_720_min_ago
                    # 29 gen 2025 tolto and ma2_last >= ma2_2_min_ago
                    # 29 gen 2025 aggiunto and macd > -60 e and macd_differenza_2_min_ago > -1.50
                    # 29 gen 2025 and ma7_last > ma25_last
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima




                       
                
                elif (
                    ma3_last > ma16_last
                    and delta_1_69_39 < delta_2_69_39

                    and deviation_ma39 < -0.15
                    and deviation_ma3_sotto_ma50 < -0.18
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.65
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.07 


                    and deviation_buy_crollo_1 < -0.29
                    and deviation_buy_crollo_1 > -0.99
                    
                    and deviation_ma5_sotto_ma200 > -1.20
                    
                    and ma450_last < ma450_720_min_ago
                    and ma300_last < ma450_last
                    
                    and ma28_last < ma28_30_min_ago
                    and deviation_ma5_sotto_ma450 < -0.99
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    and macd_differenza_2_min_ago > -18.30
                   
                ):
                    buy = f"""BUY 5 con ma450_last < ma450_720_min_ago e ma28_last < ma28_30_min_ago and delta_1_69_39 < delta_2_69_39 - r 7203 B1 Y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    deviation_buy_crollo_1 {deviation_buy_crollo_1:.2f} 
                    """
                    
                    action = "buy"
                    percentage = 70
                    
                    # 25 gen 2024 se ma100_last >= ma100_60_min_ago compra anche con 3-90
                    # 29 gen 2025 incomincio a risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 27 mag 2025 modificata per anticipare ndecchia
                    # 24 set 2025 aggiunta and delta_1_69_39 < delta_2_69_39
                    # 24 set 2024 deviation_buy_crollo_1 a -0.99 da > -0.80
                    # 16 ott 2025 aggiunte parentesi graffe - e' andata bene e voglio conoscere i valori delle deviation.

                
                
                elif (
                    ma50_last >= ma50_2_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    and ma300_last < ma450_last
                    
                    and ma28_last < ma28_30_min_ago
                    and ma78_last > ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.05
                    and deviation_ma3_sopra_ma16 > 0.165
                    and deviation_ma5_sopra_ma28 > 0.12
                    
                    and deviation_buy3 > 0.06
                    and deviation_ma7_sopra_ma40 > 0.08
                    
                  
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last >= ma2_2_min_ago
                
                ):
                    buy = "BUY 5 con ma50 > AND 50>100 and ma28_last < ma28_30_min_ago and 5-28 > 0.17 - r 7203 B2"
                    action = "buy"
                    percentage = 70
                    
                    #  6 giu 2022 5-28 a 0.17 da 0.19
                    # 10 gen 2023 5-28 a 0.12 da 0.17
                    # 10 gen 2023 dev buy 3 a 0.06 da 0.07
                    # 10 gen 2023 dev 7-40 a 0.08 da 0.09
                    # aggiunta 3-10 a 0.05
                    #  6 apr 2023 aggiunta 3-16 > 0.165





                    
                    
                    
                elif (
                        ma50_last >= ma50_2_min_ago

                        and delta_CM_300_25_last < delta_CM_300_25_2_min_ago
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        and deviation_ma10_sopra_ma200 < -0.25
                        and (ma4_prev < ma30_prev and ma4_last > ma30_last)
                        
                        and ma2_last > ma5_last
                        
                    ):
                        sell = "BUY 5 con 300 < 120 min E CON ma50> e incr 4-30 E GIORNO E dev_ma2_sopra_o_sotto_ma2_2_min < -0.02 - r 7215"
                        action = "sell"
                        
                        # 24 set 2025 aggiunto da un sell de RCCR perche' maddog non aveva comprato.
                        




                          
                elif (
                    ma5_last >= ma5_2_min_ago
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma300_sopra_ma450 > 0.10
                    and ma300_last > ma450_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd_differenza_2_min_ago > 1.5
                    and ma2_differenza_ma5 > 3
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > E 50<100 and 300 > 120 min ago e 5-28 > 0.23 and ma2_diff_2_min_ago > 10 - r 7237 A1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 70


                elif (
                    ma5_last >= ma5_2_min_ago
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma300_sopra_ma450 > 0.10
                    and ma300_last > ma450_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    
                    and macd_differenza_2_min_ago > -1.50
                    and ma2_differenza_ma5 > 3
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > E 50<100 and 300 > 120 min ago e 5-28 > 0.23 and ma2_diff_2_min_ago > 10 - r 7237 A1 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 70

                elif (
                    ma5_last >= ma5_2_min_ago
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma300_sopra_ma450 > 0.10
                    and ma300_last > ma450_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd_differenza_2_min_ago > 1.5
                    and ma2_differenza_ma5 > 3
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > E 50<100 and 300 > 120 min ago e 5-28 > 0.23 and ma2_diff_2_min_ago > 10 - r 7237 A1 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 70


                  

                elif (
                    ma3_last > ma18_last
                    and ma78_last < ma150_last
                    and ma100_last < ma100_120_min_ago

                    and ma100_last > ma100_300_min_ago
                    and ma300_last > ma300_120_min_ago

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma25_sotto_ma300 < -0.35
                    and deviation_ma50_sotto_ma300 < -0.35

                    and deviation_ma39 < 0.07
                    and deviation_ma3_sotto_ma50 < 0.03

                    and deviation_ma5_sopra_o_sotto_ma100 < 0.01
                    and deviation_ma5_sotto_ma200 < -0.15
                    and deviation_ma5_sotto_ma300 < -0.20
                    and deviation_ma5_sotto_ma450 < -0.25

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma13_last
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):
                    buy = "BUY 5 con 300 > 120 min ago MA ma78_last < ma150_last e DNAM + cuspide - r 7237 A1 NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 70
                    
                    #  9 feb 2024 IMPORTANTE ! solo BUY 5 NUOVA ERA A3 SOFT con ma100> ma100 5 min ago !!!
                    #  2 dic 2024 aggiunta DNAM
                    # 16 feb 2024 e' andata bene.
                    # 16 feb 2025 aggiunta cuspide - che se vedi c' era gia' in forma embrionale.
                    # 27 mag 2025 anticipata ndecchiecella. per tenerla.



                elif (
                    ma5_last >= ma5_2_min_ago
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma300_sopra_ma450 > 0.10
                    and ma300_last > ma450_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd_differenza_2_min_ago > 1.5
                    and ma2_differenza_ma5 > 3
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > E 50<100 and 300 > 120 min ago e 5-28 > 0.23 and ma2_diff_2_min_ago > 10 - r 7237 A1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 70


                elif (
                    ma5_last >= ma5_2_min_ago
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma300_sopra_ma450 > 0.10
                    and ma300_last > ma450_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd_differenza_2_min_ago > 1.5
                    and ma2_differenza_ma5 > 3
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > E 50<100 and 300 > 120 min ago e 5-28 > 0.23 and ma2_diff_2_min_ago > 10 - r 7237 A1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 70

                elif (
                    ma5_last >= ma5_2_min_ago
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma300_sopra_ma450 > 0.10
                    and ma300_last > ma450_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd_differenza_2_min_ago > 1.5
                    and ma2_differenza_ma5 > 3
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > E 50<100 and 300 > 120 min ago e 5-28 > 0.23 and ma2_diff_2_min_ago > 10 - r 7237 A1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 70


              
                elif (
                    ma5_last >= ma5_2_min_ago
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last > ma300_120_min_ago
                    and deviation_ma300_sopra_ma450 > 0.10
                    and ma300_last > ma450_last
                    
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > 0.07
                    
                    and ma3_last > ma13_last
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 10
                    and macd_differenza_2_min_ago > 1.5
                    and ma2_differenza_ma5 > 3
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > E 50<100 and 300 > 120 min ago e 5-28 > 0.23 and ma2_diff_2_min_ago > 10 - r 7237 A1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 70
                    
                    # 7 feb 2023 dev bellissima 0.10 da 0.12
                    # 7 feb 2023 5-28 a 0.23 da 0.27
                    # 19 dic 2023 aggiunta and ma2_differenza_2_min_ago > 8
                    # 19 dic 2023 aggiunta and macd_differenza_2_min_ago > 1.5
                    # 24 dic 2023 aggiunta and ma2_differenza_2_min_ago > 10 da 8
                    # 24 dic 2023 aggiunta and ma2_differenza_ma5 > 3

              
                
                elif (
                    ma50_last >= ma50_2_min_ago
                    and ma300_last > ma300_120_min_ago
                    and ma300_last < ma450_last
                    
                    and ma78_last < ma150_last
                    and deviation_ma5_sopra_ma28 > 0.27
                    and ma50_last > ma100_last
                    
                    
                    and deviation_buy3 > 0.10
                    and deviation_ma7_sopra_ma40 > 0.10
                    and deviation_bellissima > 0.10
                    
                    and ma3_last > ma13_last
                    
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                
                ):
                    buy = "BUY 5 con 300 > 450 and ma50 > AND 50<100 and 300 > 120 min ago and 5-28 > 0.23 - r 7237 B"
                    action = "buy"
                    percentage = 70
                    
                    # 7 feb 2023 dev bellissima 0.10 da 0.12
                    # 7 feb 2023 5-28 a 0.23 da 0.27
                    
                    
                elif (
                    ma3_last > ma18_last
                    and ma450_last > ma450_360_min_ago

                    and deviation_ma3_sotto_ma50 < -0.20

                    and ma300_last < ma300_120_min_ago
                    and ma78_last < ma150_last
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    
                    and ma3_last > ma9_last
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 5 con 3-18 and 300 < 60 min ago + distanza al ribasso - riga 7264"
                    action = "buy"
                    percentage = 70

                    # 21 mar 2025 distanza al ribasso
                    
                    
                    
                    
                    
                elif (    
                    ma3_last > ma8_last
                    
                    and ma100_last < ma100_10_min_ago
                    and ma100_last < ma100_120_min_ago

                    and (ma300_last > ma300_180_min_ago or ma200_last > ma450_last or deviation_ma300_sopra_ma450 > -0.50)

                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.14
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.24
                    and deviation_ma25_sotto_ma300 < -0.32
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.053
                    
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015

                    and ma2_last >= ma2_2_min_ago
                    
                ):    
                    buy = f"BUY 5 CF + 300>180 or 200>450 or 300-450>-0.50 - r 7270 NUOVA ERA A1 SOFT - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    
                    action = "buy"
                    percentage = 90

                    # 13 ott 2025 anticipata ndecchiecella
                    # 14 ott 205 ok
                    # 14 ott 2025 aggiunte parentesi graffe (sulla stessa riga MA ALLA FINE)(speriamo che funzionino)
                    # 14 OTT 2025 HANNO FUNZIONATO !
                    # 14 ott 2025 3-8 da 3-15
                    # 16 ott 2025 ok ! e' andata benissimo.
                    # 16 ott 2025 aggiunto :.3f alle parentesi graffe
                    # 16 ott 2025 ho messo tutte le deviation nelle parentesi con valori piu' tolleranti

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma300_last > ma300_180_min_ago
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    and ma2_last >= ma20_last
                ):    
                    buy = "BUY 5 da r 1537 A3X 4A compare forever + 300>180 min con 3-20 E 300 vicina 450 e 3-16 > 0.01 + MACD > - r 7270 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90
                  

                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 
                    
                    and ma300_last > ma300_180_min_ago
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    and ma2_last >= ma20_last
                ):    
                    buy = "BUY 5 da r 1537 A3X 4A compare forever + 300>180 min con 3-20 E 300 vicina 450 e 3-16 > 0.01 + MACD > - r 7270 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90

              
                elif (    
                    ma3_last > ma20_last

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2

                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.37
                    and deviation_ma50_sotto_ma300 < -0.27
                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    and deviation_ma5_sotto_ma450 < -0.51

                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01

                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 5 CF + 300 > 180 min con 3-20 + DNAM - GIORNO - r 7270 NUOVA ERA A3 SOFT x"
                    action = "buy"
                    percentage = 90
                    
                    #  9 feb 2024 IMPORTANTE ! solo BUY 5 NUOVA ERA A3 SOFT con ma100 > ma100 5 min ago !!!
                    #  2 dic 2024 aggiunta DNAM
                    #  8 dic 2024 DNAM piu' agressiva
                    # 28 feb 2025 anticipata ndecchiecella




                elif (    
                    ma3_last > ma20_last
                     
                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 > delta_DNA_2

                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.37
                    and deviation_ma50_sotto_ma300 < -0.27

                    and deviation_ma39 < -0.22
                    and deviation_ma3_sotto_ma50 < -0.35

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    and deviation_ma5_sotto_ma450 < -0.51

                    and ma100_last < ma100_120_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01

                    and ma300_last > ma300_180_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 5 CF + 300 > 180 min con 3-20 + DNAM + DNA - NOTTE - r 7270 NUOVA ERA A3 SOFT y"
                    action = "buy"
                    percentage = 90
                    
                    #  9 feb 2024 IMPORTANTE ! solo BUY 5 NUOVA ERA A3 SOFT con ma100 > ma100 5 min ago !!!
                    #  2 dic 2024 aggiunta DNAM
                    #  8 dic 2024 DNAM piu' agressiva
                    # 28 feb 2025 anticipata ndecchiecella
                    # 28 feb 2025 aggiunta DNA - NOTTE



                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma300_last > ma300_180_min_ago
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    and ma2_last >= ma20_last
                ):    
                    buy = "BUY 5 da r 1537 A3X 4A compare forever + 300>180 min con 3-20 E 300 vicina 450 e 3-16 > 0.01 + MACD > - r 7270 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

              

                elif (    
                    ma3_last > ma20_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma300_last > ma300_180_min_ago
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    and ma2_last >= ma20_last
                ):    
                    buy = "BUY 5 da r 1537 A3X 4A compare forever + 300>180 min con 3-20 E 300 vicina 450 e 3-16 > 0.01 + MACD > - r 7270 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90

              

                elif (    
                    ma3_last > ma20_last
                    
                    and ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma300_last > ma300_180_min_ago
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    and ma2_last >= ma20_last
                ):    
                    buy = "BUY 5 da r 1537 A3X 4A compare forever + 300>180 min con 3-20 E 300 vicina 450 e 3-16 > 0.01 + MACD > - r 7270 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                
                elif (    
                    ma3_last > ma20_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma300_last > ma300_180_min_ago
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and ma100_last < ma100_120_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.017
                    and deviation_ma3_sopra_ma16 > 0.025
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 3
                    and ma2_differenza_ma5 > 26
                    and macd > -10
                    and macd >= macd_2_min_ago
                    and ma2_last >= ma20_last
                ):    
                    buy = "BUY 5 da r 1537 A3X 4A compare forever + 300>180 min con 3-20 E 300 vicina 450 e 3-16 > 0.01 + MACD > - r 7270 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # 15 nov 2023 se compra quando 3<39 allora riduco dev 3-16 
                    # 16 nov 2023 AGGIUNTO SOLO SU QUESTA CONDIZIONE E DOPO ATTENTA ANALISI STATISTICA and macd > 8
                    #  5 dic 2023 aggiunta and ma2_differenza_ma5 > 26 vedi 4 dic 2023 ore 16:45
                    #  5 dic 2023 macd >-8 da >8
                    # 12 dic 2023 macd a -10 da -8


              

              
                # BUY 5 di emergenza CROLLO FERRARI - modo 1
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma3_last > ma18_last
                    and deviation_ma5_sotto_ma300 > 5.00
                ):
                    buy = "BUY 5 di emergenza CROLLO FERRARI - modo 1 - 3-18 - r 7282 A"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # SALTA IL BUY 2 allora ho fatto il BUY 3 di emergenza (se <-2.30 si attiva 8-25)
                    
                    
                    
                # BUY 5 di emergenza CROLLO FERRARI - modo 1
                
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -2.30
                    and ma3_last > ma9_last
                    and deviation_ma5_sotto_ma300 < 5.00
                ):
                    buy = "BUY 5 di emergenza CROLLO FERRARI - modo 1 - 3-9 - r 7282 B"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # SALTA IL BUY 2 allora ho fatto il BUY 3 di emergenza (se <-2.30 si attiva 8-25)
                    
                    
                    
                    
                    
                    
                elif (
                    ma50_last >= ma50_2_min_ago
                    and ma78_last > ma150_last
                    
                    and deviation_ma5_sotto_ma200 > 0.05
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.31
                    
                    and ma50_last < ma100_last
                    
                    
                    and deviation_buy3 > 0.10
                    and ma3_last > ma13_last
                    and deviation_ma7_sopra_ma40 > 0.09
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    and deviation_bellissima > 0.12
                    and ma2_last > ma2_2_min_ago
                
                ):
                    buy = "BUY 5 con ma50 > AND 50<100 and 5-28 > 0.31 (SI !) (PER SPEZZARE LA CATENA un po' di meno - vs effetti laterali) - r 7314 a"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_bellissima = 6/30
                    # spezzare la catena dei buy - effetti laterali.
                    # se e' arrivato il buy 5 e' molto probabile che il trend sia consolidato
                    # e, a questo punto, non importa se compra con un + 0.10 piu' in alto. NON FA UNA GRANDE DIFFERENZA !
                    
                elif (
                    ma50_last >= ma50_2_min_ago
                    and ma78_last < ma150_last
                    
                    and deviation_ma5_sotto_ma200 < 0.05
                    and deviation_ma5_sotto_ma200 > -0.35
                    
                    and deviation_ma3_sopra_ma10 > 0.17
                    and deviation_ma5_sopra_ma28 > 0.35
                    
                    and ma50_last < ma100_last
                    
                    
                    and deviation_buy3 > 0.10
                    and ma3_last > ma13_last
                    and deviation_ma7_sopra_ma40 > 0.09
                    and ma4_last > ma9_last
                    and ma4_last > ma50_last
                    
                    and ma6_last > ma15_last
                    and ma7_last > ma25_last
                    and deviation_bellissima > 0.12
                    and ma2_last > ma2_2_min_ago
                
                ):
                    buy = "BUY 5 con ma50 > AND 50<100 and 5-28 > 0.31 (SI !) (PER SPEZZARE LA CATENA un po' di meno - vs effetti laterali) - r 7314 b"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_bellissima = 6/30
                    # spezzare la catena dei buy - effetti laterali.
                    # se e' arrivato il buy 5 e' molto probabile che il trend sia consolidato
                    # e, a questo punto, non importa se compra con un + 0.10 piu' in alto. NON FA UNA GRANDE DIFFERENZA !
                    
                    
                

                elif (
                    ma3_last > ma13_last

                    and ma450_last < ma450_480_min_ago
                    
                    and deviation_ma5_sotto_ma450 < -0.49
                    and delta_DNA_1 < delta_DNA_2
                    and deviation_ma200_sotto_ma300 > -0.10
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.20
                    and deviation_ma39 < -0.06
                    and deviation_ma3_sotto_ma50 < -0.09
                    
                    and ma78_last < ma150_last
                    and ma200_last < ma300_last
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                  
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 con ma450< se rallenta la discesa - r 7314 c"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_bellissima = 6/30
                    # spezzare la catena dei buy - effetti laterali.
                    # se e' arrivato il buy 5 e' molto probabile che il trend sia consolidato
                    # e, a questo punto, non importa se compra con un + 0.10 piu' in alto. NON FA UNA GRANDE DIFFERENZA !
                    #  4 apr 2025 rallenta la discesa
                    # 20 mag 2025 e' andata bene
                    # 29 mag 2025 perfezionata


                
                
                # BUY 5 TUTTE LE ma IN CRESCITA

                elif (
                    ma69_last < ma69_2_min_ago

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.085
                    and deviation_ma300_sopra_ma450 > -0.085

                    and ma39_last > ma39_20_min_ago

                    and ma100_last > ma200_last
                    and ma200_last > ma300_last

                    and ma100_last > ma100_10_min_ago

                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_120_min_ago
                    and deviation > -0.30
                    
                    and ma3_last > ma8_last
                  
                    
                    and macd > -60
                    and macd_differenza_2_min_ago > -2
                ):
                    buy = "BUY 5 con 69< MA TUTTE LE ma IN CRESCITA E ma100> - r 7352 ax 1"
                    action = "buy"
                    percentage = 70

                    # 29 gen 2025 incomincio a risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 AGGIUNTA and ma450_last > ma450_720_min_ago
                    # 29 gen 2025 tolto and ma2_last > ma2_2_min_ago
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima


                elif (
                    ma69_last < ma69_2_min_ago
                    and ma450_last < ma450_720_min_ago


                    and ma39_last > ma39_20_min_ago

                    and ma100_last > ma200_last
                    and ma200_last > ma300_last

                    and ma100_last > ma100_10_min_ago

                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_120_min_ago
                    and deviation > -0.30
                    
                    and ma3_last > ma8_last
                  
                    and ma2_last > ma2_2_min_ago
                    and macd > -60
                    and macd_differenza_2_min_ago > -2
                ):
                    buy = "BUY 5 con 69< MA TUTTE LE ma IN CRESCITA E ma100> - r 7352 ax 2"
                    action = "buy"
                    percentage = 70

                    # 29 gen 2025 incomincio a risolvere il problema del trend laterale dopo un grande RIBASSO.




                
                elif (
                    ma3_last > ma13_last
                   
                    and (ma20_last < ma50_last or ma39_last < ma100_last)
                    
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80


                    and ma450_last > ma450_360_min_ago
                    and ma450_last > ma450_120_min_ago
                    and ma300_last > ma300_60_min_ago

                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    and ma300_last > ma450_last

                    and ma39_last < ma39_20_min_ago
                    and ma69_last < ma69_2_min_ago
                    
                    and ma3_last > ma8_last
                  
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 5 {ma450_last} {ma450_720_min_ago} TUTTE LE ma IN CRESCITA MA ritracciamento pesante - r 7352 ay"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 14 ott 2024 anticipata di molto (tutte le ma sono in crescita !)
                    # 14 ott 2024 aggiunto MACD e diff macd
                    # 29 ott 2024 se ma39 scende da 20 min and deviation_ma39 < -0.17 (una specie di osso)
                    #  1 apr 2025 ritracciamento pesante
                    # 11 apr 2025 correzione or e aggiunta f



                elif (
                    ma69_last < ma69_2_min_ago
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80

                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_120_min_ago
                    
                    
                    and ma3_last > ma8_last
                  
                    and ma2_last > ma2_2_min_ago
                    and macd > -40
                    and macd_differenza_2_min_ago > -2
                ):
                    buy = "BUY 5 con 69< MA TUTTE LE ma IN CRESCITA MA ma39<100 E zia amalia grafana - r 7352 b1"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 14 ott 2024 anticipata di molto (tutte le ma sono in crescita !)
                    # 14 ott 2024 aggiunto MACD e diff macd

                    # 28 ott 2024 se ma100 scende MA se ma5 last non scende molto dalla ma5 di 30 min ago ok cosi
                    # 17 nov 2024 se 39<100 interviene zia amalia grafana

                elif (
                    ma69_last < ma69_2_min_ago
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma5_30_min_ago < -0.08

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    and deviation_ma10_sopra_ma200 < -0.20
                    and deviation_ma5_sotto_ma300 < -0.20

                    and ma300_last > ma300_60_min_ago
                    and ma450_last > ma450_120_min_ago
                    and deviation > -0.30
                    
                    and ma3_last > ma8_last
                  
                    and ma2_last > ma2_2_min_ago
                    and macd > -40
                    and macd_differenza_2_min_ago > -2
                ):
                    buy = "BUY 5 con 69< MA TUTTE LE ma IN CRESCITA MA ma100< E ma5 last scende molto dalla ma5 di 30 min ago (+OSSO !)- r 7352 b2"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 14 ott 2024 anticipata di molto (tutte le ma sono in crescita !)
                    # 14 ott 2024 aggiunto MACD e diff macd

                    # 28 ott 2024 se ma100 scende E se ma5 last scende molto dalla ma5 di 30 min ago ALLORA OSSO CANO STAF !

                
                elif (
                    ma69_last < ma69_2_min_ago
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    and (ma5_prev < ma100_prev and ma5_last > ma100_last)
                    and ma300_last > ma300_60_min_ago
                    
                    and deviation > -0.30
                    
                    and deviation_ma4_sopra_ma30 > 0.10
                    and delta_buy3_incrocio_ma3_ma8 > 0.07
                    and ma7_last > ma25_last
                    
                    and ma3_last > ma8_last
                    and ma3_last > ma78_last
                    
                    and ma2_last > ma2_2_min_ago
                    
                ):
                    buy = "BUY 5 nuova condizione con 69< MA CON TUTTE LE ma IN CRESCITA con incrocio dal basso 5-100 vocazione tardiva - r 7353"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # and deviation > -0.30 perche' se va un po' troppo giu' dal SELL 2 (last_trade_price) DEVE RICOMINCIARE dal BUY 1 !
                    # 18 dic 2023 nuova condizione con (ma5_prev < ma100_prev and ma5_last > ma100_last) vedi 14 dic 2023 ore 20:52
                    
                    
                    
                    
                # ATTENZIONE ! AL BUY 5 TRANNE CHE IN UNA EVENTUALE CORREZIONE HO MESSO 78>150 STIAMO AL BUY 5 PERDIO !
                # SENZA QUESTA 78>150 HO AVUTO MOLTI PROBLEMI !


                elif (    
                    ma3_last > ma13_last
                    and ma450_last >= ma450_360_min_ago
                    and deviation_ma200_sotto_ma300 > -0.05


                    and ma39_last < ma100_last
                    
                    and deviation_ma25_sotto_ma300 < -0.37
                    and deviation_ma50_sotto_ma300 < -0.43
                    
                    and deviation_ma39 < 0.02
                    and deviation_ma3_sotto_ma50 < -0.05

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma5_sotto_ma200 < -0.37
                    and deviation_ma5_sotto_ma300 < -0.39
                    and deviation_ma5_sotto_ma450 < -0.41

                    and ma300_last < ma300_120_min_ago
                    and ma100_last < ma100_10_min_ago

                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 5 con 3-13 and 450_last >= 450_360_min_ago and 5-28 > 0.02 CON 50 > 450 and ma2_differenza_ma5 > 8 - r 7384 A1"
                    action = "buy"
                    percentage = 70

                    # 12 set 2024 aggiunta questa condizione che compra quando ma300 curva al ribasso GIA' DA UN PO'. NO se comincia a curvare !
                    # 19 feb 2025 and deviation_ma200_sotto_ma300 > -0.05 cioe' 200 non si e' ancora allontanata dalla 300 !
                    # 19 feb 2025 aggiunto un osso MA ma200 DEVE STARE ANCORA VICINA alla ma300 (altrimenti continua a comprare !)


                # 24 nov 2024 cancellata r 7384 A2xx1X
                

                elif (
                    ma3_last > ma13_last
                    and ma39_last < ma100_last
                    
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80


                    and ma450_last > ma450_360_min_ago
                    and ma300_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd > -80
                    and macd_differenza_2_min_ago > -2
                ):
                    buy = "BUY 5A con ma450_last > ma450_360_min_ago con 39<100 e zia amalia grafana - r 7384 A2xx1Y"
                    action = "buy"
                    percentage = 70

                    # 14 ott 2024 se 450 sale da 6 ore NON FARTI TROPPI PROBLEMI !
                    #  10 nov 2024 anticipata ancora di una ndecchiecella
                    # 17 nov 2024 se 39<100 allora interviene zia amalia grafana





                elif (
                    ma3_last > ma13_last

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13

                    and deviation_ma39 < -0.17
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80
                    
                    
                    and ma450_last > ma450_360_min_ago
                    and ma300_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_360_min_ago MA 39<100 E zia amalia grafana - r 7384 A2 xx2 xx"
                    action = "buy"
                    percentage = 70

                    # 17 nov 2024 se 39<100 zia amalia grafana
                    #  6 apr 2025 se e' buy 5 deve essere and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    


                elif (
                    ma3_last > ma13_last

                    and deviation_ma39 < -0.17
                    and deviation_ma3_sotto_ma50 < -0.25
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -1.70
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80
                    
                    
                    and ma450_last > ma450_360_min_ago
                    and ma300_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_360_min_ago MA 39<100 E zia amalia grafana - r 7384 A2 xx2 xy"
                    action = "buy"
                    percentage = 70

                    # 17 nov 2024 se 39<100 zia amalia grafana
                    #  6 apr 2025 se e' buy 5 deve essere and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    # 14 apr 2025 anticipata ndecchiecella ma aggiunta and deviation_ma3_sotto_ma50 < -0.25


                




                elif (
                    ma3_last > ma13_last
                    and ma100_last > ma100_60_min_ago

                    and (ma450_last > ma450_360_min_ago or ma300_last > ma450_last)
                    and deviation_ma300_sopra_ma450 > -0.18
                    and deviation_ma100_sopra_ma300 > -0.29


                    and deviation_ma5_sopra_o_sotto_ma100 < -0.33
                    and deviation_ma10_sotto_ma100 < -0.06
                    
                    and deviation_ma3_sotto_ma50 < -0.123
                    and deviation_ma39 < -0.127
                 
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_360_min_ago + distanza al ribasso E ma100_last > ma100_60_min_ago - r 7384 A2 xx 2y X"
                    action = "buy"
                    percentage = 70

                    # 14 ott 2024 se 450 sale da 6 ore NON FARTI TROPPI PROBLEMI !
                    # 29 ott 2024 se 39 scende da 20 min allora una specie di osso (and deviation_ma39 < -0.17)
                    # 21 mar 2025 distanza al ribasso se 30 ma39_last < ma39_20_min_ago
                    # 16 apr 2025 and macd_differenza_2_min_ago a -18.50 da -2.50

                    


                elif (
                    ma3_last > ma13_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.30)


                    and (ma450_last > ma450_360_min_ago or ma300_last > ma450_last)

                    and deviation_ma300_sopra_ma450 > -0.40
                    and deviation_ma100_sopra_ma300 > -0.40

                    and deviation_ma39 < -0.127
                    and deviation_ma3_sotto_ma50 < -0.123
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.30
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.10

                    and deviation_ma10_sotto_ma100 < -0.06

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 IL MIO CAPOLAVORO ! con ma450_last > ma450_360_min_ago + distanza al ribasso + CM + CV - r 7384 A2 XX 2Y Y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    # 14 ott 2024 se 450 sale da 6 ore NON FARTI TROPPI PROBLEMI !
                    # 29 ott 2024 se 39 scende da 20 min allora una specie di osso (and deviation_ma39 < -0.17)
                    # 21 mar 2025 distanza al ribasso se 30 ma39_last < ma39_20_min_ago
                    # 16 apr 2025 and macd_differenza_2_min_ago a -18.50 da -2.50

                    # 14 ago 2025 IL MIO CAPOLAVORO.
                    # 14 ago 2025 SE E' NOTTE (CV) DEVE ESSERE GIORNO (CM)
                    # 17 OTT 2025 AGGIUNTE PG



                elif (
                    ma3_last > ma13_last

                    and ma100_last < ma100_60_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                    and deviation_ma5_sotto_ma200 < -0.10
                    and deviation_ma25_sotto_ma300 < -0.11

                    and ma300_last > ma300_30_min_ago
                    and ma450_last > ma450_360_min_ago
                    and ma78_last > ma150_last

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 5A con ma450_last > ma450_360_min_ago E CON ma100 > E deviation_ma5_sopra_o_sotto_ma100 < -0.03 - r 7384 A2xy"
                    action = "buy"
                    percentage = 70

                    # 14 ott 2024 se ma100< 100 60 min ago allora OSSO !


                elif (
                    ma3_last > ma13_last
                    and ma100_last < ma100_60_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50

                    and ma300_last > ma300_30_min_ago
                    and ma450_last > ma450_360_min_ago
                    and ma78_last > ma150_last

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
              
                ):
                    buy = "BUY 5A con ma450_last > ma450_360_min_ago MA CON ma100 < E deviation_ma5_sopra_o_sotto_ma100 < -0.50 - r 7384 A2y"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_bellissima = 6/30
                    # spezzare la catena dei buy - effetti laterali !
                    # se e' arrivato il buy 5 e' molto probabile che il trend sia consolidato
                    # e, a questo punto, non importa se compra con un + 0.10 piu' in alto. NON FA UNA GRANDE DIFFERENZA !
                    # > vacanza anticipato buy
                    
                    #  7 mar 2024 con ma450_last > ma450_360_min_ago and deviation_ma3_sopra_ma100 > -0.01 da 0.01
                    #  7 mar 2024 con ma450_last > ma450_360_min_ago 4-20 da 4-30
                    #  9 set 2024 dopo un grande rialzo la faccio comprare SOLO quando ma3 e' ancora vicina alla ma100
                    # 12 set 2024 aggiunta and ma300_last > ma300_30_min_ago prima di CANCELLARE
                    #  2 ott 2024 aggiunta and deviation_ma5_sopra_o_sotto_ma100 < -0.05 e anticipata una ndecchiecella
                    #  2 ott 2024 sempre prima di cancellare. dare un' altra possibilita'.
                    #  3 ott 2024 aggiunta da CANO STAF and deviation_ma5_sopra_o_sotto_ma100 < -0.15 (ma e' -0.30)
                    #  3 ott 2024 aggiunta da CANO STAF and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    #  4 ott 2024 se 100 scende da 60 min allora compro soltanto se dev 5-100 < -0.50
                    #  4 ott 2024 se devo comprare con 100 che sta scendendo da 60 min mi devi dare un osso !



                # 21 set 2024 cancellata r 7384 B1
                #  5 nov 2024 cancellata r 7384 B2
                
                
                



                elif (
                    ma3_last > ma13_last

                    and ma200_last >= ma200_120_min_ago
                    and ma20_last > ma50_last
                    
                    and ma100_last > ma300_last
                    and ma300_last > ma450_last
                    and ma300_last >= ma300_60_min_ago
                    
                    and delta_1 < delta_2

                    and deviation_ma3_sotto_ma50 < -0.03

                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA - GIORNO - E 20>50 E ma200> 120 min con 3-50 < -0.03 - r 7410 A1 X1 x1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 22 feb 2025 aggiunta and ma300_last > ma450_last
                    # 22 feb 2025 and delta_1 < delta_2
                    # 23 mar 2025 and deviation_ma3_sotto_ma50 < -0.03
                    #  3 apr 2025 se 100>300 and deviation_ma3_sotto_ma50 < -0.03
                    #  8 apr 2025 con 20>50 va bene cosi'
                    # 22 ott 2025 per adesso non la modifico. ma aggiungo pg.


                

                elif (
                    ma3_last > ma15_last
                    and (ma20_last < ma50_last or delta_1 > delta_2)

                    and ma300_last >= ma300_60_min_ago
                    and ma200_last >= ma200_120_min_ago
                    
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.03

                    and ma100_last > ma300_last
                    and ma300_last > ma450_last
                    
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma8_last
                   
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 ma300_last {ma300_last} ma300_60_min_ago {ma300_60_min_ago} con ma200> 120 min MA 20<50 - STA RITRACCIANDO - r 7410 A1 X1 x2"
                    action = "buy"
                    percentage = 80
                    
                    # 22 feb 2025 aggiunta and ma300_last > ma450_last
                    # 22 feb 2025 and delta_1 < delta_2
                    # 23 mar 2025 and deviation_ma3_sotto_ma50 < -0.03
                    #  3 apr 2025 se 100>300 and deviation_ma3_sotto_ma50 < -0.03
                    #  8 apr 2025 con 20<50 siamo in presenza, probabilmente, di un RITRACCIAMENTO.
                    #  8 apr 2025 al momento lascio. avrei dovuto mettere che 3 deve stare sotto 100
                    # 11 apr 2025 aggiunta f
                    # 26 apr 2025 aggiunta deviation_ma5_sopra_o_sotto_ma100 < -0.03 
                    # 26 apr 2025 tolto GIORNO ! 100-200 faceva arrivare tardi
                    #  7 mag 2025 aggiunta and (ma20_last < ma50_last or delta_1 > delta_2)
                    #  7 mag 2025 deviation_ma3_sotto_ma50 < -0.30
                    # ATTENZIONE 300 LAST > 300 60 MIN AGO MA SUL GRAFICO DI GRAFANA E' < !!!



                elif (
                    ma200_last >= ma200_120_min_ago
                    and ma100_last < ma300_last

                    and ma300_last > ma450_last
                    and ma300_last >= ma300_60_min_ago
                    
                    and delta_1 < delta_2

                    and deviation_ma3_sotto_ma50 < -0.25

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma8_last
                   
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA - GIORNO - SE ma200> 120 min con 3-50 < -0.03 - r 7410 A1 X1y"
                    action = "buy"
                    percentage = 80

                    # 22 feb 2025 aggiunta and ma300_last > ma450_last
                    # 22 feb 2025 and delta_1 < delta_2
                    # 23 mar 2025 and deviation_ma3_sotto_ma50 < -0.03
                    #  3 apr 2025 se 100>300 and deviation_ma3_sotto_ma50 < -0.25




                elif (
                    ma3_last > ma11_last

                    and ma450_last > ma450_360_min_ago
                    and ma100_last > ma100_60_min_ago
                    and ma300_last > ma450_last

                    and (ma20_last < ma50_last or ma39_last < ma100_last)

                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    and deviation_ma50_sotto_ma300 < -1.10
                    and deviation_ma25_sotto_ma300 < -1.70
                    
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.40

                    and delta_1 > delta_2

                    and deviation_ma5_sopra_o_sotto_ma100 < -1.30
                    and deviation_ma5_sotto_ma200 < -1.60
                    and deviation_ma5_sotto_ma300 < -1.80
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.01

                    and ma300_last >= ma300_60_min_ago
                    and ma200_last >= ma200_120_min_ago
                    
                    and ma3_last > ma8_last
                   
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 {ma450_last} {ma450_360_min_ago} NOTTE - con ma450> 360 min MA RITRACCIA - r 7410 A1 X2x"
                    action = "buy"
                    percentage = 80
                    
                    # 22 feb 2025 aggiunta and ma300_last > ma450_last
                    # 22 feb 2025 and delta_1 < delta_2
                    # 23 mar 2025 and deviation_ma3_sotto_ma50 < -0.06
                    # 29 mar 2025 SE RITRACCIA vedi ma20_last < ma50_last con ma450_last > ma450_720_min_ago
                    # 30 mar 2025 se 200-300 < -0.07 NON E' PIU' UN RITRACCIAMENTO ! quindi devo dare un limite !
                    # 30 mar 2025 PER QUESTA RAGIONE ho dovuto aggiungere and deviation_ma200_sotto_ma300 > -0.07
                    #  1 apr 2025 se ritraccia piu' pesante
                    # 11 apr 2025 correzione or e aggiunta f


                elif (
                    ma3_last > ma11_last

                    and ma20_last < ma50_last
                    and ma300_last > ma300_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma450_last
                    
                    and delta_1 < delta_2

                    and ma450_last < ma450_720_min_ago

                    and deviation_ma100_sopra_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.30

                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 {ma200_last} {ma200_120_min_ago} - GIORNO - con 200 > 120 min MA RITRACCIANDO - r 7410 A1 X2y"
                    action = "buy"
                    percentage = 70
                    
                    # 22 feb 2025 aggiunta and ma300_last > ma450_last
                    # 22 feb 2025 and delta_1 < delta_2
                    # 23 mar 2025 and deviation_ma3_sotto_ma50 < -0.06
                    # 29 mar 2025 SE RITRACCIA vedi ma20_last < ma50_last con ma450_last < ma450_720_min_ago
                    #  6 apr 2025 aggiunto and deviation_ma100_sopra_ma300 < -0.30 continuava a comprare male
                    #  6 apr 2025 aggiunto and deviation_ma25_sotto_ma300 < -0.30 continuava a comprare male 
                    # 11 apr 2025 aggiunto f




                elif (
                    ma3_last > ma8_last

                    and ma450_last >= ma450_360_min_ago
                    and deviation_ma300_sopra_ma450 < -0.22

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.094

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12

                    and deviation_ma39 < -0.03
                    and deviation_ma3_sotto_ma50 < -0.04
                    
                    and macd > -100

                ):   
                    buy = f"BUY 5 con ma450_last >= ma450_360_min_ago e ma200> 120 min - r 7410 A1 y1 - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 70

                    # 22 feb 2025 aggiunta and ma300_last > ma450_last
                    # 22 feb 2025 and delta_1 > delta_2 notte 
                    # 22 feb 2025 se notte aggiunte 3-39 e 3-50
                    # 15 ott 2023 aggiunte parentesi graffe
                    # 15 ott 2025 aggiunta, intanto, and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.094


                elif (
                    ma3_last > ma8_last

                    and ma450_last < ma450_360_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.023
                    and ma39_last < ma100_last
                    
                    and deviation_ma300_sopra_ma450 < -0.22
                    and deviation_ma25_sotto_ma300 < -1.00
                    and deviation_ma5_sotto_ma200 < -1.50

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.03
                    

                    and macd_differenza_2_min_ago > -2.50

                ):   
                    buy = "BUY 5 con ma450_last < ma450_360_min_ago con deviation_ma300_sopra_ma450 < -0.22 - r 7410 A1 y2"
                    action = "buy"
                    percentage = 70

                    # 22 feb 2025 aggiunta and ma300_last > ma450_last
                    # 22 feb 2025 and delta_1 > delta_2 notte 
                    # 22 feb 2025 se notte aggiunte 3-39 e 3-50
                    # 22 feb 2025 and deviation_ma300_sopra_ma450 < -0.22 significa che deve restare dentro i limiti.

                    # 12 mar 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.023
                    # 12 mar 2025 aggiunta and macd_differenza_2_min_ago > -2.50


                elif (
                    
                    ma3_last > ma11_last
                    
                    and deviation_ma39 < -0.007
                    and deviation_ma3_sotto_ma50 < -0.06
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.12
                    and deviation_ma25_sotto_ma300 < -0.009
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.010

                    and (ma100_last > ma200_last or ma100_last > ma300_last)
                    and (ma50_last > ma100_last or ma200_last > ma450_last)

                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or delta_50_25_last < delta_50_25_30_min_ago or ma20_last > ma40_last)
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 20>40 - r 7410 A2 X1 Xx1 Xx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 11 mag 2025 se 50 >100 ok cosi'
                    # 13 ott 2025 anticipata ndecchiecella
                    # 14 ott 2025 se ma100_last > ma300_last ok cosi'
                    # 20 ott 2025 anticipata ndecchiecella
                    # 20 ott 2025 aggiunte pg
                    # 20 ott 2025 se 20>40 ok cosi'
                    # 25 ott 2025 anticipata ndecchiecella mettondo dev da pg !


                elif (
                    
                    ma3_last > ma13_last

                    and ma20_last < ma40_last
                    and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.20
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.035

                    and (ma100_last > ma200_last or ma100_last > ma300_last)
                    and (ma50_last > ma100_last or ma200_last > ma450_last)

                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or delta_50_25_last < delta_50_25_30_min_ago)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 20<40 - r 7410 A2 X1 Xx1 Xy 1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 11 mag 2025 se 50 >100 ok cosi'
                    # 13 ott 2025 anticipata ndecchiecella
                    # 14 ott 2025 se ma100_last > ma300_last ok cosi'
                    # 20 ott 2025 anticipata ndecchiecella
                    # 20 ott 2025 aggiunte pg
                    # 20 ott 2025 se 20<40 aggiunte deviation
                    # 23 ott 2023 con cv giorno




                elif (
                    
                    ma3_last > ma13_last
                    and ma20_last < ma40_last
                    and delta_CV_300_25_last > delta_CV_300_25_45_min_ago

                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.23
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.35
                    and deviation_ma25_sotto_ma300 < -0.035
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.095

                    and (ma100_last > ma200_last or ma100_last > ma300_last)
                    and (ma50_last > ma100_last or ma200_last > ma450_last)

                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or delta_50_25_last < delta_50_25_30_min_ago)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 20<40 - r 7410 A2 X1 Xx1 Xy 2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 11 mag 2025 se 50 >100 ok cosi'
                    # 13 ott 2025 anticipata ndecchiecella
                    # 14 ott 2025 se ma100_last > ma300_last ok cosi'
                    # 20 ott 2025 anticipata ndecchiecella
                    # 20 ott 2025 aggiunte pg
                    # 20 ott 2025 se 20<40 aggiunte deviation
                    # 23 ott 2025 con cv notte





                elif (
                    
                    ma3_last > ma20_last

                    and ma100_last < ma300_last

                    and deviation_ma39 < -0.19
                    and deviation_ma3_sotto_ma50 < -0.25
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.56
                    and deviation_ma25_sotto_ma300 < -0.72
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.11


                    and (ma20_last > ma50_last or delta_50_25_last < delta_50_25_30_min_ago)
                    
                    and (ma50_last > ma100_last or ma100_last > ma200_last or ma200_last > ma450_last)
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA - r 7410 A2 X1 Xx1 Y"
                    action = "buy"
                    percentage = 80

                    # 11 mag 2025 se 50 >100 ok cosi'
                    # 13 ott 2025 anticipata ndecchiecella
                    # 14 ott 2025 se ma100_last < ma300_last allora aggiungo valori parentesi graffe





                elif (
                    
                    ma3_last > ma20_last
                    and ma50_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.08

                    and ma20_last > ma50_last
                    

                    and ma100_last > ma200_last
                    and ma200_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12

                    and ma3_last > ma8_last
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA - con 20>50 E 3>20 ma 50<100 and 3-50 < -0.08 - r 7410 A2 X1 Xx2"
                    action = "buy"
                    percentage = 80

                    # 27 mar 2025 se GIORNO ok cosi'
                    #  7 apr 2025 aggiunta questa che mancava !
                    # 13 apr 2025 con ma20_last > ma50_last ok cosi'
                    # 26 apr 2025 anticipato ndecchia
                    # 26 apr 2025 con ma5_last > ma39_last
                    # 11 mag 2025 se 50<100 aggiungo 3-50 < -0.08



                elif (
                    ma3_last > ma8_last

                    and (ma5_last < ma39_last or delta_1 > delta_2)
                    and deviation_ma3_sotto_ma50 < -0.30
                    
                    and ma20_last > ma50_last

                    and ma100_last > ma200_last
                    and ma200_last > ma450_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 con 5<39 or NOTTE e con 20>50 and dev_ma3_sotto_ma50 < -0.27 - r 7410 A2 X1 Xy"
                    action = "buy"
                    percentage = 80

                    # 27 mar 2025 se GIORNO ok cosi'
                    #  7 apr 2025 aggiunta questa che mancava !
                    # 13 apr 2025 con ma20_last > ma50_last ok cosi'
                    # 26 apr 2025 anticipato ndecchia
                    # 26 apr 2025 SE 5<39 allora deviation_ma3_sotto_ma50 < -0.01

                    #  7 mag 2025 anche se 20<50 in questo caso 5<39 OR NOTTE lo considero RITRACCIAMENTO
                    #  7 mag 2025 aggiunta and dev_ma3_sotto_ma50 < -0.27


                elif (
                    ma3_last > ma8_last

                    and ma20_last < ma50_last
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.10

                    and ma30_last > ma100_last
                    and ma100_last > ma200_last
                    
                    and delta_1 < delta_2
                  
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA - GIORNO MA 20<50 e con dev 5-100 < -0.05 - r 7410 A2 X1 y"
                    action = "buy"
                    percentage = 80

                    # 27 mar 2025 se GIORNO ok cosi'
                    #  7 apr 2025 aggiunta questa che mancava !
                    # 13 apr 2025 con and ma20_last < ma50_last 
                    # 28 apr 2025 se 20<50 aggiungo dev 5-100 < -0.05




                elif (
                    ma3_last > ma8_last
                    and delta_1_50_20 < delta_2_50_20
                    and ma20_last > ma50_last

                    and ma200_last >= ma200_120_min_ago
                    and ma300_last >= ma300_60_min_ago

                    and delta_1 < delta_2
                  
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA con 20-50 giorno and GIORNO - SE ma200> 120 min con 3-10 > 0.01 e 5-28 > -0.10 - r 7410 A2 x2 x1"
                    action = "buy"
                    percentage = 80

                    # 27 mar 2025 se GIORNO ok cosi'
                    #  8 apr 2025 con 20>50
                    #  3 giu 2025 se 20-50 GIORNO ok cosi'



                elif (
                    ma3_last > ma8_last
                    and delta_1_50_20 > delta_2_50_20
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.05
                    and ma20_last > ma50_last

                    and ma200_last >= ma200_120_min_ago
                    and ma300_last >= ma300_60_min_ago

                    and delta_1 < delta_2
                  
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA con 20-50 NOTTE and GIORNO - SE ma200> 120 min con 3-10 > 0.01 e 5-28 > -0.10 - r 7410 A2 x2 x2"
                    action = "buy"
                    percentage = 80

                    # 27 mar 2025 se GIORNO ok cosi'
                    #  8 apr 2025 con 20>50
                    #  3 giu 2025 se 20-50 NOTTE deve essere 5-100 < -0.05 cazzo.



                elif (
                    ma3_last > ma8_last

                    and ma20_last < ma50_last
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_60_min_ago
                    and delta_1 < delta_2

                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.15

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 {ma200_last} {ma200_120_min_ago} con ma200> 120 min e GIORNO MA 20<50 - RITRACCIAMENTO - r 7410 A2 x2y"
                    action = "buy"
                    percentage = 80
                    
                    # 27 mar 2025 se GIORNO ok cosi'
                    #  8 apr 2025 con 20<50 ritracciamento
                    #  8 apr 2025 aggiunto le basi del ritracciamento
                    # 11 apr 2025 aggiunto f




                elif (
                    ma3_last > ma8_last
                    and ma50_last < ma50_2_min_ago
                    and delta_DNA_1 < delta_DNA_2
                    
                    and delta_50_39 < delta_50_39_30_min
                    and delta_450_300 < delta_450_300_60_min

                    and ma10_last <= ma20_last
                
                
                    and deviation_ma39 < 0.07
                    and deviation_sell < -0.01
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    and ma5_last <= ma100_last
                    and deviation_ma100_sopra_ma300 > 0.20
                    
                
                    and deviation_ma3_sotto_ma150 > -1.20
                
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 {ma450_last} {ma450_720_min_ago} con delta 450-300 giorno MA ritracciamento - r 7410 A2 Y1 x"
                    action = "buy"
                    percentage = 80
                    
                    #  6 apr 2025 se e' buy 5 deve essere and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    # 11 apr 2025 aggiunta f
                    # 14 apr 2025 ma450 e' vero che e' > ma 450 720 min ago ! viva ro combaro meo !
                    # 14 apr 2025 and deviation_ma39 < -0.06 da < -0.01
                    # 14 apr 2025 and deviation_ma3_sotto_ma50 < -0.08 da < -0.06
                    # 26 mag 2025 modificata







                elif (
                    ma3_last > ma8_last
                    and ma100_last > ma100_60_min_ago

                    and ma20_last < ma50_last

                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    
                    and deviation_ma3_sotto_ma50 < -0.06
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.01

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"""BUY 5 con ma450> 720 min MA ritracciamento MA 100 > 1 ora - r 7410 A2 Y1 y1
                    ma450_last {ma450_last:.2f} 
                    ma450_720_min_ago {ma450_720_min_ago:.2f} 
                    deviation_ma39 {deviation_ma39:.2f}
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f}
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}
                    """
                    action = "buy"
                    percentage = 80

                    # deviation_buy3 = ma4_last/ma30_last
                    # ok tu non voi spezzare la catena.
                    # ma per essere un BUY 5 devi avere almeno ma13>ma50 cazzo !
                    # 14 ott 2022 aggiunto 3-10 !
                    # 20 gen 2025 anticipata ndecchia
                    # 27 gen 2025 se giorno anticipata ndecchia - e' GIORNO !
                    # 27 gen 2025 quando e' giorno tolto and ma2_last >= ma2_2_min_ago
                    # 27 mar 2025 se NOTTE and deviation_ma39 < -0.01
                    # 29 mar 2025 se ritraccia con 450 >
                    #  3 apr 2025 e' andata bene
                    #  3 apr 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.01
                    #  6 apr 2025 se e' buy 5 deve essere and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    # 11 apr 2025 aggiunto f
                    # 17 ago 2025 aggiunti valori deviation
                    # 17 ago 2025 se 100> ok cosi'



                elif (
                    ma3_last > ma8_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and (delta_CM_300_25_last < delta_CM_300_25_2_min_ago or deviation_ma25_sotto_ma300 < -0.35)

                    and ma20_last < ma50_last

                    and ma450_last > ma450_720_min_ago
                    and ma300_last > ma300_60_min_ago
                    and ma200_last > ma200_120_min_ago
                    and delta_1 < delta_2

                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    
                    and deviation_ma3_sotto_ma50 < -0.06
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05

                    and deviation_ma39 < -0.01
                    and deviation_ma3_sotto_ma50 < -0.01

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"""BUY 5 con ma450> 720 min MA ritracciamento + IL MIO CAPOLAVORO - r 7410 A2 Y1 y2

                    ma450_last {ma450_last:.2f} 
                    ma450_720_min_ago {ma450_720_min_ago:.2f} 
                    deviation_ma39 {deviation_ma39:.2f}
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f}
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}
                    """

                    action = "buy"
                    percentage = 80

                    # deviation_buy3 = ma4_last/ma30_last
                    # ok tu non voi spezzare la catena.
                    # ma per essere un BUY 5 devi avere almeno ma13>ma50 cazzo !
                    # 14 ott 2022 aggiunto 3-10 !
                    # 20 gen 2025 anticipata ndecchia
                    # 27 gen 2025 se giorno anticipata ndecchia - e' GIORNO !
                    # 27 gen 2025 quando e' giorno tolto and ma2_last >= ma2_2_min_ago
                    # 27 mar 2025 se NOTTE and deviation_ma39 < -0.01
                    # 29 mar 2025 se ritraccia con 450 >
                    #  3 apr 2025 e' andata bene
                    #  3 apr 2025 aggiunta and deviation_ma3_sotto_ma50 < -0.01
                    #  6 apr 2025 se e' buy 5 deve essere and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    # 11 apr 2025 aggiunto f
                    # 17 ago 2025 aggiunti valori deviation
                    # 17 ago 2025 aggiunto IL MIO CAPOLAVORO







                elif (
                    ma3_last > ma8_last

                    and ma20_last < ma50_last
                    and delta_DNA_1 < delta_DNA_2

                    and ma300_last >= ma300_60_min_ago
                    and ma200_last >= ma200_120_min_ago
                    
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma39 < -0.01
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.10

                    and ma450_last < ma450_720_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 {ma300_last} {ma300_60_min_ago} SE ma200> 120 min and delta_DNA_1 > delta_DNA_2 MA ritraccia - r 7410 A2 y2 x"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # ok tu non voi spezzare la catena.
                    # ma per essere un BUY 5 devi avere almeno ma13>ma50 cazzo !
                    # 14 ott 2022 aggiunto 3-10 !
                    # 20 gen 2025 anticipata ndecchia
                    # 27 gen 2025 se giorno anticipata ndecchia - e' GIORNO !
                    # 27 gen 2025 quando e' giorno tolto and ma2_last >= ma2_2_min_ago
                    # 27 mar 2025 se NOTTE and deviation_ma39 < -0.01
                    # 29 mar 2025 se ritraccia con 450 >
                    # 11 apr 2025 aggiunto f



                elif (
                    ma3_last > ma8_last

                    and ma20_last < ma50_last
                    and delta_DNA_1 > delta_DNA_2
                    and deviation_ma50_sotto_ma100 < -0.18
                    and deviation_ma25_sotto_ma300 < -0.30

                    and ma300_last >= ma300_60_min_ago
                    and ma200_last >= ma200_120_min_ago
                    
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma39 < -0.01
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.10

                    and ma450_last < ma450_720_min_ago
                    and delta_1 > delta_2
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and macd_differenza_2_min_ago > -18.50
                ):   
                    buy = f"BUY 5 {ma300_last} {ma300_60_min_ago} SE ma200> 120 min and delta_DNA_1>delta_DNA_2 MA ritraccia - r 7410 A2 y2 y"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # ok tu non voi spezzare la catena.
                    # ma per essere un BUY 5 devi avere almeno ma13>ma50 cazzo !
                    # 14 ott 2022 aggiunto 3-10 !
                    # 20 gen 2025 anticipata ndecchia
                    # 27 gen 2025 se giorno anticipata ndecchia - e' GIORNO !
                    # 27 gen 2025 quando e' giorno tolto and ma2_last >= ma2_2_min_ago
                    # 27 mar 2025 se NOTTE and deviation_ma39 < -0.01
                    # 29 mar 2025 se ritraccia con 450 >
                    # 11 apr 2025 aggiunto f








                elif (
                    ma200_last >= ma200_120_min_ago
                    and ma300_last >= ma300_60_min_ago
                    and delta_1 > delta_2

                    and ma39_last < ma100_last
                    and deviation_ma100_sopra_ma300 < -0.07
                    and deviation_ma25_sotto_ma300 < -0.20

                    and deviation_ma300_sopra_ma450 < -0.072
                    and deviation_ma50_sotto_ma300 < -0.20

                    and deviation_ma39 < 0.01
                    and deviation_ma3_sotto_ma50 < 0.01

                    and deviation_ma5_sopra_o_sotto_ma100 < -0.03
                    and deviation_ma5_sotto_ma200 < -0.05
                    and deviation_ma5_sotto_ma300 < -0.07
                    and deviation_ma5_sotto_ma450 < -0.09


                    and deviation_ma200_sotto_ma300 > -0.20
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma5_last > ma10_last


                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    
                    and ma3_last > ma8_last
                    and macd > -60
                    
                ):   
                    buy = "BUY 5 che NON SPEZZA LA CATENA - NOTTE ! - con OSSO - r 7410 B"
                    action = "buy"
                    percentage = 70
                    
                    # deviation_buy3 = ma4_last/ma30_last
                    # ok tu non voi spezzare la catena.
                    # ma per essere un BUY 5 devi avere almeno ma13>ma50 cazzo !
                    # 14 ott 2022 aggiunto 3-10 !
                    # 20 gen 2025 anticipata ndecchia

                    # 27 gen 2025 e' NOTTE pero' 
                    # 27 gen 2025 and ma200_last >= ma200_120_min_ago
                    # 27 gen 2025 and ma300_last >= ma300_60_min_ago
                    # 27 gen 2025 and deviation_ma200_sotto_ma300 > -0.07 (ma200 e' ancora vicina alla ma300 !)


                    
                elif (      
                    ma3_last > ma11_last
                        
                    and (ma100_last > ma150_last or delta_1 < delta_2)
                    and (ma100_last > ma100_60_min_ago or ma300_last > ma300_120_min_ago)
                        
                    and ma2_last > ma5_last
                    and ma8_last > ma8_2_min_ago
                        
                ):
                    buy = "BUY 5 del 25 ott 2025 da un SELL GIORNO con ma100> E ma300> - r 7430"
                    action = "sell"

                    # 25 mar 2025 8-100 da 3-100 se GIORNO
                    #  8 ott 2025 10-100 da 8-100
                    # 18 ott 2025 aggiunta and ma10_last < ma30_last
                    # 25 ott 2025 aggiunta questa


                    
                      
                elif (
                    ma3_last > ma10_last
                    
                    and ma450_last > ma450_360_min_ago
                    and ma200_last > ma200_60_min_ago
                    and ma300_last > ma450_last

                    and deviation_ma25 < -0.17
                    and deviation_ma3_sotto_ma100 < -0.01

                    and deviation_ma3_sopra_ma10 > 0.01
                  
                    and ma3_last > ma8_last
                    
                    and macd > -80
                ):
                    buy = "BUY 5 con 300>450 NON C'E' proprio NIENTE DA SPEZZARE ! (la catena) - r 7441 a"
                    action = "buy"
                    percentage = 70

                    #  4 ott 2924 ho preso da un sell precedente e ho modificato questa anticipandola !
                    # 22 mag 2025 con deviation_ma25 < -0.17 aggiungo deviation_ma3_sotto_ma100 < -0.01


                elif (
                    ma3_last > ma8_last

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.085
                    and deviation_ma300_sopra_ma450 > -0.085

                    and ma450_last > ma450_360_min_ago
                    and ma78_last > ma150_last

                    and ma300_last < ma450_last

                    and deviation_ma3_sopra_ma10 > 0.01

                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 5 con ma450 > ma450 720 min ago e ma300_last < ma450_last - r 7441 B1 X"
                    action = "buy"
                    percentage = 70

                    #  9 nov 2024 se 450 sale da 6 ore non devi spezzare la catena !
                    # 29 gen 2025 comincio a risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 ma questa e' andata bene
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima



                
                elif (
                    ma3_last > ma8_last

                    and ma39_last > ma39_30_min_ago

                    and ma300_last < ma450_last
                    and ma450_last < ma450_720_min_ago

                    and ma450_last > ma450_360_min_ago
                    and ma78_last > ma150_last

                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 5 con ma450 < ma450 720 min ago MA ma450_last > ma450_360_min_ago - r 7441 B1 Ya"
                    action = "buy"
                    percentage = 70

                    # 21 mar 2025 anticipato ndecchiecella se ma39_last > ma39_30_min_ago


                elif (
                    ma3_last > ma8_last

                    and ma39_last < ma39_30_min_ago
                    and deviation_ma3_sotto_ma50 < -0.28

                    and (ma300_last < ma450_last or ma450_last < ma450_720_min_ago or ma450_last > ma450_360_min_ago)
                    

                    and ma450_last > ma450_360_min_ago
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 5 con ma450 < ma450 720 min ago MA ma450_last > ma450_360_min_ago + distanza al ribasso - r 7441 B1 Yb - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 70

                    #  9 nov 2024 se 450 sale da 6 ore non devi spezzare la catena !
                    # 29 gen 2025 comincio a risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 29 gen 2025 ma questa e' andata bene
                    # 21 mar 2025 se ma39_last < ma39_30_min_ago allora aggiungo and deviation_ma3_sotto_ma50 < -0.28
                    # 16 ott 2025 aggiunte parentesi graffe (ha comprato molto tardi dopo un rialzo improvviso)
                    # 16 ott 2025 and macd_differenza_2_min_ago > -18.50
                    # 16 ott 2025 ho tenuto or ma450_last > ma450_360_min_ago perche' potrebbe essere un buy veloce durante un trend in rialzo.


                elif (
                    ma3_last > ma15_last
                    
                    and (ma78_last < ma150_last or ma100_last < ma100_120_min_ago)
                    

                    and deviation_ma39 < -0.18
                    and deviation_ma3_sotto_ma50 < -0.18
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    and deviation_ma25_sotto_ma300 < -0.20
                    and deviation_ma25_sotto_ma300 > -0.50
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.10

                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 5 con ma78<ma150 or ma100< ma100_120_min e 25-300 tra -0.50 e -0.20 MA dev39 <-0.18 e 3-50 <-0.18 - r 7441 B2x
                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    
                    action = "buy"
                    percentage = 70

                    # 24 nov 2024 modificato importando un vecchio pensiero laterale da RCCR
                    #  8 mag 2025 anticipata ndecchia
                    # 16 mag 2025 con 25-300 tra -0.50 e -0.20 dev39 < -0.18 e 3-50 < -0.18
                    # 25 set 2025 aggiunte parentesi graffe !

                
                elif (
                    ma3_last > ma15_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    and deviation_ma25_sotto_ma300 < -1.50

                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 5 con ma78_last < ma150_last or ma100_last < ma100_120_min_ago e 25-300 < -0.50 - r 7441 B2 Yx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}
                    deviation_ma39 {deviation_ma39:.2f}
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 70

                    # 24 nov 2024 modificato importando un vecchio pensiero laterale da RCCR
                    #  8 mag 2025 anticipata ndecchia
                    # 16 mag 2025 con 25-300 < -0.50
                    # 14 ago 2025 e' andata bene. ha fatto la doppietta.
                    # 17 AGO 2025 aggiunto IL MIO CAPOLAVORO.
                    # 17 AGO 2025 N.B. 25-300 < -1.50
                    # 17 AGO 2025 N.B. 3-39 < -0.10
                    # 17 AGO 2025 N.B. 3-50 < -0.30
                    # 17 ago 2025 aggiunti valori deviation.
                    # 15 ott 2025 i valori deviation NON SONO COMPARSI. metto sulla stessa riga !




                elif (
                    ma3_last > ma15_last

                    and (ma100_last < ma100_60_min_ago or delta_CV_300_25_last > delta_CV_300_25_45_min_ago)
                    and deviation_ma25_sotto_ma300 < -1.60
                    and ma8_last >= ma8_2_min_ago 


                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.30
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    

                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 5 con ma78_last < ma150_last or ma100_last < ma100_120_min_ago e 25-300 < -1.60 - r 7441 B2 Yy - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}
                    deviation_ma39 {deviation_ma39:.2f}
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    action = "buy"
                    percentage = 70

                    # 24 nov 2024 modificato importando un vecchio pensiero laterale da RCCR
                    #  8 mag 2025 anticipata ndecchia
                    # 16 mag 2025 con 25-300 < -0.50
                    # 14 ago 2025 e' andata bene. ha fatto la doppietta.
                    # 17 AGO 2025 aggiunto IL MIO CAPOLAVORO.
                    # 17 AGO 2025 N.B. 25-300 < -1.50
                    # 17 AGO 2025 N.B. 3-39 < -0.10
                    # 17 AGO 2025 N.B. 3-50 < -0.30
                    # 17 ago 2025 aggiunti valori deviation.
                    # 15 ott 2025 i valori deviation NON SONO COMPARSI. metto sulla stessa riga !
                    # 15 ott 2025 aggiunto and ma8_last >= ma8_2_min_ago
                    # 17 ott 2025 ok !




                elif (
                    ma3_last > ma15_last

                    and ma150_last > ma250_last

                    and deviation_ma39 < -0.12

                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 5 8 mag 2025 - r 7470 a

                    deviation_ma39 {deviation_ma39:.2f} 
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                    """
                    
                    action = "buy"
                    percentage = 70

                    # 24 nov 2024 modificato importando un vecchio pensiero laterale da RCCR
                    #  8 mag 2025 ho modificato anche la precedente. e ho aggiunto ANCHE questa nuova condizione. va tutto bene. 
                    # 25 set 2025 con 150>250 lasco





                elif (
                    ma3_last > ma15_last

                    and delta_DNA_1 > delta_DNA_2

                    and deviation_ma39 < -0.30
                    and deviation_ma3_sotto_ma50 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and deviation_ma25_sotto_ma300 < -1.00
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.11
                    and ma8_last >= ma8_2_min_ago


                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma5_sopra_ma59 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma2_last >= ma10_last
                    
                    and macd_differenza_2_min_ago > -28.50
                ):
                    buy = f"BUY 5 modificato radicalmente il 25 set 2025 ex 8 mag 2025 - r 7470 b - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    
                    action = "buy"
                    percentage = 70

                    # 24 nov 2024 modificato importando un vecchio pensiero laterale da RCCR
                    #  8 mag 2025 ho modificato anche la precedente. e ho aggiunto ANCHE questa nuova condizione. va tutto bene. 
                    # 25 set 2025 se delta_DNA_1 > delta_DNA_2 aggiungo osso con parentesi graffe
                    # 14 OTT 2025 AGGIUNTE PARENTESI GRAFFE SULLA STESSA RIGA ma senza virgolette finale ( se ci sono le 3 virgolette iniziali.)
                    # 21 ott 2025 modificate deviation che sono comparse nelle pg
                    # 21 ott 2025 aggiunta and ma8_last >= ma8_2_min_ago
                    # 21 ott 2025 come vedi non c'e' ancora CV giorno o notte con intervento CM giorno.

                    
              


                # BUY 5 copiata da buy1 r1313 con modifiche
                
                elif (    
                    
                    ma200_last > ma200_20_min_ago
                    and ma78_last > ma150_last
                    and deviation_ma5_sopra_ma28 > 0.10
                    and (ma5_prev < ma28_prev and ma5_last > ma28_last)
                    
                    and ma28_last > ma34_last
                    
                    and ma3_last > ma28_last
                    
                    and ma100_last > ma200_last
                    and ma200_last > ma300_last
                    
                    and ma100_last > ma100_120_min_ago
                    and ma200_last > ma200_120_min_ago
                    and ma300_last > ma300_120_min_ago
                    
                    and ma13_last > ma100_last
                    and deviation_ma100_sopra_ma300 > 0.70
                    
                    and ma2_last > ma2_2_min_ago
                    
                ):    
                    
                    buy = "BUY 5 copiata da BUY 1 r1313 con modifiche - riga 7475"
                    action = "buy"
                    percentage = 70
                    
                    
                    
              
                # BUY 5D RIVOLUZIONARIO con ma78 < and deviation_bellissima > 0.163
                
                elif (
                    ma78_last < ma78_2_min_ago
                    and ma78_last > ma150_last
                    
                    and deviation_ma4_sopra_ma100 > 0.25
                    
                    and ma20_last > ma200_last
                    and deviation_buy3 > 0.04
                    and deviation_bellissima > 0.181
                    and delta_buy3_incrocio_ma3_ma8 > 0.075
                    and deviation_ma4_sopra_ma30 > 0.19
                    and ma3_last > ma8_last
                    and ma3_last > ma78_last
                    and ma4_last > ma4_2_min_ago
                    and ma7_last > ma25_last
                    
                    and ma2_last > ma2_2_min_ago
                ):
                    buy = "BUY 5D RIVOLUZIONARIO con ma78 < and deviation_bellissima > 0.163 - r 7502"
                    action = "buy"
                    percentage = 70
                    
                    
                   
                
                
                # RIALZO IMPROVVISO 200< DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE !
                
                elif (    
                   
                    ma200_last < ma200_20_min_ago
                    
                    and deviation_rialzo_improvviso_1 > 1.10
                    and deviation_rialzo_improvviso_2 > 0.20
                    and deviation_rialzo_improvviso_3 > 0.20
                    and deviation_rialzo_improvviso_4 > 0.20
              
                    and deviation_range_1 < 0.20
                    and deviation_range_1 > -0.20
                    and deviation_range_2 < 0.20
                    and deviation_range_2 > -0.20
                    and deviation_range_3 < 0.20
                    and deviation_range_3 > -0.20
             
                    and deviation_range_x < 0.20
                    and deviation_range_x > -0.20
                 
                ):

                    buy = "BUY 5 RIALZO IMPROVVISO con 200 < tentando di evitare falsi acquisti DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE ! - r 7538"
                    action = "buy"
                    percentage = 70
                    
                    # da 1.20 a 1.1 !
                    
                    
                    
                elif (    
                    ma3_last > ma10_last
                    and deviation_ma200_sotto_ma300 > -0.10

                    and ma8_last > ma8_2_min_ago
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 

                    and deviation_ma39 < -0.06
                    and deviation_ma3_sotto_ma50 < -0.09

                    
                    and ma78_last < ma150_last
                    and ma200_last < ma300_last
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    and ma450_last < ma450_480_min_ago

                    and deviation_ma5_sotto_ma450 < -0.49
                    
                    and (delta_DNA_1 < delta_DNA_2 or delta_50_25_last < delta_50_25_30_min_ago)
                    

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 5 - condizione 31 mar 2025 ! > 480 min di ribasso MA finalmente cominciano a migliorare le condizioni - r 7550 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}

                    deviation_ma39 {deviation_ma39:.2f}
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f}
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}
                    """

                    action = "buy"
                    percentage = 90
                    
                    # 31 mar 2025 aggiunta questa condizione MA DEVO SPIEGARTELA !
                    # and ma450_last < ma450_480_min_ago stiamo in un CHIARO ED EVIDENTE trend ribassista 
                    # and delta_DNA_1 < delta_DNA_2 significa CHE STANNO COMINCIANDO AD AVVICINARSI DOPO TANTO TEMPO 150-250
                    # and deviation_ma200_sotto_ma300 > -0.10 significa CHE ANCHE LA ma200 finalmente NON E' DISTANTE DALLA ma300 !
                    # 25 set 2025 aggiunte parentesi graffe
                    # 15 ott 2025 aggiunte pg sulla stessa riga (se ci sono 3 virgolette NON HO CHIUSO CON ")
                    # 23 ott 2025 aggiunto ma8 > ma8 2 min ago
                    # 23 ott 2025 aggiunto cm giorno



                elif (    
                    ma3_last > ma10_last
                    and deviation_ma200_sotto_ma300 > -0.10

                    and ma8_last > ma8_2_min_ago
                    and delta_CM_300_25_last > delta_CM_300_25_2_min_ago
                    
                    and deviation_ma39 < -0.15
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.093


                    and ma450_last < ma450_480_min_ago
                    and ma78_last < ma150_last
                    and ma200_last < ma300_last
                    
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago

                    and deviation_ma5_sotto_ma450 < -0.49
                    
                    and (delta_DNA_1 < delta_DNA_2 or delta_50_25_last < delta_50_25_30_min_ago)
                    

                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"""BUY 5 - condizione 31 mar 2025 ! > 480 min di ribasso MA finalmente cominciano a migliorare le condizioni - r 7550 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}

                    deviation_ma39 {deviation_ma39:.2f}
                    deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                    deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f}
                    deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                    deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f}
                    """

                    action = "buy"
                    percentage = 90
                    
                    # 31 mar 2025 aggiunta questa condizione MA DEVO SPIEGARTELA !
                    # and ma450_last < ma450_480_min_ago stiamo in un CHIARO ED EVIDENTE trend ribassista 
                    # and delta_DNA_1 < delta_DNA_2 significa CHE STANNO COMINCIANDO AD AVVICINARSI DOPO TANTO TEMPO 150-250
                    # and deviation_ma200_sotto_ma300 > -0.10 significa CHE ANCHE LA ma200 finalmente NON E' DISTANTE DALLA ma300 !
                    # 25 set 2025 aggiunte parentesi graffe
                    # 15 ott 2025 aggiunte pg sulla stessa riga (se ci sono 3 virgolette NON HO CHIUSO CON ")
                    # 23 ott 2025 aggiunto ma8 > ma8 2 min ago
                    # 23 ott 2025 aggiunto cm notte


                elif (
                    ma3_last > ma20_last
                    and (deviation_ma200_sotto_ma300 > -0.12 or delta_DNA_1 < delta_DNA_2)
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and ma50_last < ma50_2_min_ago
                    and delta_1 > delta_2
                    and ma100_last < ma100_60_min_ago
                        
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                        
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and ma2_last > ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 5 IMPORTATO DA RCCR e modificato dopo 50000 righe - r 7555"
                    action = "buy"
                    percentage = 80

                    # 16 mag 2025 in questa circostanza 3-10 e 3-50 non hanno profondita' ! vedi doppio delta 250-150
                    # 16 mag 2025 la ma200 si sta avvicinando alla ma300 ! (deviation_ma200_sotto_ma300 > -0.12)


                elif (    
                    ma3_last > ma18_last

                    and ma39_last < ma100_last
                    and deviation_ma3_sotto_ma50 < -0.30

                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last

                    and deviation_ma5_sotto_ma450 < -0.35
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso + distanza al ribasso - r 7562"
                    action = "buy"
                    percentage = 90
                    
                    # vuoi comprare dopo 120 min di ribasso ? deve essere 5-300 < -0.35 ! 
                    # voglio uno sconto ulteriore dello 0.35% ! PENSIERO LATERALE !
                    #  4 feb 2025 aggiunta da RCCR che era andata bene
                    # 21 mar 2025 pensiero laterale = distanza al ribasso




                # RIALZO IMPROVVISO 200> DOPO TANTO TEMPO DI TREND LATERALE - POTREBBE SUCCEDERE !
                
                elif (
                    ma200_last > ma200_20_min_ago
                    and (deviation_rialzo_improvviso_sopra > 0.50 or ma300_last > ma300_120_min_ago)
                    and deviation_rialzo_improvviso_1 > 0.40
                    and deviation_rialzo_improvviso_2 > 0.18
                    and deviation_rialzo_improvviso_3 > 0.18
                    and deviation_range_1 < 0.23
                    and deviation_range_1 > -0.23
                    and deviation_range_2 < 0.23
                    and deviation_range_2 > -0.23
                    and deviation_range_x < 0.23
                    and deviation_range_x > -0.23
                ):
             
                    buy = "BUY 5 RIALZO IMPROVVISO con 200> or 300 > DOPO TANTO TREND LATERALE - POTREBBE SUCCEDERE e' successo ! - r 7563"
                    action = "buy"
                    percentage = 70
                    
                    # 6 giu 2022 deviation rialzo improvviso a 0.82 da 0.62
                    # 1 luglio a 0.72 da 0.82
                    # > estate 0.69 da 0.72
                    #  3 lug 2023 0.60 da 0.69
                    # 26 apr 2025 and deviation_rialzo_improvviso_sopra > 0.50 da > 0.60
                    # 26 apr 2025 aggiunto or ma300_last > ma300_120_min_ago
                    # 26 apr 2025 and deviation_rialzo_improvviso_1 > 0.40 da 0.45



                
                # BUY 5 29 ago 2022 > 120 min di ribasso 78>150
                
                elif (
                    
                    ma18_last > ma100_last
                    and ma78_last > ma150_last
                    and deviation_ma5_sotto_ma200 < -0.30

                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 > 0.08
                    and ma2_last >= ma2_2_min_ago
                    
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78>150 - r 7564 A1"
                    action = "buy"
                    percentage = 90

                    #  2 ott 2024 con ma300_last < ma300_120_min_ago al BUY 5 aggiunto and deviation_ma5_sotto_ma200 < -0.50
                    #  2 ott 2024 nota bene quando si tratta di BUY 5 non dev 5-100 ma dev 5-200 
                    
                    
                    
                # BUY 5 29 ago 2022 > 120 min di ribasso 78<150
                
                elif (
                    
                    ma18_last > ma100_last
                    and ma78_last < ma150_last
                    
                    and ma100_last > ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.07
                    and deviation_ma5_sopra_ma28 > 0.12
                    and ma2_last >= ma2_2_min_ago
                    
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78<150 CON ma100>120 min ago - r 7564 A2x"
                    action = "buy"
                    percentage = 90
                    
                    # 19 set 2022 aggiunta 3-10 a 0.07
                    # 25 gen 2023 5-28 a 0.12

              
              
                elif (    
                    ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                    and ma450_last > ma450_480_min_ago
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78<150 CON ma100 < 120 min ago - r 7564 A2 YX1 NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90



                elif (    
                    ma3_last > ma39_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma5_last > ma50_last
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78<150 CON ma100 < 120 min ago - r 7564 A2 YX1 NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90
                    

                elif (    
                    ma3_last > ma20_last
                    
                    and ma3_last > ma20_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and ma450_last > ma450_480_min_ago
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78<150 CON ma100 < 120 min ago - r 7564 A2 YX1 NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90



                # 8 set 2024 CANCELLATA r 7564 A2 YX1 NUOVA ERA A3 SOFT



                elif (    
                    ma3_last > ma39_last
                    
                    and ma3_last > ma20_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78<150 CON ma100 < 120 min ago - r 7564 A2 YX1 NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

                elif (    
                    ma3_last > ma39_last
                    
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma450_last > ma450_480_min_ago
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78<150 CON ma100 < 120 min ago - r 7564 A2 YX1 NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90




                elif (    
                    ma3_last > ma39_last
                    
                    and ma5_last > ma39_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and ma450_last > ma450_480_min_ago
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.01
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.018
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso 78<150 CON ma100 < 120 min ago - r 7564 A2 YX1 NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90


                
                elif (    
                    ma3_last > ma13_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    and deviation_ma39_sotto_ma100 > -0.15

                    and deviation_ma39 < -0.10
                    and deviation_ma3_sotto_ma50 < -0.12

                    and deviation_ma300_sopra_ma450 < -0.33
                    and deviation_ma25_sotto_ma300 < -1.20
                    and deviation_ma50_sotto_ma300 < -1.20

                    and deviation_ma5_sotto_ma200 < -0.80
                    and deviation_ma5_sotto_ma300 < -1.50

                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                    
                    
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 5 continua a scendere > 120 min di ribasso - r 7564 A2 YX1 NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    #  2 feb 2024 tolto 39>78
                    # 14 nov 2024 aggiunta di zia amalia grafana
                    # 10 dic 2024 and macd > -60 and macd_differenza_2_min_ago > -2.00
                    # 26 feb 2025 tolta ma2 > ma2 2 min ago !
                    # 26 feb 2025 and macd a -70 da -60
                    # 27 feb 2025 CONTINUA A SCENDERE
                    # 27 feb 2025 tolto ma2 > ma2 2 min ago
                    # 27 feb 2025 tolto macd > -70

              
                # 30 dic 2024 cancellata r 7564 A2yy1

                

                elif (
                    
                    ma8_last > ma54_last
                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.37
                    and deviation_ma50_sotto_ma300 < -0.27
                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.15
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.22
                    and deviation_ma5_sotto_ma200 < -0.31
                    and deviation_ma5_sotto_ma300 < -0.41
                    and deviation_ma5_sotto_ma450 < -0.51
                    and deviation_ma300_sopra_ma450 < -0.072

                    

                    and ma78_last < ma150_last
                    
                    and ma100_last < ma100_120_min_ago
                    and ma200_last < ma200_120_min_ago
                    and ma300_last < ma300_120_min_ago
                  
                    and ma450_last < ma450_480_min_ago
                  
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.10
                    and ma2_last >= ma2_2_min_ago
                    
                ):
                    buy = "BUY 5 29 ago 2022 > 120 min di ribasso E 78<150 CON ma100<120 min ago E 39<100 aggiunta dnam - r 7564 A2yy2"
                    action = "buy"
                    percentage = 90
                    
                    # 19 set 2022 aggiunta 3-10 0.07 
                    # 25 gen 2023 5-28 0.15 da 0.12
                    #  1 feb 2023 8-100 da 18-100
                    # 12 set 2023 8-54 da 8-100
                    # 14 ott 2024 se anche 39<100 allora diamogli un osso !
                    #  5 gen 2025 aggiunta DNAM


                    
                # BUY 5 13 apr 2023 zia pina > 180 min di ribasso MA 39>100

                elif (    
                    ma3_last > ma20_last

                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.13
                    and deviation_ma39_sotto_ma100 > -0.15

                    
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma50_sotto_ma300 < -0.17
                    and deviation_ma39 < -0.03
                    and deviation_ma3_sotto_ma50 < -0.13
                    
                    and deviation_ma5_sotto_ma200 < -0.23
                    and deviation_ma5_sotto_ma300 < -0.27
                    and deviation_ma5_sotto_ma450 < -0.33
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    
                    and macd > -70
                    and macd_differenza_2_min_ago > -2.50
                ):
                    buy = "BUY 5 13 apr 2023 zia pina > 180 min di ribasso + DNAM + circello - r 7564 B1 X"
                    action = "buy"
                    percentage = 90
                    
                    # 27 set 2023 5-54 da 18-100
                    #  6 dic 2023 78>100 da 78>150
                    #  6 dic 2023 and macd >= macd_2_min_ago
                    #  5 nov 2024 se ma39_last > ma100_last fai un BUY
                    #  2 dic 2024 aggiunta DNAM
                    #  8 dic 2024 DNAM piu' aggressivo
                    #  5 gen 2025 aggiunto and deviation_ma300_sopra_ma450 < -0.072
                    #  5 gen 2025 tolta ma2 > ma2 2 min ago
                    # 17 feb 2025 macd a -70 da -60
                    # 17 feb 2025 and deviation_ma3_sotto_ma50 < -0.13 da < -0.10
                    # 22 feb 2025 aggiunta continua a scendere circello

                
                elif (    
                    ma5_last > ma54_last
                    and deviation_ma5_sotto_ma200 < -0.25
                    and ma30_last > ma300_last
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and deviation_ma5_sopra_ma28 > 0.01
                    
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > -2
                ):
                    buy = "BUY 5 13 apr 2023 zia pina > 180 min di ribasso 20>200 and macd >= macd_2_min_ago - r 7564 B1 Y"
                    action = "buy"
                    percentage = 90
                    
                    # 27 set 2023 5-54 da 18-100
                    #  6 dic 2023 78>100 da 78>150
                    #  6 dic 2023 and macd >= macd_2_min_ago
                    
                    # ATTENZIONE 8 dic 2023 basta BUY 5 continui !
                    # 10 set 2024 ma30 deve andara sopra la ma300
                    #  2 ott 2024 al BUY 5 se 300< aggiungo and deviation_ma5_sotto_ma200 < -0.25


                    
                # BUY 5 29 ago 2022 > 180 min di ribasso 78<150
                
                
                elif (
                    
                    
                    ma78_last < ma150_last
                    and deviation_ma5_sotto_ma300 > -0.10
                    
                    and deviation_ma5_sopra_ma59 < -0.10
                    and deviation_ma3_sopra_ma10 > 0.057
                    and deviation_ma3_sopra_ma16 > 0.06
                  
                    and deviation_ma5_sopra_ma28 < 0.10
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min di ribasso 78<150 and 3-16 > 0.06 and macd > macd 2 min ago - r 7564 B2x"
                    action = "buy"
                    percentage = 90

              
                elif (
                    ma3_last > ma18_last
                    and ma78_last < ma150_last
                    
                    and deviation_ma300_sopra_ma450 < -0.22
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.06
                    
                    and deviation_ma39 < -0.20
                    and deviation_ma3_sotto_ma50 < -0.22

                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and macd > -80
                    and ma2_last > ma5_last
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min di ribasso E 78<150 - r 7564 B2 Y1 X"
                    action = "buy"
                    percentage = 90

                    # 26 feb 2025 anticipato ndecchiecella
                    
                
                elif (
                 
                    ma78_last < ma150_last
                    and ma39_last < ma39_13_min_ago
                    and ma20_last > ma20_2_min_ago
                    and deviation_ma39 > 0.33
                    
                    and ma2_differenza_2_min_ago > 7
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.057
                    and deviation_ma3_sopra_ma16 > 0.06
                    and deviation_ma5_sopra_ma28 < 0.03
                    
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min di ribasso CON ma20>ma20 2 min ago E 78<150 and 3-16 > 0.06 e ma2_differenza_2_min_ago > 7 - r 7564 B2Y1y"
                    action = "buy"
                    percentage = 90
                    
                    # 18 dic 2023 aggiunto ma20 > ma20 2 min ago

                  


                elif (     
                    ma5_last > ma54_last

                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.20
                 
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A1 SOFT"
                    action = "buy"
                    percentage = 90

              

                
                elif (     
                    ma5_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A2 SOFT 1"
                    action = "buy"
                    percentage = 90
                  

                
                elif (     
                    ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60 
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A2 SOFT 2"
                    action = "buy"
                    percentage = 90
                  

                elif ( 
                    ma5_last > ma54_last
                    and ma100_last > ma100_5_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.50
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A3 SOFT"
                    action = "buy"
                    percentage = 90
                    
                    #  9 feb 2024 IMPORTANTE ! solo BUY 5 NUOVA ERA A3 SOFT con ma100 > ma100 5 min ago !!!
                
                
                elif (     
                    ma3_last > ma39_last
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.50
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A4 SOFT"
                    action = "buy"
                    percentage = 90

               

                
                elif (     
                    ma5_last > ma54_last
                    and ma3_last > ma54_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > 0.22
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A1 STRONG"
                    action = "buy"
                    percentage = 90
                  

                
                elif (     
                    ma5_last > ma50_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.40
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A2 STRONG"
                    action = "buy"
                    percentage = 90

                
                
                elif (     
                    ma3_last > ma30_last
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    and ma20_last <= ma20_2_min_ago
                    and ma78_last < ma150_last
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma100_last < ma100_180_min_ago
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and deviation_ma5_sotto_ma300 < -0.10
                    
                    and deviation_ma3_sopra_ma10 > 0.022
                    and deviation_ma3_sopra_ma16 > 0.05
                    and deviation_ma5_sopra_ma28 < -0.02
                    
                    and ma2_last >= ma2_2_min_ago
                    and ma2_differenza_2_min_ago > 8
                    and macd >= macd_2_min_ago
                    and ma2_last > ma5_last
                    and ma3_differenza_2_min_ago > 1
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < 0.10 ma > -1.20 e 78<150 e 3-16 > 0.05 e macd > - r 7564 B2 Y2 X NUOVA ERA A3 STRONG"
                    action = "buy"
                    percentage = 90
                    
                    # 14 gen 2024 aggiunta and ma3_differenza_2_min_ago > 1
                    # 14 gen 2024 deviation_ma3_sopra_ma10 > 0.022 da 0.01

              

              
                
                elif ( 
                    ma3_last > ma10_last
                    
                    and ma100_last < ma450_last
                    and deviation_ma39_di_adesso_diviso_ma39_di_120_min_ago < -0.75
                    and deviation_ma300_sopra_ma450 < -0.22
                    and delta_1 > delta_2
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                    

                    
                    and ma39_last > ma100_last
                    and deviation_ma5_sotto_ma300 < -1.20
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.08
                    
                    
                    
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    
                    and ma200_last < ma300_last
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 29 ago 2022 > 180 min ribasso CON 5-300 < -1.20 E 78<150 + cano STAF + circello - r 7564 B2 Y2 y"
                    action = "buy"
                    percentage = 90
                    
                    # 7 feb 2023 deviation_ma5_sopra_ma28 > 0.10 da 0.13
                    # tolto 18>100 
                    # aggiunto PENSIERO LATERALE and deviation_ma5_sopra_ma59 < -0.09
                    # 19 apr 2023 aggiunta 3-16 > 0.06
                    #  9 mag 2023 aggiunta 3-10 > 0.057
                    #  9 mag 2023 aggiunto macd > macd 2 min ago
                    # 24 ago 2023 and deviation_ma5_sopra_ma59 < -0.10
                    # 27 set 2023 3-39 da 3-59
                    
                    # 18 nov 2023 and deviation_ma5_sopra_ma28 < 0.03 da < 0.05
                    #  6 dic 2023 aggiunto and ma2_differenza_2_min_ago > 5
                    # 10 dic 2023 aggiunto and ma2_last > ma5_last 
                    # 10 dic 2023 ma2_differenza_2_min_ago >7 da >5
                    # 18 dic 2023 aggiunto ma20 <= ma20 2 min ago
                    # 18 dic 2023 and deviation_ma3_sopra_ma16 > 0.08 da 0.06

                    #  2 ott 2024 aggiunta da CANO STAF and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    #  2 ott 2024 aggiunta da CANO STAF and deviation_ma5_sopra_o_sotto_ma100 < -0.27
                    #  2 ott 2024 e' una condizione che ha continuato a comprare diverse volte durante il ribasso !
                    # 22 feb 2025 aggiunta continua a scendere circello
                    #  8 apr 2025 anticipata ndecchiecella




                
                elif (    
                    ma3_last > ma18_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    
                    
                    and ma450_last < ma450_360_min_ago
                    and ma300_last < ma300_60_min_ago
                    
                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    and deviation_ma100_sopra_ma300 < -0.10

                    and deviation_ma3_sotto_ma50 < -0.06

                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.125
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 5 che mancava 8 apr 2025 - r 7570 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # aggiunta 8 apr 2025 e' andata benissimo su RCCR durante un lungo crollo !
                    # 21 ott 2025 aggiunte pg



                elif (    
                    ma3_last > ma13_last

                    and ma300_last < ma300_60_min_ago
                    and ma450_last < ma450_360_min_ago

                    and ma100_last < ma100_10_min_ago

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.045

                    and deviation_ma5_sopra_o_sotto_ma100 > -0.60
                    and deviation_ma5_sopra_ma200 > -0.30
                    and deviation_ma5_sotto_ma300 > -0.30
                    and deviation_ma5_sotto_ma450 > -0.30

                    and deviation_ma50_sopra_o_sotto_ma100 > -0.20
                    and deviation_ma100_sopra_ma300 > -0.20

                    and deviation_ma3_sotto_ma50 < -0.05

                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = f"BUY 5 che mancava 21 ott 2025 - r 7570 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # aggiunta 8 apr 2025 e' andata benissimo su RCCR durante un lungo crollo !
                    # 21 ott 2025 aggiunte pg
                    # 21 ott 2025 aggiunta questa nuova condizione che deriva dalla precedente
                    # 21 ott 2025 trend decrescente consolidato ma tutte le medie lunghe cominciano a risalire !
                    # 21 ott 2025 and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.045 (e' una garanzia)



                # 16 apr 2025 nuova condizione che mancava e che ci deve essere


                elif (
                    ma3_last > ma13_last
                    and ma100_last > ma100_120_min_ago
                   
                    and delta_1 < delta_2
                    and (ma3_last > ma100_last or ma3_last > ma150_last or ma3_last > ma200_last)
                    and deviation_ma100_sopra_ma200 > -0.13

                    and ma300_last < ma300_180_min_ago
                    and deviation_ma200_sotto_ma300 < -0.06
                    and deviation_ma25_sotto_ma300 < -0.05
                    and deviation_ma100_sopra_ma300 < -0.15
                    
                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
             
                ):
                    buy = "BUY 5 nuova condizione 16 apr 2025 - GIORNO - CAZZO e 100>120 min - r 7575a"
                    action = "buy"
                    percentage = 70

                    # 16 mag 2025 se anche ma100_last > ma100_120_min_ago




                elif (
                    ma3_last > ma13_last

                    and ma100_last < ma100_120_min_ago
                    and deviation_ma39 < -0.08
                    and deviation_ma3_sotto_ma50 < -0.08
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20
                    and deviation_ma25_sotto_ma300 < -0.50

                    and delta_1 < delta_2
                    and (ma3_last > ma100_last or ma3_last > ma150_last or ma3_last > ma200_last)
                    and deviation_ma100_sopra_ma200 > -0.13

                    and ma300_last < ma300_180_min_ago
                    and deviation_ma200_sotto_ma300 < -0.06
                    and deviation_ma100_sopra_ma300 < -0.15
                    
                    
                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
             
                ):
                    buy = "BUY 5 nuova condizione 16 apr 2025 - GIORNO - CAZZO ma 100<120 min - r 7575b1"
                    action = "buy"
                    percentage = 70

                    # 16 mag 2025 MA ma100_last < ma100_120_min_ago



                elif (
                    ma3_last > ma13_last

                    and ma100_last < ma100_120_min_ago
                    and deviation_ma25_sotto_ma300 < -0.20
                    and deviation_ma25_sotto_ma300 > -0.50

                    and deviation_ma39 < -0.18
                    and deviation_ma3_sotto_ma50 < -0.18
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.20

                    and delta_1 < delta_2
                    and (ma3_last > ma100_last or ma3_last > ma150_last or ma3_last > ma200_last)
                    and deviation_ma100_sopra_ma200 > -0.13

                    and ma300_last < ma300_180_min_ago
                    and deviation_ma200_sotto_ma300 < -0.06
                    and deviation_ma100_sopra_ma300 < -0.15
                    
                    
                    and ma3_last > ma10_last
                    
                    and macd_differenza_2_min_ago > -18.50
             
                ):
                    buy = "BUY 5 nuova condizione 16 apr 2025 - GIORNO - CAZZO MA 100<120 min - r 7575b2"
                    action = "buy"
                    percentage = 70

                    # 16 apr 2025 attenzione ! IN QUESTA CIRCOSTANZA TOLTO and deviation_ma39 < -0.02
                    # 16 apr 2025 attenzione ! and deviation_ma100_sopra_ma200 > -0.13 significa che 100 si sta avvicinando alla 200 
                    # 16 apr 2025 ha smesso di crollare e sta risalendo !

                    # 16 mag 2025 MA ma100_last < ma100_120_min_ago






                elif ( 
                    ma3_last > ma10_last

                    and ma78_last < ma150_last
                    and ma100_last < ma450_last

                    and deviation_ma5_sotto_ma300 < -2.00
                    and deviation_ma25_sotto_ma300 < -2.00
                    and deviation_ma50_sotto_ma300 < -2.20
                    and deviation_ma200_sotto_ma300 < -1.00
                    and deviation_ma5_sotto_ma450 < -3.00
                    and deviation_ma300_sopra_ma450 < -0.22

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.15
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.08
                    
                    and ma100_last < ma200_last
                    and ma200_last < ma300_last
                    and ma200_last < ma200_180_min_ago
                    and ma300_last < ma300_180_min_ago
                    
                    and macd_differenza_2_min_ago > -18.50
                ):
                    buy = "BUY 5 apr 2025 in pieno ribasso con 78<150 + cano STAF + roma - r 7580"
                    action = "buy"
                    percentage = 90

                    #  7 apr 2025 nuova condizione che mancava !




                
                # NELLA CORREZIONE EVENTUALE (SIAMO AL BUY 5 !) qui NON HO messo and ma50_last > ma100_last
                
                # BUY 5 DURANTE UNA piccola CORREZIONE che NON E' un forte ribasso e NON E' un crollo ! (compare stammi vicino!)

                elif (    
                    ma3_last > ma39_last
                        
                    and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                    and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                    and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.10
                        
                    and ma300_last < ma300_301_min_ago
                    and ma200_last < ma200_60_min_ago
                    and ma50_last < ma100_last
                        
                    and ma3_last < ma5_last
                    and ma2_last > ma2_2_min_ago
                    and ma8_last > ma8_2_min_ago 
                    and macd_differenza_2_min_ago > 0.20
                ):
                    sell = "BUY 5 con and ma8_last > ma8_2_min_ago se 300 < 300 301 min ago and macd_differenza_2_min_ago > 0.20 - r 7587"
                    action = "sell"
                        
                    # 29 ott 2023 non aveva comprato e ho aggiunto questa
                

                
                elif (
                    ma3_last > ma8_last
                    and ma20_last < ma50_last
                    and delta_1 > delta_2

                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 


                    and ma450_last > ma450_720_min_ago
                    
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    

                    and deviation_ma39 < -0.02
                    and deviation_ma3_sotto_ma50 < -0.07

                    and ma200_last >= ma200_120_min_ago
                    and ma300_last >= ma300_60_min_ago

                    and deviation_buy_crollo_1 < -0.29

                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma5_sopra_ma28 > -0.12
                    
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"BUY 5 DURANTE UNA CORREZIONE che non e' un forte ribasso e non e' un crollo ! - r 7588 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # 23 ott 2023 se CM GIORNO ok cosi'
                    # 23 ott 2025 aggiunte pg


                    

                elif (
                    ma3_last > ma8_last
                    and ma20_last < ma50_last
                    and delta_1 > delta_2


                    and delta_CM_300_25_last > delta_CM_300_25_2_min_ago
                    and deviation_ma39 < -0.23
                    and deviation_ma3_sotto_ma50 < -0.25
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.35

                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.10

                    and deviation_buy_crollo_1 < -0.29
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.05
                    
                    and ma450_last > ma450_720_min_ago
                    and ma200_last >= ma200_120_min_ago
                    and ma300_last >= ma300_60_min_ago

                    and deviation_ma3_sopra_ma10 > 0.01
                   
                    and macd_differenza_2_min_ago > -18.50
                ):    
              
                    buy = f"BUY 5 DURANTE UNA CORREZIONE che non e' un forte ribasso e non e' un crollo ! - r 7588 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 80

                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # deviation_correzione = ma3_last / ma25_last
                    # ma5 non deve allontanarsi troppo dalla ma200 !
                    # 27 mar 2025 anticipata ndecchiecella
                    #  3 apr 2025 perfezionata
                    #  4 apr 2025 perfezionata con 3-39 e 3-50
                    # 23 ott 2025 se CV notte aggiungo deviation da una condizione successiva che e' andata bene
                    # 23 ott 2025 aggiunte pg

                
               
                
                # BUY 5 compare forever EX BUY 1 r 1537 A2y1 - con 5-20 E CON 300 ancora vicina alla 450 ( anche un poco sotto !)
                
                elif (      
                    ma3_last > ma13_last
                    
                    and (ma100_last < ma100_120_min_ago or deviation_ma78_sopra_o_sotto_ma200 < -0.028)
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and ma2_last >= ma20_last
                    and ma2_last >= ma2_2_min_ago
                ):    
                    buy = f"BUY 5 CF EX BUY 1 r 1537 A2y1 - 100<120 min ago MA 100>60 min ago con 5-20 E 300 vicina alla 450 + MACD > E ma50_diff_ma59 > -5 - r 7589 a2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                    action = "buy"
                    percentage = 90
                    
                    # 20 nov 2023 ma100 < 100 120 min ago MA ma 100> 60 min allora compra una ndecchiecella prima
                    # ATTENZIONE 8 dic 2023 se 78 sotto 200 allora aggiunto diff ma2 > 10 e diff macd >2 CIOE' basta BUY 5 continui ! (se 78 molto sotto 200)
                    # 24 ott 2025 aggiunte pg - intanto ho tentato di anticipare ndecchiecella.



              

                # 22 set 2024 cancellata r 7589 B1



                elif (      
                    ma3_last > ma13_last

                    and ma450_last > ma450_120_min_ago
                    and ma100_last < ma100_120_min_ago
                    and ma100_last < ma100_60_min_ago

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2 

                    and deviation_ma78_sopra_o_sotto_ma200 < -0.028
                    
                    and deviation_ma39 < -0.015
                    and deviation_ma3_sotto_ma50 < -0.015
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 5 CF con 100<120 min ago E 100<60 min ago MA 450 > 450 350 min ago ! e 450>120 min - r 7589 B2 x1 x1"
                    action = "buy"
                    percentage = 90
                    
                    #  10 gen 2023 se 5 e' vicina alla 300 E STIAMO AL BUY 5 deve essere almeno 3-39
                    #  8 dic 2024 39 e' andata sopra 100 con ma100_last < ma100_120_min_ago
                    # 22 feb 2025 se ma450_last > ma450_360_min_ago anticipo ndecchiecella
                    # 28 feb 2025 tolta ma2 > ma2 2 min ago
                    # 28 feb 2025 tolta macd > -60
                    #  6 ago 2025 ok - E' ANDATO BENISSIMO
                    # 10 ago 2025 KO - E' ANDATO MALE



                elif (      
                    ma3_last > ma13_last

                    and deviation_ma78_sopra_o_sotto_ma200 > -0.028

                    and ma450_last < ma450_120_min_ago
                    and ma100_last < ma100_120_min_ago
                    and ma100_last < ma100_60_min_ago

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 < delta_DNA_2 

                    and deviation_ma39 < -0.015
                    and deviation_ma3_sotto_ma50 < -0.015
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and macd_differenza_2_min_ago > -18.50
                    
                ):    
                    buy = "BUY 5 CF con 100<120 min ago E 100<60 min ago MA 450 > 450 350 min ago ! MA 450<120 min  - r 7589 B2 x1 x2"
                    action = "buy"
                    percentage = 90
                    
                    #  10 gen 2023 se 5 e' vicina alla 300 E STIAMO AL BUY 5 deve essere almeno 3-39
                    #  8 dic 2024 39 e' andata sopra 100 con ma100_last < ma100_120_min_ago
                    # 22 feb 2025 se ma450_last > ma450_360_min_ago anticipo ndecchiecella
                    # 28 feb 2025 tolta ma2 > ma2 2 min ago
                    # 28 feb 2025 tolta macd > -60
                    #  6 ago 2025 ok - E' ANDATO BENISSIMO
                    # 10 ago 2025 KO - E' ANDATO MALE
                    # 10 ago 2025 se ma450_last < ma450_120_min_ago allora deviation_ma78_sopra_o_sotto_ma200 > -0.028 
                    # 10 ago 2025 78-200> -0.028 l' ho presa dalla condizione che ha comprato dopo tanto tempo di riavvicinamento.


                elif (      
                    ma3_last > ma13_last

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 > delta_DNA_2
                    and deviation_ma3_sotto_ma50 < -0.40

                    and deviation_ma78_sopra_o_sotto_ma200 < -0.028
                    
                    and ma100_last < ma100_120_min_ago
                    and ma100_last < ma100_60_min_ago

                    and deviation_ma39 < -0.30
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 5 CF con 100<120 min ago E 100<60 min ago MA 450 > 450 350 min ago + DNA - NOTTE - r 7589 B2 x1 y"
                    action = "buy"
                    percentage = 90
                    
                    #  10 gen 2023 se 5 e' vicina alla 300 E STIAMO AL BUY 5 deve essere almeno 3-39
                    #  8 dic 2024 39 e' andata sopra 100 con ma100_last < ma100_120_min_ago
                    # 22 feb 2025 se ma450_last > ma450_360_min_ago anticipo ndecchiecella
                    # 28 feb 2025 aggiunta DNA - NOTTE
                    # 28 feb 2025 tolta ma2 > ma2 2 min ago
                    # 28 feb 2025 tolta macd > -60


                elif (     
                    
                    ma3_last > ma13_last
                    and deviation_ma39 <= -0.30
                    and ma100_last < ma100_120_min_ago
                    and ma100_last < ma100_60_min_ago

                    and deviation_ma5_sotto_ma300 > -1.00
              
                    and deviation_ma78_sopra_o_sotto_ma200 < -0.028
                    and ma2_differenza_2_min_ago > 10
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -40
                    
                    and macd_differenza_2_min_ago > 2
                ):    
                    buy = "BUY 5 ipervenduto DNA - 100<120 min ago E 100<60 min ago con 5-20 + MACD > E ma50_diff_ma59 > -5 - r 7589 B2x2"
                    action = "buy"
                    percentage = 90
                    
                    # 10 gen 2023 se 5 e' vicina alla 300 E STIAMO AL BUY 5 deve essere almeno 3-39
                    # 21 feb 2024 ipervenduto DNA



    
                elif (     
                    
                    ma3_last > ma13_last
                    and deviation_ma5_sotto_ma300 < -1.00
                    
              
                    and deviation_ma78_sopra_o_sotto_ma200 < -0.028
                    and ma2_differenza_2_min_ago > 10
                    
                    and ma100_last < ma100_120_min_ago
                    and ma100_last < ma100_60_min_ago
                    
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < 0.015
                    and deviation_ma54_sopra_o_sotto_ma72 > -0.015
                    
                    and deviation_ma39_sotto_ma200 < 0.10
                    and deviation_ma300_sopra_ma450 > -0.37
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > 0.01
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last >= ma20_last
                  
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                    and macd > -40
                    and ma50_differenza_ma59 > -5
                    and macd_differenza_2_min_ago > 2
                ):    
                    buy = "BUY 5 compare forever EX BUY 1 r 1537 A2y1 - 100<120 min ago E 100<60 min ago con 5-20 E CON 300 vicina alla 450 + MACD > E ma50_diff_ma59 > -5 - r 7589 B2y"
                    action = "buy"
                    percentage = 90
                    
                    # 27 nov 2023 aggiunta and ma2_differenza_2_min_ago > 3
                    
                    # ATTENZIONE 8 dic 2023 se 78 sotto 200 allora aggiunto diff ma2 > 10 e diff macd >2 CIOE' basta BUY 5 continui ! (se 78 molto sotto 200)
                    #  10 gen 2023 se 5 molto sotto alla 300 E STIAMO AL BUY 5 e' comunque un crollo e sono aggressivo ! e' una occasione.
              

                  
                # BUY 5 migliore EX r 1043 B che considera distanza 5-300 AND dev 10-200 < -0.24 AND 8-59
                
                elif (
                    
                    ma3_last > ma18_last
                
                    and ma450_last < ma450_360_min_ago
                    and deviation_ma100_sopra_ma450 > -0.27

                    and deviation_ma5_sopra_ma200 < -0.30
                    and deviation_ma5_sotto_ma300 < -0.30
                    and deviation_ma5_sotto_ma450 < -0.30
                    and deviation_ma50_sopra_o_sotto_ma100 < -0.01
                    
                    and deviation_ma100_sopra_ma300 < -0.10
                    
                    and ma300_last < ma300_60_min_ago
                    and ma200_last < ma200_60_min_ago
                    
                    and deviation_ma3_sopra_ma10 > 0.081
                    
                    and deviation_ma5_sopra_ma28 > -0.15
                    and deviation_ma3_sopra_ma16 > -0.12
                    
                    and ma2_last >= ma2_2_min_ago
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 5 EX BUY 1 1043 B considera distanza 5-300 AND dev 10-200 < -0.24 AND dev 4-18 - r 7590"
                    action = "buy"
                    percentage = 70
                    
                    # 16 nov 2023 questa condizione l'ho importata dal BUY 1 perche' ha comprato benissimo e mi ha fatto risparmiare un sacco di SELL
                    #  2 ott 2024 lasciala per il momento (ha comprato appena ha ripreso a scendere e con 450 che scendeva da gia' da tanto...)
                    #  2 ott 2024 se e' un BUY 5 e 450 scende da tanto tempo la ma100 NON DEVE STARE TROPPO LONTANA DALLA ma450 ! 
                    #  2 ott 2024 perche' altrimenti sta scendendo ed e' inutile andare contro il mercato. lasciala scendere !


                elif (
                    ma3_last > ma8_last
                    
                    and ma300_last > ma300_301_min_ago

                    and deviation_ma200_sotto_ma300 < -0.30
                    and deviation_ma25_sotto_ma300 < -0.70
                    
                    and deviation_ma3_sotto_ma50 < -0.30

                    and macd_differenza_2_min_ago > -5.50
                ):    
              
                    buy = "BUY 5 che mancava 26 mar 2025 - r 7591"
                    action = "buy"
                    percentage = 90

                    # 26 mar 2025 aggiunta questa condizione che mancava




                # BUY 1 GRANDE RIBASSO MASERATI CHE NON E' UN CROLLO ! (compare stammi vicino!) HA FUNZIONATO ! viva ro combaro meo !
              
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -0.91
                    and deviation_buy_crollo_1 > -1.80
                    and deviation_ma5_sopra_ma28 > 0.03
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 5 GRANDE RIBASSO MASERATI CHE NON E' UN CROLLO che ho dovuto mettere! con 5-28 - r 7592"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !

              

                # BUY 1 CROLLO FERRARI ! (compare stammi vicino!) HA FUNZIONATO ! viva ro combaro meo !
              
                elif (
                    ma2_last > ma2_2_min_ago
                    and deviation_buy_crollo_1 < -1.81
                    
                    and deviation_ma5_sopra_ma28 > 0.03
                    and ma78_last < ma200_last
                    and macd >= macd_2_min_ago
                ):
                    buy = "BUY 5 CROLLO FERRARI che ho dovuto mettere! con 5-28 - r 7593"
                    action = "buy"
                    percentage = 80
                    
                    # deviation_buy_crollo_1 = ma8_last / ma78_last
                    # questa cosa che 78 deve essere < 200 ha dell' incredibile. MA NON TOCCARE !



                elif (  
                    ma3_last > ma16_last
                    and ma20_last > ma50_last

                    and ma450_last > ma450_360_min_ago
                    and (ma78_last > ma150_last or ma100_last > ma450_last)
                    
                    and deviation_ma3_sotto_ma100 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma9_last
                    and macd_differenza_2_min_ago > -12.50
                    
                ):    
              
                    buy = "BUY 5 con ma450_last > ma450_360_min_ago E 20>50 e 78>150 del 18 mag 2025 - r 7594 a"
                    action = "buy"
                    percentage = 90

                    # 18 mag 2025 aggiunta da RCCR
                    # 22 mag aggiunta or ma100_last > ma450_last


                    


                elif (  
                    ma3_last > ma13_last

                    and ma20_last < ma50_last
                    and (delta_1 < delta_2 or delta_DNA_1 < delta_DNA_2)
                    

                    and ma450_last > ma450_360_min_ago
                    and (ma78_last > ma150_last or ma100_last > ma450_last)
                    

                    and deviation_ma39 < -0.12
                    and deviation_ma3_sotto_ma50 < -0.12
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.25
                    and deviation_ma25_sotto_ma300 < -0.25
                    and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.10
                    
                    
                    and ma3_last > ma9_last
                    and macd_differenza_2_min_ago > -18.50
                    
                ):    
              
                    buy = f"BUY 5 con ma450_last > ma450_360_min_ago MA 20<50 e 78>150 del 18 mag 2025 - r 7594 b - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                    action = "buy"
                    percentage = 90

                    # 18 mag 2025 aggiunta da RCCR
                    # 22 mag aggiunta or ma100_last > ma450_last
                    #  6 ago 2025 se 20<50 aggiunto and (delta_1 < delta_2 or delta_DNA_1 < delta_DNA_2)
                    # 17 ott 2025 aggiunte pg




                elif (  
                    ma3_last > ma16_last
                    and (ma100_last < ma200_last or ma78_last < ma150_last)
                    and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                    and ma450_last > ma450_360_min_ago
                    and ma100_last > ma450_last
                    
                    and deviation_ma3_sotto_ma100 < -0.02
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    
                    and ma3_last > ma9_last
                    and macd_differenza_2_min_ago > -12.50
                    
                ):    
              
                    buy = "BUY 5 con ma450_last > ma450_360_min_ago MA CHE COMINCIA A CURVARE VERSO IL BASSO (78<150) and CM GIORNO - r 7595"
                    action = "buy"
                    percentage = 90

                    # 18 mag 2025 aggiunta da RCCR
                    # 22 mag 2025 aggiunta or ma78_last < ma150_last
                    # 22 mag 2025 aggiunta and deviation_ma3_sotto_ma100 < -0.02
                    # 10 ago 2025 con 100<200 or 78<150 aggiunto CM GIORNO !


                elif (
                    ma3_last > ma13_last

                    and ma450_last > ma450_360_min_ago
                    and delta_DNA_1 > delta_DNA_2
                    and deviation_ma3_sotto_ma50 < -0.02

                    and ma450_last > ma450_720_min_ago
                    and deviation_ma300_sopra_ma450 < 0.11
                    and deviation_ma300_sopra_ma450 > -0.11

                    and ma200_last > ma200_60_min_ago

                    and ma3_last > ma7_last
                    
                    and macd_differenza_2_min_ago > -12.50
                ):
                    buy = "BUY 5 con ma450_last > ma450_720_min_ago e con ma200> + DNA NOTTE - r 7598"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 sto cercando di risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 cancellato and ma2_last > ma2_2_min_ago e anticipato ndecchiecella
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 28 feb 2025 aggiunta DNA NOTTE
                    # 21 mag 2025 e' andata bene sul BUY 3 e pe ro 2 botte e' stata portata anche qui.



                elif (        
                    ma3_last >= ma20_last
                    
                    and ma100_last < ma100_30_min_ago
                    and deviation_ma3_sotto_ma50 < -0.28

                    and ma450_last > ma450_360_min_ago
                    and ma450_last > ma450_720_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    
                    and macd_differenza_2_min_ago > -2.50
                    
                ):    
                    buy = "BUY 5 CF con 3-20 and ma100_last < ma100_30_min_ago + distanza al ribasso - r 7600 NUOVA ERA 1X X"
                    action = "buy"
                    percentage = 90

                    # 17 feb 2025 anche 25 deve stare vicina alla 300 ! 
                    # 22 feb 2025 anticipata ndecchiecella
                    # 21 mar 2025 con and ma100_last < ma100_30_min_ago aggiungo distanza al ribasso 

                elif (        
                    ma3_last >= ma20_last
                    and deviation_ma25_sotto_ma300 < -0.22

                    and ma39_last < ma100_last
                    and ma100_last < ma100_30_min_ago
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015

                    and deviation_ma50_sotto_ma300 < -0.17
                    and deviation_ma39 < -0.07
                    and deviation_ma3_sotto_ma50 < -0.10
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.13
                    and deviation_ma5_sotto_ma200 < -0.55
                    and deviation_ma5_sotto_ma300 < -0.59
                    and deviation_ma5_sotto_ma450 < -0.69
                    and deviation_ma300_sopra_ma450 < -0.072


                    and ma450_last > ma450_720_min_ago
                    and ma450_last > ma450_360_min_ago
                    
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    
                    
                    and deviation_ma3_sopra_ma10 > -0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last > ma5_last
                    and macd > -60
                    and macd_differenza_2_min_ago > -1.50
                    
                ):    
                    buy = "BUY 5 CF - con 3-30 E CON 300 ancora vicina alla 450 ( anche un poco sotto ! ) + diff macd > - r 7600 NUOVA ERA 1Xy"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 comincio a risolvere il problema del trend laterale dopo un grande RIALZO
                    # 29 gen 2025 and ma450_last > ma450_720_min_ago
                    # 29 gen 2025 tolto and ma2_last >= ma2_2_min_ago
                    # 30 gen 2025 nel corridoio 300-450 puo' comprare prima
                    # 17 feb 2025 se 25 ha cominciato a scendere si allontana dalla 300 allora osso



                elif (        
                    ma3_last >= ma30_last
                    and ma450_last < ma450_720_min_ago


                    and ma100_last > ma100_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.57
                    
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma3_differenza_2_min_ago > 7
                    
                    and ma100_last < ma100_30_min_ago
                    and ma450_last > ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.027
                    and deviation_ma3_sopra_ma16 > -0.01
                    and deviation_ma3_sopra_ma18 > -0.02
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1.10
                    
                ):    
                    buy = "BUY 5 CF - con 3-30 E CON 300 ancora vicina alla 450 ( anche un poco sotto ! ) + diff macd > - r 7600 NUOVA ERA 1Y"
                    action = "buy"
                    percentage = 90

                    # 29 gen 2025 comincio a risolvere il problema del trend laterale dopo un grande RIBASSO
                    # 29 gen 2025 and ma450_last < ma450_720_min_ago




                  

                elif (     
                    
                    ma3_last >= ma30_last
                    
                    and ma100_last > ma100_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.57
                    
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma3_differenza_2_min_ago > 7
                    
                    and ma100_last < ma100_30_min_ago
                    and ma450_last > ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1.10
                    
                ):    
                    buy = "BUY 5 compare forever - con 3-30 E CON 300 ancora vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + diff macd > - r 7600 NUOVA ERA 2"
                    action = "buy"
                    percentage = 90
                    
                    # 18 dic 2023 3-30 da 3-18 
                    # 18 dic 2023 and ma2_differenza_2_min_ago > 8 da 7
                    # 18 dic 2023 and ma3_differenza_2_min_ago > 6 da 5
                    # 18 dic 2023 tolto macd > macd 2 min ago
                    # 18 dic 2023 aggiunto and macd_differenza_2_min_ago > 1.10 (per anticipare di una ndecchiecella)
                    # 24 dic 2023 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02

                elif (     
                    
                    ma3_last >= ma30_last
                    
                    and ma100_last < ma100_10_min_ago
                    and deviation_ma5_sopra_o_sotto_ma100 > -0.57
                    and deviation_ma3_sopra_o_sotto_ma99 > 0.27
                    
                    and ma2_differenza_2_min_ago > 8
                    and deviation_ma2_sopra_o_sotto_ma2_2_min_ago > 0.02
                    and ma3_differenza_2_min_ago > 7
                    
                    and ma100_last < ma100_30_min_ago
                    and ma450_last > ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma39_sotto_ma200 < -0.01
                    and deviation_ma300_sopra_ma450 > -0.50
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.02
                    and deviation_ma3_sopra_ma18 > -0.03
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and macd_differenza_2_min_ago > 1.10
                    
                ):    
                    buy = "BUY 5 compare forever - con 3-30 E CON 300 ancora vicina alla 450 ( anche un poco sotto ! ) and 3-18 > -0.01 + diff macd > - r 7600 NUOVA ERA 3"
                    action = "buy"
                    percentage = 90

                
                   
                elif (      
                    ma3_last >= ma30_last
                
                    and ma39_last < ma100_last
                    and deviation_ma25_sotto_ma300 < -1.30
                    and deviation_ma50_sotto_ma300 < -1.00
                    and deviation_ma39 < -0.15
                    and deviation_ma3_sotto_ma50 < -0.20
                    and deviation_ma5_sopra_o_sotto_ma100 < -0.60
                    and deviation_ma5_sotto_ma200 < -1.00
                    and deviation_ma5_sotto_ma300 < -1.20
                    and deviation_ma5_sotto_ma450 < -1.50

                    and ma450_last > ma450_360_min_ago
                    
                    and deviation_ma54_sopra_o_sotto_ma72 < -0.015
                    
                    and deviation_ma3_sopra_ma10 > 0.01
                    and deviation_ma3_sopra_ma16 > -0.025
                    and deviation_ma3_sopra_ma18 > -0.035
                    
                    and ma2_last > ma5_last
                    and ma2_last >= ma2_2_min_ago
                    and macd > -60
                    and macd_differenza_2_min_ago > -1.50
                    
                ):    
                    buy = "BUY 5 CF - con 3-30 and ma450_last > ma450_360_min_ago + DNAM - r 7600 NUOVA ERA 4"
                    action = "buy"
                    percentage = 90

                    # 10 dic 2024 aggiunta DNAM
                
                
                
                    
                    
                  
        
        ############################################################################################

        #  V E N D I T A !                                                                    

        ############################################################################################

        # NON TOCCARE QUESTE RIGHE (DICE CHE STA IN MODO SELL, DEVO VENDERE !)

        elif last_trade_action == "buy":

            percentage = self.sell_percentage
            # E' 100 DI DEFAULT !
            

            ###################################################################################################################################
            ###################################################################################################################################

            # VENDITA CON SESSIONE 1-2-3-x

            # LA PRIMA VENDITA DOPO IL BUY 1 E' COMPLETAMENTE DIVERSA E PIU' REATTIVA !
            # LA SECONDA VENDITA "PIU' TRANQUILLA"
            # DALLA TERZA VENDITA IN POI COME PER LA PRIMA SI VENDE EVITANDO, SE POSSIBILE, UNA GRANDE PERDITA

            ###################################################################################################################################
            ###################################################################################################################################

            # sell sessione 1 .................... righe  706 - 1593 
            # sell sessione 2 .................... righe 1604 - 2489
            # sell sessione 3 .................... righe 2500 - 3386
            # sell sessione 4-5-x ................ righe 2500 - 3386
           
            # VENDITA - con fasce di tempo ! i minuti sono espressi in secondi

            #   0 -  3
            #   3 -  5
            #   5 - 12
            #  12 - 21
            #  21 - 50
            #  50 - 90 
            #  90 - 110 solo le prime 2 sessioni  (> 90 min tutte le altre)
            #     > 110 solo le prime 2 sessioni
          
             
            # < -0.20
            # < -0.10  cuscino di sant' antonio se trend > e cuscino della madonna se trend <
            # 0.25 - 0.59  MARADONA 5-25 CHE DOPO 60 MIN DIVENTA 5-39 che dopo 90 min diventa 5-50
            # 0.60 - 1.20  RONALDO CHE DOPO 60 MIN DIVENTA 4-20
            # 1.21 - 2.50  TACCO DI ALLAH
            #  > 2.50      SI VIVE TRA GLI ANGELI, compa !
            
            # vendite eccezionali
            
            # aumento della perdita tollerata - trend e doppia deviation
            
            
            ####################################################################################################################### SESSIONE 1
            
            # al SELL 1 PUOI AUMENTARE LA PERDITA TOLLERATA POICHE' HAI SOLO IL 10%-20% DEL CAPITALE - eviterai, INOLTRE, un po' di sell e buy nel movimenti laterali !
            # la perdita tollerata ovviamente va aumentata anche alle 5 vendite eccezonali del SELL 1 sperando che la nuova indentazione ha funzionato
            # fino a questo momento vendevano SOLO le ULTIME 5 condizioni eccezionali
            
            
            
            ####################################################################################################################### sessione 1 ( 0 - 3 min )

            if self.session == 1:
                
                # e l' incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde ! e mi protegge anche questa quando ma78 sta molto in alto !
                # VENDITA - da 0 a 3 minuti = da 0 a 180 secondi
                
                if seconds_since_last_trade > 0 and seconds_since_last_trade <= 180:

                    # con ma50 >
                    
                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (0-3 min) con ma50 > and incrocio 3-39 and deviation_sell < -0.23 - r 7685"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                 
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 0.27 and deviation_sell < 0.60
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 1 (0-3 min) con ma50 > and incrocio 3-33 and deviation_sell 0.27 - 0.60 LA PRIMA FINTA DI MARADONA - r 7699"
                        action = "sell"
                        
                        
                
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 0.61 and deviation_sell < 0.79
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (0-3 min) con ma50 > and incrocio 3-33 and deviation_sell 0.61 - 0.79 IL PRIMO DRIBBLING ALLA RONALDO  - r 7711"
                        action = "sell"

                    # attenzione : tacco di allah e dribbling alla ronaldo SOLO con ma50> (altrimenti si attivano in "sell durante il crollo" che ha le sue leggi.)
                    
                    
                
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 0.80 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 (0-3 min) con ma50 > and incrocio 3-11 and deviation_sell 0.80 - 1.20 ( DOPPIA FINTA ALLA RONALDO ! ) - r 7726"
                        action = "sell"
                        
                        
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 1.21 and deviation_sell < 1.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 (0-3 min) con ma50 > and incrocio 3-13 and deviation_sell 1.21-1.7( TACCO DI ALLAH ! ) - r 7738"
                        action = "sell"
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 1.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 (0-3 min) con ma50 > and incrocio 3-11 and deviation_sell > 1.71 ( SI VA TRA GLI ANGELI, compa ! ) - r 7751"
                        action = "sell"
                        
                   
                
                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (0-3 min) con ma50 < and incrocio 3-28 - r 7764"
                        action = "sell"

                    # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                    
                    
                   
                    
                    # SELL 1 (0-3 min) con ma50 < and incrocio 3-33 and deviation_sell -0.23 and rapporto_delta_1_delta_2 < 1
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.29
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (0-3 min) con ma50 < and incrocio 3-33 and deviation_sell -0.29 SOTTO RIALZO RIALZO - GIORNO - r 7785"
                        action = "sell"
                        
                        
                        
                        
                    # SELL 1 (0-3 min) con ma50 < and incrocio 3-33 and deviation_sell -0.23 and rapporto_delta_1_delta_2 > 1
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        
                        
                        and delta_1 > delta_2
                        and ma100_last < ma100_60_min_ago
                        
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (0-3 min) con ma50 < and incrocio 3-33 and deviation_sell -0.23 SOTTO RIBASSO RIBASSO - NOTTE - r 7804"
                        action = "sell"
                        
                        
                   
                 
                    # ---------------------------------------------------------------------------------------------------------------------- crollo

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma16_prev and ma3_last < ma16_last)
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 CROLLO (0-3 min) con ma50 < and incrocio 3-16 and deviation_sell < -0.50 - r 7818"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        
                   
                
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23 and deviation_sell < 0.60
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 CROLLO (0-3 min) con ma50 < and incrocio 3-23 and deviation_sell > 0.23 - r 7832"
                        action = "sell"
                        
                        
                      
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma8_prev and ma3_last < ma8_last)
                        and deviation_sell > 0.61 and deviation_sell < 0.80
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 CROLLO (0-3 min) con ma50 < and incrocio 3-8 and deviation_sell > 0.60 - r 7845"
                        action = "sell"
                  
               
            
            
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma2_prev > ma5_prev and ma2_last < ma5_last)
                        and deviation_sell > 0.81
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 CROLLO (0-3 min) con ma50 < and incrocio 3-8 and deviation_sell > 0.60 - r 7858"
                        action = "sell"
             
            
            
                ################################################################################################################## sessione 1 ( 3-5 min )

                # VENDITA - da 3 a 5 minuti = da 180 a 300 secondi

                elif seconds_since_last_trade > 180 and seconds_since_last_trade <= 300:
                    
                    if (
                        ma50_last >= ma50_2_min_ago
                        and ma78_last > ma200_last
                        
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 > and incrocio 3-39 and deviation_sell < -0.27 CON 78>200 - r 7878 a"
                        action = "sell"
                         
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma78_last < ma200_last
                        
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell < -0.24
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 > and incrocio 3-39 and deviation_sell < -0.24 CON 78<200 - r 7894 b"
                        action = "sell"
                         
                        # deviation_sell = ma3_last/last_trade_price
                        
                
                
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.27 and deviation_sell < 0.60
                        and ma2_last < ma2_2_min_ago
                       
                        
                    ):
                        sell = "SELL 1 (3-5 min) con ma50> 5-25 and deviation_sell 0.27 - 0.60 - la prima FINTA ALLA MARADONA - r 7910"
                        action = "sell"
                         
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                     
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 0.61 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 > and incrocio 3-15 and deviation_sell 0.91 - 1.20 DRIBBLING ALLA RONALDO - r 7925"
                        action = "sell"
                        
                        
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 1.21 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 > and incrocio 3-20 and deviation_sell 1.21 -2.70 ( TACCO DI ALLAH ! ) - r 7937"
                        action = "sell"
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 > and incrocio 3-11 and deviation_sell > 2.71 ( SI VA TRA GLI ANGELI, comba ! ) - r 7949"
                        action = "sell"
                        
                        
                        

                    ###########################################################################     trend in ribasso
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma200_last
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.32
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 < and incrocio 3-28 and dev_sell < -0.32 - r 7964 A"
                        action = "sell"
                        
                        # deviation_sell_ma78 = ma3_last / ma78_last
                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma200_last
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.33
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 < and incrocio 3-28 and dev_sell < -0.32 - r 7964 B"
                        action = "sell"
                        
                        # deviation_sell_ma78 = ma3_last / ma78_last
                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (3-5 min) con ma50 < and incrocio 3-33 and deviation_sell < -0.25 - r 7978"
                        action = "sell"

                    
                    
                    
                    # guadagno durante il crollo o il trend discendente
                     
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23 and deviation_sell < 0.80
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 GUADAGNO CON CROLLO (3-5 min) con ma50 < and incrocio 3-23 and gain > 0.23 - r 7992"
                        action = "sell"
                        
                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma2_prev > ma8_prev and ma2_last < ma8_last)
                        and deviation_sell > 0.81 and deviation_sell < 1.70
                        and ma2_last < ma2_2_min_ago

                    ):

                        sell = "SELL 1 CROLLO (3-5 min) con ma50 < and incrocio 2-8 and gain > 0.81-1.70 - r 8006"
                        action = "sell"

                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma9_prev and ma3_last < ma9_last)
                        and deviation_sell > 1.71
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 GUADAGNO CON CROLLO (3-5 min) con ma50 < and incrocio 3-9 and gain > 1.71 - r 8019"
                        action = "sell"
                        
                        
                     

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 PARACADUTE CROLLO (0-3 min) con ma50 < and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 8031"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE !
                        
                        
                
                
                ############################################################################################################ sessione 1 ( 5-12 min )

                # VENDITA - da 5 a 12 minuti = da 300 a 720 secondi

                elif seconds_since_last_trade > 300 and seconds_since_last_trade <= 720:

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.41
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 > and incrocio 3-78 and deviation_sell < -0.41 - r 8052"
                        action = "sell"

                        # guardare la stella (guardare da una stella!)
                        # QUESTO E' IL RISCHIO PIU' GRANDE CHE PRENDO ! ( ma con ma50 > ma50 2 min ago DOPO 5 min (+2))
                        # deviation_sell = ma3_last/last_trade_price 
                    
                    
                      
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.28
                        and ma2_last < ma2_2_min_ago
                  
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 > and incrocio 5-100 (cuscino di sant' antonio) and deviation_sell < -0.28 - r 8069"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        
                        and deviation_sell > 0.27 and deviation_sell < 0.60
                        and ma2_last < ma2_2_min_ago
                    
                    ):
                        sell = "SELL 1 (5-12 min) con ma50> 5-25 and deviation_sell 0.27 - 0.60 - FINTA ALLA MARADONA - r 8085"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                      
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma13_last
                        
                        and deviation_sell > 0.61 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 >  3-13 and deviation_sell 0.61 - 0.90 - DRIBBLING ALLA RONALDO - r 8101"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 > and incrocio 3-15 and deviation_sell 0.91 - 1.20 ( DOPPIA FINTA ALLA RONALDO ) - r 8117"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 1.21 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 > and incrocio 3-15 and deviation_sell 1.21-2.70 ( TACCO DI ALLAH ! ) - r 8132"
                        action = "sell"
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 > and incrocio 3-11 and deviation_sell > 2.71 ( SI STA TRA GLI ANGELI, compa! ) - r 8144"
                        action = "sell"
                        
                        
                      
                    
                    
                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.49
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 < and incrocio 3-28 and deviation_sell < -0.49 - r 8159"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 < and incrocio 3-100 (cuscino di sant' antonio) - r 8173"
                        action = "sell"
                        
                        
                    
                    
                    # ------------------------------------------------------------------------------- guadagno con crollo
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23 and deviation_sell < 0.54
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 < GUADAGNO DURANTE IL CROLLO 0.23-0.54 con incrocio 3-23 - r 8189"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 0.55
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (5-12 min) con ma50 < GUADAGNO DURANTE IL CROLLO > 0.55  and incrocio 3-13 - r 8200"
                        action = "sell"
                        
                        
                        

                    # -------------------------------------------------- PARACADUTE crollo SE SI RIDUCE LA DISTANZA TRA ma 100 E ma 200 quindi sta risalendo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.45
                        and ma2_last < ma2_2_min_ago
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                    ):
                        sell = "SELL 1 (5-12 min) PARACADUTE CROLLO distanza< ma100-ma200  E ma50< E ma3<ma16 and deviation_sell< -0.35 - GIORNO- r 8219"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE ma sta risalendo
                        # and delta_1 < 0.25
                        # and delta_2 > 0.40
                        
                        
                      
                    
                    
                    
                    
                    
                    # --------------------------------------------------- PARACADUTE crollo SE AUMENTA LA DISTANZA TRA ma 100 E ma 200 quindi grande ribasso INFERI
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.35
                        and ma2_last < ma2_2_min_ago
                        and ma300_last > ma300_120_min_ago
                       
                        
                        and delta_1 > delta_2
                        and ma100_last < ma100_60_min_ago
                    ):
                        sell = "SELL 1 (5-12 min) PARACADUTE CROLLO 300 > distanza> ma100-ma200  e ma50< and ma3 < ma16 and dev_sell < -0.35  - NOTTE - r 8246"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE ma sta continuando a scendere
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.47
                        and ma2_last < ma2_2_min_ago
                        
                        and ma300_last < ma300_120_min_ago
                       
                        
                        and delta_1 > delta_2
                        and ma100_last < ma100_60_min_ago
                    ):
                        sell = "SELL 1 (5-12 min) PARACADUTE CROLLO 300 < distanza> ma100-ma200  e ma50< and ma3 < ma16 and dev_sell < -0.47  - NOTTE - r 8260"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE ma sta continuando a scendere


                    
                    # ----------------------------------------------------------------------------- CONDIZIONE SPECIALE NEL SELL 1 !
                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        
                        and delta_1 < delta_2
                        
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.09
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        
                        and macd_differenza_2_min_ago < -3.25
                        and ma2_differenza_2_min_ago < -9
                        
                    ):
                        sell = "SELL 1 (5-12 min) EX CS con ma300< 5 ore ma delta1 < delta2 - dev 3-39 < 0.05 E dev_sell < -0.09 con ma50 < - r 8261 a"
                        action = "sell"
                        
                        # 12 nov 2023 ho messo 2 volte and ma2_differenza_2_min_ago < -9 perche' non l' ha presa !
                        # 12 nov 2023 aggiunta and ma50_differenza_ma59 > -6 se ma 50 sta VICINO alla ma59 allora aumento di una ndecchia la perdita.
                        # 12 nov 2023 and deviation_sell < -0.08
                        # 10 ago 2025 se giorno deviation_sell a -0.09 da -0.08

                        
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        and ma2_differenza_2_min_ago < -9
                        
                        and deviation_ma39 < 0.08
                        and deviation_sell < -0.05
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and macd < 17
                        and macd_differenza_2_min_ago < -0.25
                        and ma2_differenza_2_min_ago < -9
                        and ma50_differenza_ma59 < -6
                    ):
                        sell = "SELL 1 (5-12 min) EX cond. spec. r 16047 B2 con ma300> 5 ore - dev 3-39 < 0.08 E dev_sell < -0.05 con ma50 < e con macd < 2 min e macd < 17 - r 8261 B"
                        action = "sell"
                        
                        # 12 nov 2023 ho messo 2 volte and ma2_differenza_2_min_ago < -9 perche' non l' ha presa !
                        # 12 nov 2023 and deviation_sell < -0.07
                        # 12 nov 2023 aggiunta and ma50_differenza_ma59 < -6 se ma 50 sta LONTANA alla ma59 allora DIMINUISCO la perdita.
                        # 17 dic 2023 and deviation_ma39 a 0.08 da 0.05
                        # 17 dic 2023 and deviation_sell a -0.05 da -0.07

                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma2_differenza_2_min_ago < -17
                        and ma300_last > ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.05
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.25
                        and ma2_differenza_2_min_ago < -17
                    ):
                        sell = "SELL 1 (5-12 min) EX cond spec 16047 B3 NOTTE con ma300> 5 ore e dev 3-39 < 0.05 e dev_sell < -0.07 e ma50 < and macd_diff_2_min_ago < -0.25 - r 8262"
                        action = "sell"
                
                        # 23 ott 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                        # 23 ott 2023 dev 3-39 a 0.06 da 0.05
                        # 23 ott 2023 dev_sell a -0.05 da -0.07
                        # 23 ott 2023 tolto and macd < macd_2_min_ago e aggiunta diff macd 2 min ago < -0.25
                        #  6 dic 2023 aggiunto and ma2_differenza_2_min_ago < -17

                  
                    elif (
                        ma8_last < ma8_2_min_ago 
                        and deviation_ma39 < 0.02
                        and deviation_sell < -0.02
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.10
                
                        and deviation_ma3_sotto_ma150 > -1.20
                        and ma2_last <= ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 1 (5-12 min) EX cond. spec 15985 A1 ok 2B - CON ma8 < ma8 2 min ago e dev 3-39 < 0.02 e dev sell < -0.02 e macd_dif_2_min_ago < -0.25 - r 8263"
                        action = "sell"




                    elif (    
                        ma2_last < ma4_last
                        and ma2_last < ma6_last
                        and ma300_last > ma450_last
                        and ma300_last > ma300_120_min_ago

                        and ma3_last < ma39_last

                        and delta_1_200_30 > delta_2_200_30_30_min
                
                        and deviation_crollo_24_aprile < -0.33
                
                        and deviation_ma5_sotto_ma200 > -1.00
                    ): 
                
                        sell = "SELL 1 (5-12 min) EX CS > CROLLO IMPROVVISO del 24 apr 2022 < -0.33 - notte MA 300>450 E 300> 2 ore - r 8264 X"
                        action = "sell"
                        
                        #  9 nov 2023 and deviation_crollo_24_aprile a < -0.35 da < -0.45
                        #  5 dic 2023 and deviation_crollo_24_aprile a < -0.33 da < -0.35
                        #  4 feb 2025 se ma300_last > ma450_last sell con 3-39


                    elif (    
                        ma2_last < ma4_last
                        and ma2_last < ma6_last
                        and ma300_last < ma450_last

                        and delta_1_200_30 > delta_2_200_30_30_min
                
                        and deviation_crollo_24_aprile < -0.33
                
                        and deviation_ma5_sotto_ma200 > -1.00
                    ): 
                
                        sell = "SELL 1 (5-12 min) EX CS > CROLLO IMPROVVISO del 24 apr 2022 < -0.33 - notte - r 8264 Y"
                        action = "sell"
                        
                        #  9 nov 2023 and deviation_crollo_24_aprile a < -0.35 da < -0.45
                        #  5 dic 2023 and deviation_crollo_24_aprile a < -0.33 da < -0.35
              
                    

                    
                    

                    
                    
                        
                        
                        
                        
                
                ###################################################################################################################  SESSIONE 1 ( 12-21 min )

                # VENDITA - da 12 a 21 minuti = da 720 a 1260 secondi

                elif (
                    seconds_since_last_trade > 720 and seconds_since_last_trade <= 1260
                ):

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma72_prev and ma3_last < ma72_last)
                        and deviation_sell < -0.65
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 > and incrocio 3-72 and deviation sell -0.65 e vaffanculo ! - r 8294"
                        action = "sell"
                         
                        # and deviation_ma39 < -0.29 vendeva troppo presto
                        # ATTENZIONE "and (ma3_prev > ma39_prev and ma3_last < ma39_last)" con ma39 NON HA INCROCIATO
                        # and deviation_sell < -0.30
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                      
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma100_prev and ma3_last < ma100_last)
                        and deviation_sell < -0.39
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 > and incrocio 3-100 cuscino di sant' antonio and deviation_sell < 0.39 - r 8313"
                        action = "sell"
                        
                        # viva sant' antonio !
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.27 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 1 (12-21 min) con ma50> and 5 < 25 and deviation_sell 0.27-0.56 - FINTA ALLA MARADONA - r 8328"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last > ma300_last
                        
                        and ma3_last < ma22_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 1 (12-21 min) con ma50> and 3 < 22 con 3 sopra 300 (NO INCROCIO 3-13) and dev_sell 0.57-0.90 - DOPPIO PASSO RONALDO - r 8346 a"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma300_last
                        and ma20_last > ma50_last

                        and ma3_last < ma50_last

                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 1 (12-21 min) con ma50> and 3<50 con 20>50 and dev_sell 0.57 - 0.90 - DOPPIO PASSO RONALDO - r 8362 bx"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        #  8 apr 2025 sell 3-50 da 3-13 se 20>50 lascialo correre !


                           
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma300_last
                        and ma20_last < ma50_last

                        and ma3_last < ma25_last

                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 1 (12-21 min) con ma50> and 3<39 con 20>50 and dev_sell 0.57 - 0.90 - DOPPIO PASSO RONALDO - r 8362 by"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        #  8 apr 20253-39 da 3-13
                        #  8 apr 2025 se 20<50 sell 3-25
                       

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 > and incrocio 3-25 and deviation_sell 0.91 - 1.20 ( DOPPIA FINTA ALLA RONALDO ) - r 8379"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 1.21 and deviation_sell < 1.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 > and incrocio 3-30 and deviation_sell 1.21-1.70 ( IL TACCO DI ALLAH ) - r 8394"
                        action = "sell"
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 1.71
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 > and incrocio 3-15 and deviation_sell > 1.71 ( SI STA TRA GLI ANGELI, compa ! ) - r 8406"
                        action = "sell"
                        
                        
                      
                    
                    ##########################################################################################
                    
                    # NON TOCCARE ! CUSCINO DI SANT' ANTONIO !
                    # L' INCROCIO 5-100 MI SALVA ! MA 5<100 VENDE DURANTE IL RIBASSO !
                    
                    
                    ##################################################################### con trend discendente
                    
                    
                    # RAFFORZATO DA 100>300
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma300_last
                        and ma300_last > ma300_120_min_ago
                        and deviation_ma39 < -0.16
                        and deviation_sell < -0.38
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (12-21 min) RAFFORZATO con 300 > 120 min ago e con ma50 < and deviation_ma39 < -0.16 and deviation_sell < -0.38 - r 8431 A"
                        action = "sell"
                        
                        # 22 set dev sell -0.38 da -0.36
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma300_last
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_ma39 < -0.16
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (12-21 min) RAFFORZATO ma 300 < 120 min ago e con ma50 < and deviation_ma39 < -0.16 and deviation_sell < -0.36 - r 8431 B"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_differenza_2_min_ago < -3
                        and ma450_last > ma450_720_min_ago
                        and ma100_last < ma300_last
                        
                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.09
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago 
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 < and dev_ma39 < -0.01 and dev_sell < -0.09 CON 450 > E macd < macd_2_min_ago and ma2_diff_2_min_ago < -3 - r 8444 A"
                        action = "sell"
                        
                        # 17 gen 2023 dev sell -0.35 da -0.34
                        
                        # 20 ott 2023 dev sell -0.25 da -0.355
                        # 20 ott 2023 dev 39 -0.10 da -0.159
                        #  1 dic 2023 dev 39 -0.01 da -0.10
                        #  1 dic 2023 dev sell -0.09 da -0.25
                        #  1 dic 2023 aggiunta and macd < macd_2_min_ago 
                        #  9 dic 2023 and ma2_differenza_2_min_ago < -3
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_720_min_ago
                        and ma100_last < ma300_last
                        and deviation_ma39 < -0.159
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 < and deviation_ma39 < -0.159 and deviation_sell < -0.36 CON 450< - r 8444 B"
                        action = "sell"
                        
                        # 17 gen 2023 dev sell -0.35 da -0.34
                        # 10 mar 2023 dev sell -0.36 da -0.35
                       
                        
                        
                        
                     
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.45
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.45 - r 8469"
                        action = "sell"
                        
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10 e vaffanculo ! ma solo se ma50 < !
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (12-21 min) con ma50 < and CUSCINO DI SANT' ANTONIO - r 8483"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # incrocio 5-100 no 5<100 altrimenti vende durante il crollo !
                        
                        
                        
                    # --------------------------------------------------------------------------------- PARACADUTE crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 PARACADUTE CROLLO (12-21min) con ma50< and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 8499"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                   
                
                
                    # -------------------------------------------- guadagno con crollo ! fondamentale per uscire, EVENTUALMENTE, con guadagno DURANTE IL CROLLO !
                    
                    # INTANTO TE LI PRENDI E TE LI PORTI A CASA ! 
                    # E' UNA SPECIE DI POCHI MALEDETTI E SUBITO.
                   
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.80
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 eventuale guadagno con crollo (12-21 min) con ma50 < and incrocio 3-28 and deviation_sell 0.25-0.80 - r 8520"
                        action = "sell"
                        
                        # 15 giu 2022 3-28 da 3-16
                    
                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 0.81
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 eventuale guadagno con crollo (12-21 min) con ma50 < and incrocio 3-11 and deviation_sell > 0.81 - r 8538"
                        action = "sell"



                  
                        
                   
                    # ----------------------------------------------------------------------------- torna a casa durante il crollo con minor danno 
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < -0.40
                        and (ma3_prev > ma36_prev and ma3_last < ma36_last)
                        and deviation_sell < -0.335
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 torna a casa durante il crollo con minor danno  (12-21 min) con ma50 < and incrocio 3-36 and dev_sell < -0.335 - r 8551"
                        action = "sell"
                        
                        #  1 giugno 2022 -0.27 da -0.25
                        # 21 lug 2022 -0.30 da -0.27
                        #  3 set 2022 -0.325 da -0.30
                        # 21 set 2022 -0.335 da -0.325

                    
                    # ----------------------------------------------------------------------------- CONDIZIONE SPECIALE NEL SELL 1 !
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma39_last >= ma50_last
                        and ma10_last >= ma20_last

                        and ma300_last < ma300_301_min_ago
                     
                        and deviation_ma39 < 0.13
                        and deviation_sell < -0.03
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015
                    ):
                        sell = "SELL 1 (12-21 min) EX CS con ma300> 5 ore E dev 3-39 < 0.13 e dev_sell < -0.03 e ma50 < MA 39>50 - r 8552 x1"
                        action = "sell"
                        
                        # 12 feb 2024 se 10>20 and deviation_sell a -0.01 da 0.02
                        # 17 set 2024 dev_sell < -0.03 da <-0.01 se ma39 e' ancora > a ma50


                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma39_last < ma50_last
                        and ma10_last >= ma20_last

                        and ma300_last < ma300_301_min_ago
                       
                        and deviation_ma39 < 0.13
                        and deviation_sell < -0.02
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015
                    ):
                        sell = "SELL 1 (12-21 min) EX CS con ma300> 5 ore E dev 3-39 < 0.13 e dev_sell < -0.02 e ma50 < E 39<50 - r 8552 x2"
                        action = "sell"
                        
                        # 12 feb 2024 se 10>20 and deviation_sell a -0.01 da 0.02
                        # # 17 set 2024 dev_sell < -0.02 da <-0.01



                    elif (
                        ma78_last < ma78_120_min_ago

                        and deviation_ma300_sopra_ma450 > -0.085

                        and ma300_last < ma300_301_min_ago
                        and ma10_last > ma30_last
                        and ma10_last < ma20_last

                        and deviation_ma39 < 0.10
                        and deviation_sell < -0.01
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015
                    ):
                        sell = "SELL 1 (12-21 min) con ma300> 5 ore E dev 3-39 < 0.13 e dev_sell < 0.005 e ma50 < - r 8552 y1 x"
                        action = "sell"
                        
                        # 25 ott 2023 and deviation_sell < -0.069 da < -0.06
                        
                        # 27 nov 2023 dev sell a 0.02 da -0.069
                        # 27 nov 2023 dev 39 a 0.13 da 0.05 INCREDIBILE ! 3-39 STAVA A 0.13 ! quando doveva vendere ! nonno mario.
                        # 11 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015 che sarebbero 6 pts !
                        # 21 feb 2024 se 10 > 30 aumento dev sell a 0.05 da 0.02
                        # 31 gen 2025 se sta sopra il limite inferiore del corridoio 300-340 aumenta la dev sell a < -0.01 ! cazzo


                    elif (
                        ma78_last < ma78_120_min_ago

                        and deviation_ma300_sopra_ma450 < -0.085

                        and ma300_last < ma300_301_min_ago
                        and ma10_last > ma30_last
                        and ma10_last < ma20_last

                        and deviation_ma39 < 0.13
                        and deviation_sell < 0.005
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015
                    ):
                        sell = "SELL 1 (12-21 min) con ma300> 5 ore E dev 3-39 < 0.13 e dev_sell < 0.005 e ma50 < - r 8552 y1 y"
                        action = "sell"
                        
                        # 25 ott 2023 and deviation_sell < -0.069 da < -0.06
                        
                        # 27 nov 2023 dev sell a 0.02 da -0.069
                        # 27 nov 2023 dev 39 a 0.13 da 0.05 INCREDIBILE ! 3-39 STAVA A 0.13 ! quando doveva vendere ! nonno mario.
                        # 11 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015 che sarebbero 6 pts !
                        # 21 feb 2024 se 10 > 30 aumento dev sell a 0.05 da 0.02
                        # 31 gen 2025 se sta SOTTO il limite inferiore del corridoio 300-340 dev sell a < 0.005



                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        and ma10_last < ma30_last
                        and ma10_last < ma20_last
                        and deviation_ma39 < 0.13
                        and deviation_sell < 0.02
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015
                    ):
                        sell = "SELL 1 (12-21 min) con ma300> 5 ore E dev 3-39 < 0.13 e dev_sell < 0.02 e ma50 < - r 8552 y2"
                        action = "sell"
                        
                        # 25 ott 2023 and deviation_sell < -0.069 da < -0.06
                        
                        # 27 nov 2023 dev sell a 0.02 da -0.069
                        # 27 nov 2023 dev 39 a 0.13 da 0.05 INCREDIBILE ! 3-39 STAVA A 0.13 ! quando doveva vendere ! nonno mario.
                        # 11 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015 che sarebbero 6 pts !
                        
                
                
                ################################################################################################################# SESSIONE 1 ( 21-60 min )

                # VENDITA - da 21 a 50 minuti = da 1261 a 3000 secondi

                elif (
                    seconds_since_last_trade > 1261 and seconds_since_last_trade <= 3000
                ):
                    if (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.65
                        and ma2_last < ma2_2_min_ago
                    
                    ):
                        sell = "SELL 1 (21-50 min) con ma50> and incrocio 3-78 and deviation_sell<-0.65 - r 8573"
                        action = "sell"
                        
                        # VENDITA IN BASSO 
                        # and deviation_ma39 < -0.16 or (deviation_sell < 0.10 and ma3_last < ma39_last)
                        # and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        # and deviation_sell < -0.26
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                      
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and macd <= macd_2_min_ago
                        and deviation_ma8_sotto_ma300 > -1.00
                        
                        and deviation_sell < -0.33
                        and ma3_last < ma50_last
                        and ma2_last < ma2_2_min_ago
                    
                    ):
                        sell = "SELL 1 (21-50 min) con ma50> and deviation_sell <-0.32 and ma3_last < ma50_last - con 8 sotto 300 > -1.00 - r 8595 A"
                        action = "sell"
                        
                        # VENDITA 1 IN ALTO dopo BUY IN RISALITA
                        # and deviation_ma39 < -0.16 or (deviation_sell < 0.10 and ma3_last < ma39_last)
                        # and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        # and deviation_sell < -0.26
                        # deviation_sell = ma3_last/last_trade_price
                        # deviation_ma8_sotto_ma300 = ma8_last / ma300_last
                        # 21 apr 2023 aggiunta macd >= 2 min ago
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma8_sotto_ma300 < -1.00
                        
                        and deviation_sell < -0.34
                        and ma3_last < ma50_last
                        and ma2_last < ma2_2_min_ago
                    
                    ):
                        sell = "SELL 1 (21-50 min) con ma50> and deviation_sell <-0.34 and ma3_last < ma50_last - con 8 sotto 300 < -1.00 - r 8615 b"
                        action = "sell"
                        
                        # VENDITA 1 IN ALTO dopo BUY IN RISALITA
                        # and deviation_ma39 < -0.16 or (deviation_sell < 0.10 and ma3_last < ma39_last)
                        # and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        # and deviation_sell < -0.26
                        # deviation_sell = ma3_last/last_trade_price
                        # deviation_ma8_sotto_ma300 = ma8_last / ma300_last
                        
                    
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.29
                        and ma300_last > ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 5-100 cuscino di sant' antonio (no 5<100) and deviation_sell < -0.29 - r 8636"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.26
                        and ma300_last < ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 5-100 cuscino di sant' antonio (no 5<100) and deviation_sell < -0.26 - r 8652"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                    
                    
                    
                    ######################################################################################### doppio delta > 1 TREND CONTINUA AL RIALZO vendi cosi'
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and (ma5_prev > ma59_prev and ma5_last < ma59_last)
                        
                        and deviation_sell > 0.34 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50> e INCROCIO 5-59 and deviation_sell 0.34 - 0.56 la prima FINTA ALLA MARADONA  - GIORNO - r 8680 B"
                        action = "sell"
                        
                        # 31 maggio 2022 5-39 da 5-20
                        # 26 feb 2023 INCROCIO dall' ALTO verso VERSO il BASSO 5-39 VEDI 26 feb 2023 ore 20:18
                        # 17 mar 2023 5-45 da 5-39 se 300>450
                        #  3 feb 2025 5-58 da 5-45 e' giorno !
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and (ma5_prev > ma49_prev and ma5_last < ma49_last)
                        
                        and deviation_sell > 0.34 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and INCROCIO 5-49 and deviation_sell 0.34 - 0.56 la prima FINTA ALLA MARADONA  - GIORNO - r 8680 B"
                        action = "sell"
                        
                        # 31 maggio 2022 5-39 da 5-20
                        # 26 feb 2023 INCROCIO dall' ALTO verso VERSO il BASSO 5-39 VEDI 26 feb 2023 ore 20:18
                        # 17 mar 2023 5-39 se 300<450
                        # 6 apr 2023 5-49 da 5-39
                        
                        
                        
                    #################################################### doppio delta < 1 TREND COMINCIA A SCENDERE ! vendi con ma50 !

                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma39_last > ma200_last
                        
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_ma100_sopra_ma200 > -0.10
                        and ma5_last < ma78_last
                        and deviation_sell > 0.34 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con 39>200 and 3-50 and dev_sell 0.34-0.56 FINTA ALLA MARADONA - - CREPUSCOLO - r 8703 x"
                        action = "sell"
                        #  8 apr 2025 5-78 da 3-50 se 39>200 cazzo lascialo stare !


                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma39_last < ma200_last
                        
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_ma100_sopra_ma200 > -0.10
                        and ma3_last < ma50_last
                        and deviation_sell > 0.34 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con 39<200 and 3-50 and dev_sell 0.34-0.56 FINTA ALLA MARADONA - - CREPUSCOLO - r 8703 y"
                        action = "sell"
                        
                        # 100 deve stare sopra 200 cosi' non vende con ma 50 durante il crollo o un forte ribasso !


                        
                        ###########################################################################################################
                        
                   
                    
                    ########################################################## doppio delta > 1 TREND CONTINUA AL RIALZO vendi cosi'
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma300_last
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma5_last < ma59_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 5-33 and deviation_sell 0.51 - 0.90 ELASTICO ALLA RONALDO E 100 > 300 - GIORNO - r 8740 A"
                        action = "sell"
                        
                        # dopo 26 minuti non c'e' piu' quello scatto in avanti - dribbling- che si verifica nei primi minuti
                        # deviation_sell = ma3_last/last_trade_price
                        # 5-22 (era 4-15)
                        # 16 gen 2023 5-59 da 5-33
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma300_last
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma5_last < ma39_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 5-39 and deviation_sell 0.51 - 0.90 ELASTICO ALLA RONALDO MA 100 < 300- GIORNO - r 8761 b"
                        action = "sell"
                        
                        # dopo 26 minuti non c'e' piu' quello scatto in avanti - dribbling- che si verifica nei primi minuti
                        # deviation_sell = ma3_last/last_trade_price
                        # 5-22 (era 4-15)
                        # 5-39 da 5-22 dopo le dolomiti !
                        
                        
                    ########################################################################## doppio delta < 1 TREND COMINCIA A SCENDERE ! vendi con ma50 !
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_ma100_sopra_ma200 > -0.10
                        and ma3_last < ma50_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 3-50 and deviation_sell 0.51-0.90 ELASTICO ALLA RONALDO - CREPUSCOLO - r 8789"
                        action = "sell"
                        
                        # dopo 26 minuti non c'e' piu' quello scatto in avanti - dribbling- che si verifica nei primi minuti
                        # deviation_sell = ma3_last/last_trade_price
                        # 100 deve stare sopra 200 per non vendere con ma50 durante il crollo o un forte ribasso
                        
                        
                        
                    #######################################################################################################
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma3_last > ma300_last
                        and (ma4_prev > ma50_prev and ma4_last < ma50_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 4-50 se 3 sopra 300 and deviation_sell 0.91 - 1.20 (DOPPIA FINTA DI RONALDO) - r 8829 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 28 set 4-50 da 3-25
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma3_last < ma300_last
                        and (ma3_prev > ma42_prev and ma3_last < ma42_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 3-42 se 3 sotto 300 and deviation_sell 0.91 - 1.20 (DOPPIA FINTA DI RONALDO) - r 8829 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma300_last
                        and (ma4_prev > ma39_prev and ma4_last < ma39_last)
                        and deviation_sell > 1.21 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 4-39 and dev_sell 1.21 - 2.70 (DOPPIO PASSO DI RONALDO) - r 8844 a"
                        action = "sell"

                        # 12 nov 2024 se 100>300 stai calmo



                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma300_last
                        and (ma4_prev > ma28_prev and ma4_last < ma28_last)
                        and deviation_sell > 1.21 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 4-28 and dev_sell 1.21 - 2.70 (DOPPIO PASSO DI RONALDO) - r 8844 b"
                        action = "sell"

                        # 12 nov 2024 
                  
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma10_sopra_ma200 > 1.00
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell > 2.71 and deviation_sell < 5.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 3-28 and deviation_sell 2.71 - 5.70 (TACCO DI ALLAH) - r 8856 A"
                        action = "sell"
                        
                        # 6 apr 2023 3-28 da 3-18
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma10_sopra_ma200 < 1.00
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 2.71 and deviation_sell < 5.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 3-11 and deviation_sell 2.71 - 5.70 (TACCO DI ALLAH) - r 8856 B"
                        action = "sell"
                        
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 5.71
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and incrocio 3-39 and deviation_sell > 2.71 (SI STA TRA GLI ANGELI, comba !) - r 8868"
                        action = "sell"
                        
                    
                    
                    ############################################################################## CUSCINO DI SANT' ANTONIO per questo segmento di tempo !
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma200_last
                        
                        and ma100_last > ma100_60_min_ago
                        and ma5_last < ma100_last
                        and deviation_sell < -0.31
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 5-100 and deviation_sell < -0.31 CUSCINO DI SANT' ANTONIO se ma100 > E 100 > 200 - r 8886 A"
                        action = "sell"
                        
                        # 19 giu 2022 dev sell a -0.26 da -0.24
                        # 29 giu 2022 dev sell a -0.29 da -0.26
                        #  1 feb 2023 dev sell a -0.31 da -0.29
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma200_last
                        and ma300_last > ma300_301_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma5_last < ma100_last
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 5-100 and deviation_sell < -0.25 CUSCINO DI SANT' ANTONIO se ma100 > MA 100 < 200 - r 8904 B1"
                        action = "sell"
                        
                        # se 300 > 301 min ago aumenta tolleranza dev sell
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma200_last
                        and ma300_last < ma300_301_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma5_last < ma100_last
                        and deviation_sell < -0.24
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 5-100 and deviation_sell < -0.24 CUSCINO DI SANT' ANTONIO se ma100 > MA 100 < 200 - r 8904 B2"
                        action = "sell"
                        
                        
                        
                        
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma40_last > ma100_last
                        and ma5_last < ma100_last
                        and deviation_sell < -0.35
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 5-100 and deviation_sell < -0.35 CUSCINO DELLA MADONNA se ma100 < MA 300 > E 40 > 100 - r 8922 A"
                        action = "sell"
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma40_last < ma100_last
                        and ma5_last < ma100_last
                        and deviation_sell < -0.34
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and 5-100 and deviation_sell < -0.34 CUSCINO DELLA MADONNA se ma100 < MA 300 > E 40 < 100 - r 8922 B"
                        action = "sell"
                        
                        # > estate -0.34 da -0.27
                        
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and ma200_last > ma200_60_min_ago
                        
                        
                        and ma5_last < ma100_last
                        and deviation_sell < -0.26
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50> and 5-100 and dev_sell< -0.26 se ma100< CUSCINO DELLA MADONNA  E DE SANTO RENATO 300 < MA 200> - r 8944"
                        action = "sell"
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and ma200_last < ma200_60_min_ago
                        
                        and ma5_last < ma100_last
                        and deviation_sell < -0.32
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50> and 5-100 and dev_sell< -0.32 se ma100< CUSCINO DELLA MADONNA E DE SANTO RENATO 300 < CON 200< - r 8962"
                        action = "sell"
                        
                        # > estate dev sell -0.32 da -0.25
                        
               
                    ################################################################################################ con trend discendente 
                    ################################################################################################ con ma100 DISTANTE sopra dalla ma300
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.10
                        
                        
                        and deviation_ma100_sopra_ma300 > 0.69
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.25
                    ):   
                        sell = "SELL 1 (21-50 min) con ma50 < con deviation_ma39 <-0.01 and dev_sell< -0.10 TREND CRESCITA (100 sopra 300 > 0.69) and macd < macd_2_min_ago - r 8978"
                        action = "sell"
                        
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        # 12 set 2023dev 39 -0.01 da -0.15
                        # 12 set 2023 dev sell -0.10 da -0.20
                        
                    
                    # cuscino sant' antonio
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and ma8_last > ma39_last
                        and deviation_ma100_sopra_ma300 > 0.69
                        and deviation_sell < -0.15
                        and ma5_last < ma100_last
                    ):
                        sell = "SELL 1 (21-50 min)con ma50 < CUSCINO SANT' ANTONIO (5-100) MA SOLO con TREND CRESCITA (100 sopra 300 > 0.69) E 8>39 - r 8997 a"
                        action = "sell"
                        
                        
                    # cuscino sant' antonio
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and ma8_last < ma39_last
                        and deviation_ma100_sopra_ma300 > 0.69
                        and deviation_sell < -0.178
                        and ma5_last < ma100_last
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < CUSCINO SANT' ANTONIO (5-100) MA SOLO con 100 sopra 300 > 0.69 and macd < macd 2 min ago - r 8997 B"
                        action = "sell"
                        
                        # 13 gen 2023 dev sell -0.175
                        # ho visto che ma175 andrebbe bene ma ho preferito modificare dev sell
                        # 3 mag 2023 aggiunta macd < macd 2 min ago
                        
                    # TREND LATERALE (100/300  <0.69 and >-0.77) NON TOCCARE
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_720_min_ago
                        
                        and delta_1_200_78 < delta_2_200_78_60_min
                        and deviation_ma39 < -0.17
                        
                        and deviation_sell < -0.235
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_ma100_sopra_ma300 > -0.77
                        and deviation_sell < -0.232
                        
                        and ma3_last < ma300_last
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < con dev_ma39 <-0.17 E dev_sell < -0.232 TREND LATERALE (100>300 <0.69 and >-0.77) - r 9016 A1"
                        action = "sell"
                        
                        # OGGI 22 LUG 2022 QUESTA SU RCCR HA FATTO -0.56 MENTRE MADDOG HA FATTO -1.43 !
                        
                        # > estate -0.21 da -0.18
                        # 20 gen 2023 dev sell < -0.235 da -0.22
                        # 24 apr 2023 dev sell < -0.235 con 450 > 720 min ago
                        # 28 apr 2023 dev sell < -0.235
                        # 28 apr 2023 dev sell < -0.232 da 0.235
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_720_min_ago
                        and delta_1_200_78 < delta_2_200_78_60_min
                        and deviation_ma39 < -0.17
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_ma100_sopra_ma300 > -0.77
                        and deviation_sell < -0.233
                        
                        and ma3_last < ma300_last
                    ):
                        sell = "SELL 1 NO TOCCARE (21-50 min) con ma50 < con dev_ma39 <-0.17 E dev_sell < -0.233 TREND LATERALE (100>300 <0.69 and >-0.77) - r 9016 A2"
                        action = "sell"
                        
                        # OGGI 22 LUG 2022 QUESTA SU RCCR HA FATTO -0.56 MENTRE MADDOG HA FATTO -1.43 !
                        
                        # > estate -0.21 da -0.18
                        # 20 gen 2023 dev sell < -0.235 da -0.22
                        # 24 apr 2023 dev sell < -0.233 da -0.255 con 450 < 720 min ago
                        
                        
                        
                        
                    # TREND LATERALE (100/300  < 0.69 and >-0.77) NON TOCCARE
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_180_min_ago
                        
                        and delta_1_200_78 > delta_2_200_78_60_min
                        and ma3_last < ma300_last
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_ma100_sopra_ma300 > -0.77
                        
                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.11
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 1 (21-50 min) NON TOCCARE se ma50 < E dev_ma39 <-0.01 E dev_sell < -0.221 TREND LAT (100>300 <0.69 and >-0.77) and diff macd < -0.25 - r 9016 B1"
                        action = "sell"
                        
                        # OGGI 22 LUG 2022 QUESTA SU RCCR HA FATTO -0.56 MENTRE MADOG HA FATTO -1.43 !
                        
                        # > estate -0.21 da -0.18
                        # 17 feb 2023 dev_sell a -0.219 da -0.215
                        #  6 apr 2023 dev_sell a -0.221 da -0.219
                        # 11 ago 2023 aggiunto and deviation_ma39 < -0.01
                        #  1 set 2023 dev sell a -0.10 da -0.221
                        #  1 set 2023 aggiunta and macd_differenza_2_min_ago < -0.25
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_180_min_ago
                        
                        and delta_1_200_78 > delta_2_200_78_60_min
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.02
                        
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_ma100_sopra_ma300 > -0.77
                        
                        and ma3_last < ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -1
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < CON dev_sell < -0.02 E dev_ma39 < 0.06 E TREND LATERALE (100>300 <0.69 and >-0.77) - r 9016 B2"
                        action = "sell"
                        
                        # OGGI 22 LUG 2022 QUESTA SU RCCR HA FATTO -0.56 MENTRE MADOG HA FATTO -1.43 !
                        
                        # > estate -0.21 da -0.18
                        # 17 feb 2023 dev_sell a -0.219 da -0.215
                        #  6 apr 2023 dev_sell a -0.221 da -0.219
                        #  5 giu 2023 dev_sell a -0.20 da -0.22
                        #  5 giu 2023 dev_39 a -0.16 da -0.165
                        # 30 ago 2023 dev_39 a -0.01 da -0.16
                        # 30 ago 2023 dev_sell a -0.02 da -0.20
                        # 31 ago 2023 and macd < macd_2_min_ago
                        # 31 ago 2023 dev_sell a -0.03 da -0.02
                        # 12 set 2023 dev_sell a -0.05 da -0.03
                        # 12 set 2023 and macd < -1
                        # 12 set 2023 dev_39 a 0.05 da -0.01
                        # 29 set 2023 dev_sell a -0.06 da -0.05
                        
                        #  5 ott 2023 dev_sell a -0.04 da -0.06
                        #  5 ott 2023 dev_39 a 0.06 da 0.05
                        # 27 ott 2023 dev_sell a -0.055 da -0.04
                        # 25 nov 2023 dev_sell a -0.02 da -0.055
                        
                    # TREND LATERALE (100/300  < 0.69 and > -0.77)
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and deviation_sell  < -0.35
                        
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_ma100_sopra_ma300 > -0.77
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < e deviation_sell < -0.35 TREND LATERALE (100>300 <0.69 and > -0.77) - r 9017 A"
                        action = "sell"
                        
                        # HO AVUTO UN PROBLEMA GRANDE ! ha venduto con -0.14 ma io avevo -0.20 e -0.27 !!! ore 15:30 25 mag 2022
                        # DEVIATION 3-39 DIVENTA 4-39 (deviation_correzione_2)
                        # DEVIATION SELL DIVENTA 5-last trade price (deviation)
                        
                        # non mi arrendo !
                        # > estate -0.34 da -0.30
                        # con 300 > 301 min ago -0.35 da -0.34
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        and deviation_sell  < -0.34
                        and ma5_last < ma72_last
                        
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_ma100_sopra_ma300 > -0.77
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < e deviation_sell < -0.34 TREND LATERALE (100>300 <0.69 and > -0.77) - r 9017 B"
                        action = "sell"
                        
                        # HO AVUTO UN PROBLEMA GRANDE ! ha venduto con -0.14 ma io avevo -0.20 e -0.27 !!! ore 15:30 25 mag 2022
                        # DEVIATION 3-39 DIVENTA 4-39 (deviation_correzione_2)
                        # DEVIATION SELL DIVENTA 5-last trade price (deviation)
                        
                        # non mi arrendo !
                        # > estate -0.34 da -0.30
                        
                        # IO HO -0.34 MA QUESTA CONTINUA A VENDERE CON 0.02
                        # allora ho agginto and 5-72 ! e vaffanculo ! vedi SELL ore 22:42 del 29 ottobre 2022 !
                        
                        
                    ######################################################################## con ma50 DISTANTE dalla ma300 # queste 2 son un souvenir !
                    
                    # ho considerato, poi, la distanza tra ma100 e ma300 (ma il principio e' lo stesso)
                    # se ma100 sta molto sopra ma300 TREND IN CRESCITA interviene solo ma39
                    # ma se ma100 e' vicina alla ma300 TREND LATERALE interviene la ma39 E la deviation sell !
                    
                    # poi c'e' il cuscino di sant' antonio 5-100
                    
                    
                    
                    ##########################################################################################
                    
                    
                    # SELL 1 maestro parte 1 (21-50 min) con ma50 < and deviation_ma39 < -0.27
                    
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.28
                        and deviation_ma50_sotto_ma300 > 0.50
                    ):
                        sell = "SELL 1 maestro parte 1 (21-50 min) con ma50 < and deviation_ma39 < -0.28 - r 9048"
                        action = "sell"
                        
                        # 27 giu 2022 deviation_ma39 < -0.28 da -0.27
                        
                        
                       
                    
                    # RAFFORZATIVO CON 300 > 300 120 AGO (TREND RIALZO) OPPURE CON 300< 300 120 min ago (CROLLO)
                    
                    # SELL 1 maestro parte 2 (21-50 min) con ma50 < and deviation_sell < -0.33
                    
                    
                    elif (        
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma300_last > ma300_20_min_ago
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.36
                        and deviation_ma50_sotto_ma300 < 0.50
                    ):
                        sell = "SELL 1 maestro parte 2 300>120 e 300>20 (21-50 min) con ma50 < and deviation_sell < -0.36 - r 9072"
                        action = "sell"
                        
                        
                        
                        
                    elif (        
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma300_last < ma300_20_min_ago
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.33
                        and deviation_ma50_sotto_ma300 < 0.50
                    ):
                        sell = "SELL 1 maestro parte 2 300>120 e 300>20 (21-50 min) con ma50 < and deviation_sell < -0.33 - r 9087"
                        action = "sell"
                        
                        
                        
                   
                        
                        
                    elif (        
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.37
                        and deviation_ma50_sotto_ma300 < 0.50
                    ):
                        sell = "SELL 1 maestro parte 2 (21-50 min) con ma50 < and deviation_sell < -0.37 - r 9110 A"
                        action = "sell"
                        
                        # da 0.33 a 0.36 perche' durante il crollo ferrari non devi guardare i centesimi.
                        
                        


                    elif (        
                        ma50_last < ma50_2_min_ago
                        and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 

                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_sell < -0.34
                        and deviation_ma50_sotto_ma300 < 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 maestro parte 2 (21-50 min) con ma50 < and deviation_sell < -0.36 - r 9110 Bx1"
                        action = "sell"
                        
                        # da 0.33 a 0.36 perche' durante il crollo ferrari non devi guardare i centesimi.
                        # 23 ott 2025 strano che abbia venduto mentre CM GIORNO con + 0.23% (io ho messo and deviation_sell < -0.36 !)
                        # 23 ott 2025 aggiunto cm giorno
                        # 23 ott 2025 vediamo.
                        # deviation_sell = ma3_last/last_trade_price



                    elif (        
                        ma50_last < ma50_2_min_ago
                        and delta_CM_300_25_last > delta_CM_300_25_2_min_ago

                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_sell < -0.36
                        and deviation_ma50_sotto_ma300 < 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 maestro parte 2 (21-50 min) con ma50 < and deviation_sell < -0.36 - r 9110 Bx2"
                        action = "sell"
                        
                        # da 0.33 a 0.36 perche' durante il crollo ferrari non devi guardare i centesimi.
                        # 23 ott 2025 strano che abbia venduto mentre CM GIORNO con + 0.23% (io ho messo and deviation_sell < -0.36 !)
                        # 23 ott 2025 aggiunto cm notte
                        # 23 ott 2025 vediamo.
                        # deviation_sell = ma3_last/last_trade_price



                    
                    elif (        
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_sell < -0.02
                        and deviation_ma50_sotto_ma300 < 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 maestro parte 2 (21-50 min) con ma50 < and deviation_sell < -0.02 and macd < macd_2_min_ago - r 9110 By"
                        action = "sell"
                        
                        # da 0.33 a 0.36 perche' durante il crollo ferrari non devi guardare i centesimi.
                        # 18 gen 2024 se macd e 100< 100 60 min < vendi con -0.02 da -0.36 
                        
                     
                    #####################################################################################
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.37
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.37 - r 9130"
                        action = "sell"
                        
                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.31
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < e 100> and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO and deviation_sell < -0.31 - r 9146"
                        action = "sell"
                        
                      
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma100_last > ma100_30_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.29
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < e 100< and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO and dev_sell < -0.30 - r 9162 A"
                        action = "sell"
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma100_last < ma100_30_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.33
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < e 100< and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO and dev_sell < -0.33 - r 9174 B"
                        action = "sell"
                        
                        # 18 set -0.33 da -0.29
                        
                       
                    
                
                    ############################################################# con ma50 discendente MA ma200 ET ma200>ma300 - PERDITA TOLLERATA AUMENTA
                
                    # ho diviso il maestro in 2 !
                    
                    
                    elif (
                        
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.60
                   
                        and deviation_ma39 < -0.28
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 compa (21-50 min) con ma50 < and deviation_ma39 < -0.28 con > PERDITA TOLLERATA 100>300 DI MOLTO - r 9202 A"
                        action = "sell"
                        
                        # and deviation_ma39 < -0.15 or (deviation_sell < 0.10 and ma3_last < ma39_last)
                        
                        # ERRORE GRAVE CORRETTO DAL MAESTRO - VENDEVA MENTRE SALIVA !
                        # ma50_last < ma50_2_min_ago
                        # and ma2_last < ma2_2_min_ago
                        # and deviation_ma39 < -0.25
                        # or deviation_sell < -0.26
                  
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.60
                        and ma300_last > ma450_last

                        and deviation_ma39 < 0.08
                        and deviation_sell < -0.03
                        
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago 
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and dev_ma39< 0.08 e dev_sell < -0.03 con > PERDITA TOLLERATA - r 9229 Bx1"
                        action = "sell"
                        
                        # 20 nov 2023 aggiunto con 50 >
                        # 20 nov 2023 dev_ma39 < -0.08 da -0.28
                        # 20 nov 2023 dev_sell < -0.10 da -0.26
                        # 20 nov 2023 and macd < macd_2_min_ago
                  
                        # 20 nov 2023 and macd_differenza_2_min_ago < -2
                        # 30 dic 2023 dev_ma39 a 0.08 da -0.08
                        # 30 dic 2023 dev_sell a -0.02 da -0.10 vedi che MACD DIFFERENZA HA DATO UNA BELLA BOTTA RIBASSISTA !
                        # 14 apr 2025 dev_sell a -0.03 da -0.02 se anche 300>450



                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.60
                        and ma300_last < ma450_last
                        and deviation_ma39 < 0.08
                        and deviation_sell < -0.02
                        
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago 
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and dev_ma39< 0.08 e dev_sell < -0.02 con > PERDITA TOLLERATA - r 9229 Bx2"
                        action = "sell"
                        
                        # 20 nov 2023 aggiunto con 50 >
                        # 20 nov 2023 dev_ma39 < -0.08 da -0.28
                        # 20 nov 2023 dev_sell < -0.10 da -0.26
                        # 20 nov 2023 and macd < macd_2_min_ago
                  
                        # 20 nov 2023 and macd_differenza_2_min_ago < -2
                        # 30 dic 2023 dev_ma39 a 0.08 da -0.08
                        # 30 dic 2023 dev_sell a -0.02 da -0.10 vedi che MACD DIFFERENZA HA DATO UNA BELLA BOTTA RIBASSISTA !


                    
                    elif (
                        
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.60
                    
                        and deviation_ma39 < -0.08
                        and deviation_sell < -0.08
                        
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < and dev_ma39 < -0.28 AND DEV SELL< -0.26 con > PERDITA TOLLERATA 100 SOPRA 300 NON DI MOLTO - r 9229 By"
                        action = "sell"
                        
                        # and deviation_ma39 < -0.15 or (deviation_sell < 0.10 and ma3_last < ma39_last)
                        
                        # ERRORE GRAVE CORRETTO DAL MAESTRO - VENDEVA MENTRE SALIVA !
                        # ma50_last < ma50_2_min_ago
                        # and ma2_last < ma2_2_min_ago
                        # and deviation_ma39 < -0.25
                        # or deviation_sell < -0.26
                        # 21 mar 2023 deviation_sell -0.26 da -0.25
                        
                        # 20 nov 2023 dev_ma39 < -0.08 da -0.28
                        # 20 nov 2023 dev_sell < -0.08 da -0.26
                        # 20 nov 2023 and macd < macd_2_min_ago 
                        # 20 nov 2023 and macd_differenza_2_min_ago < -2
                    
                    # perdita tollerata DOPPIA
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma125_last > ma300_last
                        and ma200_last > ma200_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.35
                        and deviation_trend_ma200 > -0.03
                        and ma200_last > ma300_last
                       
                    ):
                        sell = "SELL 1 compa (21-50 min) con ma50 < and dev_sell < -0.35 con > perdita tollerata doppia (200> 120 min)- r 9255 A"
                        action = "sell"
                        
                        
                    # perdita tollerata SEMPLICE
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma125_last < ma300_last
                        and ma200_last > ma200_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.33
                        and deviation_trend_ma200 > -0.03
                        and ma200_last > ma300_last
                    
                    ):
                        sell = "SELL 1 compa (21-50 min) con ma50 < and deviation_sell < -0.33 con > perdita tollerata semplice (200> 120 min) - r 9255 B"
                        action = "sell"
                        
                        
                     
                        
                    # rafforzativo alla perdita tollerata
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.28
                        and deviation_trend_ma200 > -0.03
                        and ma200_last > ma300_last
                        
                        
                    ):
                        sell = "SELL 1 compa (21-50 min) con ma50 < and deviation_sell < -0.28 con > PERDITA TOLLERATA - r 9273"
                        action = "sell"
                        
                        # and deviation_ma39 < -0.15 or (deviation_sell < 0.10 and ma3_last < ma39_last)
                        
                        # ERRORE GRAVE CORRETTO DAL MAESTRO - VENDEVA MENTRE SALIVA !
                        # ma50_last < ma50_2_min_ago
                        # and ma2_last < ma2_2_min_ago
                        # and deviation_ma39 < -0.25
                        # or deviation_sell < -0.26
                        
                        
                      
                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        
                        and ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.40
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.40 - CON PERDITA TOLLERATA > - r 9296"
                        action = "sell"
                        
                        
                        

                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        
                        and ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 < and INCROCIO 3-100 -0.30 CUSCINO DI SANT' ANTONIO - CON PERDITA TOLLERATA > - r 9311"
                        action = "sell"
                        
                    
                    
                    # SELL 1 NON grande PERDITA dopo BUY AUDI E crollo SUCCESSIVO (21-50 min) 
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma33_prev and ma5_last < ma33_last)
                        and deviation_sell < -0.17
                        and ma59_last > ma59_30_min_ago
                        
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma100_last < ma100_120_min_ago
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_ma200_sotto_ma300 < -0.10
                        
                        and deviation_ma100_sopra_ma300 < -0.20
                        and deviation_ma100_sopra_ma300 > -0.80
                        and deviation_ma100_laterale > -1.00
                        
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 NON GRANDE PERDITA dopo BUY AUDI E crollo SUCCESSIVO (21-50 min) and dev sell < -0.17 - r 9312 A"
                        action = "sell"
                        
                        # in questa circostanza drammatica di crollo AUDI INTANTO TE LI PRENDI poi, eventualmente, ci pensa BUY 2
                        
                        # deviation 100 laterale =5/100 >-1.00 significa che questa condizione NON non interviene E' UNA SITUAZIONE DI CROLLO !
                        # si interviene solo nella fascia di mezza cottura ! 
                        # 20 set 2022 dev sell -0.10 da 0.01
                        # 26 ott 2022 dev sell -0.13 da -0.10 con ma59 > ma59 30 min ago
                        # 12 feb 2023 dev sell -0.15 da -0.13
                        # 17 mar 2023 dev sell -0.17 da -0.15
                        
                        
                    # SELL 1 NON grande PERDITA dopo BUY AUDI E crollo SUCCESSIVO (21-50 min) 
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma39_prev and ma5_last < ma39_last)
                        and deviation_sell < -0.15
                        and ma59_last < ma59_30_min_ago
                        
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma100_last < ma100_120_min_ago
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_ma200_sotto_ma300 < -0.10
                        
                        and deviation_ma100_sopra_ma300 < -0.20
                        and deviation_ma100_sopra_ma300 > -0.80
                        and deviation_ma100_laterale > -1.00
                        
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 NON GRANDE PERDITA dopo BUY AUDI E crollo SUCCESSIVO (21-50 min) and deviation_sell < -0.15 - r 9312 B"
                        action = "sell"
                        
                        # in questa circostanza drammatica di crollo AUDI INTANTO TE LI PRENDI poi, eventualmente, ci pensa BUY 2
                        
                        # deviation 100 laterale =5/100 > -1.00 significa che questa condizione NON non interviene E' UNA SITUAZIONE DI CROLLO !
                        # si interviene solo nella fascia di mezza cottura ! 
                        # 20 set 2022 dev sell -0.10 da 0.01
                        # 26 ott 2022 dev sell -0.12 da -0.10 con ma59 > ma59 30 min ago
                        # 20 apr 2023 dev sell -0.13 da -0.12
                        # 20 apr 2023 5-39 da 5-33
                        #  8 giu 2023 deviation_sell < -0.15 da < -0.13
                        
                    
                    #-------------------------------------------- nuova condizione 31 mar 2025

                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.19
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and deviation_ma25 < -0.20 - r 9320"
                        action = "sell"

                        # 25 nov 2023 and deviation_ma100_sopra_ma300 > 0.30
                        # 25 nov 2023 and deviation_ma25 < -0.19 da -0.20
                        # 31 mar 2025 aggiunta questa nuova condizione



                    # -------------------------------------------------------------------------------------- guadagno durante il crollo LEGGERO

                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > -1.20
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 0.30 
                        and deviation_sell < 0.54
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 eventuale GAIN nel crollo LEGGERO (21-50 min) con ma50 < incr 3 -30 and dev_sell 0.30 - 0.54 and dev 5-300 > -1.20- r 9327 A1"
                        action = "sell"



                    elif (
                        ma3_last < ma10_last
                        and (ma50_last < ma50_2_min_ago or ma50_last < ma50_50_min_ago)
              
                        
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)

                        and deviation_sell > 0.30 
                        and deviation_sell < 0.60

                        and deviation_ma5_sotto_ma300 > -1.20
                        and ma2_last < ma2_2_min_ago
                        
                        and macd_differenza_2_min_ago < -11
                        and macd < 80
                    ):
                        sell = "SELL 1 eventuale GAIN nel crollo LEGGERO (21-50 min) con ma50 < incr 3 -20 con diff macd < -11 e dev_sell 0.30 - 0.54 and dev 5-300 > -1.20 - r 9327 A2x"
                        action = "sell"
                        
                        #  7 dic 2023 se macd da una botta al ribasso allora vende con un ma 25
                        


                    elif (
                        ma3_last < ma10_last
                        and (ma50_last < ma50_2_min_ago or ma50_last < ma50_50_min_ago)
              
                        
                        and (ma3_prev > ma50_prev and ma3_last < ma50_last)
                        and deviation_sell > 0.30 
                        and deviation_sell < 0.60

                        and deviation_ma5_sotto_ma300 > -1.20
                        and ma2_last < ma2_2_min_ago
                        
                        and macd_differenza_2_min_ago < -11
                        and macd < 80
                    ):
                        sell = "SELL 1 eventuale GAIN nel crollo LEGGERO (21-50 min) con ma50 < incr 3 -25 con diff macd < -11 e dev_sell 0.30 - 0.54 and dev 5-300 > -1.20 - r 9327 A2y"
                        action = "sell"
                        
                        #  7 dic 2023 se macd da una botta al ribasso allora vende con un ma 25
                        # 16 ott 2025 aggiunto incrocio al ribasso 3-50 per farlo vendere un po' prima (strano, ma la ma50 sta sopra la ma25 !)





                        
                    # -------------------------------------------------------------------------------------- guadagno durante il crollo PESANTE

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma39_last > ma100_last
                        and (ma3_prev > ma90_prev and ma3_last < ma90_last)

                        and deviation_ma5_sotto_ma300 < -1.20
                        
                        and deviation_sell > 0.25 
                        and deviation_sell < 0.60
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 eventuale GAIN nel crollo (21-50 min) con ma50< e incr 3-90 (ma39 e' andata sopra ma100) E dev_sell 0.25-0.60 - r 9327 Bx"
                        action = "sell"
                        
                        # 14 set 3-30 da 3-28
                        #  3 ott 2024 se durante il crollo ma39 e' andata sopra ma100 allora statti un poco piu' calmo. 
                        #  3 ott 2024 se durante il crollo ma39 e' andata sopra ma100 vende con incrocio al ribasso 3-90 da 3-30 !


                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma39_last < ma100_last

                        and deviation_ma5_sotto_ma300 < -1.20
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 0.30 
                        and deviation_sell < 0.54
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 eventuale GAIN nel crollo (21-50 min) con ma50< E incr 3-30 (ma39 sta ancora sotto ma100) E dev_sell 0.30-0.54 - r 9327 By"
                        action = "sell"
                        
                        # 14 set 3-30 da 3-28
                        
                       
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 0.55
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 eventuale guadagno durante il crollo (21-50 min) con ma50 < incrocio 3 - 11 and deviation_sell > 0.55 - r 9338"
                        action = "sell"
                        
                        
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and macd < macd_2_min_ago
                        and deviation_ma100_sopra_ma300 > -0.90
                        
                        and (ma3_prev > ma18_prev and ma3_last < ma18_last)
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 piccola perdita durante il crollo (21-50 min) con ma50 < incrocio 3 - 18 and dev_sell < -0.27 non e' crollo ! - r 9353 A"
                        action = "sell"
                        
                        # 21 apr 2023 aggiunto macd < macd_2_min_ago
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < -0.90
                        
                        and (ma3_prev > ma18_prev and ma3_last < ma18_last)
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min) piccola perdita durante il crollo con ma50 < incrocio 3 - 18 and dev_sell < -0.27 e' crollo ! - r 9353 B"
                        action = "sell"
                        
                        
                        
                        
                    # AGGIUNTA TARDIVA MA FORSE NECESSARIA !
                  
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma20_last > ma39_last
                        and delta_1 > delta_2
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                   
                        and deviation_sell < -0.1155
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min)  piccola perdita durante il crollo - AGGIUNTA TARDIVA MA FORSE NECESSARIA ! and delta_1 > delta_2 and dev_sell < -0.1155 - r 9354 A1"
                        action = "sell" 

                  
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma20_last > ma39_last
                        and delta_1 > delta_2
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                   
                        and deviation_sell < -0.05
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -7
                        and macd < -20
                    ):
                        sell = "SELL 1 (21-50 min)  piccola perdita durante il crollo - AGGIUNTA TARDIVA MA forse NECESSARIA ! and delta_1>delta_2 and dev_sell < -0.05 - r 9354 A2"
                        action = "sell"
                        
                        
                        # 29 mag 2023 AGGIUNTO 
                        # 29 mag 2023 dev_sell a -0.10
                        # 30 mag 2023 dev_sell a -0.115 da -0.10
                        # 10 giu 2023 dev_sell a -0.114 da -0.115 ( dopo che ha fatto -0.54% )
                        # 27 giu 2023 dev_sell a -0.1155 da -0.115 se 20>39
                        
                        # 11 dic 2023 aggiunta and macd_differenza_2_min_ago < -7
                        # 11 dic 2023 aggiunta and macd < -20
                             
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma20_last < ma39_last
                        and delta_1 > delta_2
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                   
                        and deviation_sell < -0.1145
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 (21-50 min)  piccola perdita durante il crollo - AGGIUNTA TARDIVA MA FORSE NECESSARIA ! and delta_1 > delta_2 and dev_sell < -0.1145 - r 9354b"
                        action = "sell"
                        
                        
                        # 29 mag 2023 AGGIUNTO 
                        # 29 mag 2023 dev_sell a -0.10
                        # 30 mag 2023 dev_sell a -0.115 da -0.10
                        # 10 giu 2023 dev_sell a -0.114 da -0.115 ( dopo che ha fatto -0.54% )
                        # 27 giu 2023 dev_sell a -0.1145 da -0.15 se 20<39


                    
                    
                    elif ( 
                        ma50_last > ma50_2_min_ago 
                        and ma200_last < ma200_60_min_ago
                        
                        and deviation_sell < -0.065

                        and ma3_last < ma50_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.50
                        and ma2_differenza_2_min_ago < -6
                        
                    ):
                        sell = "SELL 1 (21-50 min) con ma50 > and deviation_sell < -0.06 and ma3_last < ma50_last - r 9354x"
                        action = "sell"

                        # 25 gen 2023 dev_sell a -0.238 da 0.24 dopo -0.95% ore 10:04 del 24 gen 2023
                        # 10 ott 2023 dev_sell a 0.05 da -0.238
                        # 14 ott 2023 aggiunta and macd_differenza_2_min_ago < -0.25
                        #  3 nov 2023 aggiunta and ma2_differenza_2_min_ago < -6
                        
                        # 17 nov 2023 deviation_sell a -0.065 da -0.06
                        # 17 nov 2023 macd_differenza_2_min_ago a -0.50 da -0.25
                  
                     
                    # ------------------------------------------------------------------------------------------------------------------ CONDIZIONI SPECIALI NEL SELL 1 !

                    
                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.10
                
                
                        and ma50_last <= ma50_2_min_ago
                
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < 5
                    ):
                        sell = "SELL 1 (21-50 min) cond spec EX r 16047 B2 con ma300> 5 ore - SALVAGENTE 4 deviation 3-39 < 0.05 and dev_sell < -0.10 - con ma50 <  - r 9355a"
                        action = "sell"

                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma50_last <= ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.07
                        
                        and deviation_ma100_sopra_ma300 < 0.40
                        and deviation_ma5_sotto_ma200 > -0.90
                        
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and macd < -3
                    ):
                        sell = "SELL 1 (21-50 min) cond. spec. EX r 16047 B2 con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell<-0.06 and macd < macd 2 min ago and macd < -3 - r 9355b"
                        action = "sell"
                        # 28 set 2023 dev sell -0.07 da -0.06
                        # 28 set 2023 and macd a -3 da -2



                  
                    elif (
                        ma50_last <= ma50_2_min_ago
                        and ma100_last <= ma100_10_min_ago
                        and macd_differenza_2_min_ago < -4
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.05
                        and ma2_last <= ma2_2_min_ago 
                        and delta_450_300 > delta_450_300_60_min
                
                        and deviation_ma100_sopra_ma300 > 0.20
                        and deviation_ma3_sotto_ma150 > -1.20
                
                    ):
                        sell = "SELL 1 (21-50 min) da SALVAGENTE RCCR AGGIUNTA IL 23 OTT 2025 cazzo con 3-39 < 0.05 e dev sell < 0.05 con ma50 <= e dev_ma3_sotto_ma200 > -1.20 - r 9358"
                        action = "sell"

                        # 23 ott 2025 AGGIUNTA IL 23 OTT 2025 cazzo




                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.08
                        and deviation_sell < -0.01
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < 5
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 1 (21-50 min) EX cond spec r 16047 B1y con ma 50 < ma 50 2 min ago  con ma300 > 5 ore - dev 3-39 < 0.08 and dev_sell < -0.01 - r 9360"
                        action = "sell"
                        
                        # 25 ott 2023 and dev_sell < -0.05 da < -0.107
                        #  7 dic 2023 dev 39 a 0.08 da 0.05 
                        #  7 dic 2023 dev sell a -0.01 da - 0,05
                        #  7 dic 2023 aggiunta and macd_differenza_2_min_ago < -0.50


                  
                    

                  
                    

                  
                    

                    
                    
                        
                   
            
            
                #############################################################################################################  SESSIONE 1 ( da 50 a 90 min )

                # VENDITA - da 50 a 90 min - da 3001 a 5400 secondi in poi
                
                elif (
                    seconds_since_last_trade > 3001 and seconds_since_last_trade <= 5400
                ):
                    
                    if (    
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma200_last
                        and deviation_ma39 < -0.22
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > and deviation_ma39 <-0.22 and deviation_sell < -0.23 - r 9388"
                        action = "sell"
                        
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma78_last > ma100_last
                        
                        and ma100_last > ma100_60_min_ago
                        and ma100_last < ma200_last
                        and deviation_ma39 < -0.27
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > and deviation_ma39 < -0.27 CON 78 > 100 - r 9404 a1"
                        action = "sell"
                        
                        # se 100 cresce da 60 min il sistema e' piu' rilassato e non ha fretta di portare a casa un guadagno minimo
                        
                        
                        
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma78_last < ma100_last
                        
                        and ma100_last > ma100_60_min_ago
                        and ma100_last < ma200_last
                        and deviation_ma39 < -0.25
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > and deviation_ma39 < -0.25 CON 78 < 100- r 9422 a2"
                        action = "sell"
                        
                        # se 100 cresce da 60 min il sistema e' piu' rilassato e non ha fretta di portare a casa un guadagno minimo
                        
                        
                        
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.50
                        and ma100_last < ma100_60_min_ago
                        and ma100_last < ma200_last
                        and deviation_ma39 < -0.22
                        and deviation_sell < 0.23
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > and deviation_ma39 < -0.22 and deviation_sell < 0.23 con 5 sopra 300 > 0.50 - r 9440 b1"
                        action = "sell"
                        
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # potrebbe essere situazione di crollo che vende con ma39 e senza deviation sell !
                        # cioe' in una situazione di crollo si porta a casa lo 0.23
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.50
                        and ma100_last < ma100_60_min_ago
                        and ma100_last < ma200_last
                        and deviation_ma39 < -0.22
                        and deviation_sell < -0.15
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > and deviation_ma39 < -0.22 and deviation_sell < -0.15 con 5 sopra 300 < 0.50 - r 9440 b2"
                        action = "sell"
                        
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # potrebbe essere situazione di crollo che vende con ma39 e senza deviation sell !
                        # cioe' in una situazione di crollo si porta a casa lo 0.23
                        
                        
                     
                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_sell < -0.23
                        and ma3_last < ma50_last
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > and deviation_sell < -0.23 and ma3_last < ma50_last  - r 9461"
                        action = "sell"
                        
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        
                   
                    
                    
                    # la prima FINTA ALLA MARADONA RAFFORZATO DA 100>150
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and macd < macd_2_min_ago
                        and ma300_last > ma450_last
                        and ma100_last > ma150_last
                        and (ma5_prev > ma90_prev and ma5_last < ma90_last)
                        and deviation_sell > 0.32 and deviation_sell < 0.52
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > and incrocio 5-90 and deviation_sell 0.31-0.52 la prima FINTA ALLA MARADONA RAFFORZATO - r 9493 Ax"
                        action = "sell"
                        
                        # MARADONA RAFFORZATO accompagna nelle prime fasi di crescita. poi interviene RONALDO se il rialzo comincia a farsi piu' consistente.
                        # 15 nov 2022 5-59 da 5-54
                        # 19 apr 2023 5-90 da 5-59
                        # 19 apr 2023 aggiunta macd < macd 2 min ago
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        and ma100_last > ma150_last
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.32 and deviation_sell < 0.52
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 5-78 and dev_sell 0.31-0.52 la prima FINTA ALLA MARADONA RAFFORZATO - r 9493 Ay"
                        action = "sell"
                        
                        # MARADONA RAFFORZATO accompagna nelle prime fasi di crescita. poi interviene RONALDO se il rialzo comincia a farsi piu' consistente.
                        # 15 nov 2022 5-59 da 5-54
                        # 23 feb 2023 5-78 da 5-59 se 300 < 450 fase di ribasso
                        
                        
                        
                    # la prima FINTA ALLA MARADONA
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.15
                        and ma100_last < ma150_last
                        and ma300_last > ma300_120_min_ago
                        
                        and (ma5_prev > ma59_prev and ma5_last < ma59_last)
                        and deviation_sell > 0.32 and deviation_sell < 0.52
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 5-59 and dev_sell 0.31-0.52 la prima FINTA ALLA MARADONA - r 9493 B1"
                        action = "sell"
                        
                        # MARADONA accompagna nelle prime fasi di crescita il titolo. poi interviene RONALDO se il rialzo comincia a farsi piu' consistente.
                        # 30 set 5-59 da 5-52 se 300 > 300 120 min ago
                        
                        
                    # la prima FINTA ALLA MARADONA
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.15
                        and deviation_ma5_sotto_ma300 > -0.30
                        and ma100_last < ma150_last
                        and ma300_last > ma300_120_min_ago
                        
                        and (ma5_prev > ma125_prev and ma5_last < ma125_last)
                        and deviation_sell > 0.32 and deviation_sell < 0.52
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 5-125 and dev_sell 0.31-0.52 la prima FINTA ALLA MARADONA - r 9493 B2"
                        action = "sell"
                        
                        # MARADONA accompagna nelle prime fasi di crescita il titolo. poi interviene RONALDO se il rialzo comincia a farsi piu' consistente.
                        # 30 set 5-59 da 5-52 se 300 > 300 120 min ago
                        
                        
                        
                    # la prima FINTA ALLA MARADONA
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        and deviation_ma5_sotto_ma300 < -0.30
                        and ma100_last < ma150_last
                        and ma300_last > ma300_120_min_ago
                        
                        and (ma5_prev > ma59_prev and ma5_last < ma59_last)
                        and deviation_sell > 0.32 and deviation_sell < 0.52
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 5-59 and dev_sell 0.31-0.52 la prima FINTA ALLA MARADONA - r 9493 B3"
                        action = "sell"
                        
                        # MARADONA accompagna nelle prime fasi di crescita il titolo. poi interviene RONALDO se il rialzo comincia a farsi piu' consistente.
                        # 30 set 5-59 da 5-52 se 300 > 300 120 min ago

                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma39_last > ma100_last

                        and ma100_last < ma150_last
                        and ma300_last < ma300_120_min_ago
                        
                        and (ma5_prev > ma69_prev and ma5_last < ma69_last)
                        and deviation_sell > 0.32 and deviation_sell < 0.52
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50> e incr 5-69 and dev_sell 0.31-0.52 and 39>100 - finta alla maradona - r 9495 a"
                        action = "sell"
                        
                        # poi interviene RONALDO se il rialzo comincia a farsi piu' consistente.
                        # 18 nov 2022 5-59 da 5-52
                        # 26 apr 2025 se 39>100 vende con 5-69 da 5-59 stai tranquillo !
                        

                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma39_last < ma100_last

                        and ma100_last < ma150_last
                        and ma300_last < ma300_120_min_ago
                        
                        and (ma5_prev > ma59_prev and ma5_last < ma59_last)
                        and deviation_sell > 0.32 and deviation_sell < 0.52
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50> e incr 5-59 and dev_sell 0.31-0.52 and 39<100 - finta alla maradona - r 9495 b"
                        action = "sell"
                        
                        # poi interviene RONALDO se il rialzo comincia a farsi piu' consistente.
                        # 18 nov 2022 5-59 da 5-52
                        # 26 apr 2025 se 39<100 vende con 5-59 ok cosi' per adesso
                    
                    
                    
                    
                    #-------------------------------------------- nuova condizione 31 mar 2025

                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.19
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 1 (50-90 min) con ma50 > and deviation_ma25 < -0.20 - r 9500"
                        action = "sell"

                        # 25 nov 2023 and deviation_ma100_sopra_ma300 > 0.30
                        # 25 nov 2023 and deviation_ma25 < -0.19 da -0.20
                        # 31 mar 2025 aggiunta questa nuova condizione




                    ######################################################## ronaldo 60-90 min dal buy se ma200 > somiglia a maradona

                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma200_last > ma200_120_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.53 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50> and incrocio 5-78 se 300 > 120 min ago and dev_sell 0.51-0.90 RONALDO - r 9514a"
                        action = "sell"
                        
                        # 5-125 da 4-50 dopo le dolomiti
                        # 5-78 tornato a roma dopo le vacanze
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma200_last > ma200_120_min_ago
                        and (ma4_prev > ma59_prev and ma4_last < ma59_last)
                        and deviation_sell > 0.53 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50> and incrocio 4-59 se 300 < 120 min ago and dev_sell 0.51-0.90 RONALDO - r 9514 B"
                        action = "sell"
                        
                        # 6 apr 4-59 da 4-50
                        
                    
                    
                    ############################################################################ ronaldo 60-90 min dal buy se ma200 < non perdona
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.59
                        and ma200_last < ma200_120_min_ago
                        and (ma4_prev > ma39_prev and ma4_last < ma39_last)
                        and deviation_sell > 0.53 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50> and incrocio 4-39 and dev_sell 0.51-0.90 RONALDO - r 9529 a"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.59
                        and ma200_last < ma200_120_min_ago
                        and (ma4_prev > ma100_prev and ma4_last < ma100_last)
                        and deviation_sell > 0.53 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50> and incrocio 4-100 ! GUARDANDO LE COSE DA LONTANO and dev_sell 0.51-0.90 RONALDO - r 9529 b"
                        action = "sell"
                        
                        # se 5 non e' distante dalla 300 movimento laterale e 4-100 ritornando dalle dolomiti e guardando le cose da lontano !
                        
                        
                    ##################################################################################################################
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.99
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 5-78 and dev_sell 0.91 - 1.49 RABONA DI RONALDO  5-300 > 0.99 - r 9543 A1"
                        action = "sell"
                  
                        # ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and deviation_ma5_sotto_ma300 < 0.99
                        and (ma5_prev > ma45_prev and ma5_last < ma45_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 5-45 and dev_sell 0.91 - 1.49 RABONA DI RONALDO se 5-300 > 0.40 ma < 0.99 - r 9543 A2"
                        action = "sell"
                  
                        # ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.40
                        and deviation_ma5_sotto_ma300 > 0.01
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > e incrocio 3-33 e dev_sell 0.91 - 1.49 RABONA RONALDO 5-300 0.01 - 0.40 - r 9543 B"
                        action = "sell"
                  
                        # ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !


                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma300_last

                        and deviation_ma5_sotto_ma300 < 0.01
                        and deviation_ma5_sotto_ma300 > -2.00
                        and (ma4_prev > ma59_prev and ma4_last < ma59_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -1.00
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > e incrocio 4-59 e dev_sell 0.91 - 1.49 RABONA RONALDO 5-300 -2.00 - 0.01 - r 9543 Cx"
                        action = "sell"
                  
                        # ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                        #  5 feb 2025 4-59 da 4-48 se 100 > 300
                        #  5 feb 2025 aggiunta and macd_differenza_2_min_ago < -1.00

                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma300_last

                        and deviation_ma5_sotto_ma300 < 0.01
                        and deviation_ma5_sotto_ma300 > -2.00
                        and (ma4_prev > ma48_prev and ma4_last < ma48_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 4-48 and dev_sell 0.91 - 1.49 RABONA DI RONALDO 5-300 -2.00 - 0.01 - r 9543 Cy"
                        action = "sell"
                  
                        # ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        and deviation_ma5_sotto_ma300 < -2.00
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 3-33 and dev_sell 0.91 - 1.49 RABONA DI RONALDO 5-300 < -2.00 - r 9543 D"
                        action = "sell"
                  
                        # ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                    
                    
                    
                    
                    # SELL 1 da 50 a 90 min DOPPIO PASSO ALLA RONALDO 1 (se 50-200 > 0.30 stai un po' piu' tranquillo)
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma50_sotto_ma200 > 0.30
                        and (ma3_prev > ma59_prev and ma3_last < ma59_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (50-90 min) con ma50 > incrocio 3-59 and dev_sell > 1.50 DOPPIO PASSO RONALDO se 50-200 > 0.30 - r 9559"
                        action = "sell"
                        
                        # deviation_ma50_sotto_ma200 = 50/200 quindi non farti ingannare dalla parola sotto.
                        # 31 maggio 2022 3-39 da 3-33
                        #  3 feb 2025 3-59 da 3-33 se deviation_ma50_sotto_ma200 > 0.30


                        
                    # SELL 1 da 50 a 90 min DOPPIO PASSO ALLA RONALDO 2 se 50-200 < 0.30 
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma50_sotto_ma200 < 0.30
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 da 50 a 90 min con ma50 > incrocio 3-33 and deviation_sell > 1.50 DOPPIO PASSO ALLA RONALDO se 50-200 < 0.30 - r 9575"
                        action = "sell"
                        
                        
                        
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.50
                        and (ma3_prev > ma42_prev and ma3_last < ma42_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 da 50 a 90 min con ma50 > incrocio 3-11 and deviation_sell > 2.71 TACCO DI ALLAH - r 9591 a"
                        action = "sell"
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.50
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 da 50 a 90 min con ma50 > incrocio 3-13 and deviation_sell > 2.71 TACCO DI ALLAH - r 9603 b"
                        action = "sell"
                        
                        
                
                  
                    ######################################################################################## con trend discendente ma50 <
                    
                    ############################################################## ipotesi peggiore e sono cazzi ! and doppio delta ( sempre con ma50 < )
                    
                    # SELL 1 50-90 min IPOTESI PEGGIORE con ma50< con deviation_ma39 <-0.205 and deviation_sell < -0.205 and DOPPIO DELTA INFERI
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 < -0.10
                        
                        and deviation_ma39 < -0.19
                        and deviation_sell < -0.22
                        
                        
                        and delta_1 > delta_2
                        and ma100_last < ma100_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 50-90 min IPOTESI PEGGIORE con ma50 < con dev_ma39 <-0.19 and dev sell < -0.22 SOTTO RIBASSO RIBASSO - NOTTE - r 9633a"
                        action = "sell"
                        
                        # 6 giu 2022 deviation sell a -0.22 da -0.195
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 < -0.10
                        
                        and deviation_ma39 < -0.19
                        and deviation_sell < -0.21
                        
                        
                        and delta_1 > delta_2
                        and ma100_last < ma100_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 50-90 min IPOTESI PEGGIORE con ma50 < con dev_ma39 <-0.19 and dev sell < -0.21 SOTTO RIBASSO RIBASSO - NOTTE - r 9633b"
                        action = "sell"
                        
                        # 6 giu 2022 deviation sell a -0.22 da -0.195
                        # 6 mag 2023 deviation sell a -0.21 da -0.22
                        # durante un ribasso evidente (ma300 scende da 6 ore !) devi perdere il meno possibile ! esci ! a ricomprare ci pensera' la condizione successiva.
                        
                        
                    elif ( 
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.05
                        
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 1 50-90 min con ma50 > and (deviation_sell < -0.05 and ma3_last < ma50_last) - r 9634"
                        action = "sell"
                        
                        # 25 gen 2023 dev_sell a -0.238 da 0.24 dopo -0.95% ore 10:04 del 24 gen 2023
                        # 10 ott 2023 dev_sell a -0.05 da -0.238

                  
                  
                    # SELL 1 50-90 min IPOTESI PEGGIORE MA DOPPIO DELTA RISALITA con ma50< con deviation_ma39 <-0.205 and deviation_sell < -0.205
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 < -0.10
                        
                        and deviation_ma39 < -0.05
                        and deviation_sell < -0.10
                        
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 50-90 min con ma50< e dev ma39 < -0.05 e dev sell < -0.10 SOTTO RIALZO RIALZO - GIORNO ! - r 9656"
                        action = "sell"
                        
                        # IPOTESI PEGGIORE MA GIORNO !
                        # 12 giu 2023 deviation_ma39 < -0.21 da 0.215
                        # 12 set 2023 dev 39 -0.05 da -0.21
                        # 12 set 2023 dev sell -0.10 da -0.30



                    
                    elif (
                        ma50_last <= ma50_2_min_ago
                        and ma100_last <= ma100_10_min_ago
                        and macd_differenza_2_min_ago < -4
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.05
                        and ma2_last <= ma2_2_min_ago 
                        and delta_450_300 > delta_450_300_60_min
                
                        and deviation_ma100_sopra_ma300 > 0.20
                        and deviation_ma3_sotto_ma150 > -1.20
                
                    ):
                        sell = "SELL 1 da 50 a 90 min - da SALVAGENTE RCCR AGGIUNTA IL 23 OTT 2025 cazzo con 3-39 < 0.05 e dev sell < 0.05 con ma50 <= e dev_ma3_sotto_ma200 > -1.20 - r 9670"
                        action = "sell"

                        # 23 ott 2025 AGGIUNTA IL 23 OTT 2025 cazzo



                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 < -0.10
                        
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell < -0.24
                      
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min IPOTESI PEGGIORE con ma50 < con incrocio 5-78 and deviation_sell < -0.24 - r 9674"
                        action = "sell"
                        
                        # > estate 5-78 da 3-78 e dev sell -0.20 da -0.15
                        # 3 set dev sell -0.24 da -0.20
                        # 18 mag 2023 aggiunto macd < macd 2 min ago
                        
                        
               
                    ############################################################### ipotesi mediana 1 RAFFORZATA un po' meno peggio ( sempre con ma50 < )
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma300_last
                        
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        
                        and deviation_ma39 < -0.05
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.15
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 50-90 min IPOTESI mediana 1 RAFFORZATA un po' MENO PEGGIO con ma50< E dev_ma39 <-0.05 E deviation_sell < -0.15 - r 9694"
                        action = "sell"
                        
                        # 30 ago 2023 dev 39 < -0.05 crolla mentre 3-39 (dev 39) stanno attaccate !
                        # 30 ago 2023 dev sell -0.15 
                        
                        
                    ############################################################### ipotesi mediana 1 un po' meno peggio ( sempre con ma50 < )
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_720_min_ago
                        
                        and ma100_last < ma300_last
                        and ma100_last > ma100_60_min_ago
                        
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        
                        and deviation_ma39 < -0.19
                        and deviation_sell < -0.22
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min IPOTESI un po' MENO PEGGIO con ma50 < con dev_ma39 < -0.19 MA 100> and dev_sell < -0.22 - r 9717a"
                        action = "sell"
                        
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_720_min_ago
                        
                        and ma100_last < ma300_last
                        and ma100_last > ma100_60_min_ago
                        
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        
                        and deviation_ma39 < -0.19
                        and deviation_sell < -0.21
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min IPOTESI un po' MENO PEGGIO con ma50 < con dev_ma39 < -0.19 MA 100> and dev_sell < -0.21 - r 9717b"
                        action = "sell"
                        
                        
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma300_last
                        and ma100_last < ma100_60_min_ago
                        
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        
                        and deviation_ma39 < -0.19
                        and deviation_sell < -0.21
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min IPOTESI un po' MENO PEGGIO con ma50 < con deviation_ma39 <-0.19 E 100< and dev_sell < -0.21 - r 9736"
                        action = "sell"
                        
                        
                   
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma200_301_min_ago
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.19
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min IPOTESI un po' MENO PEGGIO con ma50 < con incrocio 3-78 and deviation_sell < -0.19 - r 9757 A"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_301_min_ago
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.17
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min IPOTESI un po' MENO PEGGIO con ma50 < con incrocio 3-78 and deviation_sell < -0.17 - r 9757 B"
                        action = "sell"
                        
                
                
                    #################################################################### # ipotesi mediana 2 un po' meglio ( sempre con ma50 < )
                   
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma300_last
                        and deviation_trend_ma200 < -0.10
                        
                        and deviation_ma39 < -0.22
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min UN PO' MEGLIO con ma50 < con deviation_ma39 <-0.22 and deviation_sell < -0.23 - r 9774"
                        action = "sell"
                        
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma300_last
                        and deviation_trend_ma200 < -0.10
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.17
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50 a 90 min UN PO' MEGLIO con ma50 < con incrocio 3-78 and deviation_sell < -0.17 - r 9789"
                        action = "sell"
                        
                    
                    ##################################################### sempre con ma50 discendente MA trend ma200> ET ma200 > ma300 - PERDITA TOLLERATA AUMENTA
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma200_last > ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        and ma78_last > ma200_last
                        
                        and deviation_ma39 < -0.23
                        and deviation_sell < -0.35
                        
                        and ma2_last <= ma2_2_min_ago
                    ):
                        sell = "SELL 1 50-90 min con ma50 < E 78 > 200 con dev_ma39 <-0.23 and dev_sell <-0.35 - PERDITA TOLLERATA > e 300 > 120 min ago - r 9807 A1"
                        action = "sell"
                        
                        # ha fatto perdita dell' 1% - forse succede tutto in quei 2 minuti se crolla improvvisamente
                        # con deviation_ma39 < -0.27 E CON con deviation_sell < -0.28
                        # 6 luglio 2022 dev_sell a -0.31 da -0.30
                        
                        
                        
                        
                    ##################################################### sempre con ma50 discendente MA trend ma200> ET ma200 > ma300 - PERDITA TOLLERATA AUMENTA
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma200_last > ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        and ma78_last > ma200_last
                        
                        and deviation_ma39 < -0.23
                        and deviation_sell < -0.33
                        
                        and ma2_last <= ma2_2_min_ago
                    ):
                        sell = "SELL 1 50-90 min con ma50 < E 78 > 200 con dev_ma39 <-0.23 and dev_sell <-0.33 - PERDITA TOLLERATA > e 300 < 120 min ago - r 9807 A2"
                        action = "sell"
                        
                        # ha fatto perdita dell' 1% - forse succede tutto in quei 2 minuti se crolla improvvisamente
                        # con deviation_ma39 < -0.27 E CON con deviation_sell < -0.28
                        # 6 luglio 2022 dev_sell a -0.31 da -0.30
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        and ma78_last < ma200_last
                        
                        and deviation_ma39 < -0.225
                        and deviation_sell < -0.29
                        
                        and ma2_last <= ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 da 50-90 min BEST con ma50< MA 78 < 200 con dev_ma39 <-0.23 and dev_sell <-0.29 - CON PERDITA TOLLERATA > and macd < macd_2_min_ago - r 9828 B"
                        action = "sell"
                        
                        # ha fatto perdita dell' 1% - forse succede tutto in quei 2 minuti se crolla improvvisamente
                        # con deviation_ma39 < -0.27
                        # con deviation_sell < -0.28
                        # DEV SELL 0.29 DA 0.295 dopo dolomiti
                        # 30 mag 2023 dev 39 da -0.225 da -0.23
                        # 30 mag 2023 macd <
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma200_last
                        
                        and ma200_last > ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.29
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 RAFFORZATA da 50-90 min BEST ma sempre con ma50 < con incrocio 3-78 and dev_sell < -0.29 - PERDITA TOLLERATA > - r 9851"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma200_last
                        
                        and ma200_last > ma300_last
                        and deviation_trend_ma200 > -0.10
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50-90 min BEST ma sempre con ma50 < con incrocio 3-78 and dev_sell < -0.25 - CON PERDITA TOLLERATA > - r 9867"
                        action = "sell"
                        
                        
                        
                    # AGGIUNTA TARDIVA MA FORSE NECESSARIA !
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_1 < delta_2
                        
                        and ma300_last > ma300_301_min_ago
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                   
                        and deviation_sell < -0.20
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50-90 min AGGIUNTA TARDIVA MA FORSE NECESSARIA ! and delta_1 < delta_2 and deviation_sell < -0.19 e 300>5 ore - r 9888 a1"
                        action = "sell"
                        
                        # 5 mag 2023 -0.20 da -0.19
                        
                        
                        
                    # AGGIUNTA TARDIVA MA FORSE NECESSARIA !
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_1 < delta_2
                        
                        and ma300_last < ma300_301_min_ago
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                   
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50-90 min AGGIUNTA TARDIVA MA NECESSARIA ! and delta_1 < delta_2 and deviation_sell < -0.30 e 300 < 5 ore - r 9888 A2"
                        action = "sell"
                        
                        # > estate -0.28 da -0.18
                        # 14 ott 2022 0.29 da 0.28 condizione forse senza forse NECESSARIA !
                        # 19 ott 2022 0.31 da 0.29 delta 1< delta 2 ! bravo mario
                        # 17 mar 2023 dev sell -0.30 da -0.29 vedi 27 feb 2023 ore 21:07
                        
                        
                        
                    # AGGIUNTA TARDIVA MA FORSE NECESSARIA !
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_1 > delta_2
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                   
                        and deviation_sell < -0.26
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 50-90 min AGGIUNTA TARDIVA MA FORSE NECESSARIA ! and delta_1 > delta_2 and deviation_sell < -0.26 - r 9908 B"
                        action = "sell"
                        
                        # 21 lug 2022 0.22 da 0.175
                        # 10 mar 2023 0.25 da 0.22
                        # 29 mag 2023 0.26 da 0.25

                    
                    # SELL 1 eventuale guadagno con crollo (50-90 min) con ma50 < and incrocio 5-59 and deviation_sell > 0.45
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma90_prev and ma5_last < ma90_last)
                        and deviation_sell > 0.45
                        
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma100_last < ma100_120_min_ago
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                     
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 eventuale guadagno con crollo (50-90 min) con ma50 < and incrocio 5-90 and deviation_sell > 0.45 - r 9930"
                        action = "sell"
                        
                        # in questa circostanza drammatica di crollo INTANTO TE LI PRENDI poi, eventualmente, ci pensa BUY 2
                        # 2 mag 2023 5-90 da 5-59


                  
                    # ----------------------------------------------------------------------------- CONDIZIONI SPECIALI NEL SELL 1 !
                    
                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                    ):
                        sell = "SELL 1 (50-90 min) - dev 3-39 < 0.01 and dev_sell < -0.30 - con ma50 < e con ma5 sotto ma200 > -0.80 - r 9931 A"
                        action = "sell"
                        
                        #   9 GIU 2023 dev 3-39 a -0.17 da -0.25
                        #   9 GIU 2023 dev sell a -0.35 da -0.36
                        #  15 GIU 2023 dev_39 -0.15 da -0.17 dopo che ha fatto -1.15% il 14 giu 2023 ore 22:06
                        #  15 GIU 2023 dev sell a -0.349 da -0.35
                        #   7 lug 2023 dev sell a -0.348 da -0.349
                        #   7 lug 2023 deviation 3-39 < -0.10 da < -0.15
                        #   1 set 2023 and deviation_ma5_sotto_ma200 > -0.80 da -0.90
                        #   1 set 2023 and deviation_ma39 < -0.01 da -0.10 aveva fatto -0.66
                        #   1 set 2023 dev sell a -0.34 da -0.348
                        #   1 set 2023 dev sell a -0.34 da -0.348
                        #   2 ott 2023 dev sell a -0.30 da -0.34
                        #   2 ott 2023 dev 39 a 0.01 da -0.01

              
                    

              
                    ################################################################################################ ex condizioni speciali importate
                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma300_last < ma300_301_min_ago
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.06
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and macd < -2
                    ):
                        sell = "SELL 1 (50-90 min) ex cond. spec. r 16047 B2 con ma300> 5 ore - dev 3-39 < 0.05 e dev_sell < -0.06 - con ma50 < e ma5 sotto ma200 > -0.90 - r 9931 B1"
                        action = "sell"
                        
                        #  7 nov 2023 se 300< 5 ore MA 100> 1 ora vendi dopo FORSE IL PEGGIO E' PASSATO !



                  
                    elif (
                        
                        ma300_last < ma300_301_min_ago
                        and ma50_last > ma50_2_min_ago
                        
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.01
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.70
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and macd < -2
                    ):
                        sell = "SELL 1 (50-90 min) ex cond. spec. r 16047 B2 con ma300> 5 ore - dev 3-39 < 0.05 e dev_sell < -0.01 - con ma50 < e ma5 sotto ma200 > -0.70 - r 9931 B2x"
                        action = "sell"
                        
                        #  7 nov 2023 se 300< 5 ore E 100< 1 ora vendi prima NON TE NE FOTTERE
                        # 16 nov 2023 ha fatto -0.78 ALLORA HO PRESO PROVVEDIMENTI DRASTICI
                        # HO MESSO con ma50>
                        # HO TOLTO CON 100< 100 60 min ago
                        # HO TOLTO CON ma78< 120 min ago
                        # ho portato ma5 sotto 200 a > -0.70 da -0.90
                        # E VAFANGULO

                  


                  
                    elif (
                        
                        ma300_last < ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                        
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.01
                        
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.70
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and macd < -2
                    ):
                        sell = "SELL 1 (50-90 min) ex cond. spec. r 16047 B2 con ma300< 5 ore - dev 3-39 < 0.05 e dev_sell < -0.01 - con ma50 < e ma5 sotto ma200 > -0.90 - r 9931 B2y"
                        action = "sell"
                        
                        #  7 nov 2023 se 300< 5 ore E 100< 1 ora vendi prima NON TE NE FOTTERE
                        # 16 nov 2023 ha fatto -0.78 ALLORA HO PRESO PROVVEDIMENTI DRASTICI
                        # HO MESSO con ma50>
                        # HO TOLTO CON 100< 100 60 min ago
                        # HO TOLTO CON ma78< 120 min ago
                        # ho portato ma5 sotto 200 a > -0.70 da -0.90
                        # E VAFANGULO

                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.08
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.60
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < 5
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 1 (50-90 min) EX cond spec 6 con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.10 - con ma50 < e con macd < 5 AND DIFF MACD < -0.20 - r 9933"
                        action = "sell"
                        
                        # -0.84%
                        

                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.08
                        
                        and ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.60
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < 6
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 1 (50-90 min) EX cond spec 6 con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.10 - con ma50 < e con macd < 5 AND DIFF MACD < -0.20 - r 9934"
                        action = "sell"
                        
                        # con ma50 < ha fatto -0.84%
                        # aggiunta anche con 50 > (ho visto che ma50 era ancora > !)

                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma50_last > ma50_2_min_ago
                        
                        and ma300_last > ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.04
                        
                        and ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and ma2_differenza_2_min_ago < -30
                    ):
                        sell = "SELL 1 (50-90 min) EX cond spec r 16047 B3 NOTTE con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < 0.04 - con ma50 > - r 9935 a"
                        action = "sell"

                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma50_last <= ma50_2_min_ago
                        and ma100_last < ma200_last

                        and ma300_last > ma300_301_min_ago
                        
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.05
                        
                        and deviation_ma100_sopra_ma300 < 0.40
                        and deviation_ma5_sotto_ma200 > -0.90
                        
                        and ma2_last <= ma2_2_min_ago 
                        and ma2_differenza_2_min_ago < -10
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                        
                    ):
                        sell = "SELL 1 (50-90 min) con ma300> 5 ore - dev 3-39 < 0.05 e dev_sell < 0.05 e ma50 <= and dev ma2 - r 9935 B"
                        action = "sell"
                        
                        # 16 nov 2023 dev sell a 0.05 da -0.03
                        # 26 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        # 26 dic 2023 aggiunta and macd_differenza_2_min_ago < -0.50
                        # 10 set 2024 aggiunto 100<200 e TOLTA macd_differenza_2_min_ago < -0.50 ! (il macd saliva e il prezzo scendeva !)




                    elif (
                        ma50_last >= ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and (ma5_prev > ma69_prev and ma5_last < ma69_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 (50-90 min) con ma50 > and incrocio 5-69 and deviation_sell 0.25 - 0.56 FINTA DI MARADONA - r 9936"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 19 ottobre 2022 5-69 da 5-50
                        # 17 ott 2025 condizione importata da RCCR




                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.12
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.50
                
                        and ma2_last < ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -5
                        and macd_differenza_2_min_ago < -1.20
                    ):
                        sell = "SELL 1 (50-90 min) GIORNO ! con ma300 < 5 ore e dev 3-39 < 0.05 e dev_sell < -0.10 - con ma50 < - r 9940"
                        action = "sell"
                        
                        # 27 nov 2023 metto diff macd SOLO nel GIORNO ! PERCHE' LA SITUAZIONE STA MIGLIORANDO ! 
                        # 28 gen 2025 and macd_differenza_2_min_ago < -1.20 da < -0.20
                        # 28 gen 2025 and deviation_sell < -0.12 da < -0.10

              
                    
                    

                    
                    
                        
                        
                   
                ########################################################################################################
                ########################################################################################################
                ######################################################################################################## SESSIONE 1 ( da 90 min a 110 min )

                # VENDITA - da 90 minuti a 110 minuti  = da 5400 secondi a 6600 secondi

                
                elif seconds_since_last_trade > 5400 and seconds_since_last_trade <= 6600:
                    
                    
                    if (    
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma200_last
                        and deviation_ma39 < -0.22 
                        and deviation_sell < -0.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > and deviation_ma39 <-0.22 and deviation_sell < -0.21 - r 9965"
                        action = "sell"
                        
                        
                        
                    if (    
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma200_last
                        and deviation_ma39 < -0.23
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > and deviation_ma39 < -0.23 - r 9977"
                        action = "sell"
                        
                        # potrebbe essere una situazione di CROLLO IN ALTO con 39 senza deviation sell !
                        # and deviation_ma39 < -0.23 da -0.22
                        
                   
                       
                    elif (     
                        ma50_last > ma50_2_min_ago
                        and ma3_last < ma50_last 
                        and deviation_sell < -0.22
                        and ma25_last < ma25_2_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90-110 min) con ma50 > and ma3_last < ma50_last and deviation_sell < -0.22 and ma25 < - r 9994"
                        action = "sell"
                        
                    
                    
                    ################################################################################### fare maradona 1 ma3>ma100 (69) e maradona 2 ma3<ma100 (50)
                    
                    # MARADONA 1a
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        and ma5_last < ma78_last

                        and deviation_ma5_sotto_ma300 > 0.49
                        and ma200_last > ma300_last
                        and ma3_last > ma100_last
                        
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90-110 min) con ma50 > con 5-78 and deviation_sell 0.35 - 0.64 - r 10012 A"
                        action = "sell"
                        
                        # maradona mentre cresce
                        #  7 mag 2025 5-78 a 5-69
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.49
                        
                        and ma200_last > ma300_last
                        and ma3_last > ma100_last
                        and ma5_last < ma100_last
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > con 5-100 (!) and deviation_sell 0.35 - 0.64 la prima FINTA DI MARADONA - r 10012 b"
                        action = "sell"
                        
                        # maradona laterale
                        # 5-100 da 5-69 se andamento laterale 
                        
                    
                    
                    # MARADONA 1b FASE LATERALE

                    elif (
                        ma50_last > ma50_2_min_ago

                        and delta_DNA_1 < delta_DNA_2
                        and ma200_last < ma300_last
                        and deviation_ma200_sotto_ma300 > -0.30
                        
                        and ma5_last < ma100_last
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > con 5-78 (!) and deviation_sell 0.35 - 0.64 la prima FINTA DI MARADONA 1 - r 10033 a"
                        action = "sell"

                        # 21 ott 2025 se delta_DNA_1 < delta_DNA_2 5-100 da 5-78




                    elif (
                        ma50_last > ma50_2_min_ago

                        and delta_DNA_1 > delta_DNA_2
                        and ma200_last < ma300_last
                        and deviation_ma200_sotto_ma300 > -0.30
                        
                        and ma3_last > ma100_last
                        and ma5_last < ma78_last
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > con 5-78 (!) and deviation_sell 0.35 - 0.64 la prima FINTA DI MARADONA 1 - r 10033 b"
                        action = "sell"

                        # 21 ott 2025 se delta_DNA_1 < delta_DNA_2 ok cosi'


                        
                        
                        
                    # MARADONA 1b FASE RIBASSO
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma200_last < ma300_last
                        and deviation_ma200_sotto_ma300 < -0.30
                        
                        and ma3_last > ma100_last
                        and ma5_last < ma69_last
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > con 5-69 (!) and dev_sell 0.35 - 0.64 la prima FINTA DI MARADONA 1 - r 10051"
                        action = "sell"
                        
                      
                    
                    # MARADONA 2
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma3_last < ma100_last
                        and ma5_last < ma100_last
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > con 5-100 (!) and deviation_sell 0.35 - 0.64 la prima FINTA DI MARADONA 1 - r 10071"
                        action = "sell"
                      
                        # 28 giu 2023 5-100 da 5-50
                        # 28 giu 2023 aggiunta macd<


                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > incrocio 5-78 (!) and deviation_sell 0.65 - 1.49 RABONA ALLA RONALDO - r 10084 A"
                        action = "sell"
                        
                        # > estate 5-78 da 5-42
                        # 28 gen 2025 se 300>450 sell con 5-100 da 5-78


                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > incrocio 5-78 (!) and deviation_sell 0.65 - 1.49 RABONA ALLA RONALDO - r 10084 B"
                        action = "sell"
                        
                        # > estate 5-78 da 5-42
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (90 - 110 min) con 50 > incrocio 3-78 and dev_sell  1.50 - 2.70 DOPPIO PASSO DI RONALDO - r 10096"
                        action = "sell"
                        
                        # > estate 3-78 da 3-30
                        
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell > 2.71 and deviation_sell < 5.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 > incrocio 3-78 (!) and deviation_sell > 2.71 TACCO DI ALLAH - r 10109"
                        action = "sell"
                        
                        # > estate 3-78 da 3-13
                        
                        
                
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma69_prev and ma3_last < ma69_last)
                        and deviation_sell > 5.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 (90 - 110 min) con ma50 > incrocio 3-69 (!) e dev_sell > 5.71 SI STA TRA GLI ANGELI, compa ! - r 10122"
                        action = "sell"
                        
                    
                    
                    
                    ######################################################################################## con trend discendente
                    
                    # con or IL MAESTRO HA FATTO LA CORREZIONE ! questa che vedi e' stata corretta dal maestro
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.17
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 <  and ma100 < con dev_ma39 < -0.17 - r 10140"
                        action = "sell"
                        
                        # ma39 non deve vendere laterale quindi per farlo vendere in alto ho dato 0.20
                        
                        
                        
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.22
                        and ma3_last < ma39_last
                        and ma100_last < ma100_60_min_ago
                        and ma300_last > ma300_120_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con 50<ma100 < e dev_sell < -0.22 e ma3_last < ma39_last MA 300 > 120 min ago - r 10158"
                        action = "sell"
                        
                        #  9 ott 2022 dev sell a -0.21 da -0.19
                        #  7 lug 2023 dev sell a -0.22 da -0.21
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_300_100 < delta_300_100_60_min
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.18
                        and ma3_last < ma39_last
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con 50<100 < e dev_sell < -0.18 e ma3_last < ma39_last e 300 < 120 min ago - r 10170 A"
                        action = "sell"
                        
                        # 27 giu 2022 dev sell 0.145 da 0.15
                        
                        # > estate -0.14 da -0.145
                        # 15 dic dev sell -0.15 da -0.14 con aggiunta doppio delta 300-100 giorno
                        # 22 dic dev sell -0.16 da -0.15
                        #  6 apr 2023 -0.17 da -0.16
                        # 15 apr 2023 -0.18 da -0.17
                        
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_300_100 > delta_300_100_60_min
                      
                        and deviation_ma300_sopra_ma450 > 0.10
                        
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.144
                        and ma3_last < ma39_last
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con 50<100 < e dev_sell < -0.142 e ma3_last < ma39_last e 300 < 120 min ago - r 10170 B1x"
                        action = "sell"
                        
                        # 27 giu 2022 dev sell 0.145 da 0.15
                        
                        # > estate -0.14 da -0.145
                        # 15 dic 2022 -0.142 da -0.14 con doppio delta 300-100 notte
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_300_100 > delta_300_100_60_min
                      
                        and deviation_ma300_sopra_ma450 < 0.10
                        and deviation_ma300_sopra_ma450 > -0.10
                        
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_sell < -0.07
                        and ma3_last < ma39_last
                        
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        and macd < -8
                    ):
                        sell = "SELL 1 (90 - 110 min) con dev_sell < -0.07 and ma3_last < ma39_last e 300 < 120 min ago and macd < -8 - r 10170 B1Y"
                        action = "sell"
                        
                        # 27 giu 2022 dev sell 0.145 da 0.15
                        
                        # > estate -0.14 da -0.145
                        # 15 dic 2022 -0.142 da -0.14 con doppio delta 300-100 notte
                        # 25 nov 2023 dev sell a -0.07 da -0.142
                        # 25 nov 2023 aggiunto and macd < -8
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma100_60_min_ago
                        
                        and delta_300_100 > delta_300_100_60_min
                      
                        and deviation_ma300_sopra_ma450 < -0.10
                        
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.10
                        and ma3_last < ma39_last
                        
                        
                    ):
                        sell = "SELL 1 (90 - 110 min) con 50<100 < and (dev_sell < -0.10 e ma3_last < ma39_last) 300 < 120 min ago - r 10170 B1z"
                        action = "sell"
                        
                        # 27 giu 2022 dev sell 0.145 da 0.15
                        
                        # > estate -0.14 da -0.145
                        # 15 dic 2022 -0.142 da -0.14 con doppio delta 300-100 notte
                        #  1 set 2023 -0.10 da -0.142 a ricomprare durante il crollo (ma300 scende da 2 ore !) eventualmente ci pensano le altre condizioni, che ci sono.
                        
                        
                        
                        
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_300_100 > delta_300_100_60_min
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.142
                        and ma3_last < ma39_last
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con 50<100 < and (dev_sell < -0.142 e ma3_last < ma39_last) 300 < 120 min ago - r 10170 B2"
                        action = "sell"
                        
                        # 27 giu 2022 dev sell 0.145 da 0.15
                        
                        # > estate -0.14 da -0.145
                        # 15 dic 2022 -0.142 da -0.14 con doppio delta 300-100 notte
                        
                        
                        
                        
                        
                        
                    
                    # ma se ma100 >
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.22
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last <= ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 < MA ma100 > con deviation_ma39 <-0.23 - r 10193 A"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 28 set con 300 > 300 301 min ago !
                        # 28 set dev 39 -0.23 da -0.20
                        #  9 set 2024 dev 39 -0.22 da -0.23


                        
                        
                        
                    # ma se ma100 >

                    elif (    
                        ma50_last < ma50_2_min_ago
                        and delta_DNA_1 < delta_DNA_2
                        and ma100_last > ma100_60_min_ago

                        and deviation_ma39 < -0.07
                        and deviation_sell > 0.25

                        and ma5_last < ma5_2_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90-110 min) GIORNO con ma50 < MA ma100 > con deviation_ma39 < -0.06 - r 10193 B1 X"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 30 nov 2023 dev 39 -0.05 da -0.20
                        #  7 apr 2025 GIORNO
                        #  9 mag 2025 aggiunta or 3-250 perche' effettivamente aveva venduto troppo tardi.
                        #  6 ago 2025 dev 39 -0.06 da -0.05
                        #  6 ago 2025 3-39 SEPARATO DALL' INCROCIO AL RIBASSO 3-250
                        # 11 ago 2025 and deviation_ma39 < -0.07 da -0.06
                        # 11 ago 2025 and deviation_sell a 0.25 da 0.20









                    elif (    
                        ma50_last < ma50_2_min_ago
                        and delta_DNA_1 < delta_DNA_2

                        and (ma3_prev > ma250_prev and ma3_last < ma250_last)
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90-110 min) GIORNO con ma50 < MA ma100 > con deviation_ma39 < -0.06 - r 10193 B1 Y"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 30 nov 2023 dev 39 -0.05 da -0.20
                        #  7 apr 2025 GIORNO
                        #  9 mag 2025 aggiunta or 3-250 perche' effettivamente aveva venduto troppo tardi.
                        #  6 ago 2025 dev 39 -0.06 da -0.05
                        #  6 ago 2025 separato 3-250 che deve essere INCROCIO AL RIBASSO 3-250




                    elif (    
                        ma50_last < ma50_2_min_ago
                        and delta_DNA_1 > delta_DNA_2
                        and ma3_last < ma150_last

                        and deviation_ma39 < -0.05
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90-110 min) NOTTE con ma50 < MA ma100 > con deviation_ma39 <-0.20 - r 10193 B2"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 30 nov 2023 dev 39 -0.05 da -0.20
                        #  7 apr 2025 NOTTE comincia a curvare verso il basso !
                        #  7 apr 2025 aggiunto and ma3_last < ma150_last
                        
                     
                    
                    # ma se ma100 >
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_ma5_sotto_ma300 > -0.50
                        
                        and deviation_sell < -0.12
                        and ma3_last < ma39_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -4
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50< MA 300> e dev_sell < -0.12 and ma3 < ma39 e macd < and macd < -4 - r 10211 A1"
                        action = "sell"
                        
                        # 2 ott dev sell -0.243 da -0.23
                        # 29 gen 2023 dev sell -0.248 da -0.243
                        # 28 set 2023 dev sell -0.10 da -0.248
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > -0.50
                        and ma100_last > ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_sell < -0.05
                        and ma3_last < ma39_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50< MA ma100> E 300< e (dev_sell < -0.05 e ma3_last < ma39_last) e macd < - r 10211 A2"
                        action = "sell"
                        
                        # 19 set dev sell -0.225 da -0.23
                        # 19 set 2023 dev sell -0.05 da -0.225
                        # 19 set 2023 and macd < macd 2 min ago
                        
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < -0.50
                        and deviation_sell < -0.28
                        and ma3_last < ma39_last
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 < MA ma100 > e (dev_sell < -0.28 e ma3_last < ma39_last) e 5-100 < -0.50 - r 10211 b"
                        action = "sell"
                        
                        
                        
                        
                    
                    
                    ############################################################################### aumento della perdita tollerata ! 50< MA 200> e 200>300
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        
                        and deviation_ma39 < -0.10
                        and deviation_sell < -0.28
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 < e deviation_ma39 < -0.10 e dev sell -0.28 e > PERDITA TOLLERATA - r 10227"
                        action = "sell"
                        
                        # > estate -0.32 da -0.23
                        # 15 gen 2023 dev 39 a -0.33 da -0.32
                        # 21 ago 2023 dev 39 a -0.10 da -0.33
                        # 21 ago 2023 aggiunta dev sell -0.28
                        
                    
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and deviation_ma300_sopra_ma450 > -0.10
                        and ma3_last < ma39_last
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 < (deviation_sell < -0.25 e ma3_last < ma39_last) e > PERDITA TOLLERATA - r 10241a"
                        action = "sell"
                        
                        # 12 apr 2023 dev sell 0.25 da 0.21 se 300 sta poco sotto o sopra alla 450
                    
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and deviation_ma300_sopra_ma450 < -0.10
                        and ma3_last < ma39_last
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (90 - 110 min) con ma50 < (deviation_sell < -0.23 E ma3_last < ma39_last) e > PERDITA TOLLERATA - r 10241b"
                        action = "sell"
                        
                        #  12 apr 2023 dev sell 0.23 da 0.21 se 300 sta sotto alla 450

                    

                    ############################################################################################################### EX CONDIZIONI SPECIALI IMPORTATR RIDOTTE
                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.05
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < 5
                    ):
                        sell = "SELL 1 (90 - 110 min) EX cond spec r 16047 B1Y con ma 50 < ma 50 2 min ago E ma300 > 5 ore E dev 3-39 < 0.05 and dev_sell < -0.05 - r 10245"
                        action = "sell"

                    
                    
                        
                    
                        
                ################################################################################################################# SESSIONE 1 ( da 110 min a 239 min )
                
                # VENDITA - da 110 minuti a 239 minuti  = da 6601 secondi a 14340 secondi
                
                elif seconds_since_last_trade > 6601 and seconds_since_last_trade <= 14340:

                    
                    if (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < -0.22 
                        and deviation_sell < -0.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (110 - 239 min) con ma50 > and deviation_ma39 <-0.22 and deviation_sell < -0.21 - r 10250"
                        action = "sell"
                        
                        
                    
                    
                    elif (     
                        ma50_last > ma50_2_min_ago
                        and ma3_last < ma50_last 
                        and deviation_sell < -0.22
                        and ma25_last < ma25_2_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (110 - 239 min) con ma50 > and ma3_last < ma50_last and deviation_sell < -0.22 and ma25 < - r 10251"
                        action = "sell"
                        
                    
                    
                    
                    ############################################################################# fare maradona 1 e maradona 2
                    
                    
                       
                        
                    # MARADONA 1
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma3_last > ma100_last
                        and ma5_last < ma100_last
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) con ma50 > con 5-100 (!) and dev_sell 0.35 - 0.64 la prima FINTA DI MARADONA 1 - r 10252"
                        action = "sell"
                        
                        # 10 GIU 2022 5-78 da 5-69
                        # > estate 100 da 78
                        
                      
                        
                    # MARADONA 2
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma5_last < ma180_last
                        and deviation_ma100_sopra_ma300 > 0.30
                        
                        and deviation_sell > 0.32 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) con 5-180 and dev_sell 0.32 - 0.64 FINTA DI MARADONA 2 CON 100 sopra 300 > 0.30 - r 10253 a"
                        action = "sell"
                        
                        # se 100 sopra 300 > 0.30 stai calmo
                        # 23 feb 2023 5-180
                        
                        
                        
                    # MARADONA 3

                    elif (
                        ma50_last > ma50_2_min_ago

                        and deviation_ma200_sotto_ma300 > 0.02

                        and ma5_last < ma200_last
                        and ma3_last < ma10_last
                        
                        and deviation_ma100_sopra_ma300 < 0.30
                        
                        and deviation_sell > 0.32 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110-239 min) con 5-200 se 200>300 e dev_sell 0.32 - 0.64 - FINTA MARADONA - r 10253 B1"
                        action = "sell"
                        
                        # 3 set ho aggiunto 3<10 incredibile ma vero vendeva mentre saliva !
                        # 12 gen 2023 5-200 da 5-50 vedi 12 gen 2023 ore 00:07
                        # 21 mag 2025 se 200 sta sopra alla 300 allora sell con 5-200



                    elif (
                        ma50_last > ma50_2_min_ago

                        and deviation_ma200_sotto_ma300 < 0.02
                        and deviation_ma200_sotto_ma300 > -0.02

                        and ma5_last < ma250_last
                        and ma3_last < ma10_last
                        
                        and deviation_ma100_sopra_ma300 < 0.30
                        
                        and deviation_sell > 0.32 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110-239 min) con 5-250 se 200 vicinissima alla 300 e dev_sell 0.32 - 0.64 - FINTA MARADONA - r 10253 B2"
                        action = "sell"
                        
                        # 3 set ho aggiunto 3<10 incredibile ma vero vendeva mentre saliva !
                        # 12 gen 2023 5-200 da 5-50 vedi 12 gen 2023 ore 00:07
                        # 21 mag 2025 se 200 sta e' coincidente alla 300 allora sell con 5-250 da 5-200



                    elif (
                        ma50_last > ma50_2_min_ago

                        and deviation_ma200_sotto_ma300 < -0.02
                        
                        and ma5_last < ma150_last
                        and ma3_last < ma10_last
                        
                        and deviation_ma100_sopra_ma300 < 0.30
                        
                        and deviation_sell > 0.32 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110-239 min) con 5-150 se 200<300 e dev_sell 0.32 - 0.64 - FINTA MARADONA - r 10253 B3"
                        action = "sell"
                        
                        # 3 set ho aggiunto 3<10 incredibile ma vero vendeva mentre saliva !
                        # 12 gen 2023 5-200 da 5-50 vedi 12 gen 2023 ore 00:07
                        # 21 mag 2025 se 200 sta sotto alla 300 allora sell con 5-150


                    
                    
                    #################################################################################################
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last
                        and ma300_last > ma300_120_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 > 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110-239 min) con ma50> incrocio 5-100 (!) se 100-200 > 0.45 and dev_sell 0.65 - 1.49 RONALDO - r 10254 A1"
                        action = "sell"
                        
                        # 26 ott se 300>300 120 min ago vende con ma90
                        # 16 mag 2025 5-100 da 5-90
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        and ma300_last > ma300_120_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 > 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) con ma50 > incrocio 5-78 (!) se 100-200 > 0.45 and dev_sell 0.65 - 1.49 RONALDO - r 10254 A2"
                        action = "sell"
                        
                        # 26 ott se 300>300 120 min ago vende con ma90
                        # 10 mar 2023 MA se 300<450 fase crollo VENDI UN PO' PRIMA. quindi 5-78 da 5-90
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 > 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) incrocio 5-78 (!) se 100-200 > 0.45 and deviation_sell 0.65 - 1.49 RONALDO - r 10255 B"
                        action = "sell"
                        
                        # 26 ott se 300<300 120 min ago vende con ma 78 da 42
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        
                        and (ma5_prev > ma200_prev and ma5_last < ma200_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 < 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) con 300 > 5 ore ago E incr 5-200 se 100-200 < 0.45 e dev_sell 0.65 - 1.49 RONALDO - r 10256 A"
                        action = "sell"
                        
                        # > estate 5-78 da 5-34
                        # 10 gen 2023 5-200 da 5-125
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        
                        and (ma8_prev > ma110_prev and ma8_last < ma110_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 < 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) con 300 < 5 ore E incr 8-110 se 100-200 < 0.45 and dev_sell 0.65 - 1.49 RONALDO - r 10256 B"
                        action = "sell"
                        
                        # > estate 5-78 da 5-34
                        # 5-125 se 300
                        # 18 nov 2022 8-110 da 5-78
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.40
                        and (ma3_prev > ma125_prev and ma3_last < ma125_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (110 - 239 min) con ma50 > incrocio 3-125 CON 100 sopra 300 > 0.40 and dev_sell  1.50-2.70 RONALDO - r 10257 A"
                        action = "sell"
                        
                        # 3 set 2022 ma100 da ma48
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                        and (ma3_prev > ma50_prev and ma3_last < ma50_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 (110 - 239 min) con incrocio 3-30 e dev_ma100_sopra_ma300 < 0.40 e dev_sell 1.50 - 2.70 RONALDO - r 10257 B"
                        action = "sell"
                        
                        # 18 set 3-50 da 3-30
                        
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma300_sopra_ma450 > 0.30
                        and (ma5_prev > ma45_prev and ma5_last < ma45_last)
                        and deviation_sell > 2.71 and deviation_sell < 5.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) con incrocio 5-45 and dev_sell > 2.71 TACCO DI ALLAH e dev 300-450 > 0.30 - r 10258 A"
                        action = "sell"
                        
                        # 1 ott 2022 3-28 da 3-13
                        # 17 mar 2023 4-39 con aggiunta dev 300-450 > 0.30
                        # 6 apr 2023 5-45 da 4-39 
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma300_sopra_ma450 < 0.30
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 2.71 and deviation_sell < 5.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 (110 - 239 min) con ma50 > incrocio 3-39 and dev_sell > 2.71 TACCO DI ALLAH se dev 300-450 < 0.30 - r 10258 B"
                        action = "sell"
                        
                        # 1 ott 2022 3-28 da 3-13
                        # 17 mar 2023 3-33 con aggiunta dev 300-450 < 0.30 
                        #  6 gen 2025 dev sell 3-39 da 3-33
                
                
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma69_prev and ma3_last < ma69_last)
                        and deviation_sell > 5.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 da 110 a 239 min con ma50 > incrocio 3-69 (!) and deviation_sell > 5.71 SI STA TRA GLI ANGELI, compa ! - r 10259"
                        action = "sell"
                        
                    
                    
                    ######################################################################################## con trend discendente
                    
                    # con or IL MAESTRO HA FATTO LA CORREZIONE ! questa che vedi e' stata corretta dal maestro
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.17
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma50 <  and ma100 < con deviation_ma39 <-0.17 - r 10260"
                        action = "sell"
                        
                        # ma39 non deve vendere laterale (!) quindi per farlo vendere in alto ho dato 0.20
                        
                        
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and deviation_sell < -0.20
                        and ma3_last <= ma39_last
                        and ma100_last < ma100_60_min_ago
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma50 < and ma100 < MA 300 > 300 120 min ago and (dev_sell < -0.20 and ma3_last <= ma39_last) - r 10261 A"
                        action = "sell"
                        
                        # > estate -0.22 da -0.15
                        # 6 apr 2023 -0.218 da -0.219
                        # 4 mag 2023 -0.20 da 0.218 che ha fatto -0.71 ma se 300 > 120 min ma300 diventa una resistenza !
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_sell < -0.21
                        and ma3_last < ma39_last
                        and ma100_last < ma100_60_min_ago
                        and ma2_last <= ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma50 < and ma100 < E 300 < 300 120 min ago and (dev_sell < -0.21 and ma3_last < ma39_last) - r 10261 B"
                        action = "sell"
                        
                        # > estate -0.22 da -0.15
                        # 24 set 2022 -0.218 da -0.22
                        # 24 ago 2023 -0.21 da -0.218
                        
                        
              
                    # ma se ma100 >
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and macd < macd_2_min_ago
                        and ma100_last > ma140_last
                        and ma4_last < ma150_last
                        and deviation_sell > 0.30
                        and ma5_last < ma5_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma5_last < ma5_2_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma50 < MA ma100 > E ma300 > e con 4-140 and ma5_last < ma5_2_min_ago and deviation_sell > 0.30 - r 10262 A1x"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 dwc ma39 <-0.197 da <-0.195
                        # 25 gen 2023 5-125 da 3-125
                        # 7 feb 2023 and ma5_last < ma5_2_min_ago
                        # 6 apr 2023 5-150 da 5-125
                        # 19 apr 2023 aggiunta macd > macd 2 min ago - solo dopo 110 min !
                        # 7 lug 2023 and deviation_sell > 0.30 da > 0.20
                        # 7 lug 2023 dev sell 4-140 da 5-150


                    
                    elif (    
                        ma10_last < ma30_last
                        and ma10_last < ma90_last
                        and delta_1 < delta_2
                        
                        and ma50_last <= ma50_2_min_ago
                        
                        and ma100_last > ma150_last
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_sell > 0.10
                        
                        and ma2_last < ma5_last
                           
                    ):
                        sell = f"SELL 1 (110-239 min) GIORNO con 10<90 e con ma50<= MA ma100 > E ma300 > E dev_sell > 0.10 - r 10262 A1 Y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"

                        # 25 mar 2025 8-100 da 3-100 se GIORNO
                        #  8 ott 2025 10-100 da 8-100
                        # 18 ott 2025 aggiunta and ma10_last < ma30_last
                        # 25 ott 2025 10-90 da 10-100
                        # 25 ott 2025 aggiunte pg

                        

                    elif (
                        ma5_last < ma100_last
                        and delta_1 > delta_2

                        and ma50_last < ma50_2_min_ago
                        
                        and ma100_last > ma150_last
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_sell < 0.10
                        and deviation_ma39 < 0.05
                        
                        and ma2_last < ma5_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.25
                        and ma2_differenza_ma5 < -6
                    ):
                        sell = "SELL 1 (110-239 min) NOTTE con 5-100 e con ma50 < MA ma100 > E ma300 > E dev_sell < 0.10 - r 10262 A1 Y2"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 dwc ma39 <-0.197 da <-0.195
                        # 25 gen 2023 5-125 da 3-125
                        # 29 gen 2023 5-150 da 5-125
                        # 14 set 2023 aggiunta and deviation_ma39 < -0.05
                        # 14 set 2023 and 4-150 da 5-150
                        # 16 ott 2023 and macd < -2.5
                        # 16 ott 2023 and  macd_differenza_2_min_ago < -0.25
                  
                        # 16 ott 2023 4-130 DA 4-150
                        # 19 ott 2023 and deviation_sell < 0.10 da > (!) 0.20
                  
                        # 30 ott 2023 3-125 da 4-130
                        #  1 nov 2023 aggiunto 2<5
                        # 17 nov 2023 tolto macd < -2.5 aggiunta in compenso diff macd < -0.25
                        # 17 nov 2023 3-100 da 3-125
                        
                        # 20 NOV 2023 TOLTO ma5 < ma5 2 min ago ( LA VENDITA E' ARRIVATA TARDI !)  
                        # 20 NOV 2023 aggiunta and ma2_differenza_ma5 < -6
                        # 29 set 2024 and deviation_sell < 0.10 da < 0.15
                        # 25 mar 2025 5-100 da 3-100 se NOTTE
                  
                    
                    elif (
                        ma5_last < ma160_last

                        and deviation_sell > 0.20
                        and deviation_ma39 < -0.01
                        
                        and ma5_last < ma5_2_min_ago
                      
                        and ma50_last <= ma50_2_min_ago
                        and ma150_last > ma150_20_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -0.05
                    ):
                        sell = "SELL 1 (110-239 min) con 5-160 and ma50 <= MA ma100 > E ma300 > e con dev_ma39 < -0.15 - r 10263 A2 x1"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        # 16 mar 2023 ma39 <-0.1965 da <-0.197
                        #  9 nov 2023 ma39 <-0.15 da <-0.1965
                        #  9 nov 2023 aggiunta and ma2_differenza_2_min_ago < -0.05
                        # 24 dic 2023 ma39 a -0.05 da -0.15
                        # 24 dic 2023 and ma50_last <= ma50_2_min_ago da ma50_last < ma50_2_min_ago
                        #  8 mag 2025 sell con 5-160 da 5-150


                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma150_last < ma150_20_min_ago
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_ma39 < -0.15
                        and deviation_sell > 0.20
                        
                        and ma5_last < ma5_2_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (110-239 min) con ma50 < MA ma100 > E ma300 > e con deviation_ma39 < -0.15 and deviation_sell > 0.20 - r 10263 A2x2"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        # 16 mar 2023 ma39 <-0.1965 da <-0.197
                        # 17 ott 2023 and deviation_ma39 < -0.15 da < -0.197


                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.184
                        and deviation_sell > 0.40
                        and ma5_last < ma5_2_min_ago

                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -7
                    ):
                        sell = "SELL 1 (110-239 min) con ma50 < MA ma100 > E ma300 > e con deviation_ma39 < -0.184 - r 10264 A2y"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        #  5 mar 2023 ma39 <-0.194 da <-0.197 ma con dev sell > 0.40 prendi e porta a casa
                        # ho aggiunto questa ma la precedente condizone rappresenta "la base" - 
                        # poi condizione speciale pochi maledetti e subito tra 0.80 e 1.20
                        # vedi 5 marzo 2023 ore 3:38 NON HA PRESO IL GUADAGNO !
                        
                        #  5 nov 2023 and deviation_ma39 < -0.19 da < -0.194
                        #  5 nov 2023 aggiunta and ma2_differenza_2_min_ago < -8
                        #  5 feb 2025 and deviation_ma39 < -0.185 da < -0.19
                        # 24 ott 2025 and deviation_ma39 a -0.184 da -0.185


                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.192
                        and macd < macd_2_min_ago
                        
                        and deviation_ma5_sotto_ma300 > 0.30
                      
                        and ma5_last < ma5_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 (110-239 min) con ma50 < MA ma100 > E ma300 < e con dev_ma39 <-0.193 - r 10265 B1"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 26 set dev39 a 0.193 da 0.195
                        #  4 mag 2023 aggiunto macd < macd 2 min ago


                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.04
                        and deviation_ma5_sotto_ma300 < 0.30
                      
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                      
                        and ma5_last < ma5_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 (110-239 min) con ma50 < MA ma100 > E ma300 < e con dev_ma39 < 0.05 and dev sell < 0.04 - r 10265 B2x"
                        action = "sell"
                        # dal 16 novembre 2023 ANCHE CON 50> !



                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma10_last < ma450_last
                        and (ma10_prev > ma450_prev and ma10_last < ma450_last)
                        and deviation_ma39 < 0.06
                        
                        and ma450_last < ma450_120_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma20_last < ma50_last
                        
                        and ma5_last < ma5_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015
                        and macd < -0.10
                    ):
                        sell = "SELL 1 (110-239 min) con ma50 < MA ma100 > E ma300 < e con dev_ma39 < 0.06 and dev sell < 0.20 - r 10265 B2 Yx"
                        action = "sell"

                        # 10 apr 2025 ha fatto -0.40 non vendeva e ma5 era andata abbondantemente sotto la ma450
                        # 10 apr 2025 aggiunta questa nuova condizione con ma10_last < ma450_last
                        # 10 apr 2025 tolto and macd_differenza_2_min_ago < -0.50 e aggiunto and macd < -0.10
                        # 10 apr 2025 tolto and deviation_sell < 0.20
                        # 10 apr 2025 aggiunto vendi con incrocio al ribasso 10-450 (altrimenti avrebbe venduto come 10 stava sotto 450)


                        

                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago

                        and deviation_ma39 < 0.06
                        and (deviation_sell < 0.20 or ma25_last < ma100_last)
                        and deviation_ma5_sotto_ma300 < 0.30
                        
                        
                        and ma100_last > ma100_60_min_ago
                      
                        and ma5_last < ma5_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 1 (110-239 min) con ma50< MA ma100 > E ma300 < e con dev_ma39 < 0.06 and dev sell < 0.20 - r 10265 B2 YY 1"
                        action = "sell"

                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 26 set dev39 a 0.193 da 0.195
                        # 31 ott 2022 dev sell -0.05 da 0.20
                        # 27 nov 2022 dev sell -0.07 da -0.05
                        # 13 feb 2023 dev sell -0.10 da -0.07
                        #  9 apr 2023 dev sell -0.12 da -0.10
                        # 12 apr 2023 dev sell -0.14 da -0.12
                        
                        # 12 apr 2023 dev39 a 0.194 da 0.193
                        # 18 mag 2023 dev39 a 0.1935 da 0.194
                        #  7 lug dev39 a 0.15 da 0.1935
                        # 24 ago 2023 dev sell -0.15 da -0.14
                        # 24 ago 2023 dev 39 a -0.10 da -0.15
                        #  1 set 2023 dev 39 a -0.01 da -0.10
                        
                        # 12 set 2023 dev sell a -0.02 da -0.15
                        # 12 set 2023 aggiunta macd < mad 2 min ago
                        # 15 ott 2023 dev sell a -0.04 da -0.02
                        
                        # 13 nov 2023 dev sell a 0.04 da -0.04 
                        # 13 nov 2023 dev 39 a 0.05 da -0.01
                        # 16 nov 2023 dev sell a 0.05 da 0.04
                        # 16 nov 2023 dev 39 a 0.06 da 0.05
                        # 24 dic 2023 dev sell a 0.20 da 0.05
                        # 24 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        # 24 dic 2023 aggiunta and macd_differenza_2_min_ago < -0.50
                        # 24 dic 2023 tolta macd < macd 2 min ago
                        # 13 ott 2025 aggiunto or ma25_last < ma100_last


                    
                    elif (
                        ma5_last < ma150_last
                        and ma50_last > ma50_2_min_ago

                        and ma300_last < ma300_120_min_ago
                        and ma20_last < ma50_last

                        and deviation_sell > 0.13
                        and deviation_ma5_sotto_ma300 < 0.50
                        
                        
                        and ma100_last > ma100_60_min_ago
                      
                        and ma5_last < ma5_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 1 (110-239 min) con ma50> MA ma300< E 20<50 and dev sell > 0.15 - r 10265 B2 YY 2"
                        action = "sell"

                        # 27 mag 2025 ho aggiunto questa perche' aveva venduto troppo tardi. vedi che 20 e' andata sotto 50 ! cazzo.
                        


                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.04
                        and deviation_ma5_sotto_ma300 < 0.30
                      
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma100_60_min_ago
                      
                        and ma5_last < ma5_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 (110 a 239 min) con ma50 < E ma100 > E ma300 < e con dev_ma39 < 0.05 and dev sell < 0.04 - r 10265 B2z"
                        action = "sell"
                        
                        
                        # 16 nov 2023 AGGIUNTA sia con 100< che con 300<


                  
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma200_301_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.31
                        and ma3_last < ma39_last
                        and ma100_last > ma100_60_min_ago
                        and ma78_last > ma200_last
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma50 < MA ma100 > and (deviation_sell < -0.27 and ma3_last < ma39_last) - r 10266 a1"
                        action = "sell"
                        
                        # 3 luglio 2022 a 0.27 da 0.20
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_301_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.27
                        and ma3_last < ma39_last
                        and ma100_last > ma100_60_min_ago
                        and ma78_last > ma200_last
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma50 < MA ma100 > and (deviation_sell < -0.27 and ma3_last < ma39_last) - r 10267 a2"
                        action = "sell"
                        
                        # 3 luglio 2022 a 0.27 da 0.20
                        
                        
                        
                    # ma se ma100 > 
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.23
                        and ma3_last < ma39_last
                        and ma100_last > ma100_60_min_ago
                        and ma78_last < ma200_last
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma50 < MA ma100 > and (deviation_sell < -0.23 and ma3_last < ma39_last) - r 10270 b"
                        action = "sell"
                        
                        # 3 luglio 2022 a 0.23 da 0.20
                        
                    
                   
                    ############################################################################### aumento della perdita tollerata ! 50< MA 200> e 200>300
                    
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma300_last > ma300_301_min_ago
                        and deviation_ma39 < -0.26
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 compa da 110 a 239 min con ma50 < and deviation_ma39 < -0.26 con > PERDITA TOLLERATA E 300 > 5 ore ago - r 10271 A"
                        action = "sell"
                        
                        # 18 set dev 39 -0.25 da -0.23
                        # 21 gen 2023 dev 39 -0.26 da -0.25
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma300_last < ma300_301_min_ago
                        and deviation_ma39 < -0.25
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 compa da 110 a 239 min con ma50 < and deviation_ma39 < -0.23  con > PERDITA TOLLERATA MA 300 < 5 ore ago - r 10271 B"
                        action = "sell"
                        
                        # 18 set dev 39 -0.25 da -0.23
                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.30
                        and deviation_sell < -0.27
                        
                        and deviation_ma39 < -0.23
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 compa da 110 a 239 min con ma50 < and deviation_ma39 < -0.23  and deviation_sell < -0.27 con > PERDITA TOLLERATA - r 10272"
                        action = "sell"
                        
                        # se 100 > 300 di poco metto anche deviation_sell < -0.21
                        # > estate -0.27 da -0.21
                        
                        
                    
                        
                    # SELL 1 da RCCR ! da 110 a 239 min IPOTESI PEGGIORE con ma50< con dev_ma39 < -0.22 and deviation_sell < -0.22 MA DOPPIO DELTA RIALZO 
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        
                        and ma3_last < ma300_last
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 < -0.08
                        
                        and deviation_ma39 < -0.10
                        and deviation_sell < -0.22
                        
                        and rapporto_delta_1_delta_2 < 1
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da RCCR ! da 110 a 239 min IPOTESI PEGGIORE con ma50< con dev_ma39 < -0.10 and deviation_sell < -0.22 MA giorno - r 10273"
                        action = "sell"
                        
                        # 19 SET r 10546 la condizione precedente ha fatto -1.65 ed e' partita insieme ad altre 2 condizioni speciali ! 
                        # quindi ho aggiunto questa importata SIA QUA CHE NELLE CONDIZIONI SPECIALI ( nuova condizione speciale )
                        # 19 set 2022 IMPORTATO DA RCCR > sell 4:18 del 19 set -1.65 % !
                        # 19 set 2022 deviation_ma39 < -0.22 AND and deviation_sell < -0.22
                        # 31 lug 2023 and deviation_ma39 < -0.10 da -0.22
                        # 31 lug 2023 and deviation_trend_ma200 < -0.08 da < -0.08

                  
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_360_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma3_last < ma39_last
                        and deviation_sell < 0.05
                        
                        
                        and deviation_trend_ma200 > -0.15
                        and ma200_last > ma300_last
                        
                        and ma2_last <= ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -2
                    ):
                        sell = "SELL 1 da 110 a 239 min con ma450 > 6 ore ago E 300 > 120 min ago con ma50 < (dev_sell < 0.05 and ma3_last < ma39_last) - r 10274 A1x"
                        action = "sell"
                        
                        # 28 dic 2022 dev sell -0.245 da -0.23
                        # 24 apr 2023 dev sell -0.243 da -0.245 (dopo che con -0.245 ha fatto -0.80%)
                        # 27 apr 2023 dev sell -0.241 da -0.243 (dopo che con -0.243 ha fatto -0.86% !)
                        # 27 apr 2023 and deviation_trend_ma200 a > -0.15 da > -0.13
                        
                        # 12 set 2023 and dev sell 0.20 da -0.24 (con il macd che comincia a scendere puo' vendere anche con un po' di guadagno invece di vendere in perdita.)
                        # 12 set 2023 and macd < macd 2 min ago
                        # 18 set 2023 and macd < -3
                        # 28 set 2023 se 450 scende da 6 ore ma 300 sale da 2 ore aspetta un poco prima di vendere.
                        #  5 ott 2023 dev sell 0.05 da 0.10
                        # 13 nov 2023 and macd < -2 da -3


                  
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma78_last
                        and deviation_sell > 0.30

                        and delta_DNA_1 < delta_DNA_2 
                        and ma200_last > ma300_last
                        and ma300_last > ma300_120_min_ago

                        and ma450_last < ma450_360_min_ago

                        and deviation_trend_ma200 > -0.15
                        
                        and ma2_last <= ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -3
                    ):
                        sell = "SELL 1 (110-239 min) con 3-78 e con 450<6 ore MA DNA GIORNO E 300>120 min e ma50< e dev_sell>0.30 - r 10274 A1 Y1"
                        action = "sell"

                        #  7 apr 2025 aggiunta DNA GIORNO - lascialo correre !
                        # 12 mag 2025 3-59 da 3-49
                        # 30 mag 2025 3-78 da 3-59


                    elif (     
                        ma50_last < ma50_2_min_ago

                        and delta_DNA_1 > delta_DNA_2 
                        and ma200_last > ma300_last
                        and ma300_last > ma300_120_min_ago

                        and ma450_last < ma450_360_min_ago

                        and ma3_last < ma39_last
                        and deviation_sell > 0.10
                        
                        and deviation_trend_ma200 > -0.15
                        
                        and ma2_last <= ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -3
                    ):
                        sell = "SELL 1 (110-239 min) con ma450 < 6 ore e DNA NOTTE E 300 > 120 min e ma50< e dev_sell > 0.10 - r 10274 A1 Y2"
                        action = "sell"
                        
                        # 28 dic 2022 dev sell -0.245 da -0.23
                        # 24 apr 2023 dev sell -0.243 da -0.245 (dopo che con -0.245 ha fatto -0.80%)
                        # 27 apr 2023 dev sell -0.241 da -0.243 (dopo che con -0.243 ha fatto -0.86% !)
                        # 27 apr 2023 and deviation_trend_ma200 a > -0.15 da > -0.13
                        
                        # 12 set 2023 and dev sell 0.20 da -0.24 (con il macd che comincia a scendere puo' vendere anche con un po' di guadagno invece di vendere in perdita.)
                        # 12 set 2023 and macd < macd 2 min ago
                        # 18 set 2023 and macd < -3
                        #  7 apr 2025 aggiunta DNA NOTTE ma 300 sale

                   
                  
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma300_last > ma300_120_min_ago
                        
                        and deviation_ma39 < -0.22
                        and ma3_last < ma39_last
                        
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 da 110 a 239 min E 300 > 120 min ago e con ma50 < and dev3-39 < -0.22 con > PERDITA TOLLERATA - r 10274 A2x"
                        action = "sell"
                        
                        
                        
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.30
                        and ma300_last > ma300_120_min_ago
                        
                        and deviation_sell < -0.155
                        
                        and ma3_last < ma39_last
                        
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_3_min_ago
                        
                    ):
                        sell = "SELL 1 da 110 a 239 min E 300 > 120 min ago e con ma50 < and dev sell < -0.155 con > PERDITA TOLLERATA and macd < macd_3_min_ago - r 10274 A2y"
                        action = "sell"
                        
                        
                        # 24 apr 2023 deviation_ma39 < -0.22
                        # macd sui tempi lunghi
                        #  3 lug 2023 deviation_sell < -0.16 da < -0.15
                        # 11 ago 2023 deviation_sell < -0.155 da < -0.16
                        #  1 set 2023 and macd < macd_3_min_ago (macd < macd 2 min ago qualche volta non prende...)

                  
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma3_last < ma39_last
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da 110 a 239 min E 300 < 120 min ago e con ma50 < (dev_sell < -0.25 and ma3_last < ma39_last) con > PERDITA TOL - r 10275 B"
                        action = "sell"
                        
                        # 17 gen 2023 dev sell 0.25
                        
                        
                    
                    
                    # ATTENZIONE 1 ! SELL 1 da 110 a 239 min CON 300 > 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min FORSE E' NECESSARA SOLO QUESTA 1 ! deviation_sell < -0.27 - r 10276"
                        action = "sell"
                        
                        
                        
                    # ATTENZIONE 2 ! SELL 1 da 110 a 239 min CON 300 > 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma300_last > ma300_120_min_ago
                        and ma100_last < ma200_last
                        and deviation_sell < -0.22
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min FORSE E' NECESSARA SOLO QUESTA 2 ! deviation_sell < -0.22 - r 10277"
                        action = "sell"
                        
                        
                        
                        
                        
                    # ATTENZIONE 3 ! SELL 1 da 110 a 239 min CON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma78_last > ma300_last
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.202
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min FORSE E' NECESSARA SOLO QUESTA 3 ! deviation_sell < -0.202 CON 78 > 300 - r 10278 A"
                        action = "sell"
                        
                        # > estate a -0.19 da 0.09
                        # 17 set 2022 a -0.23 da -0.19
                        # 11 ott 2022 a -0.225 da -0.23
                        # 12 giu 2023 a -0.202 da -0.225
                        
                        
                        
                    # ATTENZIONE 3 ! SELL 1 da 110 a 239 min CON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    
                    elif (    
                        ma3_last < ma100_last
                        and deviation_ma300_sopra_ma450 > -0.20
                        and ma78_last < ma300_last
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.195
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min FORSE E' NECESSARA SOLO QUESTA 3 ! dev_sell < -0.195 CON 300>450 e con 78 < 300 (ancora ribasso !) torna a casa ! - r 10278 B1"
                        action = "sell"
                       
                        # 17 mar 2023 -0.19 da -0.17 con 300>450
                        # 21 mag 2023 -0.20 da -0.19 con 300>450
                        # 21 mag 2023 -0.195 da -0.20 con 300>450
                        
                      
                    elif (    
                        ma3_last < ma100_last
                        and deviation_ma300_sopra_ma450 < -0.20
                        and ma78_last < ma300_last
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.20
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min FORSE E' NECESSARA SOLO QUESTA 3 ! dev_sell < -0.20 CON 78 < 300 (ancora ribasso !) (PERDI POCO - porta a casa) - r 10278 B2"
                        action = "sell"
                        
                        # 23 lug 2022 dev sell < 0.10 ha fatto fare perdita di -0.26 !
                        # 23 lug 2022 a < 0.09 da < 0.10
                        # > estate -0.10 da 0.09
                        # -0.13 da -0.10
                        # 17 dicembre 2022 -0.14 da -0.13
                        #  7 feb 2023 -0.17 da -0.14
                        # 17 mar 2023 -0.18 da -0.17 con 300<450
                        # 29 mag 2023 -0.20 da -0.18 con 300<450
                        
                    # ATTENZIONE 4 ! SELL 1 da 110 a 239 min CON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma5_last > ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma200_last
                        and deviation_sell < -0.15
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min con 5 > 200 ! FORSE E' NECESSARA SOLO QUESTA 4 ! deviation_sell < -0.15 - r 10279 A"
                        action = "sell"
                        
                        
                        
                        
                    # ATTENZIONE 4 ! SELL 1 da 110 a 239 min CON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma5_last < ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        
                        and ma100_last < ma200_last
                        and ma100_last > ma300_last
                        and deviation_sell < -0.16
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min con 5 < 200 MA 100 > 300 ! FORSE E' NECESSARA SOLO QUESTA 4 ! deviation_sell < -0.16 - r 10280 B1"
                        action = "sell"
                        
                        #  4 set 2022 dev sell -0.07 da -0.05
                        # 26 set 2022 dev sell -0.10 da -0.07
                        # 12 ott 2022 dev sell -0.14 da -0.10
                        #  7 nov 2022 dev sell -0.16 da -0.14
                        
                    elif (    
                        ma3_last < ma100_last
                        and ma450_last > ma450_720_min_ago
                        and ma5_last < ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma200_last
                        and ma100_last < ma300_last
                        and deviation_sell < -0.158
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min and 450 > 12 ore con 5 < 200 e 100 < 300 ! FORSE E' NECESSARA SOLO QUESTA ! deviation_sell < -0.158 - r 10281 B2x"
                        action = "sell"
                        
                        #  4 set 2022 dev sell -0.07 da -0.05
                        # 26 set 2022 dev sell -0.10 da -0.07
                        # 12 ott 2022 dev sell -0.13 da -0.10
                        # 19 dic 2022 dev sell -0.152 da -0.13
                        
                        # 25 gen 2023 dev sell -0.158 da -0.152
                        # 21 apr 2023 dev sell -0.158 
                        # 21 apr 2023 ma450 > 12 ore

                  
                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.01
                      
                        and ma450_last < ma450_720_min_ago
                        and ma5_last < ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma200_last
                        and ma100_last < ma300_last
                        
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -1
                    ):
                   
                        sell = "SELL 1 da 110 a 239 min and 450 < 12 ore con 5 < 200 e 100 < 300 ! deviation_sell < -0.01 and macd_differenza_2_min_ago < -1 - r 10281 B2y"
                        action = "sell"
                        
                        #  4 set 2022 dev sell -0.07 da -0.05
                        # 26 set 2022 dev sell -0.10 da -0.07
                        # 12 ott 2022 dev sell -0.13 da -0.10
                        # 19 dic 2022 dev sell -0.152 da -0.13
                        
                        # 25 gen 2023 dev sell -0.158 da -0.152
                        # 21 apr 2023 dev sell -0.156 da -0.158
                        # 21 apr 2023 ma450 < 12 ore
                        # 30 ago 2023 dev sell -0.05 da -0.156
                        #  1 set 2023 dev sell -0.01 da -0.05


                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma50_last < ma59_last
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.07
                
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                        and macd < -15
                    ):
                        sell = "SELL 1 (110-239 min) EX cond spec r 16047 A1y CON 50<59 e dev 3-39 < 0.05 e dev_sell < 0.05 con ma50 < and macd_diff_2_min_ago < -0.20 - r 10284"
                        action = "sell"

                  

              
                    

              
                        
                        
                        
                ############################################################################ vendita > 240 min
                
                # VENDITA - da 240 minuti in poi = da 14400 secondi in poi
                
                elif seconds_since_last_trade > 14400:

                    
                    if (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < -0.22 
                        and deviation_sell < -0.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > and deviation_ma39 <-0.22 and deviation_sell < -0.21 - r 10290"
                        action = "sell"
                        
                        
                    
                    
                    elif (     
                        ma50_last > ma50_2_min_ago
                        and ma3_last < ma50_last 
                        and deviation_sell < -0.22
                        and ma25_last < ma25_2_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > and ma3_last < ma50_last and deviation_sell < -0.22 and ma25 < - r 10291"
                        action = "sell"
                        
                    
                    
                    
                    ############################################################################# fare maradona 1 e maradona 2
                    
                    
                       
                        
                    # MARADONA 1
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma3_last > ma100_last
                        and ma5_last < ma100_last
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > con 5-100 (!) and deviation_sell 0.35 - 0.64 la prima FINTA DI MARADONA 1 (non toccare) - r 10292"
                        action = "sell"
                        
                        # 10 GIU 2022 5-78 da 5-69
                        # > estate 100 da 78
                        
                      
                        
                    # MARADONA 2
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma5_last < ma180_last
                        and deviation_ma100_sopra_ma300 > 0.30
                        
                        and deviation_sell > 0.32 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > con 5-180 and dev_sell 0.32 - 0.64 la prima FINTA DI MARADONA 2 CON 100 sopra 300 > 0.30 - r 10310 a"
                        action = "sell"
                        
                        # se 100 sopra 300 > 0.30 stai calmo
                        # 23 feb 2023 5-180
                        
                        
                        
                    # MARADONA 3
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma3_last < ma100_last
                        and ma5_last < ma200_last
                        and ma3_last < ma10_last
                        
                        and deviation_ma100_sopra_ma300 < 0.30
                        
                        and deviation_sell > 0.35 and deviation_sell < 0.64
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.9
                    ):
                        sell = "SELL 1 >240 min con ma50> e con 5-200 and dev_sell 0.35 - 0.64 - prima FINTA MARADONA CON 100 sopra 300< 0.30 and macd_diff_2_min_ago < -0.9 - r 10329 B"
                        action = "sell"
                        
                        # 3 set ho aggiunto 3<10 incredibile ma vero vendeva mentre saliva !
                        # 12 gen 2023 5-200 da 5-50 vedi 12 gen 2023 ore 00:07
                        # 29 nov 2023 and macd < -2
                    
                    #################################################################################################
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last
                        and ma300_last > ma300_120_min_ago
                        and (ma5_prev > ma90_prev and ma5_last < ma90_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 > 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 5-90 (!) se 100-200 > 0.45 and deviation_sell 0.65 - 1.49 RABONA ALLA RONALDO - r 10346 A1"
                        action = "sell"
                        
                        # 26 ott se 300>300 120 min ago vende con ma90
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        and ma300_last > ma300_120_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 > 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 5-78 (!) se 100-200 > 0.45 and deviation_sell 0.65 - 1.49 RABONA ALLA RONALDO - r 10346 A2"
                        action = "sell"
                        
                        # 26 ott se 300>300 120 min ago vende con ma90
                        # 10 mar 2023 MA se 300<450 fase crollo VENDI UN PO' PRIMA. quindi 5-78 da 5-90
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 > 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 5-78 (!) se 100-200 > 0.45 and deviation_sell 0.65 - 1.49 RABONA ALLA RONALDO - r 10346 B"
                        action = "sell"
                        
                        # 26 ott se 300<300 120 min ago vende con ma 78 da 42
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        
                        and (ma5_prev > ma200_prev and ma5_last < ma200_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 < 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 >240 min con 300 > 5 ore ago E con ma50 > E incr 5-200 se 100-200 < 0.45 and dev_sell 0.65 - 1.49 RABONA RONALDO - r 10358 A"
                        action = "sell"
                        
                        # > estate 5-78 da 5-34
                        # 10 gen 2023 5-200 da 5-125
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        
                        and (ma8_prev > ma110_prev and ma8_last < ma110_last)
                        and deviation_sell > 0.65 and deviation_sell < 1.49
                        and deviation_ma100_sopra_ma200 < 0.45
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 >240 min con 300 < 5 ore ago E con ma50 > E incr 8-110 se 100-200 < 0.45 and dev_sell 0.65 - 1.49 RABONA RONALDO - r 10358 B"
                        action = "sell"
                        
                        # > estate 5-78 da 5-34
                        # 5-125 se 300
                        # 18 nov 2022 8-110 da 5-78
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.40
                        and (ma3_prev > ma125_prev and ma3_last < ma125_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 3-125 CON 100 sopra 300 > 0.40 and deviation_sell  1.50-2.70 DOPPIO PASSO RONALDO - r 10382 A"
                        action = "sell"
                        
                        # 3 set 2022 ma100 da ma48
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                        and (ma3_prev > ma50_prev and ma3_last < ma50_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):    
                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 3-30 CON 100 sopra 300 <0.40 and deviation_sell  1.50-2.70 DOPPIO PASSO RONALDO - r 10393 B"
                        action = "sell"
                        
                        # 18 set 3-50 da 3-30
                        
                        
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma300_sopra_ma450 > 0.30
                        and (ma5_prev > ma45_prev and ma5_last < ma45_last)
                        and deviation_sell > 2.71 and deviation_sell < 5.70
                        and ma2_last < ma2_2_min_ago
                        and macd>-50
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 5-45 and deviation_sell > 2.71 TACCO DI ALLAH se dev 300-450 > 0.30 - r 10411 A"
                        action = "sell"
                        
                        # 1 ott 2022 3-28 da 3-13
                        # 17 mar 2023 4-39 con aggiunta dev 300-450 > 0.30
                        # 6 apr 2023 5-45 da 4-39

                  
                    
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma300_sopra_ma450 < 0.30
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 2.71 and deviation_sell < 5.70
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 3-33 and deviation_sell > 2.71 TACCO DI ALLAH se dev 300-450 < 0.30 - r 10411 B"
                        action = "sell"
                        
                        # 1 ott 2022 3-28 da 3-13
                        # 17 mar 2023 3-33 con aggiunta dev 300-450 < 0.30 
                
                
                
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma69_prev and ma3_last < ma69_last)
                        and deviation_sell > 5.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 1 dopo 240 min con ma50 > incrocio 3-69 (!) and deviation_sell > 5.71 SI STA TRA GLI ANGELI, compa ! - r 10424"
                        action = "sell"
                        
                    
                    
                    ######################################################################################## con trend discendente
                    
                    # con or IL MAESTRO HA FATTO LA CORREZIONE ! questa che vedi e' stata corretta dal maestro
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.17
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 <  and ma100 < con deviation_ma39 <-0.17 - r 10441"
                        action = "sell"
                        
                        # ma39 non deve vendere laterale (!) quindi per farlo vendere in alto ho dato 0.20
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_480_min_ago
                        and deviation_sell < -0.20
                        
                        and ma2_last <= ma2_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and ma2_last <= ma39_last
                        and ma100_last < ma100_60_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < and ma100 < MA 300 > 300 120 min ago and (dev_sell < -0.21 and ma2_last <= ma39_last) - r 10456 A1"
                        action = "sell"
                        
                        # > estate -0.22 da -0.15
                        # 6 apr 2023 -0.218 da -0.219
                        # 25 mag 2023 aggiunto 450 > 450 480 min ago ok cosi'
                        # 31 lug 2023 -0.21 da -0.218
                        # 24 ago 2023 -0.20 da -0.21 and ma2_last <= ma39_last invece di 3-39 ha fatto -0.80 !
                  
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_480_min_ago
                        and deviation_sell < -0.202
                        
                        and ma2_last < ma2_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and ma3_last <= ma39_last
                        and ma100_last < ma100_60_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < and ma100 < MA 300 > 300 120 min ago and dev_sell < -0.202 - r 10456 A2"
                        action = "sell"
                        
                        # > estate -0.22 da -0.15
                        # 6 apr 2023 -0.218 da -0.219
                        # 25 mag 2023 aggiunto 450 < 450 480 min ago diminuito dev sell di una ndecchiecella
                        #  9 giu 2023 -0.202 da -0.216
                        
                        
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and deviation_sell < -0.214
                        and ma3_last < ma39_last
                        and ma100_last < ma100_60_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < and ma100 < E 300 < 300 120 min ago and (dev_sell < -0.214 and ma3_last < ma39_last) - r 10456 B"
                        action = "sell"
                        
                        # > estate -0.22 da -0.15
                        # 24 set 2022 -0.218 da -0.22
                        # 11 ago 2023 -0.214 da -0.218
                        
                        
              
                    # ma se ma100 >
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma100_last > ma150_last
                        
                        and ma8_last < ma300_last
                        and deviation_sell < -0.05
                        
                        and ma3_last < ma18_last
                        and ma5_last < ma5_2_min_ago
                        
                        and macd < macd_2_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con 8-300 and ma5_last < ma5_2_min_ago and macd < macd_2_min_ago - r 10472 A1x"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 dwc ma39 <-0.197 da <-0.195
                        # 25 gen 2023 5-125 da 3-125
                        # 7 feb 2023 and ma5_last < ma5_2_min_ago
                        # 6 apr 2023 5-150 da 5-125
                        # 19 apr 2023 aggiunta macd > macd 2 min ago - solo dopo 110 min !
                        #  3 mag 2023 5-250 da 5-150 e vendita con pareggio.
                        # 12 ago 2023 8-300 da 5-250
                        # 13 set 2023 aggiunta 3 < 18 !
                        # 13 set 2023 dev sell a -0.05 da > 0.05 ! (ma300 sale da 2 ore !)
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma100_last > ma150_last
                        
                        and ma5_last < ma250_last
                        and deviation_sell > 0.10
                        
                        
                        and ma5_last < ma5_2_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.3
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con 5-250 e con macd < macd 2 min ago - r 10472 A1y"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 dwc ma39 <-0.197 da <-0.195
                        # 25 gen 2023 5-125 da 3-125
                        # 29 gen 2023 5-150 da 5-125
                        #  4 mag 2023 5-250 con aggiunta macd < macd 2 min ago
                        # 14 ott 2023 aggiunta and macd - macd 2 min ago < -0.3 (deve avere un minimo di scatto - di forza al ribasso)
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.1965
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                      
                        and ma5_last < ma150_last
                        and ma150_last > ma150_20_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con deviation_ma39 < -0.197 - r 10472 A2x1"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        # 16 mar 2023 ma39 <-0.1965 da <-0.197
                        
                        
                    elif (    
                        ma50_last <= ma50_2_min_ago
                        and deviation_ma39 < -0.192
                        and deviation_sell > 0.20
                        and ma5_last < ma5_2_min_ago
                      
                        and ma150_last < ma150_20_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con deviation_ma39 < -0.197 - r 10472 A2x2"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        # 16 mar 2023 ma39 <-0.1965 da <-0.197



                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < -0.193
                        and deviation_sell > 0.40
                        and ma5_last < ma5_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = f"SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con deviation_ma39 < -0.194 - r 10472 A2 y1 x1 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        #  5 mar 2023 ma39 <-0.194 da <-0.197 ma con dev sell > 0.40 prendi e porta a casa
                        # ho aggiunto questa ma la precedente condizone rappresenta "la base" - poi condizione speciale pochi maledetti e subito tra 0.80 e 1.20
                        # vedi 5 marzo 2023 ore 3:38 NON HA PRESO IL GUADAGNO !
                        # 21 ott 2025 piccolo anticipo

                        

                    elif (    
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma90_prev and ma5_last < ma90_last)

                        and deviation_sell > 0.40
                        and ma5_last < ma5_2_min_ago
                        and ma8_last < ma8_2_min_ago

                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = f"SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con deviation_ma39 < -0.194 - r 10472 A2 y1 x1 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        #  5 mar 2023 ma39 <-0.194 da <-0.197 ma con dev sell > 0.40 prendi e porta a casa
                        # ho aggiunto questa ma la precedente condizone rappresenta "la base" - poi condizione speciale pochi maledetti e subito tra 0.80 e 1.20
                        # vedi 5 marzo 2023 ore 3:38 NON HA PRESO IL GUADAGNO !
                        # 21 ott 2025 piccolo anticipo
                        # 25 ott 2025 aggiunto and ma8_last < ma8_2_min_ago


                        

                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.193
                        and deviation_sell > 0.40
                        and ma5_last < ma5_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = f"SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con deviation_ma39 < -0.194 - r 10472 A2 y1 x2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 17 gen 2023 ma39 <-0.197 da <-0.195
                        #  5 mar 2023 ma39 <-0.194 da <-0.197 ma con dev sell > 0.40 prendi e porta a casa
                        # ho aggiunto questa ma la precedente condizone rappresenta "la base" - poi condizione speciale pochi maledetti e subito tra 0.80 e 1.20
                        # vedi 5 marzo 2023 ore 3:38 NON HA PRESO IL GUADAGNO !    
                        # 21 ott 2025 piccolo anticipo
                        
                    


                        

                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.01
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell > 0.80
                        and ma5_last < ma5_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 > e con incrocio 5-100 se guadagno > 0.80 - r 10472 A2 y2"
                        action = "sell"
                        
                        # 28 mag 2023 aggiunta. perche' ha venduto con la precedente perdendo un grande guadagno
                        # 24 ago 2023 5-100 da 5-90
                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.193
                        
                        and deviation_ma5_sotto_ma300 > 0.30
                      
                        and ma5_last < ma5_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > E ma300 < e con deviation_ma39 <-0.193 - r 10472 B1"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 26 set dev39 a 0.193 da 0.195
                        # 31 ott 2022 dev sell -0.05 da 0.20
                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.13
                        and deviation_sell < -0.125
                        and deviation_ma5_sotto_ma300 < 0.30
                      
                        and ma5_last < ma5_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min CON ma300 < e con ma50 < MA ma100 > e con dev_ma39 < -0.13 and dev sell < -0.125 - r 10472 B2"
                        action = "sell"
                        
                        # ma39 NON DEVE VENDERE in fase laterale ma in alto
                        # 26 set dev39 a 0.193 da 0.195
                        # 31 ott 2022 dev sell -0.05 da 0.20
                        # 27 nov 2022 dev sell -0.07 da -0.05
                        # 13 feb 2023 dev sell -0.10 da -0.07
                        #  9 apr 2023 dev sell -0.12 da -0.10
                        # 12 apr 2023 dev sell -0.14 da -0.12
                        
                        # 22 mag 2023 dev39 a 0.194 da 0.193
                        # 22 mag 2023 dev39 a 0.1935 da 0.194
                        # 31 lug 2023 and deviation_ma39 < -0.13 da -0.1935
                        # 31 lug 2023 dev sell -0.125 da -0.14
                        
                    # ma se ma100 > dopo 240 min
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma200_301_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.31
                        and ma3_last < ma39_last
                        and ma100_last > ma100_60_min_ago
                        and ma78_last > ma200_last
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > and (deviation_sell < -0.27 and ma3_last < ma39_last) - r 10489 a1"
                        action = "sell"
                        
                        # 3 luglio 2022 a 0.27 da 0.20
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_301_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.22
                        and ma3_last < ma39_last
                        and ma100_last > ma100_60_min_ago
                        and ma78_last > ma200_last
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > and (deviation_sell < -0.22 and ma3_last < ma39_last) - r 10489 A2"
                        action = "sell"
                        
                        # 3 luglio 2022 a 0.27 da 0.20
                        # 30ago 2023 a 0.22 da 0.27
                        
                        
                    # ma se ma100 > dopo 240 min
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_sell < -0.23
                        and ma3_last < ma39_last
                        and ma100_last > ma100_60_min_ago
                        and ma78_last < ma200_last
                    ):
                        sell = "SELL 1 dopo 240 min con ma50 < MA ma100 > and (deviation_sell < -0.23 and ma3_last < ma39_last) - r 10489 b"
                        action = "sell"
                        
                        # 3 luglio 2022 a 0.23 da 0.20
                        
                    
                   
                    ############################################################################### aumento della perdita tollerata ! 50< MA 200> e 200>300
                    
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma300_last > ma300_301_min_ago
                        and deviation_ma39 < -0.26
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 compa dopo 240 min con ma50 < and deviation_ma39 < -0.26 con > PERDITA TOLLERATA E 300 > 5 ore ago - r 10530 A"
                        action = "sell"
                        
                        # 18 set dev 39 -0.25 da -0.23
                        # 21 gen 2023 dev 39 -0.26 da -0.25
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma300_last < ma300_301_min_ago
                        and deviation_ma39 < -0.25
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 compa dopo 240 min con ma50 < and deviation_ma39 < -0.23  con > PERDITA TOLLERATA MA 300 < 5 ore ago - r 10530 B"
                        action = "sell"
                        
                        # 18 set dev 39 -0.25 da -0.23
                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.30
                        and deviation_sell < -0.27
                        
                        and deviation_ma39 < -0.23
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 1 compa dopo 240 min con ma50 < and deviation_ma39 < -0.23  and deviation_sell < -0.27 con > PERDITA TOLLERATA - r 10546"
                        action = "sell"
                        
                        # se 100 > 300 di poco metto anche deviation_sell < -0.21
                        # > estate -0.27 da -0.21
                        
                        
                    
                        
                    # SELL 1 da RCCR ! dopo 240 min IPOTESI PEGGIORE con ma50< con dev_ma39 < -0.22 and deviation_sell < -0.22 MA DOPPIO DELTA RIALZO 
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        
                        and ma3_last < ma300_last
                        and ma200_last < ma300_last
                        and deviation_trend_ma200 < -0.10
                        
                        and deviation_ma39 < -0.22
                        and deviation_sell < -0.22
                        
                        and rapporto_delta_1_delta_2 < 1
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 da RCCR ! da 240 min in poi IPOTESI PEGGIORE con ma50< con dev_ma39 < -0.22 and deviation_sell < -0.22 MA DOPPIO DELTA RIALZO - r 10571"
                        action = "sell"
                        
                        # 19 SET r 10546 la condizione precedente ha fatto -1.65 ed e' partita insieme ad altre 2 condizioni speciali ! 
                        # quindi ho aggiunto questa importata SIA QUA CHE NELLE CONDIZIONI SPECIALI ( nuova condizione speciale )
                        # 19 set 2022 IMPORTATO DA RCCR > sell 4:18 del 19 set -1.65 % !
                        # 19 set 2022 deviation_ma39 < -0.22 AND and deviation_sell < -0.22
                        
                        
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma3_last < ma39_last
                        and deviation_sell < -0.241
                        
                        and ma2_last <= ma2_2_min_ago
                        and deviation_trend_ma200 > -0.15
                        and ma200_last > ma300_last
                        
                    ):
                        sell = "SELL 1 > 240 min E 300 > 120 min ago e con ma50 < (dev_sell < -0.241 and ma3_last < ma39_last) con > PERDITA TOLLERATA - r 10572 A1"
                        action = "sell"
                        
                        # 28 dic 2022 dev sell -0.245 da -0.23
                        # 24 apr 2023 dev sell -0.243 da -0.245 (dopo che con -0.245 ha fatto -0.80%)
                        # 27 apr 2023 dev sell -0.241 da -0.243 (dopo che con -0.243 ha fatto -0.86% !)
                        # 27 apr 2023 and deviation_trend_ma200 a > -0.15 da > -0.13
                        
                        
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and deviation_ma39 < 0.03
                        and ma3_last < ma69_last
                        
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = f"SELL 1 > 240 min con 3-69 SE 300 > 120 min e con ma50 < and dev 3-39 < 0.03 - r 10572 A2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"
                        
                        # deviation_ma39 = ma4_last / ma39
                        # 24 apr 2023 deviation_ma39 < -0.22
                        # macd sui tempi lunghi
                        #  7 lug 2023 deviation_ma39 < -0.17 da < -0.22
                        #  8 ott 2023 deviation_ma39 < 0.03 da < -0.17
                        # 14 apr 2024 sell con ma3<49 da 3-39
                        #  7 ago 2025 sell con ma3<69 da 3-49
                        # 25 ott 2025 aggiunte pg


                  
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma3_last < ma39_last
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 1 dopo 240 min E 300 < 120 min ago e con ma50 < (dev_sell < -0.25 and ma3_last < ma39_last) con > PERDITA TOLLERATA - r 10572 B"
                        action = "sell"
                        
                        # 17 gen 2023 dev sell 0.25
                        
                        
                    
                    
                    # ATTENZIONE 1 ! > 110 min E CON 300 > 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma300_last > ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min FORSE E' NECESSARA SOLO QUESTA 1 ! deviation_sell < -0.27 - r 10588"
                        action = "sell"
                        
                        
                        
                    # ATTENZIONE 2 ! dopo 240 min E CON 300 > 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma300_last > ma300_120_min_ago
                        and ma100_last < ma200_last
                        and deviation_sell < -0.22
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min FORSE E' NECESSARA SOLO QUESTA 2 ! deviation_sell < -0.22 - r 10603"
                        action = "sell"
                        
                        
                        
                        
                        
                    # ATTENZIONE 3 ! dopo 240 min CON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma78_last > ma300_last
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.225
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min FORSE E' NECESSARA SOLO QUESTA 3 ! deviation_sell < -0.225 CON 78 > 300 - r 10621 A"
                        action = "sell"
                        
                        # > estate a -0.19 da 0.09
                        # 17 set a -0.23 da -0.19
                        # 11 ott a -0.225 da -0.23
                        
                        
                    # ATTENZIONE 3 ! dopo 240 min CON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    
                    elif (    
                        ma3_last < ma100_last
                        and deviation_ma300_sopra_ma450 > -0.20
                        and ma78_last < ma300_last
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.19
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min FORSE E' NECESSARA SOLO QUESTA 3 ! dev_sell < -0.19 CON 78 < 300 (ancora ribasso !) porta a casa ! - r 10637 B1"
                        action = "sell"
                       
                        # 17 mar 2023 -0.19 da -0.17 con 300>450
                      
                    elif (    
                        ma3_last < ma100_last
                        and deviation_ma300_sopra_ma450 < -0.20
                        and ma78_last < ma300_last
                        and ma300_last < ma300_120_min_ago
                        and ma100_last > ma200_last
                        and deviation_sell < -0.18
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min FORSE E' NECESSARA SOLO QUESTA 3 ! dev_sell < -0.18 CON 78 < 300 (ancora ribasso !) porta a casa ! - r 10637 B2"
                        action = "sell"
                        
                        # 23 lug 2022 dev sell < 0.10 ha fatto fare perdita di -0.26 !
                        # 23 lug 2022 a < 0.09 da < 0.10
                        # > estate -0.10 da 0.09
                        # -0.13 da -0.10
                        # 17 dicembre 2022 -0.14 da -0.13
                        #  7 feb 2023 -0.17 da -0.14
                        # 17 mar 2023 -0.18 da -0.17 con 300<450
                        
                        
                    # ATTENZIONE 4 ! dopo 240 minCON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma5_last > ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma200_last
                        and deviation_sell < -0.15
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min con 5 > 200 ! FORSE E' NECESSARA SOLO QUESTA 4 ! deviation_sell < -0.15 - r 10655 A"
                        action = "sell"
                        
                        
                        
                        
                    # ATTENZIONE 4 ! dopo 240 minCON 300 < 120 min FORSE E' NECESSARA SOLO QUESTA !
                    
                    
                    elif (    
                        ma3_last < ma100_last
                        and ma5_last < ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        
                        and ma100_last < ma200_last
                        and ma100_last > ma300_last
                        and deviation_sell < -0.16
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min con 5 < 200 MA 100 > 300 ! FORSE E' NECESSARA SOLO QUESTA 4 ! deviation_sell < -0.16 and macd < - r 10655 B1"
                        action = "sell"
                        
                        #  4 set 2022 dev sell -0.07 da -0.05
                        # 26 set 2022 dev sell -0.10 da -0.07
                        # 12 ott 2022 dev sell -0.14 da -0.10
                        #  7 nov 2022 dev sell -0.16 da -0.14
                  
                        
                    elif (    
                        ma3_last < ma100_last
                        and ma450_last > ma450_720_min_ago
                        and ma5_last < ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma200_last
                        and ma100_last < ma300_last
                        
                        and deviation_sell < -0.149
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < 3.0
                    ):
                   
                        sell = "SELL 1 > 240 min and 450 > 12 ore con 5 < 200 e 100 < 300 ! FORSE E' NECESSARA SOLO QUESTA ! dev_sell < -0.149 and macd < and macd < -3 - r 10655 B2x"
                        action = "sell"
                        
                        #  4 set 2022 dev sell -0.07 da -0.05
                        # 26 set 2022 dev sell -0.10 da -0.07
                        # 12 ott 2022 dev sell -0.13 da -0.10
                        # 19 dic 2022 dev sell -0.152 da -0.13
                        
                        # 25 gen 2023 dev sell -0.158 da -0.152
                        # 21 apr 2023 dev sell -0.158 
                        # 21 apr 2023 ma450 > 12 ore
                        # 28 mag 2023 dev sell -0.152 da -0.149
                        # 28 mag 2023 dev sell -0.15 da -0.15
                        # 13 ago 2023 dev sell a -0.15 da -0.152
                        
                        # 29 set 2023 dev sell a -0.149 da -0.15
                        # 29 set 2023 macd < -3
                  
                        
                    elif (    
                        ma3_last < ma100_last
                        and ma450_last < ma450_720_min_ago
                        and ma5_last < ma200_last
                        
                        and ma300_last < ma300_120_min_ago
                        and ma100_last < ma200_last
                        and ma100_last < ma300_last
                      
                        and deviation_sell < 0.10
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 1 > 240 min and 450 < 12 ore con 5 < 200 e 100 < 300 ! FORSE E' NECESSARA SOLO QUESTA ! deviation_sell < 0.10 and macd < - r 10655 B2y"
                        action = "sell"
                        
                        #  4 set 2022 dev sell -0.07 da -0.05
                        # 26 set 2022 dev sell -0.10 da -0.07
                        # 12 ott 2022 dev sell -0.13 da -0.10
                        # 19 dic 2022 dev sell -0.152 da -0.13
                        
                        # 25 gen 2023 dev sell -0.158 da -0.152
                        # 21 apr 2023 dev sell -0.156 da -0.158
                        # 21 apr 2023 ma450 < 12 ore
                        # 16 ago 2023 dev sell -0.10 da -0.156
                        #  5 set 2023 dev sell -0.05 da -0.10
                        # 12 set 2023 dev sell < 0.10 da -0.05

          
            ########################################################################################################################### SESSIONE 2
            
            # ALLA SESSIONE 2 MANCAVA UN ACQUISTO DURANTE IL CROLLO SE PER ES SESSIONE 1 HA GIA' VENDUTO MA IL TITOLO RESTA IN IPERVENDUTO
            
            elif self.session == 2:

                ############################################################################################################# sessione 2 ( 0-3 min )
                
                if seconds_since_last_trade > 0 and seconds_since_last_trade <= 180:

                    # con ma50 >

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 2 (0-3 min) con ma50 > and incrocio 3-39 and deviation_sell < -0.23 - r 10680"
                        action = "sell"
                      
                    
               
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.60
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 2 (0-3 min) con ma50 > and incrocio 3-33 and deviation_sell 0.25 - 0.60 FINTA DI MARADONA - r 10692"
                        action = "sell"
                        
                 
                
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 0.61 and deviation_sell < 0.79
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (0-3 min) con ma50 > and incrocio 3-33 and deviation_sell 0.61 - 0.79 DRIBBLING DI RONALDO - r 10704"
                        action = "sell"
                    
                    
                    
               
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 0.80 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (0-3 min) con ma50 > and incrocio 3-13 and deviation_sell 0.80 - 1.20 DOPPIO PASSO ALLA RONALDO - r 10716"
                        action = "sell"
                  
                
                
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (0-3 min) con ma50 > and incrocio 3-11 and deviation_sell > 1.21 (che sarebbe come IL DRIBBLING ALLA RONALDO !) - r 10728"
                        action = "sell"
                        
                        
                    
                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (0-3 min) con ma50 < and incrocio 3-28 - r 10741"
                        action = "sell"
                        
                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                   
                
                
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (0-3 min) con ma50 < and incrocio 3-33 and deviation_sell -0.23 - r 10755"
                        action = "sell"
                        
                        
                        
               
                    # ---------------------------------------------------------------------------------------------------------------------- crollo

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma16_prev and ma3_last < ma16_last)
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 CROLLO (0-3 min) con ma50 < and incrocio 3-16 and deviation_sell < -0.50 - r 10769"
                        action = "sell"
                        
                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        
                
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 CROLLO (0-3 min) con ma50 < and incrocio 3-23 and deviation_sell > 0.23 - r 10782"
                        action = "sell"
                   
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma8_prev and ma3_last < ma8_last)
                        and deviation_sell > 0.60
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 CROLLO (0-3 min) con ma50 < and incrocio 3-8 and deviation_sell > 0.60 - r 10794"
                        action = "sell"
                        

                    ################################################################################################################### CONDIZIONI SPECIAL IMPORTATE RIDOTTE
                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.05
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL (0-3 min) EX condizione speciale R 16047 A1 con dev 3-39 < 0.01 e dev_sell < -0.05 e con ma50 < and macd_diff_2_min_ago < -0.20 - r 10798"
                        action = "sell"
                        
                        #  1 nov 2023 dev sell a -0.05 da -0.11
                      
                    
                        
                        
                        
              
                ##################################################################################################################### SESSIONE 2 ( 3-5 min )

                # VENDITA - da 3 a 5 minuti = da 180 a 300 secondi

                elif seconds_since_last_trade > 180 and seconds_since_last_trade <= 300:

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                    ):  
                        sell = "SELL 2 (3-5 min) con ma50 > and incrocio 3-39 and deviation_sell < -0.25 - r 10812"
                        action = "sell"
                        
                 
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                    ):  
                        sell = "SELL 2 (3-5 min) con ma50 > and 5-25 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 10823"
                        action = "sell"
                        
                        
                        
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 0.57 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (3-5 min) con ma50 > and incrocio 3-15 and deviation_sell 0.57 - 1.20 - r 10835"
                        action = "sell"
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (3-5 min) con ma50 > and incrocio 3-25 and deviation_sell > 1.21 - r 10847"
                        action = "sell"
                        
                    
                    
                    
                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 2 (3-5 min) con ma50 < and incrocio 3-28 - r 10862"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        # deviation_sell_ma78 = ma3_last / ma78_last
                        
                        
                        
                  
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.28
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (3-5 min) con ma50 < and incrocio 3-33 and deviation_sell < -0.28 - r 10877"
                        action = "sell"
                        
                        # 0.28 da 0.23
                        
                        
                        

                    # ---------------------------------------------------------------------------------------------------------------------- guadagno con crollo
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 GUADAGNO CON CROLLO (3-5 min) con ma50 < and incrocio 3-23 and deviation_sell > 0.23 - riga 10892"
                        action = "sell"
                        
                   
                
                
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (0-3 min) PARACADUTE CROLLO  con ma50 < and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 10904"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        
                        

                ####################################################################################################################### SESSIONE 2  ( 5-12 min )

                # VENDITA - da 5 a 12 minuti = da 300 a 720 secondi

                elif seconds_since_last_trade > 300 and seconds_since_last_trade <= 720:

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.41
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 > and incrocio 3-78 and deviation_sell < -0.41 - r 10924"
                        action = "sell"
                    
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 > and incrocio 5-100 (cuscino di sant' antonio) and deviation_sell < -0.25 - r 10936"
                        action = "sell"
                        
                        
                        
                   
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and 5-25 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 10949"
                        action = "sell"
                        
                        
                        
                   
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma15_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 >  3 < 15 and deviation_sell 0.57 - 0.90 - DRIBBLING ALLA RONALDO - r 10962"
                        action = "sell"
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 > and incrocio 3-25 and deviation_sell 0.91 - 1.20 - r 10975"
                        action = "sell"
                        
                        
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 > and incrocio 3-25 and deviation_sell > 1.21 - r 10987"
                        action = "sell"
                        
                        
                        
                        
                    ###########################################################################     trend in ribasso and ma200_last < ma300_last
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma300_last
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.31
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 < AND 200<300 and incrocio 3-28 and deviation_sell < -0.31 - r 11002"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        
                        
                  
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma300_last
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 < AND 200<300 and incrocio 3-100 (cuscino di sant' antonio) - r 11017"
                        action = "sell"
                        
                 
                
                
                    ###########################################################################     trend in ribasso MA ma200_last > ma300_last
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma300_last
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.35
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 < MA 200>300 and incrocio 3-28 and deviation_sell < -0.35 - r 11032"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                  
                
                
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma300_last
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.40
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) con ma50 < MA 200>300 and incrocio 5-100 (cuscino di sant' antonio) and deviation_sell < -0.40 - r 11047"
                        action = "sell"
                        
                        
                        
                   
                    # ------------------------------------------------------------------------------- guadagno con crollo

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma200_last
                        and ma100_last > ma300_last

                        and (ma3_prev > ma50_prev and ma3_last < ma50_last)
                        and deviation_sell > 0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) guadagno con crollo con ma50< e incrocio 3-50 SE ma100 > ma200 - r 11061 X1"
                        action = "sell"

                        #  7 apr 2025 3-50 da 3-23 SE ma100_last > ma200_last



                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma200_last
                        and ma100_last < ma300_last

                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 0.25
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) guadagno con crollo con ma50< e incrocio 3-39 SE 100 > 200 MA 100<300 - r 11061 X2"
                        action = "sell"

                        #  7 apr 2025 3-50 da 3-23 SE ma100_last > ma200_last ma ma100_last < ma300_last MA 100<300




                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma200_last

                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) guadagno con crollo con ma50< e incrocio 3-23 - r 11061 Y"
                        action = "sell"



                        
                    # ------------------------------------------------------------------------------ PARACADUTE crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.48
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) PARACADUTE CROLLO  con ma50 < and ma3<ma16 (no incrocio) and deviation_sell < -0.48 - r 11074"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE


                    ######################################################################## CONDIZIONI SPECIALI IMPORTATE RIDOTTE

                    elif (
                        ma78_last < ma78_120_min_ago
                        and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07

                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.01
                        and ma3_last < ma8_last
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) EX CS GIORNO con ma300< 5 ore e dev 3-39 < 0.06 e dev_sell < 0.01 e ma50< - r 11079 A"
                        action = "sell"
                        
                        # 16 nov 2023 dev 3-39 a 0.06 da 0.05
                        # 16 nov 2023 dev_sell a 0.01 da -0.109
                        # 12 mag 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07
                        # 12 mag 2025 and deviation_sell a -0.01 da 0.01
                        # 16 ott 2025 aggiunta 3<8


                    elif (
                        ma78_last < ma78_120_min_ago
                        and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.07

                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.01
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 (5-12 min) EX CS GIORNO con ma300> 5 ore e dev 3-39 < 0.06 e dev_sell < 0.01 e ma50< - r 11079 B"
                        action = "sell"
                        
                        # 16 nov 2023 dev 3-39 a 0.06 da 0.05
                        # 16 nov 2023 dev_sell a 0.01 da -0.109
                        # 12 mag 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.07




                    elif (
                        ma78_last > ma78_120_min_ago
                        and delta_DNA_1 < delta_DNA_2

                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.06

                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 2 (5-12 min) GIORNO con dev 3-39 < 0.01 e dev_sell < -0.06 e ma50 < - r 11080 A"
                        action = "sell"
                        
                        #  1 nov 2023 dev sell a -0.05 da -0.11
                        #  7 apr 2025 DNA GIORNO dev sell a -0.06 da -0.05


                    elif (
                        ma78_last > ma78_120_min_ago
                        and delta_DNA_1 > delta_DNA_2

                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.05

                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 2 (5-12 min) NOTTE con dev 3-39 < 0.01 e dev_sell < -0.05 e ma50 < - r 11080 B"
                        action = "sell"
                        
                        #  1 nov 2023 dev sell a -0.05 da -0.11
                        #  7 apr 2025 DNA NOTTE 


                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma2_differenza_2_min_ago < -5
                        
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.105
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and macd_differenza_2_min_ago < -1.5
                        and ma2_last < ma5_last
                        and macd < 14
                        
                    ):
                        sell = "SELL 2 (5-12 min) EX cond spec 16047 B1Y con ma 50 < ma 50 2 min ago  con ma300 > 5 ore - SALVAGENTE 4 dev 3-39 < 0.06 and dev_sell < -0.11 - r 11081"
                        action = "sell"


                  
                    
                    
                    
                        
                        
                   
                
                
                ####################################################################################################################### SESSIONE 2 ( 12-21 min )

                # VENDITA - da 12 a 21 minuti = da 720 a 1260 secondi

                elif (
                    seconds_since_last_trade > 720 and seconds_since_last_trade <= 1260
                ):

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma69_prev and ma3_last < ma69_last)
                        and deviation_sell < -0.34
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and incrocio 3-69 and deviation sell -0.34 e vaffanculo ! - r 11097"
                        action = "sell"
                        
                        # and deviation_ma39 < -0.29 vendeva troppo presto
                        # ATTENZIONE "and (ma3_prev > ma39_prev and ma3_last < ma39_last)" con ma39 NON HA INCROCIATO
                        
                        
                        
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma100_prev and ma3_last < ma100_last)
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and incrocio 3-100 cuscino di sant' antonio and deviation_sell < 0.36 - r 11112"
                        action = "sell"
                        
                  
                
                
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and 5<25 and deviation_sell 0.25-0.56 - MARADONA - r 11125"
                        action = "sell"
                        
                       
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma25_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and 3<25 and deviation_sell 0.57-0.90 - DOPPIO PASSO ALLA RONALDO fino a +0.50 - r 11138"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                    
                    
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma100_last > ma300_last
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and incrocio 3-25 and deviation_sell 0.91 - 1.20 CON 100 > 300 RIALZO - r 11156 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 12 gen 2023 3-25 da 3-15
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma100_last < ma300_last
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and incrocio 3-20 and deviation_sell 0.91 - 1.20 CON 100 < 300 CROLLO - r 11171 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                       
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 > and incrocio 3-13 and deviation_sell > 1.21 - r 11190"
                        action = "sell"
                        
                        

                    ##########################################################################################
                    # NON TOCCARE ! CUSCINO DI SANT' ANTONIO !
                    # L' INCROCIO 5-100 MI SALVA ! MA, attenzione, 5<100 VENDE DURANTE IL RIBASSO !
                    ########################################################################################### con trend discendente
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.50
                        and deviation_ma39 < -0.199
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 < and deviation_ma39 < -0.195 - r 11206 A"
                        action = "sell"
                        
                        # and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        # ATTENZIONE deviation_sell < -0.25 aveva FATTO -0.61% !
                        # HO NOTATO CHE ANCHE INCROCIO 5-100 SAREBBE ARRIVATO TARDI
                        
                        # > estate se 5 molto sopra 300 ma39 -0.199 da -0.19
                        
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma20_last > ma40_last
                        and deviation_ma5_sotto_ma300 < 0.50
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.13
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 < and deviation_ma39 < -0.03 and dev sell -0.12 - r 11206 Bx"
                        action = "sell"
                        
                        # 24 dic 2023 con 20>40 deviation_sell < -0.13

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma100_10_min_ago
                        
                        and ma20_last <= ma40_last
                        and deviation_ma5_sotto_ma300 < 0.50
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.12
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 < and deviation_ma39 < -0.03 and dev sell -0.12 - r 11206 BY1"
                        action = "sell"

                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma5_last <= ma40_last

                        and ma100_last < ma100_10_min_ago
                        
                        and ma20_last <= ma40_last
                        and deviation_ma5_sotto_ma300 < 0.50
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.04
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 < and deviation_ma39 < -0.03 and dev sell 0.03 - r 11206 BY2"
                        action = "sell"
                        
                        # ATTENZIONE deviation_sell < -0.25 aveva FATTO -0.61% !
                        # HO NOTATO CHE ANCHE INCROCIO 5-100 SAREBBE ARRIVATO TARDI
                        
                        # > estate se 5 vicina 300 ma39 -0.199 da -0.19 e dev sell -0.30
                        # 12 set 2023 dev 39 a -0.05 da -0.199
                        # 12 set 2023 dev sell a -0.12 da -0.30
                        #  2 ott 2023 and deviation_ma39 < -0.03 da < -0.05 dopo che ha fatto -0.46
                        
                        # 24 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        # 24 dic 2023 aggiunta and macd_differenza_2_min_ago < -0.50
                        # 24 dic 2023 con 20<=40 deviation_sell < -0.12
                        # 14 gen 2024 con ma 100< 100 10 min ago and deviation_sell < 0.03 da < -0.12
                        # 31 gen 2025 aggiunta and ma5_last <= ma40_last


                  
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.45
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.45 - r 11226"
                        action = "sell"
                        
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10 e vaffanculo ! ma solo se ma50< ! 
                        
                        
                       

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.28
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (12-21 min) con ma50 < and CUSCINO DI SANT' ANTONIO - r 11240"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # incrocio 5-100 no 5<100 altrimenti vende durante il crollo !
                        
                        

                        
                    # --------------------------------------------------------------------------------- PARACADUTE crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 PARACADUTE CROLLO (12-21min) con ma50< and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 11257"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        
                        
                        
                    # ----------------------------------------------------------------------------- guadagno con crollo
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma18_last > ma18_30_min_ago
                         
                        and (ma4_prev > ma33_prev and ma4_last < ma33_last)
                        and deviation_sell > 0.22
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 eventuale guadagno con crollo (12-21 min) con ma50 < and incrocio 4 - 33 se 18> and deviation_sell > 0.22 - r 11276 a"
                        action = "sell"
                        
                        # 19 giu 2022 4-33 da 4-20

                   
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma18_last < ma18_30_min_ago
                        
                        and (ma4_prev > ma20_prev and ma4_last < ma20_last)
                        and deviation_sell > 0.22
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (12-21 min) eventuale guadagno con crollo  con ma50 < and incrocio 4 - 20 se 18< and deviation_sell > 0.22 - r 11276 b"
                        action = "sell"
                        
                        # 19 giu 2022 4-33 da 4-20


                    ########################################################################################################### condizioni speciali importate ridotte

                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last > ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.117
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < 5
                    ):
                        sell = "SELL 2 (12-21 min) EX cond spec 16047 B1x con ma 50 > ma 50 2 min ago con ma300 > 5 ore e dev 3-39 < 0.05 e dev_sell < -0.117 - r 11277"
                        action = "sell"
                        
                        # 25 ott 2023 dev sell -0.117 da -0.107
                    

                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma18_last > ma28_last
                        
                        and ma2_differenza_2_min_ago < -8
                
                        and ma300_last > ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.084
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 (12-21 min) EX cond spec r 16047 B3 con ma300 > 5 ore con dev 3-39 < 0.05 e dev_sell < -0.084 e ma50 < and ma2_diff_2_min_ago < -8 - r 11280a"
                        action = "sell"

                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma18_last < ma28_last
                        
                        and ma2_differenza_2_min_ago < -6
                
                        and ma300_last > ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.076
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 (12-21 min) EX cond spec r 16047 B3 con ma300 > 5 ore con dev 3-39 < 0.05 e dev_sell < -0.076 e ma50 < and ma2_diff_2_min_ago < -6 - r 11280b"
                        action = "sell"

                  
                    

                  
                    
            
            
            
                ############################################################################################################## SESSIONE 2 ( 21-60 min )

                # VENDITA - da 21 a 60 minuti = da 1261 a 3600 secondi
                
                
                elif (
                    seconds_since_last_trade > 1261 and seconds_since_last_trade <= 3600
                ):
                    
                
                    ######################################################################################################## righe compa RADDOPPIATE !
                    
                    # situazione in miglioramento
                    
                    if (        
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.255
                        and ma200_last < ma200_60_min_ago
                        and ma100_last > ma200_last
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and deviation_ma39 < -0.255 situazione in miglioramento - r 11318"
                        action = "sell"
                        
                        
                   
                    
                    # situazione post crollo
                    
                    elif (        
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma200_last
                        and deviation_sell < -0.28
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.26
                        and ma200_last < ma200_60_min_ago
                        
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and deviation_ma39 < -0.26 and deviation_sell < -0.28 - situazione post crollo - r 11338"
                        action = "sell"
                        
                        
                    
                        
                        
                    # situazione in miglioramento
                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma200_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.32
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                        
                    ):
                        sell = "SELL 2 (21-60 min) RAFFORZATA con ma50 > and (dev_sell < -0.32 and ma3_last < ma50_last) situazione in miglioramento - r 11365"
                        action = "sell"
                        
                        
                     
                  
                    
                    # situazione post crollo
                    
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.30
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                        and ma100_last < ma200_last
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and (deviation_sell < -0.28 and ma3_last < ma50_last) situazione post crollo - r 11384"
                        action = "sell"
                        
                        
                        
                        #######################################################################################################################
                        
                    
                    elif (        
                        ma50_last > ma50_2_min_ago
                        and delta_1 < delta_2

                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.295
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and deviation_ma39 < -0.29 - TOLLERANTE ! - r 11410 a"
                        action = "sell"
                        
                        # 17 feb 2023 dev_39 a -0.295 da -0.29
                        # 14 apr 2025 se delta_1 > delta_2 ok cosi'


                    elif (        
                        ma50_last > ma50_2_min_ago
                        and delta_1 > delta_2

                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.29
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and deviation_ma39 < -0.29 - TOLLERANTE ! - r 11410 b"
                        action = "sell"
                        
                        # 17 feb 2023 dev_39 a -0.295 da -0.29
                        # 14 apr 2025 se delta_1 > delta_2 allora anticipo di una ndecchiecella il delta_buy2_dal_sell
                        # 14 apr 2025 dev_39 a -0.29 da -0.295

                  
                
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and delta_1_69_39 < delta_2_69_39
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.35
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and (deviation_sell < -0.35 and ma3_last < ma50_last) TOLLERANTE ! con doppio delta giorno - r 11423 A"
                        action = "sell"
                        
                        # 21 giu 2022 dev sell -0.31 da -0.29
                        # 13 set 2022 dev sell -0.33 da -0.31
                        # 18 nov 2022 dev sell -0.35 da -0.33


                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and delta_1_69_39 > delta_2_69_39
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.34
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and (deviation_sell < -0.34 and ma3_last < ma50_last) TOLLERANTE ! con doppio delta notte - r 11423 B"
                        action = "sell"
                        
                        # 21 giu 2022 dev sell -0.31 da -0.29
                        # 13 set 2022 dev sell -0.33 da -0.31
                        # 18 nov 2022 dev sell -0.34 da -0.33
                        
                    ##############################################################################################################################
                        
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.29
                        and ma300_last > ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and incrocio 5-100 cuscino di sant' antonio (no 5<100) and deviation_sell < -0.29 - r 11440"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.26
                        and ma300_last < ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and incrocio 5-100 cuscino di sant' antonio (no 5<100) and deviation_sell < -0.26 - r 11452"
                        action = "sell"
                  
                        # deviation_sell = ma3_last/last_trade_price
                        # IMPORTANTE !   
                        # vai compaaaaaaaaaa
                        # poco guadagno ma piu' alta
                        # molto guadagno ma piu' bassa
                        
                        
                      
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma450_last > ma450_360_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and ma5_last < ma78_last
                        and deviation_sell > 0.27 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and 5 < 69 and dev_sell 0.25 - 0.56 MARADONA e' piu' stanco e paziente - r 11477 Ax"
                        action = "sell"
                        
                        #  8 mar 2024 aggiunta and ma450_last > ma450_360_min_ago

                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago

                        and ma300_last > ma450_last
                        and deviation_ma5_sotto_ma300 > 0.40
                        and ma5_last < ma100_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -2.50
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and 5<100 and dev_sell 0.25 - 0.56 MARADONA e' piu' paziente - r 11477 AY1"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 5-69 da 5-39 dopo dolomiti
                        
                        #  8 mar 2024 aggiunta and ma450_last > ma450_360_min_ago
                        # 27 feb 2025 aggiunta and ma300_last > ma450_last
                        # 27 feb 2025 5-100 da 5-69
                        # 27 feb 2025 and macd < macd_2_min_ago
                        # 27 feb 2025 aggiunta and macd_differenza_2_min_ago < -2.50



                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago

                        and ma300_last < ma450_last
                        and deviation_ma5_sotto_ma300 > 0.40
                        and ma5_last < ma78_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -2.50
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and 5<78 and dev_sell 0.25 - 0.56 MARADONA e' piu' paziente - r 11477 AY2"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 5-69 da 5-39 dopo dolomiti
                        
                        #  8 mar 2024 aggiunta and ma450_last > ma450_360_min_ago
                        # 27 feb 2025 aggiunta and ma300_last < ma450_last
                        # 27 feb 2025 5-78 da 5-69
                        # 27 feb 2025 and macd < macd_2_min_ago
                        # 27 feb 2025 aggiunta and macd_differenza_2_min_ago < -2.50

                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma200_last

                        and deviation_ma5_sotto_ma300 < 0.40
                        and deviation_ma5_sotto_ma300 > -0.40

                        and ma5_last < ma100_last
                        and delta_1 > delta_2

                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > e 5 < 45 e deviation_sell 0.25 - 0.56 MARADONA e' piu' stanco e paziente - r 11477 B1"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 5-69 da 5-39 dopo dolomiti
                        # 29 set 5-39 fascia mediana 5-300
                        # 17 mar 2023 5-45 da 5-39
                        # 31 gen 2025 se 100>200 vende quando ma100 comincia a curvare verso il basso - NOTTE

                       
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma200_last

                        and deviation_ma5_sotto_ma300 < 0.40
                        and deviation_ma5_sotto_ma300 > -0.40

                        and ma5_last < ma59_last

                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > e 5<59 e dev_sell 0.25 - 0.56 MARADONA e' piu' stanco - r 11477 B2"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 5-69 da 5-39 dopo dolomiti
                        # 29 set 5-39 fascia mediana 5-300
                        # 17 mar 2023 5-45 da 5-39
                        # 27 mar 2025 5-59 da 5-45


                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < -0.40
                        and ma5_last < ma78_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and 5 < 78 and deviation_sell 0.25 - 0.56 MARADONA e' piu' stanco e paziente - r 11477 C"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # > estate 5-78 da 5-48 
                        
                        
                        
                        
                    ############################################################################################################################
                    
                    # ATTENZIONE !
                    # ELASTICO ALLA RONALDO SE ma200 > ma200 120 min ago
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma200_last > ma200_120_min_ago
                        and ma5_last < ma69_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > AND 200>120 min and 5<69 (fidati!) and deviation_sell 0.57 - 0.90 ELASTICO ALLA RONALDO - r 11499"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                    # ELASTICO ALLA RONALDO SE ma200 < ma200 120 min ago
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma200_last < ma200_120_min_ago
                        
                        and ma3_last < ma48_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > AND 200>120min and 100> and 3<48 and deviation_sell 0.57 - 0.90 ELASTICO ALLA RONALDO - r 11518 a"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    # ELASTICO ALLA RONALDO SE ma200 < ma200 120 min ago
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma200_last < ma200_120_min_ago
                        
                        and ma3_last < ma39_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > e 200>120 min e 100< e 3<39 and dev_sell 0.57 - 0.90 ELASTICO RONALDO - r 11538 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 30 dic 2024 sell con 3-39 da 3-25
                        
                    
                    ##############################################################################################################
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.50
                        and (ma5_prev > ma59_prev and ma5_last < ma59_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and incrocio 5-59 se 5-300 > 0.50 and deviation_sell 0.91 - 1.20 - r 11555 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 17 set 3-42 da 3-18
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.50
                        and (ma3_prev > ma42_prev and ma3_last < ma42_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and incrocio 3-42 se 5-300 < 0.50 and deviation_sell 0.91 - 1.20 - r 11555 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 17 set 3-42 da 3-18
                        
                       
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma39_prev and ma5_last < ma39_last)
                        and deviation_sell > 1.21 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and incrocio 5-39 and deviation_sell 1.21 - 2.70 - r 11568"
                        action = "sell"

                        #  3 feb 2025 5-39 da 5-30
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 > and incrocio 3-20 and deviation_sell > 2.71 - r 11579"
                        action = "sell"
                        

                        
                    #################################################################################################### con trend discendente
                    #################################################################################################### 2 righe del compa GIA' CON TOLLERANZA
                    
                    
                    
                    elif (        
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and ma78_last > ma200_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.30
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_ma39 < -0.30 AND 78>200 - r 11599 A"
                        action = "sell"    
                        
                        
                    elif (        
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and ma78_last < ma200_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.295
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_ma39 < -0.295 AND 78<200 - r 11613 B"
                        action = "sell"
                        
                        
                      
                        
                    # ecco inequivocabilmente il crollo !
                    
                    elif (        
                        ma50_last < ma50_2_min_ago
                        and ma30_last > ma30_2_min_ago
                        and ma2_differenza_2_min_ago < -10
                        and ma2_differenza_ma5 < -9
                        and ma300_last < ma300_120_min_ago
                        and ma200_last < ma200_60_min_ago
                        
                        and deviation_ma39 < 0.13
                        and deviation_sell < 0.02
                        
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_ma39 < 0.13 and deviation_sell < 0.02 - r 11633x"
                        action = "sell"
                        
                        # 17 dic 2023 MARIO se ma30> aggiunta and ma2_differenza_2_min_ago < -10 and ma2_differenza_ma5 < -9 (c'e' un segno di ripresa!)

                    



                    elif (        
                        ma50_last > ma50_2_min_ago
                        and ma78_last < ma78_120_min_ago
                        and ma100_last < ma300_last

                        and ma20_last <= ma20_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma200_last < ma200_60_min_ago
                
                        and deviation_ma39 < 0.10
                        and deviation_sell < -0.03
                
                
                        and deviation_ma100_sopra_ma300 < 0.40
                        and deviation_ma5_sotto_ma200 > -0.90
                        
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago


                    ):
                        sell = "SELL 2 (21-60 min) con ma50> e ma20_last <= ma20_2_min_ago e dev_ma39 < 0.10 e dev_sell < -0.03 - r 11633 Y1"
                        action = "sell"

                        #  7 feb 2025  aggiunta questa perche' e' andata benissimo durante il ribasso !
                        #  7 feb 2025 se vedi bene 50> !




                    elif (        
                        ma50_last < ma50_2_min_ago
                        
                        and ma300_last < ma300_120_min_ago
                        and deviation_ma39 < 0.13
                        and deviation_sell < 0.10 
                        and (ma20_prev > ma50_prev and ma20_last < ma50_last)

                        and ma200_last < ma200_60_min_ago
                        and ma20_last <= ma20_2_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                        and macd_differenza_2_min_ago < -0.40
                    ):
                        sell = "SELL 2 (21-60 min) con ma50< e ma20_last <= ma20_2_min_ago e dev_ma39 < 0.13 e dev_sell < 0.10 - r 11633 Y2"
                        action = "sell"
                        
                        # durante il crollo non devi pensare ai centesimi !
                        # cazzo oggi 13 dic 2013 and deviation_ma39 < 0.13 da -0.31 !
                        # 17 dic 2023 and ma2_differenza_2_min_ago < -10
                        # 17 dic 2023 and ma2_differenza_ma5 < -9
                        # 24 dic 2023 a 0.10 da 0.02
                        # 24 dic 2023 and ma20_last <= ma20_2_min_ago da ma30 < 30 2 min ago
                        # 25 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                        # 25 gen 2024 aggiunta and macd_differenza_2_min_ago < -0.40
                        # 16 mag 2025 and (ma20_prev > ma50_prev and ma20_last < ma50_last)



                    
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.12
                        and ma200_last < ma200_60_min_ago
                        and ma50_last > ma100_last
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_sell < -0.12 - r 11650"
                        action = "sell"
                        
                        # 26 set 2022 -0.318 da -0.32
                        #  6 set 2023 -0.12 da -0.32
                    
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_480_min_ago
                        and deviation_sell < -0.348
                        
                        and ma2_last < ma2_2_min_ago 
                        
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_sell < -0.348 CON ma450_last > ma450_480_min_ago - r 11663 a"
                        action = "sell"
                        
                        # 2 GIUGNO a 0.335 da 0.32
                        # 0.345 da 0.335 dopo le dolomiti
                        # 24 set 2022 -0.348 da -0.345
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_480_min_ago
                        and deviation_sell < -0.34
                        
                        and ma2_last < ma2_2_min_ago 
                        
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_sell < -0.34 CON ma450_last > ma450_480_min_ago- r 11663b"
                        action = "sell"
                        
                        # 2 GIUGNO a 0.335 da 0.32
                        # 0.345 da 0.335 dopo le dolomiti
                        # 24 set 2022 -0.348 da -0.345
                    
                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_60_min_ago
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.37
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.37 - r 11681"
                        action = "sell"
                        
                       
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma100_last > ma100_60_min_ago
                        
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.31
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50< 200< e 100> and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO con dev_sell < -0.31 - r 11699"
                        action = "sell"
                        
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma100_last < ma100_60_min_ago
                        
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.29
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50< 200< e 100< and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO con dev_sell < -0.29 - r 11714"
                        action = "sell"
                        
                       
                    ############################################################################################################## con > PERDITA TOLLERATA !
                    
                    # ATTENZIONE ! AUMENTA LA PERDITA TOLLERATA  ! PERCHE' ma200 sale e perche' ma200 > ma300
                    
                    
                    # divido in 2 parti la correzione del maestro !
                    
                    elif (
                        
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.37
                        and ma200_last > ma200_60_min_ago
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                    
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_ma39 < -0.37 con > PERDITA TOLLERATA ! - r 11741"
                        action = "sell"
                        
                        # > estate -0.37 da -0.29
                        
                        
                        
                        
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        
                        and deviation_sell < -0.30
                        
                        and ma300_last > ma300_301_min_ago
                        and ma200_last > ma200_60_min_ago
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -1
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_sell < -0.30 con > PERDITA TOLLERATA ! and macd_differenza_2_min_ago < -1 - r 11755 A"
                        action = "sell"
                        
                        # 28 set se 300 > 300 301 min ago allora dev sell a -0.36 da -0.35
                        # 22 otobre 2022 dev sell 0.37 da 0.36
                        # 27 set 2023 aggiunto and macd_differenza_2_min_ago < -1
                        # 27 set 2023 dev sell 0.30 da 0.37

                    
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.35
                        and ma300_last < ma300_301_min_ago
                        and ma200_last > ma200_60_min_ago
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                     
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and deviation_sell < -0.35 con > PERDITA TOLLERATA ! - r 11755 B"
                        action = "sell"
                        
                     
                   
                
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma200_60_min_ago
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.40
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.40 con > PERDITA TOLLERATA ! - r 11770"
                        action = "sell"
                        
                        
                        
                    elif (
                        deviation_trend_ma200 > -0.10
                        and deviation_ma5_sotto_ma300 > 0.59
                        
                        and ma200_last > ma200_60_min_ago
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO con > PERDITA TOLLERATA ! - r 11785a"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # NON INCROCERANNO MAI DURANTE IL CROLLO !
                        # non toccare ! INCROCIO 3-100 CUSCINO DI SANT' ANTONIO !
                        
                        
                        
                        
                        
                    elif (
                        deviation_trend_ma200 > -0.10
                        and deviation_ma5_sotto_ma300 < 0.59
                        
                        and ma200_last > ma200_60_min_ago
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma8_prev > ma130_prev and ma8_last < ma130_last)
                        and deviation_sell < -0.38
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < and INCROCIO 8-130 (no 3<100) CUSCINO DI SANT' ANTONIO con > PERDITA TOLLERATA ! - r 11785b"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # NON INCROCERANNO MAI DURANTE IL CROLLO !
                        # non toccare ! INCROCIO 3-100 CUSCINO DI SANT' ANTONIO !
                        # tornando dalle dolomiti se 5 e' vicina a 300 sant' antonio e' piu' delicato ( e' un movimento laterale )
                        # > estate -0.38 da 0.30
                
                
                    # -------------------------------------------------------------------------------------- guadagno durante il crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_450_300 < delta_450_300_60_min
                        and (ma3_prev > ma45_prev and ma3_last < ma45_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) eventuale guadagno durante il crollo (21-60 min) con ma50 < incrocio 3-45 and dev_sell > 0.23 - r 11803 A"
                        action = "sell"
                        
                        # 14 set 3-28 da 3-18
                        # 16 mar 2023 3-39 da 3-28 giorno

                  
                  
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_450_300 > delta_450_300_60_min
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (21-60 min) eventuale guadagno durante il crollo (21-60 min) con ma50 < incrocio 3-45 and dev_sell > 0.23 - r 11803 B"
                        action = "sell"
                        
                        # 14 set 3-28 da 3-18
                        # 16 mar 2023 3-39 da 3-28 notte

                    

                    ##################################################################################################################### condizioni speciali importate ridotte
                    
                    elif (
                        deviation_sell > 0.80
                        and ma5_last < ma5_10_min_ago
                
                        and ma3_last < ma28_last
                
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1
                    ):    
                        sell = "SELL 2 (21-60 min) EX cond. spec r 16873 C - POC MALED E SUB mentre scende con dev > 0.80 and macd < macd 2 min ago con ma5_10_min_ago - r 11804"
                        action = "sell"

                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.107
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < 5
                    ):
                        sell = "SELL 2 (21-60 min) EX cond spec r 16047 B1Y con ma 50 < ma 50 2 min ago  con ma300 > 5 ore - CON dev 3-39 < 0.05 and dev_sell < -0.107 - r 11805"
                        action = "sell"

                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.05
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < 5
                        and ma2_differenza_2_min_ago < -3
                    ):
                        sell = "SELL 2 (21-60 min) EX cond spec r 16047 B1Y con ma 50 < ma 50 2 min ago e ma300 > 5 ore e dev 3-39 < 0.05 and dev_sell < -0.107  - r 11806"
                        action = "sell"
                        
                        # 31 ott 2023 and deviation_sell < -0.05 invece di -0.10 IMPORTATA RIDOTTA !



                  
                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma100_sopra_ma300 > 0.25
                        and deviation_ma39 < 0.07
                        and deviation_sell < -0.06
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last >= ma50_2_min_ago
                        
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 2 (21-60 min) CRESCITA con ma50 >= EX cond spec r 16047 A1 con dev 3-39 < 0.07 e dev_sell < -0.06 and macd_diff_2_min_ago < -0.20 - r 11807 a1"
                        action = "sell"
                        
                        #  4 ott 2023 ex condizione speciale r 16047 A1 ridotta
                        #  4 nov 2023 ex condizione speciale r 16047 A1 con ma50 >=
                        # 29 dic 2023 SITUAZIONE DI CRESCITA dev_sell a -0.04 da -0.05

                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma100_sopra_ma300 < 0.25
                        and deviation_ma100_sopra_ma300 > -0.25
                        
                        and deviation_ma39 < 0.07
                        and deviation_sell < -0.07
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last >= ma50_2_min_ago
                        
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 2 (21-60 min) LATERALE con ma50 >= EX cond spec r 16047 A1 con dev 3-39 < 0.07 e dev_sell < -0.07 and macd_diff_2_min_ago < -0.20 - r 11807 a2"
                        action = "sell"
                        
                        #  4 ott 2023 ex condizione speciale r 16047 A1 ridotta
                        #  4 nov 2023 ex condizione speciale r 16047 A1 con ma50 >=
                        # 29 dic 2023 SITUAZIONE LATERALE dev_sell a -0.07 da -0.07

                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma100_sopra_ma300 < -0.25
                        
                        and deviation_ma39 < 0.07
                        and deviation_sell < -0.05
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last >= ma50_2_min_ago
                        
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 2 (21-60 min) RIBASSO con ma50 >= EX cond spec r 16047 A1 con dev 3-39 < 0.07 e dev_sell < -0.05 and macd_diff_2_min_ago < -0.20 - r 11807 a3"
                        action = "sell"
                        
                        #  4 ott 2023 ex condizione speciale r 16047 A1 ridotta
                        #  4 nov 2023 ex condizione speciale r 16047 A1 con ma50 >=
                        # 29 dic 2023 SITUAZIONE DI RIBASSO
                        





                  
                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.05
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 2 (21-60 min) con ma50 < EX condizione speciale r 16047 A1 con dev 3-39 < 0.01 e dev_sell < -0.05 and macd_diff_2_min_ago < -0.20 - r 11807 b"
                        action = "sell"
                        
                        #  4 ott 2023 ex condizione speciale r 16047 A1 ridotta
                        #  4 nov 2023 ex condizione speciale r 16047 A1 con ma50 <
                    

                  
                    

                  
                    
                
                
                
                
                #################################################################################################################### SESSIONE 2 ( da 60 a 90 min )

                # VENDITA - da 60 a 90 min - da 3600 a 5400 secondi in poi
                
                elif (
                    seconds_since_last_trade > 3600 and seconds_since_last_trade <= 5400
                ):
                    
                  
                    ################################################################### RIGHE DEL COMPA DA RADDOPPIARE PER AUMENTO TOLLERANZA
                    
                    if (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < -0.18
                        and deviation_ma100_sopra_ma300 > 0.70
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and deviation_ma39 < -0.18 SE 100 MOLTO ALTA RISPETTO ALLA 300 OK COSI' - r 11828 a1"
                        action = "sell"
                      
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma5_last < ma39_last
                        and deviation_ma100_sopra_ma300 > 0.70
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and 5 < 39 SE 100 MOLTO ALTA RISPETTO ALLA 300 OK COSI' - r 11828 A2x"
                        action = "sell"
                        
                        # 20 ott 2023 5-39 da 3-39
                  
                  
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and macd_differenza_2_min_ago < -13
                        and ma3_last < ma28_last
                        and deviation_ma100_sopra_ma300 > 0.70
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and 3<28 SE 100 MOLTO ALTA RISPETTO ALLA 300 OK COSI' and macd_differenza_2_min_ago < -13 - r 11828 A2y"
                        action = "sell"
                        
                        # 20 ott 2023 5-39 da 3-39
                        #  4 dic 2023 vende con 3-28 se macd diff 2 min ago < -13

                    
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < -0.18
                        and deviation_ma100_sopra_ma300 < 0.70
                        and deviation_sell < -0.10
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and deviation_ma39 < -0.18 SE 100 VICINA ALLA 300 C'E' DEV SELL < -0.10  - r 11839 b"
                        action = "sell"
                        
                        
                     
                    elif (      
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last
                        and deviation_sell < -0.215
                        and ma3_last < ma50_last
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and (deviation_sell < -0.215 and ma3_last < ma50_last)  - r 11853 A"
                        action = "sell"
                        
                        # 20 feb 2023 aggiunta se 200>450
                        # 20 feb 2023 dev_sell a -0.20 da -0.18
                        # 24 feb 2023 dev_sell -0.215 da -0.20
                        
                    elif (      
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        and deviation_sell < -0.19
                        and ma3_last < ma50_last
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and (deviation_sell < -0.18 and ma3_last < ma50_last)  - r 11853 B"
                        action = "sell"
                        
                        # 20 feb 2023 aggiunta se 300<450
                        # 20 feb 2023 dev_sell a -0.19 da -0.18
                    
                    
                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < -0.23
                        and ma2_last < ma2_2_min_ago
                        and ma200_last > ma200_60_min_ago
                        and ma300_last > ma300_301_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and deviation_ma39 <-0.23 - r 11864 A"
                        action = "sell"
                        
                        # 21 gen 2023 con 300> 5 ore dev ma39 <-0.23 da -0.22 
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma39 < -0.22
                        and ma2_last < ma2_2_min_ago
                        and ma200_last > ma200_60_min_ago
                        and ma300_last < ma300_301_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and deviation_ma39 <-0.22 - r 11864 B"
                        action = "sell"
                        
                        
                        
                  
                    elif (      
                        ma50_last > ma50_2_min_ago
                        and deviation_sell < -0.21
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50 > and (deviation_sell < -0.21 and ma3_last < ma50_last)  - r 11876"
                        action = "sell"
                        
                       
                    
                    
                        ##################################################################################################################### 
                     
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma450_last > ma450_120_min_ago

                        and ma5_last < ma100_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (60-90 min) con ma50> E 450> 2 ore  and 5-100 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 11892 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 21 lug 2022 5-69 da 5-50 dopo le dolomiti
                        
                        # > estate 5-78 da 5-69
                        #  6 ago 2025 SE and ma450_last > ma450_120_min_ago allora 5-100 da 5-78



                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma450_last < ma450_120_min_ago

                        and ma5_last < ma78_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (60-90 min) con ma50> e 450< 2 ore and 5-78 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 11892 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 21 lug 2022 5-69 da 5-50 dopo le dolomiti
                        
                        # > estate 5-78 da 5-69
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and (ma4_prev > ma78_prev and ma4_last < ma78_last)
                        and deviation_sell > 0.57 and deviation_sell < 0.80
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50> and incrocio 4-78 CON 100-300 > 0.30 and deviation_sell 0.57-0.80 FINTA ALLA RONALDO - r 11906 A"
                        action = "sell"
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.30
                        and (ma4_prev > ma39_prev and ma4_last < ma39_last)
                        and deviation_sell > 0.57 and deviation_sell < 0.80
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con ma50> e incrocio 4-39 con 100-300 < 0.30 e dev_sell 0.57-0.80 FINTA ALLA RONALDO - r 11906 B"
                        action = "sell"

                        # 19 gen 2025 4-39 da 4-25
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma450_last > ma450_720_min_ago
                        and (ma5_prev > ma39_prev and ma5_last < ma39_last)
                        and deviation_sell > 0.81 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (60-90 min) con ma50 > and incrocio 5-39 and deviation_sell 0.81 - 1.49 RABONA ALLA RONALDO con 450 > 720 min - r 11919 a"
                        action = "sell"

                        # ma ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                        # 5-28 da 3-18 dopo dolomiti



                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last

                        and ma450_last < ma450_720_min_ago
                        and (ma5_prev > ma69_prev and ma5_last < ma69_last)
                        and deviation_sell > 0.81 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (60-90 min) se ma50 > e incr 5-69 e dev_sell 0.81 - 1.49 RABONA RONALDO con 450 < 720 min  - r 11919 B1"
                        action = "sell"

                        # ma ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                        # 5-28 da 3-18 dopo dolomiti
                        # 17 feb 2025 sell con 5-69 da 5-28 se ma300_last > ma450_last


                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last

                        and ma450_last < ma450_720_min_ago
                        and (ma5_prev > ma50_prev and ma5_last < ma50_last)
                        and deviation_sell > 0.81 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (60-90 min) se ma50 > e incrocio 5-50 e dev_sell 0.81 - 1.49 RABONA RONALDO con 450 < 720 min  - r 11919 B2"
                        action = "sell"

                        # ma ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                        # 5-28 da 3-18 dopo dolomiti
                        # 17 feb 2025 sell con 5-50 da 5-28 ma300_last < ma450_last
                    
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma34_prev and ma3_last < ma34_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and deviation_ma100_sopra_ma200 > 0.45
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (60-90 min) con ma50 > CON 100>200 > 0.45 incrocio 3-34 (!) and dev_sell 1.50 - 2.70 DOPPIO PASSO RONALDO - r 11943"
                        action = "sell"
                        
                        # 6 giu 2022 3-34 da 3-13
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma25_prev and ma5_last < ma25_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and deviation_ma100_sopra_ma200 < 0.45
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (60-90 min) con ma50 > CON 100>200 < 0.45 incrocio 3-16 and dev_sell 1.50 - 2.70 DOPPIO PASSO RONALDO - r 11959"
                        action = "sell"
                        
                        # 6 giu 2022 3-16 da 3-13
                        # 5-25 da 3-16 dopo dolomiti
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (60-90 min) con ma50 > incrocio 3-20 and dev_sell > 2.71 STIAMO TRA GLI ANGELI, compa ! - r 11983"
                        action = "sell"
                        
                        
                    
                    ######################################################################################## trend discendente con PERDITA BASE
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma100_last < ma100_60_min_ago
                        
                        and deviation_ma39 < -0.17
                        and deviation_sell < -0.10
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) TREND < con PERDITA BASE con ma50 < con deviation_ma39 < -0.17 and dev_sell < -0.12 - r 11999 A"
                        action = "sell"
                        
                        # and ma3_last < ma39_last
                        # and deviation_sell < 0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare ! POI STIAMO GIA' AL SELL 2 -le ma hanno avuto piu' tempo di salire
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        # > estate dev sell -0.10 da 0.10
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        and ma100_last < ma100_60_min_ago
                        
                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.11
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con TREND< con PERDITA BASE con ma50 < con deviation_ma39 < -0.01 and dev_sell < -0.11 - r 11999 B"
                        action = "sell"
                        
                        # and ma3_last < ma39_last
                        # and deviation_sell < 0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare ! POI STIAMO GIA' AL SELL 2 - le ma hanno avuto piu' tempo di salire
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        #  9 mag 2023 dev sell a -0.11 da -0.10
                        #  9 mag 2023 dev 39 a -0.01 da -0.17
                    
                    

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.13
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con TREND < con PERDITA BASE  con ma50 < con incrocio 3-78 and dev_sell < -0.13 - r 12018"
                        action = "sell"
                        
                       
                        
                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma100_sopra_o_sotto_ma100_60_min_ago > 0.20
                        and ma5_last < ma300_last
                        

                        and ma50_last < ma50_2_min_ago
                        and ma50_last < ma59_last 
                        
                        
                        and deviation_ma39 < 0.08
                        
                        and deviation_ma5_sotto_ma200 > -0.80
                
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.30
                    ):
                        sell = "SELL 2 (60-90 min) con 50<59 e 5<300 con 100 che se ngricca no poco - r 12020"
                        action = "sell"

                        # 12 mag 2025 aggiunta questa.
                        # 12 mag 2025 se 100 se ngricca no poco e 5 va sotto 300 vendi.




                    ######################################################## trend discendente con POCA PERDITA TOLLERATA

                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.25
                        
                        and ma100_last > ma100_60_min_ago
                        and ma100_last > ma200_last
                        
                        and deviation_ma39 < -0.18
                        and deviation_sell < -0.22
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con TREND < con POCA PERDITA TOLLERATA con ma50 < con deviation_ma39 <-0.17 and dev_sell < -0.22 - r 12037 a"
                        action = "sell"
                        
                        # and ma3_last < ma39_last
                        # and deviation_sell < -0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare ! POI STIAMO GIA' AL SELL 2 -le ma hanno avuto piu' tempo di salire
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.25
                        and deviation_ma100_sopra_ma300 > -0.25
                        
                        and ma100_last > ma100_60_min_ago
                        and ma100_last > ma200_last
                        
                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.10
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < -5
                    ):
                        sell = "SELL 2 (60-90 min) con TREND < con POCA PERDITA TOLLERATA con ma50 < con deviation_ma39 < -0.01 and dev_sell < -0.10 - r 12037 B"
                        action = "sell"
                        
                        # and ma3_last < ma39_last
                        # and deviation_sell < -0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare ! POI STIAMO GIA' AL SELL 2 - le ma hanno avuto piu' tempo di salire
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        # dev 39 a -0.01 da -0.17
                        # dev sell a -0.10 da -0.20
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < -0.25
                        
                        
                        and ma100_last > ma100_60_min_ago
                        and ma100_last > ma200_last
                        
                        and deviation_ma39 < -0.18
                        and deviation_sell < -0.20
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con TREND < con POCA PERDITA TOLLERATA con ma50 < con deviation_ma39 <-0.17 and dev_sell < -0.20 - r 12037 c"
                        action = "sell"
                        
                        # and ma3_last < ma39_last
                        # and deviation_sell < -0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare ! POI STIAMO GIA' AL SELL 2 -le ma hanno avuto piu' tempo di salire
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        
                       
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and ma100_last < ma200_last
                        
                        and deviation_ma39 < -0.18
                        and deviation_sell < -0.15
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con TREND < con POCA PERDITA TOLLERATA con ma50 < con deviation_ma39 <-0.17 and dev_sell < -0.15 - r 12060"
                        action = "sell"
                        
                        # and ma3_last < ma39_last
                        # and deviation_sell < -0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare ! POI STIAMO GIA' AL SELL 2 -le ma hanno avuto piu' tempo di salire
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        
                       
                    

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.14
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con POCA PERDITA TOLLERATA con ma50 < con incrocio 3-78 and deviation_sell < -0.14 - r 12087"
                        action = "sell"
                        
                        
                    
                    
                    ################################################################################## trend discendente con MOLTA PERDITA TOLLERATA
                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma5_last < ma90_last
                        and deviation_sell < -0.15
                        and deviation_ma100_sopra_ma300 > 0.50
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con MOLTA PERDITA TOLLERATA con ma50 < con 5<90 con 100 sopra 300 < 0.50 - r 12105 A"
                        action = "sell"
                        
                        # questa anticipa di una ndecchia la prossima
                        # 25 ottobre 2022 5-90 da 3-59
                        # 23 feb 2023 aggiunta di deviation_sell < -0.15
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma59_last
                        and deviation_ma100_sopra_ma300 < 0.50
                        and deviation_sell < -0.25
                        
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con MOLTA PERDITA TOLLERATA con ma50 < con 3 < 59 con 100 sopra 300 < 0.50 - r 12123 b"
                        action = "sell"
                        
                        # questa anticipa di una ndecchia la prossima
                        
                        
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (deviation_ma39 < -0.22 or ma5_last < ma450_last)
                        
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con MOLTA PERDITA TOLLERATA con ma50 < con dev_ma39 < -0.22 or 5<450  - r 12140"
                        action = "sell"
                        
                        # and ma3_last < ma33_last
                        # and deviation_sell < 0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        
                        # > vacanza -0.29 da -0.19
                        # 13 set 2023 dev 39 -0.22 da -0.29
                        #  7 mag 2025 aggiunta or ma5_last < ma450_last

                        
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.15
                        
                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) con MOLTA PERDITA TOLLERATA con ma50 < con incrocio 3-78 and deviation_sell < -0.15 - r 12169"
                        action = "sell"
                        
                        
                        
                        
                    # AGGIUNTA TARDIVA MA FORSE NECESSARIA !
                    
                    elif (
                        ma50_last <= ma50_2_min_ago
                        
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and delta_300_100 < delta_300_100_60_min
                   
                        and deviation_sell < -0.118
                        and ma2_last <= ma2_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) AGGIUNTA TARDIVA MA FORSE NECESSARIA ! delta 300-100 < and deviation_sell < -0.12 - r 12191 A"
                        action = "sell"
                        
                        # 20 feb 2023 dev_sell a -0.115 da -0.12
                        # 25 mag 2023 dev_sell a -0.118 da -0.115
                        
                        
                        
                    # AGGIUNTA TARDIVA MA FORSE NECESSARIA !

                    elif (
                        ma50_last < ma50_2_min_ago
                        
                        and ma100_last < ma200_last
                        and ma200_last < ma300_last
                        
                        and ma200_last < ma200_120_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and delta_300_100 > delta_300_100_60_min
                   
                        and deviation_sell < -0.123
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 (60-90 min) AGGIUNTA TARDIVA MA FORSE NECESSARIA ! delta 300-100 > and deviation_sell < -0.123 and macd < macd 2 min ago - r 12191 B"
                        action = "sell"
                        
                        # 17 mar 2023 dev sell a -0.12 da -0.10
                        #  4 giu 2023 dev sell a -0.123 da -0.12
                        #  4 giu 2023 aggiunto macd < macd 2 min ago


                    elif (
                        ma78_last > ma78_120_min_ago
                        and delta_DNA_1 < delta_DNA_2

                        and macd_differenza_2_min_ago < -0.30
                        
                        
                        and ma50_last < ma59_last
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.02
                
                        
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80

                        and ma2_last < ma2_2_min_ago 
                        and ma8_last < ma8_2_min_ago 
                        and macd < macd_2_min_ago

                    ):
                        sell = f"SELL 2 (60-90 min) giorno - EX CS CON 50<59 E dev 3-39 < 0.05 e dev_sell < 0.02 e ma50< - r 12230 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"
                        
                        # 20 nov 2023 and macd < macd_2_min_ago
                        # 26 ott 2025 aggiunte pg
                        # 26 ott 2025 se giorno aggiungo deve essere anche ma8_last < ma8_2_min_ago



                    elif (
                        ma78_last > ma78_120_min_ago

                        and delta_DNA_1 > delta_DNA_2
                        and macd_differenza_2_min_ago < -0.30
                        
                        
                        and ma50_last < ma59_last
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.02
                
                        
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80

                        and ma2_last < ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = f"SELL 2 (60-90 min) notte - EX CS CON 50<59 E dev 3-39 < 0.05 e dev_sell < 0.02 e ma50< - r 12230 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"
                        
                        # 20 nov 2023 and macd < macd_2_min_ago
                        # 26 ott 2025 aggiunte pg
                        # 26 ott 2025 se notte ok cosi'
                    


              
                     
                
                ######################################################################################################### SESSIONE 2 ( da 90 min a 110 min )
                
                # VENDITA 2 - da 90 minuti a 110 minuti = da 5400 secondi a 6600 secondi
                
                elif seconds_since_last_trade > 5400 and seconds_since_last_trade <= 6600:    
                
                    ###################################################################################   RIGHE DEL COMPA raddoppiate PER AUMENTO TOLLERANZA
                    
                    
                    if (  
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and ma200_last > ma200_60_min_ago
                    ):    
                        sell = "SELL 2 (90-110 min) con ma50 > and deviation_ma39 <-0.22 (no ma3<ma39) - r 12237"
                        action = "sell"
                        
                   
                
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.21 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 2 90-110 min con ma50 > and (deviation_sell < 0.21 and ma3_last < ma50_last) - r 12249"
                        action = "sell"
                        
                        
                        
                        
                    elif (  
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.23
                        and ma200_last < ma200_60_min_ago
                    ):    
                        sell = "SELL 2 90-110 min con ma50 > and deviation_ma39 < -0.23 - r 12261"
                        action = "sell"
                        
                        
                        
                   
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.22 
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 2 90-110 min con ma50 > and (deviation_sell < -0.22 and ma3_last < ma50_last) - r 12274"
                        action = "sell"
                        
                        
                        
                    #########################################################################################################
                   
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma100_last > ma200_last
                        and ma5_last < ma90_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 90-110 min con ma50 > and 5-90 (!) and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA and ma100_last > ma200_last - r 12289 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 25 set 2025 5-90 da 5-78


                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma100_last < ma200_last
                        and ma5_last < ma50_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 90-110 min con ma50 > and 5-50 (!) and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA and ma100_last > ma200_last - r 12289 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                     
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.40
                        and ma4_last < ma48_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 90-110 min con ma50 > con 4-48 CON 100 sopra 300 > 0.40 and deviation_sell 0.57-0.90 DRIBBLING ALLA RONALDO - r 12303 a"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                        and ma4_last < ma69_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 90-110 min con ma50 > con 4-69 CON 100 sopra 300 > 0.40 and deviation_sell 0.57-0.90 DRIBBLING ALLA RONALDO - r 12315 B"
                        action = "sell"
                        
                        # 17 mar 2023 4-69 da 4-20 questa e' la base
                        # ATTENZIONE dovrai aggiungere una nuova condizione speciale pochi maledetti e subito tra 0.80 e 1.20
                        
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and (ma4_prev > ma50_prev and ma4_last < ma50_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 90-110 min con 5-300 > 0.40 e con ma50 > incrocio 4-50 and deviation_sell 0.91 - 1.49 - r 12328 A"
                        action = "sell"

                        # ma 3-48 mi evita la ricompra e la rivendita con perdita !
                        # ma 3-15 vendeva troppo presto. guardando il grafico da piu' lontano.
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.40
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 90-110 min con 5-300 < 0.40 e con ma50 > incrocio 3-33 and deviation_sell 0.91 - 1.49 - r 12328 B"
                        action = "sell"

                        # ma 3-48 mi evita la ricompra e la rivendita con perdita !
                        # ma 3-15 vendeva troppo presto. guardando il grafico da piu' lontano.
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 90-110 min con ma50 > incrocio 3-28 con ma300 > 120_min_ago and deviation_sell 1.50 - 2.70 - r 12343a"
                        action = "sell"





                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma300_last

                        and ma300_last < ma300_120_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 90-110 min con ma50 > incrocio 3-33 con ma300 < 120_min_ago and deviation_sell 1.50 - 2.70 - r 12343 B1"
                        action = "sell"

                        # 13 apr 2025 se ma100_last > ma300_last
                        # 13 apr 2025 sell a 3-33 da 3-18


                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma300_last

                        and ma300_last < ma300_120_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 90-110 min con ma50 > incrocio 3-18 con ma300 < 120_min_ago and deviation_sell 1.50 - 2.70 - r 12343 B2"
                        action = "sell"

                        # 13 apr 2025 se ma100_last < ma300_last
                        # 13 apr 2025 sell a 3-25 da 3-18



                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 90-110 min con ma50 > incrocio 3-11 (!) and deviation_sell > 2.71 - r 12355"
                        action = "sell"
                        
                        
                        

                    ######################################################################################## con trend discendente


                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma25_last > ma300_last

                        and deviation_ma100_sopra_ma300 < 0.30
                        and (ma4_prev > ma59_prev and ma4_last < ma59_last)
                        and deviation_sell > 0.57 and deviation_sell < 0.80
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (90-110 min) con ma50> e 4-59 e 25>300 e 100-300 < 0.30 and deviation_sell 0.57-0.80 FINTA ALLA RONALDO - r 12370 A1 x"
                        action = "sell"

                        # 20 gen 2025 4-39 da 4-25
                        # 25 ago 2025 4-59 da 4-39 se 25>300

                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma25_last < ma300_last

                        and deviation_ma100_sopra_ma300 < 0.30
                        and (ma4_prev > ma49_prev and ma4_last < ma49_last)
                        and deviation_sell > 0.57 and deviation_sell < 0.80
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (90-110 min) con ma50> e 4-49 e 25<300 e 100-300 < 0.30 and deviation_sell 0.57-0.80 FINTA ALLA RONALDO - r 12370 A1 y"
                        action = "sell"

                        # 20 gen 2025 4-39 da 4-25
                        # 25 ago 2025 4-49 da 4-39 se 25<300



                    
                    elif (  
                        ma50_last < ma50_2_min_ago
                        and delta_450_300 < delta_450_300_60_min
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.25
                        and deviation_trend_ma100 > 0.10
                    ):
                        sell = "SELL 2 90-110 min con ma50 < MA ma100 > con deviation_ma39 <-0.25 - r 12370 A2"
                        action = "sell"
                        
                        # se 450-300 GIORNO dev_39 0.25

              
                        
                    elif (  
                        ma50_last < ma50_2_min_ago
                        and delta_450_300 > delta_450_300_60_min
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.23
                        and deviation_trend_ma100 > 0.10
                    ):
                        sell = "SELL 2 90-110 min con ma50 < MA ma100 > con deviation_ma39 <-0.23 - r 12370 B"
                        action = "sell"
                        
                        # se 450-300 NOTTE dev_39 0.24
                        # 25 ott 2023 and deviation_ma39 < -0.23 da < -0.24
                        
              
                    
                
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.22
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 > 0.10
                    ):
                        sell = "SELL 2 90-110 min con ma50 < MA ma100 > and (deviation_sell < -0.22 and ma3_last < ma39_last) - r 12383"
                        action = "sell"
                        
                        # 1 ott dev sell -0.22 da -0.20
                  
                
                        
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and deviation_sell < -0.30
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 90-110 min con ma50 < MA ma100 < con deviation_ma39 <-0.22 and deviation_sell < -0.30 - r 12395"
                        action = "sell"
                        
                        
                
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.24
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 90-110 min con ma50 < MA ma100 < and (deviation_sell < -0.24 and ma3_last < ma39_last) - r 12408a"
                        action = "sell"
                        
                        # 14 feb 2023 -0.24 da -0.20

                  
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.22
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 90-110 min con ma50 < MA ma100 < and (deviation_sell < -0.24 and ma3_last < ma39_last) - r 12408b"
                        action = "sell"
                        
                        # 14 feb 2023 -0.24 da -0.20
                        #  1 ago 2023 dev sell -0.22 da -0.24 con 300 < 300 120 min ago
                    
                    
                    ########################################################################################## AUMENTA PERDITA TOLLERATA e divido in 2 il compa
                    
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.235
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 compa 90-110 min  con ma50 < con deviation_ma39 <-0.235 con > PERDITA TOLLERATA - r 12425"
                        action = "sell"



                    elif (  
                        ma50_last < ma50_2_min_ago 
                        
                        and deviation_trend_ma100_300_min_ago > 1.00
                        and ma5_last < ma200_last
                        
                        and ma200_last > ma300_last
                        and ma200_last > ma450_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 compa 90-110 min con ma50< e 5<200 durante un trend al rialzo - r 12426"
                        action = "sell"

                        # 19 mag 2025 aggiunta questa perche' la precedente aveva venduto troppo tardi.
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.24 
                        and ma3_last < ma39_last
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 compa 90-110 min con ma50 < (deviation_sell < -0.24 and ma3_last < ma39_last) con > PERDITA TOLLERATA - r 12440"
                        action = "sell"

                  

                    #............................................................................................................................ CONDIZIONI SPECIALI IMPORTATE
                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                        
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.05
                        
                        and deviation_ma100_sopra_ma300 < 0.40
                        and deviation_ma5_sotto_ma200 > -0.50
                        
                        and ma2_last < ma2_2_min_ago 
                
                    ):
                        sell = "SELL 2 90-110 min EX condizione speciale r 16045 GIORNO con ma300 < 5 ore - dev 3-39 < 0.05 and dev_sell < -0.05 - con ma50 < e con ma78 > - r 12441a"
                        action = "sell"
                        
                        # 27 ott 2023 and deviation_sell < -0.05 da -0.105

                     
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        and delta_1_50_20 > delta_2_50_20

                        and ma50_last <= ma50_2_min_ago
                        
                        and delta_150_100 <= delta_150_100_60_min
                        
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        
                        and deviation_ma100_sopra_ma300 < 0.40
                        and deviation_ma5_sotto_ma200 > -0.50
                        
                        and ma2_last < ma2_2_min_ago 
                
                    ):
                        sell = "SELL 2 (90-110 min) se 300 < e se doppio delta 50-20 notte vendo con incrocio al ribasso 5-100 e vafangulo - r 12441 B"
                        action = "sell"
                        
                        # 27 ott 2023 and deviation_sell < -0.05 da -0.105
                        #  7 NOV 2023 and deviation_sell < -0.06 da -0.05
                        # 28 mag 2025 se 300< e se doppio delta 50-20 notte vendo con incrocio al ribasso 5-100 e vafangulo !



                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.03
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < 6
                        and ma2_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 2 (90-110 min) EX cond spec 16047 B1Y con ma 50 < ma 50 2 min ago con ma300 > 5 ore e dev 3-39 < 0.05 and dev_sell < -0.03 - r 12442"
                        action = "sell"
                        
                        # 11 nov 2023 dev sell -0.03 da -0.112
                        # 11 nov 2023 aggiunta and ma2_differenza_2_min_ago < -2

              
                    
                    
                        
                        
                 
                ##########################################################################################################
                
                # VENDITA 2 - da 110 minuti a 240 = da 6601 secondi a 14499 secondi
                
                elif seconds_since_last_trade > 6601 and seconds_since_last_trade <= 14400:    
                    
                    ###################################################################################   RIGHE DEL COMPA raddoppiate
                    
                    if (  
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma200_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and deviation_sell < -0.25 
                        and ma200_last > ma200_60_min_ago
                    ):    
                        sell = "SELL 2 (110-240 min) con ma50 > and deviation_ma39 <-0.22 (no ma3<ma39) - r 12450"
                        action = "sell"
                        
                        
                    if (  
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma200_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and ma200_last > ma200_60_min_ago
                    ):    
                        sell = "SELL 2 (110-240 min) con ma50 > and deviation_ma39 <-0.22 (no ma3<ma39) - r 12451"
                        action = "sell"
                        
                        # POTREBBE ESSERE SITUAZIONE DI CROLLO SOLO CON 39 E SENZA DEVIATION SELL
                        
                    
                
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.21 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 2 (110-240 min) con ma50 > and (deviation_sell < 0.21 and ma3_last < ma50_last) - r 12452"
                        action = "sell"
                        
                        
                        
                        
                    elif (  
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.23
                        and ma200_last < ma200_60_min_ago
                    ):    
                        sell = "SELL 2 (110-240 min) con ma50 > and deviation_ma39 < -0.23 - r 12453"
                        action = "sell"
                        
                   
                
                
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.22 
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 2 (110-240 min) con ma50 > and (deviation_sell < -0.22 and ma3_last < ma50_last) - r 12454"
                        action = "sell"
                        
                        
                        
                        
                    ################################################################################### fare maradona 1 e maradona 2 se ma2 sta sopra ma100
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma200_last
                        and ma300_last > ma300_180_min_ago
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 (110-240 min) con ma300 > 300 180 min ago e con ma50 > and 5-200 (!) and dev_sell 0.25-0.56 - FINTA ALLA MARADONA - r 12455 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 9 GIU 2022 5-59 da 5-50
                        # > estate 5-100 da 5-59
                        # 26 set se 300 > 300 180 min sell con 5-200 (!) da 5-100
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma125_last
                        and ma300_last < ma300_180_min_ago
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 2 (110-240 min) con ma300 > 300 180 min ago e con ma50 > and 5-125 (!) and dev_sell 0.25-0.56 - FINTA ALLA MARADONA - r 12455 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        #  9 GIU 2022 5-59 da 5-50
                        # > estate 5-100 da 5-59
                        # 30 ago 2023 macd < macd 2 min ago
                        # 24 dic 2022 5-125 da 5-100
                        # 24 dic 2022 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        # 24 dic 2022 and aggiunta macd_differenza_2_min_ago < -0.50



                    elif (
                        ma50_last > ma50_2_min_ago
                        and delta_CV_300_25_last < delta_CV_300_25_45_min_ago

                        and ma5_last < ma90_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (110-240 min) con CV GIORNO e con ma50> sell con 5-90 and deviation_sell 0.57-0.90 DRIBBLING ALLA RONALDO - r 12456 a"
                        action = "sell"
                        
                        # > estate 4-78 da 4-20
                        #  8 ott 2025 se CV GIORNO ALLORA VENDE CON 5-90



                    elif (
                        ma50_last > ma50_2_min_ago
                        and delta_CV_300_25_last > delta_CV_300_25_45_min_ago

                        and ma4_last < ma78_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 (110-240 min) con CV NOTTE e con ma50> sell con 4-78 and deviation_sell 0.57-0.90 DRIBBLING ALLA RONALDO - r 12456 b"
                        action = "sell"
                        
                        # > estate 4-78 da 4-20
                        #  8 ott 2025 se CV NOTTE ALLORA ok cosi'
                        
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and (ma4_prev > ma90_prev and ma4_last < ma90_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (110-240 min) con ma50 > incrocio 4-90 and deviation_sell 0.91 - 1.49 - r 12457 A"
                        action = "sell"

                        # evitare la ricompra e la rivendita con perdita !
                        # 18 set 4-42 da 3-15
                        # 26 ott 4-90 da 4-42
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and (ma4_prev > ma78_prev and ma4_last < ma78_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (110-240 min) con ma50 > incrocio 4-78 and deviation_sell 0.91 - 1.49 - r 12457 B"
                        action = "sell"

                        # evitare la ricompra e la rivendita con perdita !
                        # 18 set 4-42 da 3-15
                        # 26 ott 4-78 da 4-42
                        
                     
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma125_prev and ma3_last < ma125_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (110-240 min) con ma50 > incrocio 3-125 and deviation_sell 1.50 - 2.70 - r 12458"
                        action = "sell"
                        
                        # > estate 3-78 da 3-13
                        # 17 gen 2023 3-125 da 3-78
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (110-240 min) con ma50 > incrocio 3-20 con 300>450 and deviation_sell > 2.71 - r 12459 A"
                        action = "sell"
                        
                        # 16 mar 2023 3-20 da 3-11 con 300>450
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 (110-240 min) con ma50 > incrocio 3-13 (!) con 300<450 and deviation_sell > 2.71 - r 12459 B"
                        action = "sell"
                        
                        # 16 mar 2023 3-13 da 3-11 con 300<450
                        

                    ######################################################################################## con trend discendente
                    
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and deviation_ma100_sopra_ma300 > 0.30
                        
                        and deviation_ma39 < -0.23
                        and deviation_trend_ma100 > 0.10
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 2 110-240 min con ma50 < MA ma100 > con deviation_ma39 <-0.23 and macd_differenza_2_min_ago < -0.23 - r 12460 a"
                        action = "sell"
                        
                        # 12 apr 2023 dev_ma39 < -0.245 da -0.25
                        # 19 ott 2023 dev_ma39 < -0.23 da -0.245 con dev 100-300 > 0.30

                  
                  
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and deviation_ma100_sopra_ma300 < 0.30
                        and deviation_sell < -0.10
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 2 110-240 min con ma50 < MA ma100 > con dev sell < -0.10 and macd_differenza_2_min_ago < -0.25 - r 12460 b"
                        action = "sell"
                        
                        # 12 apr 2023 dev_ma39 < -0.245 da -0.25
              
                    
                
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.20 
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 > 0.10
                    ):
                        sell = "SELL 2 110-240 min con ma50 < MA ma100 > and (deviation_sell < -0.20 and ma3_last < ma39_last) - r 12461"
                        action = "sell"
                        
                  
                        
                    elif (  
                        ma50_last < ma50_2_min_ago
                        and ma150_last > ma300_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 110-240 min con ma50 < MA ma100 < con deviation_ma39 <-0.22 and 150 > 300 - r 12462 A"
                        action = "sell"
                        
                        
                    elif (  
                        ma50_last < ma50_2_min_ago
                        and ma150_last < ma300_last
                        and deviation_trend_ma100 < 0.10
                        
                        and deviation_ma39 < 0.05
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 110-240 min con ma50 < MA ma100 < con deviation_ma39 <-0.215 and 150 < 300 and deviation_sell < -0.01 - r 12462 B"
                        action = "sell"
                        
                        # 25 gen 2023 dev_39 0.215 da 0.22
                        # 18 dic 2023 aggiunta and deviation_sell < -0.01
                        # 18 dic 2023 and deviation_ma39 a 0.05 da -0.21 ( ma39 va da sola soltanto con grande rialzo cioe' con ma100 molto sopra ma300 )
                        # 18 dic 2023 aggiunta and macd < macd_2_min_ago
                
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago
                        and ma450_last > ma450_720_min_ago
                        and deviation_sell < -0.235
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 110-240 min con ma50 < MA ma100 < and (deviation_sell < -0.235 and ma3_last < ma39_last) CON 450> - r 12463 A"
                        action = "sell"
                        
                        # 17 gen 2023 da -0.235 da -0.18
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago
                        and ma450_last < ma450_720_min_ago
                        and deviation_sell < -0.23
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 110-240 min con ma50 < MA ma100 < and (deviation_sell < -0.23 and ma3_last < ma39_last) CON 450< - r 12463 B"
                        action = "sell"
                        
                        # 17 gen 2023 da -0.23 da -0.18
                    
                    
                    
                    ########################################################################################## AUMENTA PERDITA TOLLERATA e divido in 2 il compa
                    
                    
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.24
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 110-240 min con ma50 < con deviation_ma39 <-0.24 con > PERDITA TOLLERATA - r 12464"
                        action = "sell"
                        
                        
                    
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.24 
                        and ma3_last < ma39_last
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 110-240 min con ma50 < (deviation_sell < -0.24 and ma3_last < ma39_last) con > PERDITA TOLLERATA - r 12465"
                        action = "sell"
                        
                        
                        


                  
                    # ATTENZIONE : DOPO 110 MIN forse E' NECESSARIA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.19
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago > 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12466 A1 prova 1"
                        action = "sell"
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago < 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12467 A1 prova 2"
                        action = "sell"
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.10
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago > 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12468 A1 prova 3"
                        action = "sell"
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < 0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago < 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell < 0.01 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12469 A1 prova 4"
                        action = "sell"
                        
                        # 16 set 2023 and dev_sell a 0.01 da -0.01
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.10
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago > 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12470 A1 prova 5"
                        action = "sell"

                    
                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago < 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12471 A1 prova 6"
                        action = "sell"
                        
                        

                  
                    elif (    
                        ma3_last < ma100_last
                        
                        and ma300_last > ma300_301_min_ago
                        and deviation_sell < -0.19
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12472 A1"
                        action = "sell"
                        
                        # > estate -0.15 da +0.02
                        # 10 dic 2022 -0.17 da -0.15
                        # 26 feb 2023 -0.19 da -0.17


                  



                  
                        
                        
                    elif (    
                        ma3_last < ma100_last
                        and ma3_last < ma450_last
                        and ma300_last > ma300_301_min_ago
                        and deviation_sell < -0.165
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min con dev sell -0.165 and 3 < 450 and 300 > 300 5 ore fa and macd < macd 2 min ago - r 12473 A2"
                        action = "sell"
                        
                        # > estate -0.15 da +0.02
                        # 10 dic 2022 -0.17 da -0.15
                        # 11 ago 2023 -0.165 da -0.17
                  
                  
                    elif (    
                        ma3_last < ma100_last
                        and ma300_last < ma300_301_min_ago
                        and deviation_sell < -0.168
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 2 110-240 min  forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa - r 12473 B"
                        action = "sell"
                        
                        # > estate -0.15 da +0.02
                        # 10 dic 2022 -0.16 da -0.15
                        # 25 gen 2023 -0.168 da -0.16
                    
                    
                    elif (    
                        ma3_last < ma78_last
                        and ma450_last > ma450_300_min_ago

                        and deviation_sell > 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -6
                        and macd_differenza_2_min_ago < -0.25
                    ):
                   
                        sell = "SELL 2 110-240 min con 3-78 vedi 25 luglio 2023 ore 16:28 NON AVEVA VENDUTO NULLA ! - r 12474 a"
                        action = "sell"
                        
                        # 16 ago 2023 3-78 da 3-39
                        # 29 mar 2025 se ma450_last > ma450_300_min_ago ok cosi'



                    elif (    
                        ma3_last < ma59_last
                        and ma450_last < ma450_300_min_ago

                        and deviation_sell > 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        
                        and macd_differenza_2_min_ago < -0.25
                    ):
                   
                        sell = "SELL 2 110-240 min con 3-78 vedi 25 luglio 2023 ore 16:28 NON AVEVA VENDUTO NULLA ! - r 12474 b"
                        action = "sell"
                        
                        # 16 ago 2023 3-78 da 3-39
                        # 29 mar 2025 se ma450_last < ma450_300_min_ago sell con ma3_last < ma59_last invece di 3-78



                    ################################################################################## importate condizioni speciali
                  
                    elif (
                        deviation_ma39 < -0.01
                        and deviation_sell < -0.013
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                        
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.20
                
                        and deviation_ma3_sotto_ma150 > -1.20
                        
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 110-240 min ex cond. spec r 15985 A1 ok 2 - SALVAGENTE con 3-39 < -0.01 e dev sell < -0.013 and dev_sell< -0.308 con ma50 < - r 12475"
                        action = "sell"
                
                        #  2 ott 2023 dev sell -0.013 da -0.02

                  
                ###############################################################################################################################
          
                elif seconds_since_last_trade > 14401:
                    
                    if (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and deviation_sell > 0.75
                        and ma5_last < ma100_last
                        and deviation_ma39 < 0.03

                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 2 > 240 min E 300 > 120 min ago e con ma50 < and dev 3-39 < 0.01 con > tolleranza - r 12480 A"
                        action = "sell"

                        # 18 feb 2025 se guadagno > 0.75% sell con 5-100 da 3-39
                        # 18 feb 2025 and deviation_sell > 0.75



                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago

                        and deviation_sell < 0.75
                        and ma3_last < ma39_last
                        and deviation_ma39 < 0.03

                        and deviation_trend_ma200 > -0.12
                        and ma200_last > ma300_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 2 > 240 min E 300 > 120 min ago e con ma50 < and dev 3-39 < 0.01 con > tolleranza - r 12480 B"
                        action = "sell"

                        # 18 feb 2025 se guadagno < 0.75% sell con 3-39 (resta uguale.)
                        
                        
                    elif (  
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma200_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and deviation_sell < -0.25 
                        and ma200_last > ma200_60_min_ago
                    ):    
                        sell = "SELL 2 dopo 240 min con ma50 > and deviation_ma39 <-0.22 (no ma3<ma39) - r 12481"
                        action = "sell"
                        
                        
                    if (  
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma200_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and ma200_last > ma200_60_min_ago
                    ):    
                        sell = "SELL 2 dopo 240 min con ma50 > and deviation_ma39 <-0.22 (no ma3<ma39) - r 12482"
                        action = "sell"
                        
                        # POTREBBE ESSERE SITUAZIONE DI CROLLO SOLO CON 39 E SENZA DEVIATION SELL
                        
                    
                
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.21 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "sessione 2 SELL dopo 240 min con ma50 > and (deviation_sell < 0.21 and ma3_last < ma50_last) - r 12489"
                        action = "sell"
                        
                        
                        
                        
                    elif (  
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.23
                        and ma200_last < ma200_60_min_ago
                    ):    
                        sell = "sessione 2 SELL 2 dopo 240 min con ma50 > and deviation_ma39 < -0.23 - r 12501"
                        action = "sell"
                        
                   
                
                
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.22 
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "sessione 2 SELL dopo 240 min con ma50 > and (deviation_sell < -0.22 and ma3_last < ma50_last) - r 12514"
                        action = "sell"
                        
                        
                        
                        
                    ################################################################################### fare maradona 1 e maradona 2 se ma2 sta sopra ma100
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma200_last
                        and ma300_last > ma300_180_min_ago
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 2 dopo 240 min con ma300 > 300 180 min ago e con ma50 > and 5-200 (!) and dev_sell 0.25-0.56 - FINTA ALLA MARADONA - r 12530 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 9 GIU 2022 5-59 da 5-50
                        # > estate 5-100 da 5-59
                        # 26 set se 300 > 300 180 min sell con 5-200 (!) da 5-100
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma100_last
                        and ma300_last < ma300_180_min_ago
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 dopo 240 min con ma300 > 300 180 min ago e con ma50 > and 5-100 (!) and dev_sell 0.25-0.56 - FINTA ALLA MARADONA - r 12530 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        #  9 GIU 2022 5-59 da 5-50
                        # > estate 5-100 da 5-59
                        # 30 ago 2023 macd < macd 2 min ago
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma4_last < ma78_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 > 240 min con ma50 > con 4-78 and deviation_sell 0.57-0.90 DRIBBLING ALLA RONALDO - r 12544"
                        action = "sell"
                        
                        # > estate 4-78 da 4-20
                        
                        
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_120_min_ago
                        and (ma4_prev > ma90_prev and ma4_last < ma90_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 dopo 240 min con ma50 > incrocio 4-90 and deviation_sell 0.91 - 1.49 - r 12557 A"
                        action = "sell"

                        # evitare la ricompra e la rivendita con perdita !
                        # 18 set 4-42 da 3-15
                        # 26 ott 4-90 da 4-42
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_120_min_ago
                        and (ma4_prev > ma78_prev and ma4_last < ma78_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 dopo 240 min con ma50 > incrocio 4-78 and deviation_sell 0.91 - 1.49 - r 12557 B"
                        action = "sell"

                        # evitare la ricompra e la rivendita con perdita !
                        # 18 set 4-42 da 3-15
                        # 26 ott 4-78 da 4-42
                        
                     
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma125_prev and ma3_last < ma125_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 dopo 240 min con ma50 > incrocio 3-125 and deviation_sell 1.50 - 2.70 - r 12572"
                        action = "sell"
                        
                        # > estate 3-78 da 3-13
                        # 17 gen 2023 3-125 da 3-78
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma450_last
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 dopo 240 min con ma50 > incrocio 3-20 con 300>450 and deviation_sell > 2.71 - r 12584 A"
                        action = "sell"
                        
                        # 16 mar 2023 3-20 da 3-11 con 300>450
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma450_last
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 2 dopo 240 min con ma50 > incrocio 3-13 (!) con 300<450 and deviation_sell > 2.71 - r 12584 B"
                        action = "sell"
                        
                        # 16 mar 2023 3-13 da 3-11 con 300<450
                        

                    ######################################################################################## con trend discendente
                    
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and deviation_ma100_sopra_ma300 > 0.30
                        
                        and deviation_ma39 < -0.23
                        and deviation_trend_ma100 > 0.10
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 2 dopo 240 min con ma50 < MA ma100 > con deviation_ma39 <-0.23 and macd_differenza_2_min_ago < -0.23 - r 12598 a"
                        action = "sell"
                        
                        # 12 apr 2023 dev_ma39 < -0.245 da -0.25
                        # 19 ott 2023 dev_ma39 < -0.23 da -0.245 con dev 100-300 > 0.30

                  
                  
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and deviation_ma100_sopra_ma300 < 0.30
                        and deviation_sell < -0.10
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 2 dopo 240 min con ma50 < MA ma100 > con dev sell < -0.10 and macd_differenza_2_min_ago < -0.25 - r 12598 b"
                        action = "sell"
                        
                        # 12 apr 2023 dev_ma39 < -0.245 da -0.25
              
                    
                
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.20 
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 > 0.10
                    ):
                        sell = "SELL 2 dopo 240 min con ma50 < MA ma100 > and (deviation_sell < -0.20 and ma3_last < ma39_last) - r 12611"
                        action = "sell"
                        
                  
                        
                    elif (  
                        ma50_last < ma50_2_min_ago
                        and ma150_last > ma300_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 dopo 240 min con ma50 < MA ma100 < con deviation_ma39 <-0.22 and 150 > 300 - r 12623 A"
                        action = "sell"
                        
                        
                    elif (  
                        ma50_last < ma50_2_min_ago
                        and ma150_last < ma300_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.215
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 dopo 240 min con ma50 < MA ma100 < con deviation_ma39 <-0.215 and 150 < 300 - r 12623 B"
                        action = "sell"
                        
                        # 25 gen 2023 dev_39 0.215 da 0.22
                        
                        
                
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago
                        and ma450_last > ma450_720_min_ago
                        and deviation_sell < -0.235
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 dopo 240 min con ma50 < MA ma100 < and (deviation_sell < -0.235 and ma3_last < ma39_last) CON 450> - r 12636 A"
                        action = "sell"
                        
                        # 17 gen 2023 da -0.235 da -0.18
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago
                        and ma450_last < ma450_720_min_ago
                        and deviation_sell < -0.23
                        and ma3_last < ma39_last
                        and deviation_trend_ma100 < 0.10
                    ):
                        sell = "SELL 2 dopo 240 min con ma50 < MA ma100 < and (deviation_sell < -0.23 and ma3_last < ma39_last) CON 450< - r 12636 B"
                        action = "sell"
                        
                        # 17 gen 2023 da -0.23 da -0.18
                    
                    
                    
                    ########################################################################################## AUMENTA PERDITA TOLLERATA e divido in 2 il compa
                    
                    
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.24
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 compa dopo 240 min con ma50 < con deviation_ma39 <-0.24 con > PERDITA TOLLERATA - r 12653"
                        action = "sell"
                        
                        
                    
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.24 
                        and ma3_last < ma39_last
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 2 compa dopo 240 min con ma50 < (deviation_sell < -0.24 and ma3_last < ma39_last) con > PERDITA TOLLERATA - r 12667"
                        action = "sell"
                        
                        
                        


                  
                    # ATTENZIONE : DOPO 240 MIN forse E' NECESSARIA SOLO QUESTA !
                    
                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.19
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago > 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12681 A1 prova 1"
                        action = "sell"
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago < 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12681 A1 prova 2"
                        action = "sell"
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.10
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago > 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12681 A1 prova 3"
                        action = "sell"
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < 0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago < 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell < 0.01 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12681 A1 prova 4"
                        action = "sell"
                        
                        # 16 set 2023 and dev_sell a 0.01 da -0.01
                      

                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.10
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago > 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12681 A1 prova 5"
                        action = "sell"

                    
                    elif (    
                        ma3_last < ma100_last
                        and deviation_sell < -0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_240_min_ago < 0.10
                        
                        and ma300_last > ma300_301_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12681 A1 prova 6"
                        action = "sell"
                        
                        

                  
                    elif (    
                        ma3_last < ma100_last
                        
                        and ma300_last > ma300_301_min_ago
                        and deviation_sell < -0.19
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell -0.19 forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa and macd < macd 2 min ago - r 12681 A1"
                        action = "sell"
                        
                        # > estate -0.15 da +0.02
                        # 10 dic 2022 -0.17 da -0.15
                        # 26 feb 2023 -0.19 da -0.17


                  



                  
                        
                        
                    elif (    
                        ma3_last < ma100_last
                        and ma3_last < ma450_last
                        and ma300_last > ma300_301_min_ago
                        and deviation_sell < -0.165
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min con dev sell -0.165 and 3 < 450 and 300 > 300 5 ore fa and macd < macd 2 min ago - r 12681 A2"
                        action = "sell"
                        
                        # > estate -0.15 da +0.02
                        # 10 dic 2022 -0.17 da -0.15
                        # 11 ago 2023 -0.165 da -0.17
                  
                  
                    elif (    
                        ma3_last < ma100_last
                        and ma300_last < ma300_301_min_ago
                        and deviation_sell < -0.168
                        and ma2_last < ma2_2_min_ago
                    ):
                   
                        sell = "SELL 2 > 240 min forse E' NECESSARA SOLO QUESTA ! and 300> 300 5 ore fa - r 12681 B"
                        action = "sell"
                        
                        # > estate -0.15 da +0.02
                        # 10 dic 2022 -0.16 da -0.15
                        # 25 gen 2023 -0.168 da -0.16
                    
                    

                    elif (    
                        ma3_last < ma78_last
                        and deviation_sell > 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -6
                    ):
                   
                        sell = "SELL 2 > 240 min con 3-78 forse E' NECESSARA SOLO QUESTA ! vedi 25 luglio 2023 ore 16:28 NON AVEVA VENDUTO NULLA ! - r 12682"
                        action = "sell"
                        
                        # 16 ago 2023 3-78 da 3-39

                    ################################################################################## importate condizioni speciali
                  
                    elif (
                        deviation_ma39 < -0.01
                        and deviation_sell < -0.013
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                        
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.20
                
                        and deviation_ma3_sotto_ma150 > -1.20
                        
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 2 > 240 min ex cond. spec r 15985 A1 ok 2 - SALVAGENTE con 3-39 < -0.01 e dev sell < -0.013 and dev_sell< -0.308 con ma50 < - r 12683"
                        action = "sell"
                
                        #  2 ott 2023 dev sell -0.013 da -0.02

            ################################################################################################### SESSIONE 3
            
            elif self.session == 3:
                
                ################################################################################################### sessione 3 ( 0-3 min )
                
                if seconds_since_last_trade > 0 and seconds_since_last_trade <= 180:

                    # con ma50 >

                    if (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma18_last
                        and deviation_sell < -0.33
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 3 (0-3 min) con ma50 > and 3<18 and deviation_sell < -0.33 - r 12704"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                     
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma5_prev > ma25_prev and ma5_last < ma25_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.60
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 3 (0-3 min) con ma50 > and incrocio 5-25 and deviation_sell 0.25 - 0.60 MARADONA - r 12718"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 0.61 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (0-3 min) con ma50 > and incrocio 3-15 and deviation_sell 0.61 - 0.90 RONALDO - r 12732"
                        action = "sell"
                        
                        
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 (0-3 min) con ma50 > and incrocio 3-13 and deviation_sell 0.91 - 1.20 - r 12745"
                        action = "sell"
                        
                        
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 (0-3 min) con ma50 > and incrocio 3-11 and deviation_sell > 1.21 (che sarebbe come IL DRIBBLING ALLA RONALDO !) - r 12758"
                        action = "sell"
                        
                        
                        

                    ###########################################################################     trend in ribasso
                    

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (0-3 min) con ma50 < and incrocio 3-28 - r 12773"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (0-3 min) con ma50 < and incrocio 3-33 and deviation_sell -0.23 - r 12787"
                        action = "sell"
                        
                        

                    # ---------------------------------------------------------------------------------------------------------------------- crollo

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma16_prev and ma3_last < ma16_last)
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 CROLLO (0-3 min) con ma50 < and incrocio 3-16 and deviation_sell < -0.50 - r 12800"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 CROLLO (0-3 min) con ma50 < and incrocio 3-23 and deviation_sell > 0.23 - r 12814"
                        action = "sell"
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma8_prev and ma3_last < ma8_last)
                        and deviation_sell > 0.60
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 CROLLO (0-3 min) con ma50 < and incrocio 3-8 and deviation_sell > 0.60 - r 12827"
                        action = "sell"
                        
               
                ######################################################################################### sessione 3-4-x ( 3-5 min  cambiata con 3-7 min )

                # VENDITA - da 3 a 7 minuti = da 180 a 420 secondi

                elif seconds_since_last_trade > 180 and seconds_since_last_trade <= 420:
                    

                    if (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma18_last
                        and deviation_sell < -0.335
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 > and 3 < 18 and deviation_sell < -0.335 - r 12844"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 > and 5-25 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 12859"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma20_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 > and 5<20 (no incrocio 3-9) and deviation_sell 0.57 - 0.90 - DRIBBLING ALLA RONALDO - r 12874"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 > and incrocio 3-25 and deviation_sell 0.91 - 1.20 - r 12888"
                        action = "sell"
                        
                        
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 > and incrocio 3-25 and deviation_sell > 1.21 - r 12900"
                        action = "sell"
                        
                  
                    ###########################################################################     trend in ribasso
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 < and incrocio 3-28 - r 12913"
                        action = "sell"
                        
                        # deviation_sell_ma78 = ma3_last / ma78_last
                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 < and incrocio 3-33 and deviation_sell < -0.23 - r 12927"
                        action = "sell"
                        
                        
                        
                        
                    # aumenta perdita tollerata se ma50< MA ma200> et ma200>ma300
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.31
                        
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                        
                      
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 < and incrocio 3-28 con > PERDITA TOLLERATA - r 12946"
                        action = "sell"
                        
                        # deviation_sell_ma78 = ma3_last / ma78_last
                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.25
                        
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 3 (3-5 min) con ma50 < and incrocio 3-33 and deviation_sell < -0.23 con > PERDITA TOLLERATA - r 12964"
                        action = "sell"
                        
                       

                    # -------------------------------------------------------------------------------------------------- guadagno con crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 GUADAGNO CON CROLLO (3-5 min) con ma50 < and incrocio 3-23 and deviation_sell > 0.23 - r 12977"
                        action = "sell"
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 PARACADUTE CROLLO (0-3 min) con ma50 < and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 12989"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        
                        

                ############################################################################### sessione 3-4-x  (5-12 min) ( cambiata con 7-12 min ! )

                # VENDITA - da 7 a 12 minuti = da 4200 a 720 secondi

                elif seconds_since_last_trade > 420 and seconds_since_last_trade <= 720:

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.41
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 > and incrocio 3-78 and deviation_sell < -0.41 - r 13009"
                        action = "sell"
                        
                    # deviation_sell = ma3_last/last_trade_price
                    # guardare la stella (guardare da una stella!)
                    # QUESTO E' IL RISCHIO PIU' GRANDE CHE PRENDO ! ( ma con ma50 > ma50 2 min ago DOPO 5 min (+2))
                    # e qua mi ha fottuto con la vendita -1.46 al min 6 del 19 dic 2021 - cambiato crollo improvviso ! e cambiato condizioni e anche fascia da 5-12
                    
                    

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 > and incrocio 5-100 (cuscino di sant' antonio) and deviation_sell < -0.25 - r 13025"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                       
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 > and 5-25 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 13040"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma20_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                  
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 >  5<20 and deviation_sell 0.57 - 0.90 - DRIBBLING ALLA RONALDO - r 13055"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma5_prev > ma20_prev and ma5_last < ma20_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 > and incrocio 5-20 and deviation_sell 0.91 - 1.20 - r 13070"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 > and incrocio 3-25 and deviation_sell > 1.21 - r 13084"
                        action = "sell"
                        
                        

                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 < and incrocio 3-28 - r 13097"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last > ma100_60_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell < -0.39
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 < and ma100 > 60 min ago and incrocio 3-100 (cuscino di sant' antonio) E dev_sell < -0.39 - r 13112"
                        action = "sell"
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell < -0.38
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (5-12 min) con ma50 < and ma100 < 60 min ago and incrocio 3-100 (cuscino di sant' antonio) E dev_sell < -0.38  - r 13124"
                        action = "sell"
                        
                        
                        

                    # ------------------------------------------------------------------------------- guadagno con crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 guadagno con crollo (5-12 min) con ma50 < and incrocio 3-23 - r 13138"
                        action = "sell"
                        
                    
                    # ------------------------------------------------------------------------------------------------------------ PARACADUTE crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.48
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 PARACADUTE CROLLO (5-12 min) con ma50 < and ma3<ma16 (no incrocio) and deviation_sell < -0.48 - r 13151"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE

                    ######################################################################################################## EX CONDIZIONI SPECIALI importate !
                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.10
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 3 5-12 min EX cond speciale 6 GIORNO con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.10 - con ma50 < e con ma5 sotto ma200 > -0.90 - r 13153"
                        action = "sell"

                  
                    
                        
                        
                        
                
                ####################################################################################################### sessione 3-4-x ( 12-21 min )

                # VENDITA - da 12 a 21 minuti = da 720 a 1260 secondi

                elif (
                    seconds_since_last_trade > 720 and seconds_since_last_trade <= 1260
                ):

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma72_prev and ma3_last < ma72_last)
                        and deviation_sell < -0.35
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 > and incrocio 3-72 and deviation sell -0.35 e vaffanculo ! - r 13173"
                        action = "sell"
                        
                        # and deviation_ma39 < -0.29 vendeva troppo presto
                        # ATTENZIONE "and (ma3_prev > ma39_prev and ma3_last < ma39_last)" con ma39 NON HA INCROCIATO
                        # and deviation_sell < -0.30
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma100_prev and ma3_last < ma100_last)
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 > and incrocio 3-100 cuscino di sant' antonio and deviation_sell < 0.36 - r 13190"
                        action = "sell"
                    
                        # viva sant' antonio !
                        # IMPORTANTE !   
                        # vai compaaaaaaaaaa
                        # poco guadagno ma piu' alta
                        # molto guadagno ma piu' bassa
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma25_last > ma100_last

                        and ma5_last < ma49_last
                        and deviation_sell > 0.25 and deviation_sell < 0.54
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (12-21 min) con ma50> and 5-49 and deviation_sell 0.25-0.54 - FINTA ALLA MARADONA - r 13209 x"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        #  3 feb 2025 5-49 da 5-25 se ma25_last > ma100_last



                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma25_last < ma100_last

                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.54
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (12-21 min) con ma50> and 5-25 and deviation_sell 0.25-0.54 - FINTA ALLA MARADONA - r 13209 y"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                       
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma20_last
                        and deviation_sell > 0.55 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 > and 5-20 and deviation_sell 0.55-0.90 - DOPPIO PASSO ALLA RONALDO - r 13227"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 > and incrocio 3-20 and deviation_sell 0.91 - 1.20 - r 13246"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                       
                    

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 > and incrocio 3-30 and deviation_sell > 1.21 - r 13260"
                        action = "sell"
                        
                  
                
                    ##########################################################################################
                    
                    # NON TOCCARE ! CUSCINO DI SANT' ANTONIO !
                    # L' INCROCIO 5-100 MI SALVA ! MA 5<100 VENDE DURANTE IL RIBASSO !
                    
                  
                    ##################################################################### con trend discendente
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.165
                        and deviation_sell < -0.337
                        
                        and deviation_ma100_sopra_ma200 < 0.25
                        and deviation_ma100_sopra_ma200 > -0.70
                        
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 < and deviation_ma39 < -0.165 100 sopra 200 > -0.70 - r 13282 a"
                        action = "sell"
                        
                        # and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        # and deviation_sell < -0.25
                        # ATTENZIONE QUESTA aveva FATTO -0.61% !
                        # QUINDI ho abbassato da 0.17 a 0.16 a 0.15
                        # HO NOTATO CHE ANCHE INCROCIO 5-100 SAREBBE ARRIVATO TARDI
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10
                        # 16 mar 2023 dev sell a -0.337 da -0.33
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.165
                        
                        and deviation_ma100_sopra_ma200 < -0.70
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 < and deviation_ma39 < -0.165 100 spra 200 < -0.70 crollo ! - r 13304 b"
                        action = "sell"
                        
                        # and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        # and deviation_sell < -0.25
                        # ATTENZIONE QUESTA aveva FATTO -0.61% !
                        # QUINDI ho abbassato da 0.17 a 0.16 a 0.15
                        # HO NOTATO CHE ANCHE INCROCIO 5-100 SAREBBE ARRIVATO TARDI
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10
                        
                       
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.45
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.45 - r 13330"
                        action = "sell"
                        
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10 e vaffanculo ! ma solo se ma50< !
                        
                    

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 < and CUSCINO DI SANT' ANTONIO - r 13344"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # incrocio 5-100 no 5<100 altrimenti vende durante il crollo !
                        
                
                
                        
                    # aumento della perdita tollerata
                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.185
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 < and deviation_ma39 < -0.185 con > PERDITA TOLLERATA - r 13363"
                        action = "sell"
                        
                        # and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        # and deviation_sell < -0.25
                        # ATTENZIONE QUESTA aveva FATTO -0.61% !
                        # QUINDI ho abbassato da 0.17 a 0.16 a 0.15
                        # HO NOTATO CHE ANCHE INCROCIO 5-100 SAREBBE ARRIVATO TARDI
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10
                        
                        
                        
                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.47
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.47 con > PERDITA TOLLERATA - r 13385"
                        action = "sell"
                        
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10 e vaffanculo ! ma solo se ma50< !
                        
                        
                        
                  
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 3 (12-21 min) con ma50 < and CUSCINO DI SANT' ANTONIO con > PERDITA TOLLERATA - r 13402"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # incrocio 5-100 no 5<100 altrimenti vende durante il crollo !
                        
                        
                  
                    
                    # --------------------------------------------------------------------------------- PARACADUTE crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (12-21 min) PARACADUTE CROLLO  con ma50< and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 13419"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                    
                    
                    
                    # ----------------------------------------------------------------------------- guadagno con crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma18_prev and ma3_last < ma18_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                        
                        and ma5_last < ma78_last
                    ):
                        sell = "SELL 3 eventuale guadagno con crollo (12-21 min) con ma50 < and incrocio 3 - 18 and deviation_sell > 0.23 - r 13437"
                        action = "sell"

                  

                    ################################################################################################################# EX CONDIZIONI SPECIALI IMPORTATE RIDOTTE

                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.05
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < 5
                    ):
                        sell = "SELL 3 (12-21 min) EX cond spec r 16047 B1Y con ma 50 < ma 50 2 min ago  con ma300 > 5 ore E dev 3-39 < 0.05 and dev_sell < -0.05 - r 13440"
                        action = "sell"
                        
                        #  1 nov 2023 dev_sell a -0.05 da -0.112

                    
                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < 0.03
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.10
                        and ma2_differenza_2_min_ago < -7
                    ):
                        sell = "SELL 3 (21-60 min) r 15349 B PROVA 4 se ma50<= e dev_sell < 0.03 E 300 < 300 301 min ago e macd_diff_2_min_ago < -0.10 e diff ma2 < -7 - r 13450"
                        action = "sell"
                        
                        # 18 nov 2023 and deviation_sell < 0.02 da < -0.01
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <
                        # 27 nov 2023 and deviation_sell < 0.03 da < 0.02

                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.05
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < 5
                    ):
                        sell = "SELL 3 (12-21 min) EX cond spec r 16047 B1Y con ma 50 < ma 50 2 min ago  con ma300 > 5 ore E dev 3-39 < 0.05 and dev_sell < -0.05 - r 13440"
                        action = "sell"
                        
                        #  1 nov 2023 dev_sell a -0.05 da -0.112

                  
                    
                        
                

                ################################################################################################################## sessione 3-4-x ( 21-60 min )

                # VENDITA - da 21 a 60 minuti = da 1261 a 3600 secondi

                elif (
                    seconds_since_last_trade > 1261 and seconds_since_last_trade <= 3600
                ):
                    
                    
                    ################################################################################################ RIGHE DEL COMPA raddoppiate
                    
                    
                    if (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma200 > 0.30
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.27
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and deviation_ma25 < -0.27 CON 100-200 > 0.30 - r 13463"
                        action = "sell"
                        
                        # in alto senza deviation sell
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma200 < 0.30
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.27
                        and deviation_sell < -0.30
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and deviation_ma25 < -0.27 and deviation_sell < -0.30 CON 100-200 < 0.30 - r 13477"
                        action = "sell"
                        
                        # in basso con deviation sell 
                        
                    
                 
                    
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.25 
                        and ma3_last < ma42_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL (21-60 min) con ma50 > and (deviation_sell < -0.25 and ma3_last < ma42_last) - r 13498"
                        action = "sell"
                        
                        # 16 GIU 2022 3-42 da 3-50
                        
                    

                    
                    elif (    
                        deviation_sell < 0.60
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and (ma300_last < ma300_360_min_ago or ma450_last < ma450_360_min_ago)
                        and delta_50_25_last > delta_50_25_30_min_ago

                        and ma2_last < ma2_2_min_ago
                        
                        and ma50_last >= ma50_3_min_ago
                        
                    ):
                        sell = "SELL 3 del 16 ott 2025  - r 13500"
                        action = "sell"

                        # 16 ott 2025 aggiunta questa per vendere con guadagno durante il trend discendente
                        # 16 ott 2025 and ma50_last >= ma50_3_min_ago da ma50_last >= ma50_2_min_ago (per essere piu' sicuro)
                        # 16 ott 2025 aggiunto and delta_50_25_last < delta_50_25_30_min_ago NOTTE per definire meglio anche nel breve il trend discendente.



                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma200_last > ma200_60_min_ago
                        
                        and deviation_ma25 < -0.22
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -3
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and deviation_ma25 < -0.22 and macd_differenza_2_min_ago < -3 - r 13511 a"
                        action = "sell"
                        
                        # 20 nov 2023 deviation_ma25 a -0.28 da -0.31
                        #  9 dic 2023 deviation_ma25 a -0.22 da -0.28
                    
                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        and ma200_last > ma200_60_min_ago
                        
                        and deviation_ma25 < -0.28
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and deviation_ma25 < -0.28 and macd_differenza_2_min_ago < -2 - r 13511 b"
                        action = "sell"
                        
                        # 20 nov 2023 deviation_ma25 a -0.28 da -0.31
                    
                    
                    
                    elif (      
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.30 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and (deviation_sell < -0.30 and ma3_last < ma50_last) - r 13524"
                        action = "sell"
                        
                        # 13 set dev sell -0.30 da -0.27
                        
                       
                    
                    
                        ##################################################################################################################
                        
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.32
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and incrocio 5-100 cuscino di sant' antonio (no 5<100) and deviation_sell < -0.32 - r 13539"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # > estate -0.32 da -0.26
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.70
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and (ma5_prev > ma50_prev and ma5_last < ma50_last)
                        
                        and ma39_last > ma100_last
                        
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and 39>100 and incrocio 5-50 and dev_sell 0.25 - 0.56 FINTA MARADONA se 100 molto sopra 300 - r 13556 a"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 5-50 da 5-39 dopo le dolomiti
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.70
                        and deviation_sell < -0.135
                        and (ma4_prev > ma100_prev and ma4_last < ma100_last)
                        and ma39_last > ma100_last
                        
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 3 (21-60 min) con ma50> and 39>100 and incr 4-100 and dev_sell < -0.135 FINTA MARADONA se 100 NON molto sopra 300 - r 13556 B1"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # > estate 5-78 da 5-33
                        # importantissimo ! VEDI 14 NOV 2022 -1.78% a 32 min dal BUY 3 ! - cazzo !
                        # 23 feb 2023 dev sell -0.135 da -0.12
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.70
                        and deviation_sell > 0.15 and deviation_sell < 0.56
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and ma39_last > ma100_last
                        
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 3 (21-60 min) con ma50> and 39>100 and incr 5-78 and dev_sell 0.15 - 0.56 FINTA MARADONA se 100 NON molto sopra 300 - r 13556 B2"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # > estate 5-78 da 5-33
                        # importantissimo ! VEDI 14 NOV 2022 -1.78% a 32 min dal BUY 3 ! - cazzo !
                        
                    
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and (ma5_prev > ma30_prev and ma5_last < ma30_last)
                        
                        and ma39_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and 39<100 and incrocio 5-39 and deviation_sell 0.25 - 0.56 FINTA DI MARADONA - r 13573"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.50
                        and ma5_last < ma78_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and 5 < 78 and deviation_sell 0.57 - 0.90 ELASTICO ALLA RONALDO - r 13593 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 31 maggio 2022 5-39 da 5-20
                        # 14 ott 2022 5-78 da 5-39 se 5-300 molto in alto !
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.50
                        and ma5_last < ma48_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and 5 < 48 and deviation_sell 0.57 - 0.90 ELASTICO ALLA RONALDO - r 13593 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 31 maggio 2022 5-39 da 5-20
                        # 14 ott 2022 5-48 da 5-39 se 5-300 in basso !
                        
                    
                    
                    
                    elif (
                        
                        ma50_last > ma50_2_min_ago
                        and deviation_ma10_sopra_ma200 > 1.00
                        and (ma4_prev > ma33_prev and ma4_last < ma33_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and incrocio 4-33 and deviation_sell 0.91 - 1.20 CON 10-200 > 1.00 !- r 13609 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 14 giu 2022 3-28 da 3-30
                        # 18 nov 2022 4-33 da 3-30 ( ho aggiunto se 10-200 > 1.00 )



                        
                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma20_last > ma100_last

                        and deviation_ma10_sopra_ma200 < 1.00
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (21-60 min) se 20>100 con ma50 > and incrocio 3-39 and deviation_sell 0.91 - 1.20 CON 10-200 < 1.00 !- r 13609 Bx"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 14 giu 2022 3-28 da 3-30
                        # 18 nov 2022 3-28 resta uguale se 10-200<1.00
                        # 21 mag 2025 se 20>100 cioe' non e' una situazione di trend ribassista allora sell con 3-39 da 3-28


                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma20_last < ma100_last

                        and deviation_ma10_sopra_ma200 < 1.00
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (21-60 min) se 20<100 con ma50 > and incrocio 3-28 and deviation_sell 0.91 - 1.20 CON 10-200 < 1.00 !- r 13609 By"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 14 giu 2022 3-28 da 3-30
                        # 18 nov 2022 3-28 resta uguale se 10-200<1.00
                        # 21 mag 2025 se 20<100 cioe' e' una situazione di trend ribassista allora sel con 3-28

                        
                        
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma300_last
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 1.21 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > e incr 3-30 e dev_sell 1.21 -2.70 - ma100 e' ancora < ma300 e vende un po' prima and macd - r 13623 A"
                        action = "sell"
                        
                        # vende un po' prima perche' e' ancora un po' preoccupato perche' ma100 sta sotto ma300
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma300_last
                        and (ma3_prev > ma52_prev and ma3_last < ma52_last)
                        and deviation_sell > 1.21 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and incrocio 3-52 and dev_sell 1.21 -2.70 - ma100 e' andata sopra ma300 e si distende - r 13623b"
                        action = "sell"
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 > and incrocio 3-11 and deviation_sell > 2.71 - r 13652"
                        action = "sell"
                    
                    
                   
                    ##################################################################### con trend discendente
                   
                    
                    elif (     
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.23
                        
                        and deviation_ma100_sopra_ma300 > 0.50
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and deviation_ma39 < -0.23 con 50 sopra 300 > 0.50 - r 13667"
                        action = "sell"
                        
                        # attenzione se ma100 sta molto sopra ma 300 basta deviation ma39
                        # ma se trend laterale metto anche una deviation sell ( vedi prossimo elif )
                        
                    
                    
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        
                        and deviation_sell < -0.15
                        and deviation_ma39 < -0.14
                        
                        and deviation_ma100_sopra_ma300 < 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.3
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and dev_ma39 < -0.14 and dev_sell < -0.15 con 50>300 < 0.50 E macd < macd_2_min_ago E macd_dif_2_min_< -0.3 - r 13685 A"
                        action = "sell"
                        
                        # attenzione se ma100 sta molto sopra ma 300 basta deviation ma39
                        # ma se trend laterale metto anche una deviation sell
                        # dev sell 0.28 da 0.25 dopo dolomiti
                        # 27 set 2023 dev sell a -0.15 da -0.28
                        # 27 set 2023 dev 39 -0.14 da -0.15
                        # 27 set 2023 and macd_differenza_2_min_ago < -0.3

                    
                    elif (     
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.02
                        
                        and deviation_ma100_sopra_ma300 < 0.50
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and dev_ma39 < 0.05 and dev_sell < 0.02 con 50 sopra 300 < 0.50 and macd < macd_2_min_ago - r 13685 B"
                        action = "sell"
                        
                        # attenzione se ma100 sta molto sopra ma 300 basta deviation ma39
                        # ma se trend laterale metto anche una deviation sell
                        # dev sell 0.28 da 0.25 dopo dolomiti
                        
                        # 27 set 2023 dev sell a -0.10 da -0.28
                        # 16 nov 2023 dev_ma39 a < 0.05 da < -0.10
                        # 16 nov 2023 dev_sell a < 0.02 da < -0.10
                        
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma78_last > ma100_last
                        
                        and ma300_last > ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.34
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and ma300> and deviation_sell < -0.34 CON 78>100 - r 13713 A"
                        action = "sell"
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma78_last < ma100_last
                        and ma300_last > ma300_301_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.345
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and ma300> and deviation_sell < -0.335 CON 78 < 100 - r 13713 B1"
                        action = "sell"
                        
                        # 21 set 2022 dev sell a -0.335 da -0.32
                        # 28 set 2022 dev sell a -0.345 da -0.335
                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma78_last < ma100_last
                        and ma300_last < ma300_301_min_ago
                        and ma300_last > ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.335
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and ma300> and deviation_sell < -0.335 CON 78 < 100 - r 13713 B2"
                        action = "sell"
                        
                        # 21 set 2022 dev sell a -0.335 da -0.32
                        
                        
                        
                    
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_480_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.28
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and ma300< and deviation_sell < -0.28 - r 13725 x"
                        action = "sell"
                        
                    
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_480_min_ago
                        and ma300_last < ma300_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and ma3_last < ma18_last
                        and deviation_sell < -0.22
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and ma300< and deviation_sell < -0.22 - r 13725 y"
                        action = "sell"

                        #  3 ott 2024 aggiunta and ma3_last < ma18_last ha venduto a +0.58 ! strano. ma vabbe'
                     
                    

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.37
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.37 - r 13737"
                        action = "sell"
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_ma5_sotto_ma300 > 0.50
                        and deviation_sell < -0.17
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and 5 molto sopra 300 and INCROCIO 5-100 (no 3<100) CUSCINO DI SANT' ANTONIO - r 13750 A"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # NON INCROCERANNO MAI DURANTE IL CROLLO !
                        # non toccare ! INCROCIO 3-100 CUSCINO DI SANT' ANTONIO !
                        # 23 feb 2023 aggiunto dev_sell < -0.17
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_ma5_sotto_ma300 < 0.50
                        and deviation_sell < -0.34
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and 5 vicino 300 and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO -0.34 - r 13750 b"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # NON INCROCERANNO MAI DURANTE IL CROLLO !
                        # non toccare ! INCROCIO 3-100 CUSCINO DI SANT' ANTONIO !
                        # > estate -0.34 da -0.27
                    
                        
                    
                    ####################################################################################################  aumento perdita tollerata se....  
                    
                    # divido il maestro in 2
                    
                    
                    elif (  
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.26
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                       
                    ):
                        sell = "SELL 3 compa (21-60 min) con ma50 < and deviation_ma39 < -0.26 con PERDITA TOLLERATA > - r 13773"
                        action = "sell"
                        
                        
                     
                    elif ( 
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.40
                        and macd_differenza_2_min_ago < -2
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.29
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                    ):
                        sell = "SELL 3 compa (21-60 min) con 100 sopra molto 300 e ma50 < and deviation_sell < 0.29 con PERDITA TOLLERATA > and macd_diff_2_min_ago < -2 - r 13786a"
                        action = "sell"
                        
                        #  4 dic 2023 aggiunto and deviation_ma100_sopra_ma300 > 0.40
                        #  4 dic 2023 aggiunto and macd_differenza_2_min_ago < -2
                   
                  
                    elif ( 
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.25
                        
                        and deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                    ):
                        sell = "SELL 3 compa (21-60 min) con 100 sopra poco 300 con ma50 < and deviation_sell < 0.25 con PERDITA TOLLERATA > - r 13786b"
                        action = "sell"
                        
                        #  4 dic 2023 aggiunto and deviation_ma100_sopra_ma300 < 0.40
                        
                        
                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.39
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.39 con > perdita tollerata - r 13800"
                        action = "sell"
                        
                        
                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (21-60 min) con ma50 < and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO - con > perdita tollerata - r 13814"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # NON INCROCERANNO MAI DURANTE IL CROLLO !
                        # non toccare ! INCROCIO 3-100 CUSCINO DI SANT' ANTONIO !
                    
                 
                    


                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_180_min_ago
                        and (ma3_prev > ma49_prev and ma3_last < ma49_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) eventuale guadagno se 300> 3 ore con ma50< incrocio 3-49 and dev_sell > 0.23 - r 13831 x"
                        action = "sell"

                        #  3 feb 2025 se 300> 3 ore vende con 3-49 da 3-18

                    # -------------------------------------------------------------------------------------- guadagno durante il crollo

                    elif (
                        ma50_last < ma50_2_min_ago

                        and ma300_last < ma300_180_min_ago
                        and (ma3_prev > ma18_prev and ma3_last < ma18_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) eventuale guadagno durante il crollo con ma50< incrocio 3-18 and dev_sell > 0.23 - r 13831 y1"
                        action = "sell"


                    
                    elif (   
                        ma450_last < ma450_360_min_ago
                        and deviation_ma5_sotto_ma450 < -0.30
                        and ma300_last < ma300_60_min_ago
                        and ma200_last < ma200_60_min_ago
                        
                        and ma300_last < ma300_180_min_ago

                        and (ma3_prev > ma7_prev and ma3_last < ma7_last)
                        and deviation_sell > 0.70

                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 (21-60 min) eventuale guadagno durante il crollo con incrocio 3-7 and dev_sell > 0.70 - r 13831 y2"
                        action = "sell"

                        #  9 mar 2025 aggiunta questa condizione che e' una specie di PMS
                        #  9 mar 2025 tolta ma50_last < ma50_2_min_ago cazzo ! ma50 (gira molto tempo dopo in questa situazione di ribasso)


                    
                    # --------------------------------------------------------------------------------- condizioni speciali importate
                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last > ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.07
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < macd_2_min_ago
                        and macd < 5
                    ):
                        sell = "SELL 3 (21-60 min) EX cond spec r 16047 B1Y (+ macd) CON ma 50 < ma 50 2 min ago e con ma300 > 5 ore e dev 3-39 < 0.05 e dev_sell < -0.07 - r 13834 a"
                        action = "sell"
                      
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.06
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and macd < macd_2_min_ago
                        and macd < 5
                    ):
                        sell = "SELL 3 (21-60 min) EX cond spec r 16047 B1Y (+ macd) CON ma 50 < ma 50 2 min ago con ma300 > 5 ore e dev 3-39 < 0.05 and dev_sell < -0.06 - r 13834 b"
                        action = "sell"
                        
                        #  5 nov 2023 dev sell a -0.06 da -0.10

                    
                    elif (
                        ma8_last < ma8_2_min_ago 
                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.02
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.10
                
                        and deviation_ma3_sotto_ma150 > -1.20
                        and ma2_last <= ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.24
                    ):
                        sell = "SELL 3 (21-60 min) ex cond. spec. r 15985 A1ok2B - CON 50< e dev 3-39 < 0.01 e dev sell < -0.015 and macd_diff_2_min_ago < -0.25 - r 13835"
                        action = "sell"
                
                        # 18 set 2023 dev sell -0.02 da -0.01
                        # 18 set 2023 dev 39 da 0.01 da -0.01
                        # 17 OTT 2023 NON METTERE MACD <  MACD 2 MIN AGO
                        # 17 ott 2023 and macd_differenza_2_min_ago < -0.24

                  
                    elif (
                        ma78_last > ma78_120_min_ago
                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.05
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 3 (21-60 min) ex condizione speciale r 16047 A1 con dev 3-39 < 0.01 e dev_sell < -0.05 con ma50 < and macd_diff_2_min_ago < -0.20 - r 13836"
                        action = "sell"
                        
                        #  4 ott 2023 ex condizione speciale r 16047 A1 ridotta

                    elif (
                        deviation_sell > 0.81
                        and deviation_ma3_sopra_ma18 < -0.056
                        and ma300_last > ma300_301_min_ago
                        
                        and ma3_last < ma18_last
                        and ma2_last < ma5_last
                
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                        and ma2_differenza_2_min_ago < -5
                        
                        and macd < macd_2_min_ago
                        and macd < 16
                        and macd_differenza_5_min_ago < -9
                        
                    ):    
                        sell = "SELL 3 (21 a 60 min) ex cond spec P M S con ma300 > 5 ore ! e dev sell > 0.81 e macd < 16 e MACD diff_5_min_ago < -9 e dev 3-18 < -0.056 - r 13838"
                        action = "sell"
                      

                    
                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < 0.03
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.10
                        and ma2_differenza_2_min_ago < -7
                    ):
                        sell = "SELL 3 (21-60 min) r 15349 B PROVA 4 se ma50<= e dev_sell < 0.03 E 300 < 300 301 min ago e macd_diff_2_min_ago < -0.10 e diff ma2 < -7 - r 13840"
                        action = "sell"
                        
                        # 18 nov 2023 and deviation_sell < 0.02 da < -0.01
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <
                        # 27 nov 2023 and deviation_sell < 0.03 da < 0.02


                    
                    

                    
                    

                  

                    
                        
                 
                ######################################################################################################## sessione 3-4-x ( da 60 a 90 min )

                # VENDITA - da 60 a 90 min - da 3600 a 5400 secondi in poi
                
                elif (
                    seconds_since_last_trade > 3600 and seconds_since_last_trade <= 5400
                ):
                  
             
                ###################################################################### RIGHE DEL COMPA DA RADDOPPIAte PER AUMENTARE LA TOLLERANZA
                    
                    
                    if (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.21
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 > and deviation_ma25 < -0.19 - r 13853"
                        action = "sell"
                        
                
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.20 
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 > and (deviation_sell < -0.19 and ma3_last < ma50_last) - r 13864"
                        action = "sell"
                        
                        
                        
                    elif (
                        deviation_sell > 0.81
                        and deviation_ma3_sopra_ma18 < -0.056
                        and ma300_last > ma300_301_min_ago
                        
                        and ma3_last < ma18_last
                        and ma2_last < ma5_last
                
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                        and ma2_differenza_2_min_ago < -5
                        
                        and macd < macd_2_min_ago
                        and macd < 16
                        and macd_differenza_5_min_ago < -9
                        
                    ):    
                        sell = "SELL 3 da 60 a 90 min ex cond spec P M e S con ma300 > 5 ore ! e dev sell > 0.81 e macd < 16 e MACD diff_5_min_ago < -9 e dev 3-18 < -0.056 - r 13870"
                        action = "sell"

              
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma25 < -0.23
                        and deviation_ma10_sopra_ma200 > 0.50
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 > and deviation_ma25 < -0.19 - r 13875 A"
                        action = "sell"
                        
                        # 18 nov 2022 dev 25 < -0.23
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma25 < -0.22
                        and deviation_ma10_sopra_ma200 < 0.50
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 > and deviation_ma25 < -0.19 - r 13875 B"
                        action = "sell"
                        
                        # 18 nov 2022 dev 25 < -0.22
                        
                        
                   
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.20 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 > and (deviation_sell < -0.19 and ma3_last < ma50_last) - r 13887"
                        action = "sell"
                        
                      
                        ############################################################################################################
                       
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma100_last > ma150_last
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (60-90 min) con ma50 > and incrocio 5-100 and deviation_sell 0.25 - 0.56 FINTA DI MARADONA - r 13901a"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price



                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma50_last > ma100_last

                        and ma100_last < ma150_last
                        and (ma5_prev > ma69_prev and ma5_last < ma69_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (60-90 min) con ma50 > and incrocio 5-69 and deviation_sell 0.25 - 0.56 FINTA DI MARADONA - r 13901 B1"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 28 apr 2025 se 50>100 dev sell a 5-69 da 5-50




                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma50_last < ma100_last

                        and ma100_last < ma150_last
                        and (ma5_prev > ma59_prev and ma5_last < ma59_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 (60-90 min) con ma50 > and incrocio 5-59 and deviation_sell 0.25 - 0.56 FINTA DI MARADONA - r 13901 B2"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 28 apr 2025 se 50<100 dev sell a 5-59 da 5-50


                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma4_last < ma78_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 60-90 min con ma50> and 4-78 and deviation_sell 0.57-0.90 DRIBBLING ALLA RONALDO - r 13915"
                        action = "sell"
                        
                        # > estate 4-78 da 4-18
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and (ma3_prev > ma59_prev and ma3_last < ma59_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 da 60 a 90 min con ma50 > AND 300> 5 ORE ago and incrocio 3-59 and deviation_sell 0.91 - 1.49 - r 13928 A"
                        action = "sell"

                        # ma ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 da 60 a 90 min con ma50 > AND 300< 5 ORE ago and incrocio 3-39 and deviation_sell 0.91 - 1.49 - r 13928 B"
                        action = "sell"

                        # ma ricordati che in diverse occasioni 3-48 mi ha evitato la ricompra e la rivendita conseguente con perdita !
                        # 27 mar 2025 3-39 da 3-30
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma33_last > ma300_last
                        and ma100_last < ma300_last
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 (60-90 min) con ma50 > incrocio 3-20 e dev_sell 1.50 - 2.70 - ma100 sotto ma300 ma 33 e' andata sopra 300 ! - r 13944 a"
                        action = "sell"

                        #  8 mar 2024 se ma33 va sopra ma300 allora vende con incrocio al rialzo 3-39 invece di 3-20 LASCIA CORRERE !


                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma33_last < ma300_last
                        and ma100_last < ma300_last
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 (60-90 min) con ma50 > incrocio 3-20 e dev_sell 1.50 - 2.70 - ma100 ancora sotto ma300 e vende un po' prima - r 13944 b"
                        action = "sell"

                        #  8 mar 2024 se ma33 sta ancora sotto ma300 vende con incrocio al rialzo 3-20


                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma300_last
                        and (ma3_prev > ma50_prev and ma3_last < ma50_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 da 60 a 90 min con ma50 > incrocio 3-50 and deviation_sell 1.50 - 2.70 - ma100 sopra ma300 e si distende - r 13956"
                        action = "sell"
                        
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 da 60 a 90 min con ma50 > incrocio 3-11 and deviation_sell > 2.71 - r 13970"
                        action = "sell"
                        
                        
                       
                    ############################################################################# con trend discendente MA 100 sopra di molto da 300
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.16
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 > 0.69
                       
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < con deviation_ma39 <-0.16 TREND CRESCITA (100 sopra 300 > 0.69) - r 13986"
                        action = "sell"
                        
                        # and ma3_last < ma33_last
                        # and deviation_sell < 0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        
                        
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma2_last < ma2_2_min_ago
                
                        and deviation_ma100_sopra_ma300 > 0.69
                        and deviation_sell < -0.10
                        and ma5_last < ma100_last
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < CUSCINO SANT' ANTONIO (5-100) MA SOLO con TREND CRESCITA (100 sopra 300 > 0.69) - r 14006"
                        action = "sell"
                        
                        
                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_1_200_78 < delta_2_200_78_60_min
                        and deviation_ma39 < -0.10
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_sell < -0.20
                       
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < con deviation_ma39 < -0.10 and deviation_sell < -0.20 TREND LATERALE (100>300 MA <0.69) - r 14021 A"
                        action = "sell"
                        
                        # 27 giu 2022 deviation_sell < -0.16 da 0.15
                        # 11 ott 2022 deviation_sell < -0.17 da 0.16
                        # 11 ott 2022 deviation_ma39 < -0.175 da 0.17
                        # 18 nov 2022 dev sell -0.20 con aggiunta doppio delta
                        # 16 ago 2023 deviation_ma39 < -0.10 da 0.17
                  
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_1_200_78 > delta_2_200_78_60_min
                        and deviation_ma39 < -0.175
                        and ma2_last < ma2_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 < 0.69
                        and deviation_sell < -0.18
                       
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < con deviation_ma39 < -0.175 and deviation_sell < 0.18 TREND LATERALE (100>300 MA <0.69) - r 14021 B"
                        action = "sell"
                        
                        # 27 giu 2022 deviation_sell < -0.16 da -0.15
                        # 11 ott 2022 deviation_sell < -0.17 da -0.16
                        # 11 ott 2022 deviation_ma39 < -0.175 da -0.17
                        # 18 nov 2022 dev sell -0.18 da -0.17
                        
                    ###########################################################################################################

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.18
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < con incrocio 3-78 and deviation_sell < -0.18 - r 14037"
                        action = "sell"
                        
                        # > estate -0.18 da -0.10 - una cosa curiosa : ha venduto mentre risaliva
                        
                        
                     
                    # maggiore perdita tollerata
                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma50_last > ma50_2_min_ago
                        
                        and ma300_last > ma450_last
                        and ma200_last > ma300_last
                        
                        
                        and deviation_ma39 < -0.15
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                       
                    ):
                        sell = "SELL 3 (60-90 min) con ma50 > AND 300>450 e con deviation_ma39 < -0.15 and macd < macd_2_min_ago - r 14052 A1"
                        action = "sell"

                        #  5 dic 2023 con ma50 >
                        #  5 dic 2023 and deviation_ma39 < -0.15 da -0.23
                        #  5 dic 2023 aggiunta and macd < macd_2_min_ago

                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma50_last < ma50_2_min_ago
                        
                        and ma300_last > ma450_last
                        and ma200_last > ma300_last
                        
                        
                        and deviation_ma39 < -0.13
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                       
                    ):
                        sell = "SELL 3 (60-90 min) con ma50 < AND 300>450 e con deviation_ma39 < -0.13 and macd < macd_2_min_ago - r 14052 A2"
                        action = "sell"

                        #  5 dic 2023 con ma50 <
                        #  5 dic 2023 and deviation_ma39 < -0.13 da -0.23
                        #  5 dic 2023 aggiunta and macd < macd_2_min_ago
                  
                    elif (
                        deviation_trend_ma200 > -0.10
                        and deviation_ma100_sopra_ma300 > 0.50
                        and ma300_last < ma450_last
                        and ma200_last > ma300_last
                        
                        and ma50_last < ma50_2_min_ago
                        
                        and deviation_ma39 < -0.10
                        
                        
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < AND300 <450 MA 200>300  e con deviation_ma39 <-0.10 - r 14052 B1"
                        action = "sell"
                        
                        # 10 gen 2024 se sta molto in alto entra in azione solo dev39
                  
                    
                    elif (
                        deviation_trend_ma200 > -0.10
                        and deviation_ma100_sopra_ma300 < 0.50
                        and ma300_last < ma450_last
                        and ma200_last > ma300_last
                        
                        and ma50_last < ma50_2_min_ago
                        
                        and deviation_ma39 < -0.15
                        and deviation_sell < 0.10
                        
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < AND300 <450 MA 200>300  e con deviation_ma39 <-0.15 and dev_sell < 0.10 con > perdita tollerata - r 14052 B2"
                        action = "sell"
                        
                        # and ma3_last < ma33_last
                        # and deviation_sell < 0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        # 10 gen 2024 aggiunto and deviation_sell < 0.10
                        
                    elif (
                        deviation_trend_ma200 > -0.10
                        and ma200_last > ma300_last
                        and ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.10
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 da 60 a 90 min con ma50 < con incrocio 3-78 and deviation_sell < -0.10 con > perdita tollerata - r 14072"
                        action = "sell"

                  
                    ################################################################################## ex condizioni speciali
                  
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.102
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL EX condizione speciale 6 GIORNO con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.102 - con ma50 < e con ma5 sotto ma200 > -0.90 - r 14073"
                        action = "sell"
                
                        # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                        # 15 set 2023 quando GIORNO a -0.11 da -0.07
                        # 15 set 2023 quando GIORNO a -0.102 da -0.11
                  
                    
                        
                        
                 

                ############################################################################################################ sessione 3-4-x ( > 90 min )

                # VENDITA - da 90 minuti in poi = da 5400 secondi in poi

                elif seconds_since_last_trade > 5400:
                    
                    
                    ################################################################################### RIGHE DEL COMPA raddoppiate PER AUMENTARE TOLLERANZA
                    
                    
                    if (    
                        ma50_last > ma50_2_min_ago 
                        
                        and deviation_ma25 < -0.20
                        and ma2_last < ma2_2_min_ago 
                        and ma2_differenza_2_min_ago < -5
                    ):
                        sell = "SELL 3 dopo 90 min con ma50> and deviation_ma25 < -0.21 (no ma 3 < ma39) and ma2_differenza_2_min_ago < -5 - r 14093"
                        action = "sell"
                        
                        # 14 ott 2023 and dev_ma25 a < -0.20 da < -0.21
                        #  9 nov 2023 aggiunta and ma2_differenza_2_min_ago < -5
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 dopo 90 min (dopo 110 min RCCR) con ma50 > incrocio 3-13 (!) and deviation_sell > 2.71 - r 14094"
                        action = "sell"
                        
                        
                    elif (     
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.20 
                        and ma3_last < ma50_last
                    ):
                        sell = "SELL 3 dopo 90 min con ma50> and (deviation_sell < 0.10 and ma3_last < ma50_last)- r 14105"
                        action = "sell"
                        
                    
                    
                        
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.23
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 3 dopo 90 min con ma50> and deviation_ma25 < -0.23 - r 14117"
                        action = "sell"
                        
                
                    
                    
                    elif (     
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.23 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 3 dopo 90 min con ma50> and (deviation_sell < -0.23 and ma3_last < ma50_last) - r 14130"
                        action = "sell"
                        
                       
                     
                        
                    ############################################################################################################################### 
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma78_last
                        and deviation_sell > 0.29 and deviation_sell < 0.59
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma200 > 0.20
                       
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 > and 5-78 and deviation_sell 0.29 - 0.59 - FINTA ALLA MARADONA se sale tanto - r 14147"
                        action = "sell"
                        
                        # > estate 5-78 da 5-39
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma150_last
                        and deviation_sell > 0.25 and deviation_sell < 0.59
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma100_sopra_ma200 < 0.20
                       
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 > and 5-150 (!) and deviation_sell 0.25 - 0.59 - FINTA ALLA MARADONA se sale poco - r 14159"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # al SELL 3 maradona e' ancora piu' stanco di quello che pensavo !
                        
                        
                      
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma4_last < ma78_last
                        and deviation_sell > 0.60 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 3 >90 min con ma50 > con 4<78 and deviation_sell 0.60 - 0.90 DRIBBLING ALLA RONALDO - r 14181"
                        action = "sell"
                        
                        # 6 giu 2022 4-30 da 4-25
                        # > estate 4-78 da 4-30
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        
                        and (ma3_prev > ma48_prev and ma3_last < ma48_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 dopo 90 min con ma50 > E CON ma300 > ma300 300 min ago e incrocio 3-48 and deviation_sell 0.91 - 1.49 - r 14195 a"
                        action = "sell"

                        # ma 3-48 mi evita la ricompra e la rivendita con perdita !
                        # 23 mag 2023 3-48 da 3-30 se ma300 > 300 301 min ago
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                      
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 dopo 90 min con ma50 > MA CON ma300 < ma300 300 min ago e incrocio 3-33 (!) and deviation_sell 0.91 - 1.49 - r 14195 b"
                        action = "sell"

                        # ma 3-48 mi evita la ricompra e la rivendita con perdita !
                        # 23 mag 2023 3-33 da 3-33 se ma300 < 300 301 min ago
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.30
                        and (ma3_prev > ma110_prev and ma3_last < ma110_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 dopo 90 min con ma50 > incrocio 3-110 (!) and deviation_sell 1.50 - 2.70 - r 14210 A"
                        action = "sell"
                        
                        # > estate 3-78 da 3-30
                        # 6 apr 2023 3-110 da 3-78 se 5-300 > 0.30
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.30
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 dopo 90 min con ma50 > incrocio 3-78 (!) and deviation_sell 1.50 - 2.70 - r 14210 B"
                        action = "sell"
                        
                        # > estate 3-78 da 3-30
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.30
                        and (ma3_prev > ma42_prev and ma3_last < ma42_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 dopo 90 min con ma50 > incrocio 3-42 and deviation_sell > 2.71 con 5-300 > 0.30 - r 14223 A"
                        action = "sell"
                        
                        # 18 set 2022 3-42 da 3-11
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.30
                        and (ma3_prev > ma18_prev and ma3_last < ma18_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 3 dopo 90 min con ma50 > incrocio 3-18 and deviation_sell > 2.71 SE 5-300 < 0.30 - r 14223 B"
                        action = "sell"
                        
                        # 18 set 2022 3-18 da 3-11
                        
                 
                
                
                    ######################################################################################## con trend discendente
                    
                    elif (      
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        
                        and deviation_sell > 1.70
                        and (ma3_prev > ma100_prev and ma3_last < ma100_last)
                      
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago 
                        
                       
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < con deviation_ma39 < -0.18 - r 14239 A1"
                        action = "sell"
                        
                        # 29 gen 2023 se deviation_ma100_sopra_ma300 > 0.33
                        
                        # 15 giu 2023 incrocio 3-100

                  
                    elif (      
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.17
                       
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < con deviation_ma39 < -0.17 - r 14239 A2"
                        action = "sell"
                        
                        # 29 gen 2023 se deviation_ma100_sopra_ma300 > 0.33
                        
                        # 15 giu 2023 dev_39 -0.18 da -0.20
                        # 30 ott 2023 dev_39 -0.17 da -0.18
                  
                    elif (      
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and deviation_sell < 1.70
                      
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.20
                       
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < con deviation_ma39 < -0.20 - r 14239 A3"
                        action = "sell"
                        
                        # 29 gen 2023 se deviation_ma100_sopra_ma300 > 0.33
                        # 29 gen 2023 dev_39 -0.21 da -0.20

                  
                        
                        
                    elif (      
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.33
                        and ma5_last > ma125_last
                        and ma200_last > ma300_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.22
                       
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < con deviation_ma39 < -0.22 - r 14239 B"
                        action = "sell"
                        
                        # 29 gen 2023 se and deviation_ma100_sopra_ma300 < 0.33
                        # 29 gen 2023 dev_39 -0.22 da -0.20
                        
                        
                    elif (      
                        ma50_last > ma50_2_min_ago
                        
                        and ma450_last > ma450_360_min_ago
                        and ma200_last < ma300_last
                        
                        and deviation_ma39 < -0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        and ma2_differenza_2_min_ago < -13
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < con deviation_ma39 < -0.15 and ma2_differenza_2_min_ago < -13 - r 14250 a1"
                        action = "sell"
                        
                        # 30 mag 2023 dev 39 a -0.17 da -0.16 se 450 > 4 ore
                        # 25 nov 2023 aggiunta and ma2_differenza_2_min_ago < -13
                        # 25 nov 2023 dev 39 a -0.15 se and ma2_differenza_2_min_ago < -13


                  
                    elif (      
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_360_min_ago
                      
                        and ma200_last < ma300_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.165
                       
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < con deviation_ma39 < -0.165 - r 14250 A2"
                        action = "sell"
                        
                        # 30 mag 2023 dev 39 a -0.17 da -0.16 se 450 > 4 ore
                        # 12 set 2024 and deviation_ma39 < -0.165 da < -0.17
                  
                        
                    elif (      
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago
                        
                        and ma200_last < ma300_last
                        and ma54_last > ma72_last
                        
                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.069
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd < -1.7
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < MA 54>72 e con deviation_ma39 < -0.01 and dev sell -0.065 and macd < macd 2 min ago and macd < -1.7 - r 14250 B1"
                        action = "sell"
                        
                        # 12 set 2023 dev 39 -0.03 da -0.16
                        # 12 set 2023 aggiunta dev sell -0.05
                        # 15 ott 2023 aggiunta dev sell dev sell -0.069 da -0.065
                        # 15 ott 2023 3-39 0.01 da -0.03
                        # 15 ott 2023 and macd < -1.7
                  
                    elif (      
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago
                        
                        and ma200_last < ma300_last
                        and ma54_last < ma72_last
                        
                        and deviation_ma39 < -0.03
                        and deviation_sell < 0.05
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 3 dopo 90 min con ma50 < E 54 >72 e con deviation_ma39 < -0.03 and dev sell 0.05 and macd < macd 2 min ago - r 14250 B2"
                        action = "sell"
                        
                        # 12 set 2023 dev 39 -0.03 da -0.16
                        # 12 set 2023 aggiunta dev sell -0.05
                        #  3 nov 2023 deviation_sell < 0.05 da -0.05
                  

                  
                  
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma450_last
                        
                        and deviation_ma5_sotto_ma300 > 0.40
                        and deviation_ma100_sopra_ma300 > 0.20
                        and ma2_last < ma2_2_min_ago 
                         
                        and ma3_last < ma100_last
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 3 dopo 90 min CON 5-300 > 0.40 E con ma50< MA ma100 > ma300 and 5-86 - r 14270 A1"
                        action = "sell"
                        
                        # se sta in alto NO DEVIATION SELL - la 100 se ne sta andando in alto.
                        # > estate 3-78 da 3-39
                        # 13 set 2023 5-86 da 3-78
                        # 15 mag 2023 5-100 da 3-86
                        # 15 mag 2023 aggiunta macd > macd 2 min ago

          
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma450_last
                        
                        and deviation_ma5_sotto_ma300 > 0.40
                        and deviation_ma100_sopra_ma300 > 0.20
                        and ma2_last < ma2_2_min_ago 
                         
                        and ma5_last < ma100_last
                    ):
                        sell = "SELL 3 dopo 90 min CON 5-300 > 0.40 E con ma50< MA ma100 > ma300 and 5-100 - r 14270 A2"
                        action = "sell"
                        
                        # se sta in alto NO DEVIATION SELL - la 100 se ne sta andando in alto.
                        # > estate 3-78 da 3-39
                        # 13 set 5-86 da 3-78
                        #  3 set 5-100 da 5-86
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_720_min_ago
                        
                        and ma300_last > ma450_last
                        and deviation_sell < -0.15
                        and deviation_ma5_sotto_ma300 < 0.40
                        and deviation_ma100_sopra_ma300 > 0.10
                        and ma2_last < ma2_2_min_ago 
                         
                        and ma8_last < ma150_last
                    ):
                        sell = "SELL 3 dopo 90 min CON 5-300 < 0.40 E con ma50< MA dev100-300> 0.10 AND 300>450 - r 14270 B1x"
                        action = "sell"
                        
                        # se sta in alto NO DEVIATION SELL - la 100 se ne sta andando in alto.
                        # > estate 3-78 da 3-39
                        # 13 set 5-86 da 3-78
                        # 25 sett 5-150 da 5-28
                        # 26 feb 2023 dev_ma100_sopra_ma300 > 0.10 da > 0.20
                        # 17 mag 2023 450 in crescita
                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_720_min_ago
                        
                        and deviation_ma100_sopra_ma300 > 0.10
                        and ma300_last > ma450_last
                        and deviation_sell < -0.15
                        and deviation_ma5_sotto_ma300 < 0.40
                        
                        and ma2_last < ma2_2_min_ago 
                         
                        and ma8_last < ma150_last
                    ):
                        sell = "SELL 3 dopo 90 min CON 5-300 < 0.40 E con ma50< MA dev100-300> 0.10 AND 300>450 and deviation_sell < -0.15 - r 14270 B1y"
                        action = "sell"
                        
                        # se sta in alto NO DEVIATION SELL - la 100 se ne sta andando in alto.
                        # > estate 3-78 da 3-39
                        # 13 set 5-86 da 3-78
                        # 25 sett 5-150 da 5-28
                        # 26 feb 2023 dev_ma100_sopra_ma300 > 0.10 da > 0.20
                        # 17 mag 2023 450 in decrescita da 720 min ! ridotto di una ndecchiecella dev sell a -0.145 da -0.15
                        # 31 lug 2023 and deviation_sell < -0.15 da 0.145
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma450_last
                        and deviation_ma5_sotto_ma300 < 0.40
                        and deviation_ma100_sopra_ma300 > 0.20
                        and ma2_last < ma2_2_min_ago 
                         
                        and ma5_last < ma150_last
                    ):
                        sell = "SELL 3 dopo 90 min CON 5-300 > 0.40 E con ma50< MA ma100 > ma300 and 5-150 AND 300<450 - r 14270 B2"
                        action = "sell"
                        
                        # se sta in alto NO DEVIATION SELL - la 100 se ne sta andando in alto.
                        # > estate 3-78 da 3-39
                        # 13 set 5-86 da 3-78
                        # 25 sett 5-150 da 5-28

                  
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        
                        and delta_450_300 < delta_450_300_60_min
                        and ma250_last > ma300_last
                        and deviation_ma100_sopra_ma300 < 0.20
                        
                        and deviation_sell < -0.21
                        and ma3_last < ma39_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 3 > 90 min GIORNO con ma50 < and ma100 NON DISTANTE dalla ma300 and (dev_sell < -0.21 and ma3_last < ma39_last) - r 14283 A1x"
                        action = "sell"
                        
                        # SE ma100 RESTA VICINA ALLA ma300 - trend laterale - allora tieniti pronto anche con la deviation sell
                        # 28 ott 2022 dev sell a 0.17 da 0.15
                        #  1 nov 2022 se 250 > 300 dev sell 0.19 da 0.17
                        # 20 feb 2023 doppio delta 450-300 GIORNO
                        # 20 feb 2023 dev_sell a -0.21 da -0.19

                  
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        
                        and delta_450_300 < delta_450_300_60_min
                        and ma250_last > ma300_last
                        and deviation_ma100_sopra_ma300 < 0.20
                        
                        and deviation_sell < -0.01
                        and ma3_last < ma39_last
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 3 > 90 min GIORNO con ma50 < and ma100 NON DISTANTE dalla ma300 and (dev_sell < -0.01 and ma3_last < ma39_last) - r 14283 A1y"
                        action = "sell"
                        
                        # SE ma100 RESTA VICINA ALLA ma300 - trend laterale - allora tieniti pronto anche con la deviation sell
                        # 28 ott 2022 dev sell a 0.17 da 0.15
                        #  1 nov 2022 se 250 > 300 dev sell 0.19 da 0.17
                        # 20 feb 2023 doppio delta 450-300 GIORNO
                        # 20 feb 2023 dev_sell a -0.21 da -0.19
                        # 15 set 2023 dev_sell a -0.01 da -0.21 se ma300 scende da 5 ore !




                  
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and delta_450_300 > delta_450_300_60_min
                        and ma250_last > ma300_last
                        and deviation_ma100_sopra_ma300 < 0.30
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.195
                        and ma3_last < ma39_last
                    ):
                        sell = "SELL 3 > 90 min NOTTE con ma50 < and ma100 NON DISTANTE dalla ma300 and (dev_sell < -0.195 and ma3_last < ma39_last) - r 14283 A2"
                        action = "sell"
                        
                        # SE ma100 RESTA VICINA ALLA ma300 - trend laterale - allora tieniti pronto anche con la deviation sell
                        # 28 ott 2022 dev sell a 0.17 da 0.15
                        #  1 nov 2022 se 250 > 300 dev sell 0.19 da 0.17
                        # 20 feb 2023 doppio delta 450-300 NOTTE
                        # 20 feb 2023 dev_sell a -0.20 da -0.19
                        #  1 ago 2023 dev_sell a -0.195 da -0.20

                  
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma250_last < ma300_last
                        and deviation_ma100_sopra_ma300 < 0.20
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.20
                        and ma3_last < ma39_last
                        and macd < macd_2_min_ago
                        and macd < -6
                    ):
                        sell = "SELL 3 > 90 min con ma50 < and ma100 NON DISTANTE dalla ma300 and (dev_sell < -0.20 and ma3_last < ma39_last) and macd < and macd < -6 - r 14283 B"
                        action = "sell"
                        
                        # SE ma100 RESTA VICINA ALLA ma300 - trend laterale - allora tieniti pronto anche con la deviation sell
                        # 28 ott 2022 dev sell a 0.17 da 0.15
                        #  1 nov 2022 se 250 < 300 dev sell 0.18 da 0.17
                        # 19 apr 2023 se 250 < 300 dev sell 0.19 da 0.18
                        # 26 apr 2023 se 250 < 300 dev sell 0.20 da 0.19
                        # 11 ago 2023 aggiunto and macd < -6

                  


                    elif (    
                        ma50_last < ma50_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 > 0.25
                        and deviation_ma39 < -0.20
                        
                        and ma100_last > ma100_120_min_ago
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 3 >90 min con ma50 < E dev_ma100_sopra_ma300 > 0.25 con dev_ma39 < -0.20 and 100 > 100 120 min ago - r 14285"
                        action = "sell"
                        
                        # 29 gen 2023 dev_39 -0.239 da -0.235
                        #  1 feb 2023 dev_39 -0.243 da -0.239
                        # 13 nov 2023 se 100 sta sopra 300 allora vende solo dev 3-39
                        # 12 set 2024 aggiunta questa condizione presa da RCCR



                    ############################################################################# HO PORTATO QUI UNA CONDIZIONE SPECIALE ABBASSANDO IL SELL DI UNA NDECCHIECELLA
                    ################################################################################## ex condizioni speciali

                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.095
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.50
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd <= macd_2_min_ago
                    ):
                        sell = "SELL 3 > 90 min EX condizione speciale 6 con ma300 > 5 ore - 4 dev 3-39 < 0.06 e dev_sell < -0.095 con ma50 < e con ma5 sotto ma200 > -0.90 - r 14290"
                        action = "sell"
                        
                        # 29 set stessa condizione speciale ma vedi che cambia di pochissimo dev 39 e anche deviation_ma100_sopra_ma300

                  

                    ######################################################################################################################## condizioni speciali importate ridotte
                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma59_last > ma100_last
                        
                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.099
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 3 EX condizione speciale 6 GIORNO con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.099 - con ma50 < e con ma5 sotto ma200 > -0.90 - r 14291 a"
                        action = "sell"
                
                        # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                        # 15 set 2023 quando GIORNO a -0.11 da -0.07
                        # 15 set 2023 quando GIORNO a -0.102 da -0.11
                        
                        # 29 set 2023 stessa condizione speciale ma vedi che cambia di pochissimo dev 39 e anche deviation_ma100_sopra_ma300
                        # 29 ott 2023 dev sell a -0.09 da 0.102

                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma59_last < ma100_last
                        
                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.09
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 3 EX condizione speciale 6 GIORNO con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.09 - con ma50 < e con ma5 sotto ma200 > -0.90 - r 14291 b"
                        action = "sell"
                
                        # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                        # 15 set 2023 quando GIORNO a -0.11 da -0.07
                        # 15 set 2023 quando GIORNO a -0.102 da -0.11
                        
                        # 29 set 2023 stessa condizione speciale ma vedi che cambia di pochissimo dev 39 e anche deviation_ma100_sopra_ma300
                        # 29 ott 2023 dev sell a -0.09 da 0.102
                    
                    elif (
                        ma8_last < ma8_2_min_ago 
                        and deviation_ma39 < 0.01
                        and deviation_sell < -0.02
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.10
                
                        and deviation_ma3_sotto_ma150 > -1.20
                        and ma2_last <= ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 3 ex cond. spec 3 r 15985 A1ok2B - CON 50< e ma8 < ma8_2_min_ago e dev 3-39 < 0.01 e dev sell < -0.015 and macd_diff_2_min_ago < -0.25 - r 14292"
                        action = "sell"
                
                        # 18 set 2023 dev sell -0.02 da -0.01
                        # 18 set 2023 dev 39 da 0.01 da -0.01
                        # 17 OTT 2023 NON METTERE MACD <  MACD 2 MIN AGO
                        # 17 ott 2023 and macd_differenza_2_min_ago < -0.25

                  
                    
                  
                    

              
                    
                    
            #######################################################################################################
            
            elif self.session > 3:
                

                ################################################################################################### sessione 4-5-x ( 0-3 min )
                
                if seconds_since_last_trade > 0 and seconds_since_last_trade <= 180:
                    

                    # con ma50 >

                    if (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma18_last
                        and deviation_sell < -0.33
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (0-3 min) con ma50 > and 3<18 and deviation_sell < -0.33 - r 14311"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma5_prev > ma25_prev and ma5_last < ma25_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 4-5-x SELL (0-3 min) con ma50 > and incrocio 5-25 and deviation_sell 0.25 - 0.56 MARADONA - r 14326"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma4_prev > ma20_prev and ma4_last < ma20_last)
                        and deviation_sell > 0.57 and deviation_sell < 0.79
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (0-3 min) con ma50 > and incrocio 4-20 and deviation_sell 0.57 - 0.79 RONALDO - r 14340"
                        action = "sell"
                        
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 0.80 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x (0-3 min) con ma50 > and incrocio 3-13 and deviation_sell 0.80 - 1.20 - r 14352"
                        action = "sell"
                        
                        
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x (0-3 min) con ma50 > and incrocio 3-11 and dev_sell > 1.21 (che sarebbe come IL DRIBBLING ALLA RONALDO !) - r 14365"
                        action = "sell"
                        
                        

                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (0-3 min) con ma50 < and incrocio 3-28 - r 14378"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (0-3 min) con ma50 < and incrocio 3-33 and deviation_sell -0.23 - r 14391"
                        action = "sell"
                        
                        

                    # ---------------------------------------------------------------------------------------------------------------------- crollo

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma16_prev and ma3_last < ma16_last)
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x CROLLO (0-3 min) con ma50 < and incrocio 3-16 and deviation_sell < -0.50 - r 14404"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x CROLLO (0-3 min) con ma50 < and incrocio 3-23 and deviation_sell > 0.23 - r 14418"
                        action = "sell"
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma8_prev and ma3_last < ma8_last)
                        and deviation_sell > 0.60
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x CROLLO (0-3 min) con ma50 < and incrocio 3-8 and deviation_sell > 0.60 - r 14431"
                        action = "sell"
                        
                        

                ################################################################################################ sessione 3-4-x ( 3-7 min )

                # VENDITA - da 3 a 7 minuti = da 180 a 420 secondi

                elif seconds_since_last_trade > 180 and seconds_since_last_trade <= 420:
                    
                    if (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma16_last
                        
                        and ma39_last > ma200_last
                        
                        and deviation_sell < -0.38
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 >  and 39 > 200 and 3 < 16 and deviation_sell < -0.38 - r 14452"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma3_last < ma16_last
                        
                        and ma39_last < ma200_last
                        
                        and deviation_sell < -0.32
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 > and 39 < 200 and 3 < 16 and deviation_sell < -0.32 - r 14470"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 > and 5-25 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 14491"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma4_last < ma20_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 > and 4<20 and deviation_sell 0.57 - 0.90 - DRIBBLING ALLA RONALDO - r 14506"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma20_prev and ma3_last < ma20_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.40
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 > and incrocio 3-20 and deviation_sell 0.91 - 1.40 - r 14520"
                        action = "sell"
                        
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 1.41
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 > and incrocio 3-15 and deviation_sell > 1.41 - r 14531"
                        action = "sell"
                        
                        
                        
                        

                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 < and incrocio 3-28 - r 14547"
                        action = "sell"
                        
                        # deviation_sell_ma78 = ma3_last / ma78_last
                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        and deviation_sell < -0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 < and incrocio 3-33 and deviation_sell < -0.23 - r 14562"
                        action = "sell"

                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell < -0.05
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -8
                    ):
                        sell = "SELL 4-5-x (3-7 min) con ma50 < and incrocio 3-30 and deviation_sell < -0.23 - r 14565"
                        action = "sell"
                        
                        # 27 gen 2024 se il macd ha una grande accelerazione al ribasso vendo prima con dev sell a -0.05 da -0.23
                        # 27 gen 2024 3-30 da 3-33

                    # --------------------------------------------------------------------------------------------------------------- guadagno con crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x GUADAGNO CON CROLLO (3-7 min) con ma50 < and incrocio 3-23 and deviation_sell > 0.23 - r 14575"
                        action = "sell"

                  
                        
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x PARACADUTE CROLLO (3-7 min) con ma50 < and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 14586"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                  

                    ######################################################################################################################   condizioni speciali importate ridotte

                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma2_differenza_2_min_ago < -4
                
                        and ma300_last > ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.075
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 4-5-x (3-7 min) EX condizione speciale r 16047 B3 NOTTE con ma300> 5 ore e dev 3-39 < 0.05 and dev_sell < -0.075 - con ma50 < - r 14587"
                        action = "sell"
                
                        # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                        # 17 nov 203 aggiunto and ma2_differenza_2_min_ago < -5
                    

                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma10_last > ma20_last
                        and ma50_last < ma59_last
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.02
                
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        
                        and ma2_last < ma3_last
                        and macd_differenza_2_min_ago < -0.20
                        and ma2_differenza_2_min_ago < -8
                    ):
                        sell = "SELL 4-5-x (3-7 min) EX cond spec 16047 A1Y CON 50<59 con dev 3-39 < 0.05 e dev_sell < -0.02 con ma50 < and macd_diff_2_min_ago < -0.20 - r 14588 X"
                        action = "sell"
                        
                        # 24 dic 2023 se 10>20 and deviation_sell a 0.01 da 0.05
                        # 24 dic 2023 se 10>20 and ma2_differenza_2_min_ago < -8 da -6
                        #  8 gen 2024 se 10>20 and deviation_sell a -0.02 da 0.01
                    
                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma10_last < ma20_last
                        and ma50_last < ma59_last
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.05
                
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                        and ma2_differenza_2_min_ago < -6
                    ):
                        sell = "SELL 4-5-x (3-7 min) EX cond spec 16047 A1Y CON 50<59 con dev 3-39 < 0.05 e dev_sell < 0.05 con ma50 < and macd_diff_2_min_ago < -0.20 - r 14588y"
                        action = "sell"
                        
                        # 20 nov 2023 aggiunta and ma2_differenza_2_min_ago < -6
                  
                    


              
                    
                        
                        
                        

                ######################################################################################## sessione 3-4-x  (7-12 min !)

                # VENDITA - da 7 a 12 minuti = da 4200 a 720 secondi

                elif seconds_since_last_trade > 420 and seconds_since_last_trade <= 720:
                    

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.41
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (7-12 min) con ma50 > and incrocio 3-78 and deviation_sell < -0.41 - r 14607"
                        action = "sell"
                        
                    # deviation_sell = ma3_last/last_trade_price
                    # guardare la stella (guardare da una stella!)
                    # QUESTO E' IL RISCHIO PIU' GRANDE CHE PRENDO ! ( ma con ma50 > ma50 2 min ago DOPO 5 min (+2))
                    # e qua mi ha fottuto con la vendita -1.46 al min 6 del 19 dic 2021 - cambiato crollo improvviso ! e cambiato condizioni e anche fascia da 5-12
                    
                    
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.25
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (7-12 min) con ma50 > and incrocio 5-100 (cuscino di sant' antonio) and deviation_sell < -0.25 - r 14624"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (7-21 min) con ma50 > and 5-25 and deviation_sell 0.25-0.56 - FINTA ALLA MARADONA - r 14638"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma4_last < ma20_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                  
                    ):
                        sell = "SELL 4-5-x (7-12 min) con ma50 > and 4-20 and deviation_sell 0.57 - 0.90 - DRIBBLING ALLA RONALDO - r 14653"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (7-12 min) con ma50 > and incrocio 3-25 and deviation_sell 0.91 - 1.20 - r 14668"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (7-12 min) con ma50 > and incrocio 3-25 and deviation_sell > 1.21 - r 14682"
                        action = "sell"
                        
                        

                    ###########################################################################     trend in ribasso

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell < -0.30
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (7-12 min) con ma50 < and incrocio 3-28 - r 14695"
                        action = "sell"

                        # incrocio 3 -28 e' fondamentale per evitare punto rosso sovrapposto al punto verde !
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (7-12 min) con ma50 < and incrocio 3-100 (cuscino di sant' antonio) - r 14708"
                        action = "sell"
                        
                        

                    # ------------------------------------------------------------------------------- guadagno con crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma23_prev and ma3_last < ma23_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x guadagno con crollo (7-12 min) con ma50 < and incrocio 3-23 - r 14721"
                        action = "sell"
                        
                        

                    # --------------------------------------------------------------------------------------------------- PARACADUTE crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x PARACADUTE CROLLO (7-12 min) con ma50 < and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 14734"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE
                        
                        

                        
                ############################################################################################################## sessione 3-4-x ( 12-21 min )

                # VENDITA - da 12 a 21 minuti = da 720 a 1260 secondi

                elif (
                    seconds_since_last_trade > 720 and seconds_since_last_trade <= 1260
                ):
                    

                    if (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma72_prev and ma3_last < ma72_last)
                        and deviation_sell < -0.35
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and incrocio 3-72 and deviation sell -0.65 e vaffanculo ! - r 14757"
                        action = "sell"
                        
                        # and deviation_ma39 < -0.29 vendeva troppo presto
                        # ATTENZIONE "and (ma3_prev > ma39_prev and ma3_last < ma39_last)" con ma39 NON HA INCROCIATO
                        # and deviation_sell < -0.30
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma100_prev and ma3_last < ma100_last)
                        and deviation_sell < -0.36
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and incrocio 3-100 cuscino di sant' antonio and deviation_sell < 0.36 - r 14774"
                        action = "sell"
                    
                        # viva sant' antonio !
                        # IMPORTANTE !   
                        # vai compaaaaaaaaaa
                        # poco guadagno ma piu' alta
                        # molto guadagno ma piu' bassa
                    
                    
                    
                    
                    #################################################################### and rapporto_delta_1_delta_2 > 1 and ma100_last > ma100_60_min_ago
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma5_last < ma25_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and 5-25 and dev_sell 0.25-0.56 - FINTA ALLA MARADONA sopra rialzo rialzo - GIORNO - r 14805"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                    ########################################################################### DOPPIO DELTA<1 AND 100< TRAMONTO
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        
                        
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma3_last < ma50_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50>and 3-50 and dev_sell 0.25-0.56 - SOPRA RIBASSO RIALZO - CREPUSCOLO - FINTA MARADONA - r 14830"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        
                        ###################################################################
                        
                        
                    ######################################################## and rapporto_delta_1_delta_2 > 1 AND 100> SORGERE
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma4_last < ma20_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and 4-20 e dev_sell 0.57 - 0.90 - SORGERE DRIBBLING ALLA RONALDO - GIORNO - r 14863"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                      
                        
                    ################################################################## and rapporto_delta_1_delta_2 < 1 TRAMONTO
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        
                        
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_ma100_sopra_ma200 > -0.10
                        and ma3_last < ma50_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and 3-50 and dev_sell 0.57 - 0.90 - DRIBBLING RONALDO sopra ribasso rialzo -CREPUSCOLO - r 14888"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 100 DEVE STARE SOPRA 200 per non vendere durante il crollo con ma50
                        
                        ###############################################################
                        
                      
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.20
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and incrocio 3-25 and deviation_sell 0.91 - 1.20 - r 14909"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                        

                    elif (
                        ma50_last >= ma50_2_min_ago
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 1.21
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and incrocio 3-30 and deviation_sell > 1.21 - r 14923"
                        action = "sell"
                        
                    
                    
                    
                    ##########################################################################################
                    
                    # NON TOCCARE ! CUSCINO DI SANT' ANTONIO !
                    # L' INCROCIO 5-100 MI SALVA ! MA 5<100 VENDE DURANTE IL RIBASSO !
                    
                    
                    

                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma39_last > ma50_last
                        and ma300_last > ma300_180_min_ago
                        
                        and deviation_ma39 < -0.17
                        and deviation_sell < -0.02

                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 < and deviation_ma39 < -0.17 - r 14943 x1"
                        action = "sell"

                        #  4 apr 2025 con ma300_last > ma300_180_min_ago
                        #  7 apr 2025 SE ma39_last > ma50_last aggiunto and deviation_sell < -0.02 lascia correre se 300 > 3 ore !



                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma39_last < ma50_last
                        and ma300_last > ma300_180_min_ago
                        
                        and deviation_ma39 < -0.17
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 < and deviation_ma39 < -0.17 - r 14943 x2"
                        action = "sell"

                        #  4 apr 2025 con ma300_last > ma300_180_min_ago




                    elif (
                        ma50_last < ma50_2_min_ago

                        and ma300_last < ma300_180_min_ago
                        

                        and deviation_ma39 < -0.17
                        and deviation_sell < -0.05

                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 < and deviation_ma39 < -0.17 - r 14943 y"
                        action = "sell"
                        
                        # and (ma3_prev > ma33_prev and ma3_last < ma33_last)
                        # and deviation_sell < -0.25
                        # ATTENZIONE QUESTA aveva FATTO -0.61% !
                        # QUINDI ho abbassato da 0.17 a 0.16 a 0.15
                        # HO NOTATO CHE ANCHE INCROCIO 5-100 SAREBBE ARRIVATO TARDI
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10
                        #  4 apr 2025 con ma300_last < ma300_180_min_ago aggiunta and deviation_sell < -0.05
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.45
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.45 - r 14963"
                        action = "sell"
                        
                        # ALLORA METTO incrocio 3-78 e deviation < 0.10 e vaffanculo ! ma solo se ma50< !
                        
                        
                        

                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                     
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 < and CUSCINO DI SANT' ANTONIO - r 14978"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # incrocio 5-100 no 5<100 altrimenti vende durante il crollo !
                        
                        
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma3_last < ma16_last
                        and deviation_sell < -0.50
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x PARACADUTE CROLLO (12-21min) con ma50< and ma3<ma16 (no incrocio) and deviation_sell < -0.50 - r 14995"
                        action = "sell"

                        # AGGIUNTA PER SICUREZZA SE CONTINUA A PRECIPITARE




                    # ----------------------------------------------------------------------------- guadagno con crollo
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and (ma3_prev > ma18_prev and ma3_last < ma18_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = f"SELL 4-5-x eventuale guadagno con crollo (12-21 min) con ma50 < and incrocio 3 - 18 and deviation_sell > 0.23 - r 15011 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"

                        # 20 ott 2025 ok !
                        # 20 ott 2025 aggiunte pg


                  
                    # --------------------------------------------------------------------------------- EX CONDIZIONI SPECIALI IMPORTATE ridotte
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        
                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.05
                        
                        and deviation_ma100_sopra_ma300 > 0.20
                        
                        and delta_450_300 < delta_450_300_60_min
                
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                
                        and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12
                
                        and deviation_ma3_sotto_ma150 > -1.20
                
                
                        and ma2_last <= ma2_2_min_ago
                        and ma2_last < ma5_last
                        and price < ma3_last
                    ):
                        sell = "SELL 4-5-x (12-21 min) EX cond. special 15985 A1 ok 4 con 3-39 < 0.06 e dev sell < -0.05 con ma50 < and price < ma3 - r 15012"
                        action = "sell"
              
                        # 27 set 2023 dev sell -0.11 da -0.10
                        # 25 ott 2023 aggiunta ma2 < ma5
                        # 25 ott 2023 dev sell -0.12 da -0.11
                        # 25 ott 2023 aggiunto price < ma3 !
                        # 25 ott 2023 3-39 < 0.06 da < -0.01
                        # 25 ott 2023 dev sell < -0.05 da < -0.12

                  
                    elif (
                
                        ma50_last > ma50_2_min_ago
                
                        and deviation_ma39 < -0.05
                        and deviation_sell < -0.10
                
                        and ma2_last <= ma2_2_min_ago 
                        and delta_450_300 < delta_450_300_60_min
                
                        and deviation_ma100_sopra_ma300 > 0.20
                
                        and deviation_ma3_sotto_ma150 > -1.20
                    ):
                        sell = "SELL 4-5-x (12-21 min) EX cond. spec 15985 A1x - ma50_last > ma50_2_min_ago con 3-39 < -0.05 e dev sell < -0.10 - r 15013"
                        action = "sell"
                        
                        # 23 nov 2023 and deviation_sell < -0.10 da -0.31
                        # 23 nov 2023 and deviation_ma39 < -0.05 da -0.20





                    elif (    
                        ma50_last <= ma50_2_min_ago
                        and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_ma39 < 0.13
                        and deviation_sell < -0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.10
                        and ma2_differenza_2_min_ago < -7
                    ):
                        sell = "SELL 4-5-x (12-21 min) se ma50<= e dev_sell < 0.03 E 300 < 300 301 min ago e macd_diff_2_min_ago < -0.10 - GIORNO - r 15014 A"
                        action = "sell"
                        
                        # 18 nov 2023 and deviation_sell < 0.02 da < -0.01
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <
                        
                        # 27 nov 2023 and dev 39 < 0.03 da 3<39
                        # 27 nov 2023 and deviation_sell < 0.03 da < -0.01
                        # 11 ago 2025 se CM GIORNO dev sell a -0.01 da 0.03



                    elif (    
                        ma50_last <= ma50_2_min_ago
                        and delta_CM_300_25_last > delta_CM_300_25_2_min_ago

                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_ma39 < 0.13
                        and deviation_sell < 0.03
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.10
                        and ma2_differenza_2_min_ago < -7
                    ):
                        sell = "SELL 4-5-x (12-21 min) se ma50<= e dev_sell < 0.03 E 300 < 300 301 min ago e macd_diff_2_min_ago < -0.10 - NOTTE - r 15014 B"
                        action = "sell"
                        
                        # 18 nov 2023 and deviation_sell < 0.02 da < -0.01
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <
                        
                        # 27 nov 2023 and dev 39 < 0.03 da 3<39
                        # 27 nov 2023 and deviation_sell < 0.03 da < 0.02
                        # 11 ago 2025 se CM NOTTE dev sell a -0.01. (inalterato)
                    
                    

                    
                    
                        
                        
                        
                  
                    
                        
                        

                ########################################################################################################### sessione 3-4-x ( 21-60 min )
                

                # VENDITA - da 21 a 60 minuti = da 1261 a 3600 secondi

                elif (
                    seconds_since_last_trade > 1261 and seconds_since_last_trade <= 3600
                ):
                    
                    
                    ############################################################################## RIGHE DEL COMPA RADDOPPIATE PER AUMENTARE TOLLERANZA
                    
                    if (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.33
                        and delta_1_200_78 < delta_2_200_78_60_min
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and deviation_ma25 < -0.33 - r 15034 A"
                        action = "sell"
                        
                        # 18 nov 2022 aggiunto doppio delta 78-200
                        
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.30
                        and delta_1_200_78 > delta_2_200_78_60_min
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and deviation_ma25 < -0.30 - r 15034 B"
                        action = "sell"
                        
                        # 18 nov 2022 aggiunto doppio delta 78-200
                     
                    
                    elif ( 
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.238 
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and (deviation_sell < -0.238 and ma3_last < ma50_last) - r 15046"
                        action = "sell"
                        
                        # 25 gen 2023 dev_sell a -0.238 da 0.24 dopo -0.95% ore 10:04 del 24 gen 2023


                     
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma39_last > ma50_last
                        and deviation_sell > 0.50

                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.19
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 100>300 E 39>50 and deviation_ma25 < -0.20 e dev sell > 0.50 - r 15058 A1 X"
                        action = "sell"

                        # 25 nov 2023 and deviation_ma100_sopra_ma300 > 0.30
                        # 25 nov 2023 and deviation_ma25 < -0.19 da -0.20
                        #  7 apr 2025 se anche ma39_last > ma50_last allora lascia correre cazzo (dev sell deve essere di almeno lo 0.50)
                        
                         
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.30
                        and ma39_last < ma50_last

                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.19
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 100>300 MA 39<50 E deviation_ma25 < -0.20  - r 15058 A2 Y"
                        action = "sell"

                        # 25 nov 2023 and deviation_ma100_sopra_ma300 > 0.30
                        # 25 nov 2023 and deviation_ma25 < -0.19 da -0.20
                        #  7 apr 2025 100>300 ma 39<50

                  
                  
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.30
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.20
                        and deviation_sell < -0.02
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and deviation_ma25 < -0.20 and deviation_sell < -0.02 - r 15058b"
                        action = "sell"
                        
                        # 30 ott 2023 and deviation_ma25 a -0.25 da -0.30
                        #  8 nov 2023 and deviation_ma25 a -0.20 da -0.25
                        
                        # 25 nov 2023 and deviation_ma100_sopra_ma300 < 0.30
                        # 25 nov 2023 and deviation_sell < -0.04
                       
                    
                    elif (        
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.28 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                        and ma450_last > ma450_480_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and (deviation_sell < -0.28 and ma3_last < ma50_last) - r 15071 A"
                        action = "sell"
                        
                        # 23 feb 2023 dev sell 0.28 da 0.26
                        
                        
                    elif (        
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.26 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                        and ma450_last < ma450_480_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and (deviation_sell < -0.26 and ma3_last < ma50_last) - r 15071 B"
                        action = "sell"
                        
                        
                      
                        #############################################################################################################
                    

                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.26
                        and ma2_last < ma2_2_min_ago
                  
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and incrocio 5-100 cuscino di sant' antonio (no 5<100) and deviation_sell < -0.26 - r 15085"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                    #######################################################
                    
                    
                    # FINTA DI MARADONA
                    
                    ###################################################### and rapporto_delta_1_delta_2 > 1 AND 100> SORGERE
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 4-5-x (21-60 min) 300 > 120 min ago e con ma50 > and incr 5-100 and dev_sell 0.25 - 0.56 - GIORNO - FINTA MARADONA - r 15110 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 22 set se 300 > 120 min ago 5-100 !


                        
                    elif (
                        ma50_last >= ma50_2_min_ago

                        and ma100_last > ma450_last
                        and ma300_last < ma300_120_min_ago

                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.020
                        and ma2_last < ma5_last
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 300 < 120 min e incr 5-78 E dev_sell 0.25-0.56 - GIORNO - MARADONA - r 15110 B1"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        #  4 nov 2023 4-28 da 5-33
                        # 12 dic 2023 4-30 da 4-28 
                        # 12 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02 = -8 pts
                        # 26 dic 2023 aggiunta and macd_differenza_2_min_ago < -0.50
                        # 12 set 2024 4-39 da 4-30

                        # 19 feb 2025 e' giorno ! cioe' 100 divarica da 200 verso l' alto ! 
                        # 19 feb 2025 sell con 5-78 da 4-39 se anche ma100_last > ma450_last
                        # 19 feb 2025 avrei dovuto mettere vendi con 39-100 ! ma non me la sono sentita !
                        
                          
                    elif (
                        ma50_last >= ma50_2_min_ago

                        and ma100_last < ma450_last
                        and ma300_last < ma300_120_min_ago

                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        
                        and (ma5_prev > ma69_prev and ma5_last < ma69_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.020
                        and ma2_last < ma5_last
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 300 < 120 min e incr 5-69 E dev_sell 0.25-0.56 - GIORNO - MARADONA - r 15110 B2"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        #  4 nov 2023 4-28 da 5-33
                        # 12 dic 2023 4-30 da 4-28 
                        # 12 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02 = -8 pts
                        # 26 dic 2023 aggiunta and macd_differenza_2_min_ago < -0.50
                        # 12 set 2024 4-39 da 4-30

                        # 19 feb 2025 e' giorno ! cioe' 100 divarica da 200 verso l' alto ! 
                        # 19 feb 2025 sell con 5-49 da 4-39
                        # 24 ott 2025 sell con 5-69 da 4-49




                     
                    ##################################################################### and rapporto_delta_1_delta_2 < 1 tramonto
                    
                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                   
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        and ma300_last > ma300_120_min_ago
                        
                        and deviation_ma100_sopra_ma200 > -0.10
                        and (ma4_prev > ma100_prev and ma4_last < ma100_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50> and incrocio 4-100 and dev_sell 0.25-0.56 FINTA MARADONA -CREPUSCOLO - r 15132 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 100 deve stare sopra 200 per non vendere con ma50 durante il crollo.
                        # # 22 set se 300 > 120 min ago 5-100 !
                        
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                   
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and deviation_ma100_sopra_ma200 > -0.10
                        and (ma4_prev > ma50_prev and ma4_last < ma50_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                   
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50> and incrocio 4-50 and dev_sell 0.25-0.56 FINTA MARADONA -CREPUSCOLO - r 15132 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 100 deve stare sopra 200 per non vendere con ma50 durante il crollo.
                        # # 22 set se 300 > 120 min ago 4-50 !
                        
                        
                        
                        
                    
                        
                    elif (
                        ma3_last < ma49_last
                        and ma300_last > ma300_301_min_ago
                        and ma200_last > ma200_60_min_ago
                        
                        and deviation_sell > 0.68
                        
                        and ma2_last < ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -7
                        
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 3-4-x (21-60 min) con 300> 5 ore tra MARADONA e RONALDO sell con 3-49 and dev_sell > 0.68 - r 15157 a"
                        action = "sell"
                         
                        #  6 mar 2024 dev sell 3-33 da 3-28
                        # 10 mag 2025 dev sell 3-49 da 3-33



                    elif (
                        ma3_last < ma28_last
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last > ma200_60_min_ago
                        
                        and deviation_sell > 0.68
                        
                        and ma2_last < ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -7
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -2
                    ):
                        sell = "SELL 3-4-x (21-60 min) con 300> 5 ore tra MARADONA e RONALDO ho messo P-M-S 18 and dev_sell > 0.68 - r 15157 b"
                        action = "sell"
                        
                        # 3-18 da 3-13 dopo dolomiti
                        # > estate 3-28 da 3-18
                        
                        #  6 mar 2024 aggiunto and ma2_differenza_2_min_ago < -7
                        #  6 mar 2024 aggiunto and macd_differenza_2_min_ago < -2
                        
                        
                        
                    
                    # FINTA ALLA RONALDO
                    
                    
                    ######################################################################## and rapporto_delta_1_delta_2 > 1 AND 100> SORGERE


                    elif (
                        ma50_last > ma50_2_min_ago
                        and delta_CM_300_25_last < delta_CM_300_25_2_min_ago 
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma4_last < ma50_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 4-5-x (21-60 min) con cm giorno con ma50 > and 4-50 (no incrocio 3-15) and deviation_sell 0.57 - 0.90 FINTA RONALDO - GIORNO - r 15185 a"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # > estate 3-39 da 3-28
                        # 24 ott 2025 se cm giorno 4-50 da 3-39



                    elif (
                        ma50_last > ma50_2_min_ago
                        and delta_CM_300_25_last > delta_CM_300_25_2_min_ago 
                        
                        and delta_1 < delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and ma5_last < ma39_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 4-5-x (21-60 min) con cm notte con ma50 > and 5-39 (no incrocio 3-15) and deviation_sell 0.57 - 0.90 FINTA RONALDO - GIORNO - r 15185 b"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # > estate 3-39 da 3-28
                        # 24 ott 2025 se cm notte 5-39 da 3-39
                        
                        
                    ######################################################## and rapporto_delta_1_delta_2 < 1 tramonto
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        
                        and delta_1 > delta_2
                        and ma100_last > ma100_60_min_ago
                        
                        and deviation_ma100_sopra_ma200 > -0.10
                        and ma3_last < ma50_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                      
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and 3-50 (no incrocio 3-15) e dev_sell 0.57-0.90 FINTA ALLA RONALDO - CREPUSCOLO - r 15208"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 100 dee stare sopra 200 per non vendere con ma50 durante il crollo o un grande ribasso
                        
                        
                        
                        ###################################################################################################
                        
                        
                       
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 1.20
                        and ma5_last < ma100_last
                        and deviation_sell > 0.91 and deviation_sell < 1.40
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 5-300 > 1.20 E con ma50 > and 5-100 and deviation_sell 0.91 - 1.40 - r 15236 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 1.20
                        and deviation_ma5_sotto_ma300 > 0.40
                        and ma5_last < ma78_last
                        and deviation_sell > 0.91 and deviation_sell < 1.40
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 5-300 tra 0.40 e 1.20 1.20 E con ma50 > and 5-78 and deviation_sell 0.91 - 1.40 - r 15236 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        and deviation_ma5_sotto_ma300 < 0.40
                        and ma3_last < ma28_last
                        and deviation_sell > 0.91 and deviation_sell < 1.40
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 5-300 < 0.40 E con ma50 > and 3-28 and deviation_sell 0.91 - 1.40 - r 15236 C"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        
                      
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last > ma300_last

                        and ma3_last < ma50_last

                        and deviation_sell > 1.41 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 100>300 e con ma50 > and 3-50 and deviation_sell 1.41 -2.70 - r 15250 x"
                        action = "sell"

                        #  8 apr 2025 se 100>300 vendi con 3-50

                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma300_last

                        and ma3_last < ma30_last

                        and deviation_sell > 1.41 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con 100<300 e con ma50 > and 3-30 and deviation_sell 1.41 -2.70 - r 15250 y"
                        action = "sell"

                        #  8 apr 2025 se 100<300 vendi con 3-30


                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        and (ma3_prev > ma11_prev and ma3_last < ma11_last)
                        and deviation_sell > 3.00
                        and deviation_ma39 > 1.80

                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and incrocio 3-11 and deviation_sell > 3.00 and 3-39 > 1.80 - r 15261"
                        action = "sell"

                        #  8 apr 2025 ok cosi' potrai in futuro pensare a 3-39 > 2.00 and dev sell > 3.00 con 3-11
                        #  8 apr 2025 fatto ! male che va VENDE SOPRA IL 3%

                        

                    elif (
                        ma50_last > ma50_2_min_ago
                        
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and incrocio 3-13 and deviation_sell > 2.71 - r 15262"
                        action = "sell"

                        #  8 apr 2025 ok cosi' 


                        

                    
                    ################################################################################################# con trend discendente
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma50_last > ma100_last
                        and deviation_ma5_sotto_ma300 > 0.35
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.29
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATA (21-60 min) con ma50 < and deviation_ma39 < -0.29 - r 15277 A"
                        action = "sell"
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma50_last > ma100_last
                        and deviation_ma5_sotto_ma300 < 0.35
                        and deviation_sell < -0.331
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.29
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATA (21-60 min) con ma50 < and deviation_ma39 < -0.29 - r 15277 B"
                        action = "sell"
                        
                      
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma50_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.28
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_ma39 < -0.28 - r 15290"
                        action = "sell"
                        
                        
                   
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma50_last > ma100_last
                        and ma100_last > ma200_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.29
                        and ma3_last < ma39_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATA (21-60 min) con ma50 < and deviation_sell < 0.32 100>200 !- r 15310"
                        action = "sell"
                        
                        
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma50_last > ma100_last
                        and ma100_last < ma200_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.29
                        and ma3_last < ma39_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATA (21-60 min) con ma50 < and deviation_sell < 0.29 100<200 - r 15326"
                        action = "sell"
                        
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma100_last < ma100_60_min_ago
                        and ma300_last < ma300_120_min_ago
                        
                        and ma5_last < ma100_last
                        and deviation_sell < -0.22
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 > and 5-100 and dev_sell < -0.22 CUSCINO DELLA MADONNA se ma100 < E DE SANTO RENATO 300 < - r 15348"
                        action = "sell"
                        
                        
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma50_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.32
                        and ma3_last < ma39_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_sell < -0.32 se 300 < 300 301 min ago - r 15349a"
                        action = "sell"


                  
                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < -0.27
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago > 0.05
                        
                        and ma2_last < ma2_2_min_ago 
                         
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_sell < -0.27 se 300 < 300 301 min ago - r 15349 B prova 1"
                        action = "sell"
                        
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago > 0.05 da > 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <

                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < -0.05
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_sell < -0.27 se 300 < 300 301 min ago - r 15349 B prova 2"
                        action = "sell"
                        
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <

                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < -0.12
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago > 0.05
                        
                        and ma2_last < ma2_2_min_ago 
                         
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_sell < -0.27 se 300 < 300 301 min ago - r 15349 B prova 3"
                        action = "sell"
                        
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago > 0.05 da > 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <
                  

                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < 0.03
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_sell < 0.03 se 300 < 300 301 min ago and macd_diff_2_min_ago < -0.20 - r 15349 B PROVA 4"
                        action = "sell"
                        
                        # 18 nov 2023 and deviation_sell < 0.02 da < -0.01
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <
                        # 27 nov 2023 and deviation_sell < 0.03 da < 0.02




                    
                    elif (    
                        ma50_last <= ma50_2_min_ago
                        and deviation_ma3_sotto_ma50 > -0.70

                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < -0.01
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50< E dev_sell < -0.01 se 300 < 300 301 min E 3-50 > -0.70 - r 15349 B prova 5 x"
                        action = "sell"
                        
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <




                    elif (    
                        ma50_last <= ma50_2_min_ago
                        and deviation_ma3_sotto_ma50 < -0.70
                        and ma5_last > ma5_30_min_ago

                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < -0.025
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50< E dev_sell < -0.025 se 300 < 300 301 min E 3-50 < -0.70 - r 15349 B prova 5 y1"
                        action = "sell"
                        
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <

                        #  8 apr 2025 se deviation_ma3_sotto_ma50 < -0.70 allora dev sell a -0.02 da -0.01
                        #  8 apr 2025 se and ma5_last > ma5_30_min_ago allora dev sell a -0.025



                    elif (    
                        ma50_last <= ma50_2_min_ago
                        and deviation_ma3_sotto_ma50 < -0.70
                        and ma5_last < ma5_30_min_ago

                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < -0.02
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < E dev_sell < -0.02 se 300 < 300 301 min E 3-50 < -0.70 - r 15349 B prova 5 y2"
                        action = "sell"
                        
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <

                        #  8 apr 2025 se deviation_ma3_sotto_ma50 < -0.70 allora dev sell a -0.02 da -0.01





                    
                  
                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < -0.13
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago > 0.05
                        
                        and ma2_last < ma2_2_min_ago 
                        
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_sell < -0.27 se 300 < 300 301 min ago - r 15349 B prova 6"
                        action = "sell"
                        
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago > 0.05 da > 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <



                  

                  
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        and ma50_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.27
                        and ma3_last < ma39_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_sell < -0.27 se 300 < 300 301 min ago - r 15349 B"
                        action = "sell"
                        
                      
            
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_60_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.37
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.37 - r 15368"
                        action = "sell"
                    
                    
                    
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last < ma200_60_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and INCROCIO 3-100 (no 3<100) CUSCINO DI SANT' ANTONIO - r 15383"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # NON INCROCERANNO MAI DURANTE IL CROLLO !
                        # non toccare ! INCROCIO 3-100 CUSCINO DI SANT' ANTONIO !
                        
                        
                        
                    ##################################################################################################### aumenta la tolleranza    
                        
                    elif (
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.26
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and deviation_ma39 < -0.26 - r 15406"
                        action = "sell"
                        
                 
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma78_last > ma78_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.33
                        and ma3_last < ma39_last
                        and ma200_last > ma200_60_min_ago
                        and ma300_last > ma300_120_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and 200> 60 min and 300 > 120 min and deviation_sell < -0.33 CON ma78 < 78 260 min ago - r 15422 a"
                        action = "sell"

                  
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_480_min_ago
                        
                        and ma78_last < ma78_60_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.32
                        and ma3_last < ma39_last
                        and ma200_last > ma200_60_min_ago
                        and ma300_last > ma300_120_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and 200> 60 min and 300 > 120 min and deviation_sell < -0.32 CON ma78 < 78 60 min ago and 450 > - r 15422 B1"
                        action = "sell"
                        
                        # 26 mag 2023 dev sell a -0.32 da -0.33 se 78 < 78 60 min ago
                  
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_480_min_ago
                        
                        and ma78_last < ma78_60_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.10
                        and ma3_last < ma39_last
                        and ma200_last > ma200_60_min_ago
                        and ma300_last > ma300_120_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and 200> 60 min and 300 > 120 min and deviation_sell < -0.10 CON ma78 < 78 60 min ago and 450 < - r 15422 B2"
                        action = "sell"
                        
                        # 26 mag 2023 dev sell a -0.32 da -0.33 se 78 < 78 60 min ago
                        #  5 set 2023 dev sell a -0.10 da -0.32 se 450 < 450 480 min ago
                        
                        
                    elif (    
                        ma50_last < ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.28
                        and ma3_last < ma39_last
                        and ma200_last > ma200_60_min_ago
                        and ma300_last < ma300_120_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and 200> 60 min and 300 < 120 min and deviation_sell < -0.28 - r 15435"
                        action = "sell"
                        
              
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma200_60_min_ago
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.39
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and incrocio 3-78 and deviation_sell < -0.39 - r 15456"
                        action = "sell"
                        
                        
                  
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma200_last > ma200_60_min_ago
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell < -0.29
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (21-60 min) con ma50 < and INCROCIO 5-100 (no 5<100) and deviation_sell < -0.29  CUSCINO DI SANT' ANTONIO - r 15469"
                        action = "sell"
                        
                        # viva sant' antonio !
                        # NON INCROCERANNO MAI DURANTE IL CROLLO !
                        # non toccare ! INCROCIO 3-100 CUSCINO DI SANT' ANTONIO !
                        
                    
                    
                    
                    # -------------------------------------------------------------------------------------- guadagno durante il crollo
                    
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma10_sopra_ma200 > 0.20
                        and (ma3_prev > ma22_prev and ma3_last < ma22_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x eventuale guadagno durante il crollo (21-60 min) con ma50 < incrocio 3 - 20 and deviation_sell > 0.23 - r 15487a"
                        action = "sell"
                        
                        # 17 mar 2023 3-20 da 3-18 vedi 3 mar 2023 ore 3:43 madonna ! c'e' stato un crollo spaventoso e si e' comportato benissimo !


                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_DNA_1 < delta_DNA_2

                        and ma33_last > ma100_last
                        and deviation_ma10_sopra_ma200 < 0.20
                        
                        and (ma3_prev > ma50_prev and ma3_last < ma50_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) eventuale guadagno durante crollo con ma50< e incr 3-50 e dev_sell > 0.23 - GIORNO - r 15487 Ax"
                        action = "sell"
                        
                        # 17 mar 2023 3-20 da 3-18 vedi 3 mar 2023 ore 3:43 madonna ! c'e' stato un crollo spaventoso e si e' comportato benissimo !
                        
                        # 27 feb 2025 se 33 > 100 allora vende con 3-33
                        # 27 feb 2025 3-33 da 3-20
                        # 28 feb 2025 3-50 da 3-33


                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_DNA_1 > delta_DNA_2

                        and ma33_last > ma100_last
                        and deviation_ma10_sopra_ma200 < 0.20
                        
                        and (ma3_prev > ma50_prev and ma3_last < ma50_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) eventuale guadagno durante crollo con ma50< e incr 3-50 e dev_sell > 0.23 - NOTTE - r 15487 Ay"
                        action = "sell"
                        
                        # 17 mar 2023 3-20 da 3-18 vedi 3 mar 2023 ore 3:43 madonna ! c'e' stato un crollo spaventoso e si e' comportato benissimo !
                        
                        # 27 feb 2025 se 33 > 100 allora vende con 3-33
                        # 27 feb 2025 3-33 da 3-20
                        # 28 feb 2025 3-50 da 3-33




                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_DNA_1 < delta_DNA_2

                        and ma33_last < ma100_last
                        and deviation_ma10_sopra_ma200 < 0.20
                        
                        and (ma3_prev > ma25_prev and ma3_last < ma25_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) eventuale guadagno durante crollo con ma50< e incr 3-25 e dev_sell > 0.23 - GIORNO - r 15487 Bx"
                        action = "sell"
                        
                        # 17 mar 2023 3-20 da 3-18 vedi 3 mar 2023 ore 3:43 madonna ! c'e' stato un crollo spaventoso e si e' comportato benissimo !

                        # 27 feb 2025 se 33<100 allora vende con 3-28
                        # 27 feb 2025 3-28 da 3-20
                        # 15 ott 2025 e' andata bene. modificata a 3-25 da 3-28


                    elif (
                        ma50_last < ma50_2_min_ago
                        and delta_DNA_1 > delta_DNA_2

                        and ma33_last < ma100_last
                        and deviation_ma10_sopra_ma200 < 0.20
                        
                        and (ma3_prev > ma28_prev and ma3_last < ma28_last)
                        and deviation_sell > 0.23
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (21-60 min) eventuale guadagno durante crollo con ma50< e incr 3-28 e dev_sell > 0.23 - NOTTE - r 15487 By"
                        action = "sell"
                        
                        # 17 mar 2023 3-20 da 3-18 vedi 3 mar 2023 ore 3:43 madonna ! c'e' stato un crollo spaventoso e si e' comportato benissimo !

                        # 27 feb 2025 se 33<100 allora vende con 3-28
                        # 27 feb 2025 3-28 da 3-20




                  



                    ############################################################################################################ CONDIZIONI SPECIALI IMPORTATE RIDOTTE

                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.03
                        
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                        and ma2_differenza_2_min_ago < -6
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX cond spec r 16047 B3 NOTTE con ma300> 5 ore - con dev 3-39 < 0.06 and dev_sell < -0.03 e ma50 < - r 15499"
                        action = "sell"
                        
                        # 23 ott 2023 dev 3-39 a 0.06 da 0.05
                        # 23 ott 2023 dev sell -0.03 da -0.07



                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma39_last > ma100_last

                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.01
                        
                        and deviation_ma5_sopra_o_sotto_ma5_60_min_ago > -0.40
                        and delta_450_300 > delta_450_300_60_min
                        
                        and deviation_ma100_sopra_ma300 > 0.20
                        and deviation_ma3_sotto_ma150 > -1.20
                        
                        and ma2_last <= ma2_2_min_ago 
                        and ma2_differenza_2_min_ago < -6
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX CS con 3-39 < 0.07 e dev sell < 0.01 MA ma50< e 39>100 - r 15500 A1"
                        action = "sell"
                
                        # 27 giu 2022 dev sell a 0.305 da 0.31
                        # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !)
                        # 21 giugno 2022 RICORDO TREMENDO 9372 ha venduto a -2.23% !!!
                        # COME PRIMA COSA HO NOTATO CHE AVEVA DEVIATION INVECE DI DEVIATON SELL 
                        # ma non sapendo se era questo il problema ho creato la prossima condizione speciale.
                        
                        # > estate dev 39 -0.24 da -0.25 dev sell -0.30 da -0.31 
                        # 13 set -3% !!! deviation_ma3_sotto_ma200 > -1.20 da deviation_ma3_sotto_ma200 > -1.20 
                        # 21 gen 2023 dev sell -0.303 da -0.30
                        # 20 feb 2023 -0.304 da -0.303 con doppio delta 450-300 NOTTE !
                        # 25 ott 2023 dev 39 -0.10
                        # 25 ott 2023 dev sell -0.20 da -0.304
                        # 25 nov 2023 dev sell -0.10 da -0.20
                        # 25 nov 2023 dev 39 a -0.05 da -0.10
                        
                        # 19 dic 2023 dev 39 a 0.07 da -0.05
                        # 19 dic 2023 dev sell 0.03 da -0.10
                        # 19 dic 2023 aggiunta and deviation_ma5_sopra_o_sotto_ma5_60_min_ago > -0.40 
                        # cioe' ma5 dopo NON sta scendendo molto dal massimo di 60 min ago. 
                        # 13 apr 2025 se anche 39>100 deviation_sell < 0.01 da < 0.03



                    elif (
                        ma50_last < ma50_2_min_ago
                        and ma39_last < ma100_last

                        and deviation_ma39 < 0.07
                        and deviation_sell < 0.03
                        
                        and deviation_ma5_sopra_o_sotto_ma5_60_min_ago > -0.40
                        and delta_450_300 > delta_450_300_60_min
                        
                        and deviation_ma100_sopra_ma300 > 0.20
                        and deviation_ma3_sotto_ma150 > -1.20
                        
                        and ma2_last <= ma2_2_min_ago 
                        and ma2_differenza_2_min_ago < -6
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX CS con 3-39 < 0.07 e dev sell < 0.03 MA ma50< e 39<100  - r 15500 A2"
                        action = "sell"
                
                        # 27 giu 2022 dev sell a 0.305 da 0.31
                        # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !)
                        # 21 giugno 2022 RICORDO TREMENDO 9372 ha venduto a -2.23% !!!
                        # COME PRIMA COSA HO NOTATO CHE AVEVA DEVIATION INVECE DI DEVIATON SELL 
                        # ma non sapendo se era questo il problema ho creato la prossima condizione speciale.
                        
                        # > estate dev 39 -0.24 da -0.25 dev sell -0.30 da -0.31 
                        # 13 set -3% !!! deviation_ma3_sotto_ma200 > -1.20 da deviation_ma3_sotto_ma200 > -1.20 
                        # 21 gen 2023 dev sell -0.303 da -0.30
                        # 20 feb 2023 -0.304 da -0.303 con doppio delta 450-300 NOTTE !
                        # 25 ott 2023 dev 39 -0.10
                        # 25 ott 2023 dev sell -0.20 da -0.304
                        # 25 nov 2023 dev sell -0.10 da -0.20
                        # 25 nov 2023 dev 39 a -0.05 da -0.10
                        
                        # 19 dic 2023 dev 39 a 0.07 da -0.05
                        # 19 dic 2023 dev sell 0.03 da -0.10
                        # 19 dic 2023 aggiunta and deviation_ma5_sopra_o_sotto_ma5_60_min_ago > -0.40 
                        # cioe' ma5 dopo NON sta scendendo molto dal massimo di 60 min ago. 
                        # 13 apr 2025 se 39<100 deviation_sell ok cosi'


                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < 0.07
                        and deviation_sell < 0.04
                        
                        and deviation_ma5_sopra_o_sotto_ma5_60_min_ago < -0.40
                        and delta_450_300 > delta_450_300_60_min
                        
                        and deviation_ma100_sopra_ma300 > 0.20
                        and deviation_ma3_sotto_ma150 > -1.20
                        
                        and ma2_last <= ma2_2_min_ago 
                        and ma2_differenza_2_min_ago < -6
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX cond. spec 15985 A2 - con 3-39 < 0.07 e dev sell < 0.04 e con ma50 < e dev_ma3_sotto_ma200 > -1.20 - r 15500 b"
                        action = "sell"
                
                        # 27 giu 2022 dev sell a 0.305 da 0.31
                        # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !)
                        # 21 giugno 2022 RICORDO TREMENDO 9372 ha venduto a -2.23% !!!
                        # COME PRIMA COSA HO NOTATO CHE AVEVA DEVIATION INVECE DI DEVIATON SELL 
                        # ma non sapendo se era questo il problema ho creato la prossima condizione speciale.
                        
                        # > estate dev 39 -0.24 da -0.25 dev sell -0.30 da -0.31 
                        # 13 set -3% !!! deviation_ma3_sotto_ma200 > -1.20 da deviation_ma3_sotto_ma200 > -1.20 
                        # 21 gen 2023 dev sell -0.303 da -0.30
                        # 20 feb 2023 -0.304 da -0.303 con doppio delta 450-300 NOTTE !
                        # 25 ott 2023 dev 39 -0.10
                        # 25 ott 2023 dev sell -0.20 da -0.304
                        # 25 nov 2023 dev sell -0.10 da -0.20
                        # 25 nov 2023 dev 39 a -0.05 da -0.10
                        
                        # 19 dic 2023 dev 39 a 0.07 da -0.05
                        # 19 dic 2023 dev sell 0.04 da -0.10
                        # 19 dic 2023 ma5 STA SCENDENDO DI MOLTO dal massimo di 60 min ago e deve vendere subito cazzo !

                  

                    elif (
                        ma78_last < ma78_120_min_ago
                        and macd_differenza_2_min_ago < -0.25
                        
                        and ma300_last < ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.07
                        and deviation_sell < -0.01
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.50
                
                        and ma2_last <= ma2_2_min_ago 
                        and ma2_last < ma5_last
                        and ma2_differenza_2_min_ago < -7
                        
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX cond spec GIORNO con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.01 - con ma50 < e ma5 sotto ma200 > -0.90 - r 15502"
                        action = "sell"
                
                        # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                        # 15 set 2023 quando GIORNO a -0.11 da -0.07
                        #  2 ott 2023 DOPO UN AKTRO -1 HO FATTO QUESTA and deviation_ma5_sotto_ma200 > -0.50
                        #  2 ott 2023 TOLTO and macd < macd_2_min_ago ARRIVATO TARDI ! VEDI 2 OTTOBRE 2023 ORE 20 e 40 - r 16047 B2
                        #  5 ott dev_sell -0.05 da -0.105
                        # 27 ott 2023 aggiunta 2<5                        
                        #  1 nov 2023 dev_sell a -0.01 da -0.05 
                        # 16 nov 2023 aggiunta and macd_differenza_2_min_ago < -0.25 e l' ho messa sopra cazzo NON HA PRESO DIFFERENZA MA2
                        # 16 nov 2023 and ma2_differenza_2_min a -7 da -6



                    elif (
                
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma100_last > ma100_60_min_ago

                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.05
                        
                        and ma2_last <= ma2_2_min_ago 
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.20
                
                        and deviation_ma3_sotto_ma150 > -1.20
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX cond. spec 15985 A1y - con dev 3-39 < 0.05 e dev sell < -0.05 con ma50 < - r 15503 A1"
                        action = "sell"



                    elif (
                
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and ma100_last < ma100_60_min_ago

                        and deviation_ma39 < 0.10
                        and deviation_sell < -0.03
                        
                        and ma2_last <= ma2_2_min_ago 
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.20
                
                        and deviation_ma3_sotto_ma150 > -1.20
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX cond. spec 15985 A1y - con dev 3-39 < 0.05 e dev sell < -0.05 con ma50 < - r 15503 A2"
                        action = "sell"

                        #  4 ott 2024 se ma300 sale da tanto MA ma100 scende da 60 min allora vendi un po' prima...


                    elif (
                
                        ma50_last < ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago

                        and deviation_ma39 < 0.05
                        and deviation_sell < -0.05
                        
                        and ma2_last <= ma2_2_min_ago 
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.20
                
                        and deviation_ma3_sotto_ma150 > -1.20
                    ):
                        sell = "SELL 4-5-x (21-60 min) EX cond. spec 15985 A1y - con dev 3-39 < 0.05 e dev sell < -0.05 con ma50 < - r 15503 B"
                        action = "sell"
                        
                        # 23 nov 2023 and deviation_ma39 a -0.05 da -0.10
                        # 23 nov 2023 and deviation_sell a -0.10 da -0.15
                        # 29 nov 2023 and deviation_ma39 a 0.05 da -0.05
                        # 23 nov 2023 and deviation_sell a -0.05 da -0.10


                    elif (
                        deviation_sell > 0.80
                        and ma39_last > ma39_15_min_ago
                        
                        and ma5_last < ma5_12_min_ago
                
                        and ma3_last < ma36_last
                
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1.50
                    ):    
                        sell = "SELL 4-5-x (21-60 min) C.S. 3-36 - PMS (ma non troppo !) e dev>0.80 e ma5_12_min_ago - r 15503 xyz"
                        action = "sell"

                        #  6 ottobre 2024 aggiuta perche' sul BUY 5 E' MEGLIO COMINCIARE A PRENDERE !


                    elif (    
                        ma50_last <= ma50_2_min_ago
                        
                        and ma300_last < ma300_301_min_ago
                        and ma200_last < ma200_60_min_ago
                        and ma50_last < ma100_last
                        
                        and deviation_sell < 0.03
                        and ma3_last < ma39_last
                        
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                        
                        and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15
                        
                        and ma2_last < ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.10
                        and ma2_differenza_2_min_ago < -7
                    ):
                        sell = "SELL 4-5-x (21-60 min) r 15349 B PROVA 4 se ma50<= e dev_sell < 0.03 E 300 < 300 301 min ago e macd_diff_2_min_ago < -0.10 e diff ma2 < -7 - r 15504"
                        action = "sell"
                        
                        # 18 nov 2023 and deviation_sell < 0.02 da < -0.01
                        # 27 nov 2023 and deviation_ma78_sopra_o_sotto_ma78_600_min_ago < 0.15 da < 0.10
                        # 27 nov 2023 ma50_last <= da ma50_last <
                        # 27 nov 2023 and deviation_sell < 0.03 da < 0.02

                    
                    

                  
                    

                
                        
                ############################################################################################################# sessione 4-5-x ( da 60 a 90 min )

                # VENDITA - da 60 a 90 min - da 3600 a 5400 secondi in poi
                
                elif (
                    seconds_since_last_trade > 3600 and seconds_since_last_trade <= 5400
                ):
                    
                    
                    
                    ######################################################################### RIGHE DEL COMPA raddoppiate PER AUMENTARE LA TOLLERANZA
                    
                    
                    if ( 
                        ma50_last > ma50_2_min_ago
                        and ma78_last > ma100_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.23
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50 > and deviation_ma25 < -0.23 con 78>100 - r 15514a"
                        action = "sell"
                        
                        # 24 ago 2023 and deviation_ma25 < -0.23 da -0.22
                  
                    elif ( 
                        ma50_last > ma50_2_min_ago
                        and ma78_last < ma100_last
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.22
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50 > and deviation_ma25 < -0.22 con 78<100 - r 15514b"
                        action = "sell"
                        
                        
                    
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.21 
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50 > and (deviation_sell < -0.19 and ma3_last < ma50_last) - r 15526"
                        action = "sell"
                        
                        
                        
                    elif ( 
                        ma50_last > ma50_2_min_ago
                        and ma450_last > ma450_360_min_ago
                        
                        and deviation_ma25 < -0.23

                        and ma200_last > ma200_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < 2
                    ):
                        sell = "SELL 4-5-x 60-90 min con ma50> E dev_ma25 < -0.23 E ma450_last > ma450_360_min_ago - r 15538 A"
                        action = "sell"
                        
                        # 30 mag 2023 dev_25 a -0.26 da -0.25
                        #  8 dic 2023 dev_25 a -0.23 da 0.26
                        #  8 dic 2023 aggiunta and macd_last < macd_2_min_ago
                        #  8 dic 2023 aggiunta and macd_differenza_2_min_ago < 2




                    elif ( 
                        ma50_last > ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago

                        and deviation_sell > 0.80
                        and deviation_ma25 < -0.20
                        and ma3_last < ma33_last
                        and ma200_last > ma200_60_min_ago
                        
                        
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 4-5-x (60-90 min) CON ma450 < ma450 360 min ago E dev sell >0.80 e dev_ma25 < -0.20 E 3<33 - r 15538 B1"
                        action = "sell"

                        #  7 feb 2025 se 450 < quindi ribasso e guadagna con una fiammata >0.80 prendi i soldi


                    elif ( 
                        ma50_last > ma50_2_min_ago
                        and ma450_last < ma450_360_min_ago

                        and deviation_sell > 0.40
                        and deviation_sell < 0.80

                        and deviation_ma25 < -0.25
                        and ma5_last < ma100_last
                        and ma200_last > ma200_60_min_ago
                        
                        
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 4-5-x (60-90 min) CON ma450 < ma450 360 min ago E dev sell 0.40-0.80 E dev_ma25 < -0.25 E 5<100  - r 15538 B2"
                        action = "sell"

                        #  7 feb 2025 se 450 < quindi ribasso e guadagna 0.40-0.80 stai calmo
                        
                        
                    
                    elif (    
                        ma50_last > ma50_2_min_ago 
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.24 
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50 > and (deviation_sell < -0.24 and ma3_last < ma50_last) - r 15551"
                        action = "sell"
                        
                        
                        
                        
                        #########################################################################################################################
                        
                      
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and (ma5_prev > ma69_prev and ma5_last < ma69_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (60-90 min) con ma50 > and incrocio 5-69 and deviation_sell 0.25 - 0.56 FINTA DI MARADONA - r 15568 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 19 ottobre 2022 5-69 da 5-50
                        


                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma450_last > ma450_360_min_ago
                        and deviation_ma5_sotto_ma300 < 0.40
                        and (ma5_prev > ma78_prev and ma5_last < ma78_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x (60-90 min) con ma450 > ma450 360 min ago e con ma50 > and incrocio 5-50 and deviation_sell 0.25 - 0.56 FINTA DI MARADONA - r 15568 B1"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 14 ott 2022 5-50 da 5-25
                        #  2 ott 2023 aggiunta ma450 > ma450 360 min ago
                        #  2 ott 2023 5-78 da 5-50

                  
                  
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma50_last > ma59_last
                        
                        and ma450_last < ma450_360_min_ago
                        and deviation_ma5_sotto_ma300 < 0.40
                        and (ma8_prev > ma78_prev and ma8_last < ma78_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.50
                       
                    ):
                        sell = "SELL 4-5-x (60-90 min) FINTA MARADONA con ma450 < ma450 360 min ago con ma50 > and 5-50 and dev_sell 0.25-0.56 and macd<macd 2 min ago - r 15568 B2x"
                        action = "sell"

                    
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma50_last < ma59_last
                        and ma450_last < ma450_360_min_ago
                        and deviation_ma5_sotto_ma300 < 0.40
                        and (ma5_prev > ma50_prev and ma5_last < ma50_last)
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -0.50
                       
                    ):
                        sell = "SELL 4-5-x (60-90 min) FINTA MARADONA con ma450 < ma450 360 min ago con ma50 > and 5-50 and dev_sell 0.25-0.56 and macd<macd 2 min ago - r 15568 B2y"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 14 ott 2022 5-50 da 5-25
                        # 19 ott 2022 and macd < macd_2_min_ago
                        # 19 ott 2022 and macd_differenza_2_min_ago < -0.50
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma4_last < ma78_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50> and 4-78 and deviation_sell 0.57-0.90 DRIBBLING ALLA RONALDO - r 15582"
                        action = "sell"
                        
                        # > estate 4-78 da 4-20
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.59
                        and (ma4_prev > ma78_prev and ma4_last < ma78_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x da 60 a 90 min ma5 molto sopra ma300 e con ma50 > and incrocio 4-78 and deviation_sell 0.91 - 1.49 - r 15595 a"
                        action = "sell"
                        
                        # > estate  4-78 da 3-30

                        
                        
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.59
                        and (ma4_prev > ma100_prev and ma4_last < ma100_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x da 60 a 90 min ma5 non distante da ma300 e con ma50 > and incrocio 4-100 and deviation_sell 0.91 - 1.49 - r 15595 b"
                        action = "sell"

                        
                        
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x da 60 a 90 min con ma50 > incrocio 3-30 and deviation_sell 1.50 - 2.70 - r 15610"
                        action = "sell"

                        # 9 set 2023 3-30 da 3-25
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x da 60 a 90 min con ma50 > incrocio 3-13 and deviation_sell > 2.71 - r 15623"
                        action = "sell"
                        
                    
                    
                    
                    ######################################################################################## con trend discendente
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.25
                        and deviation_ma100_sopra_ma300 > 0.50
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50 < con deviation_ma39 <-0.25 - r 15638 A"
                        action = "sell"
                        
                        # and ma3_last < ma33_last
                        # and deviation_sell < 0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        
                        # > estate se 100 molto sopra 300 no dev sell ma solo dev39 aumentata -0.25 da -0.18
                        
                        
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma39 < -0.25
                        and deviation_ma100_sopra_ma300 < 0.50
                        and deviation_sell < -0.27
                        and ma2_last < ma2_2_min_ago
                       
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50 < con deviation_ma39 <-0.25 and dev_sell < -0.27 - r 15638 B"
                        action = "sell"
                        
                        # and ma3_last < ma33_last
                        # and deviation_sell < 0.10
                        # se non ha forza dopo 1 ora e' inutile continuare a sperare !
                        # qui non ho messo il crollo perche' dopo 40 min o gia' ha venduto o e' gia' risalita
                        # cuscino dell' angelo custode
                        
                        # > estate con 100 vicino 300 interviene ance que dev sell !
                        
                        
                    
                    
                    # sta in alto
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.25
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        and deviation_sell < -0.12
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x da 60 a 90 min con ma50 < con incrocio 3-78 and deviation_sell < -0.12 (sta in alto) - r 15660 A"
                        action = "sell"
                        
                        # 29 gen 2023 dev sell <-0.12 da -0.07
                        
                        
                        
                        
                    # sta in basso
                    
                    elif (
                        ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.25
                        
                        and (ma3_prev > ma78_prev and ma3_last < ma78_last)
                        
                        and deviation_sell < -0.19
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x (60-90 min)  con ma50 < con incrocio 3-78 and deviation_sell < -0.19 (sta in basso) - r 15660 B"
                        action = "sell"

                    

                    ################################################################################################################## CONDIZIONI SPECIALI IMPORTATE NEL SEL 4-5-x
                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma2_differenza_2_min_ago < -10
                        and ma300_last > ma300_301_min_ago
                        and ma50_last <= ma50_2_min_ago
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.11
                
                        and deviation_ma5_sotto_ma200 > -0.64
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < -1.7
                    ):
                        sell = "SELL 4-5-x (60-90 min) r 16047 B1 modificata con ma300 > 5 ore - dev 3-39 < 0.05 and dev_sell < -0.11 E ma50 < and ma2_diff_2_min_ago < -10 - r 15661"
                        action = "sell"
                        #  1 DIC 2023 aggiunta and ma2_differenza_2_min_ago < -10

                    
                    elif (
                        ma78_last < ma78_120_min_ago
                        and ma300_last > ma300_301_min_ago
                        and delta_150_100 <= delta_150_100_60_min
                
                        and deviation_ma39 < 0.06
                        and deviation_sell < -0.03
                
                
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.90
                
                        and ma2_last <= ma2_2_min_ago 
                        and macd < macd_2_min_ago
                    ):
                        sell = "SELL 4-5-x (60-90 min) EX cond spec r 16047 B3 NOTTE con ma300> 5 ore - con dev 3-39 < 0.06 and dev_sell < -0.03 e ma50 < - r 15662"
                        action = "sell"
                        
                        # 23 ott 2023 dev 3-39 a 0.06 da 0.05
                        # 23 ott 2023 dev sell -0.03 da -0.07


                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma50_last > ma50_2_min_ago
                        
                        and deviation_ma39 < 0.02
                        and deviation_sell < -0.045
                        and ma2_last < ma2_2_min_ago 
                
                        
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 4-5-x (60-90 min) EX cond spec r 16047 A1 - con ma50 > e dev 3-39 < 0.02 e dev_sell < -0.05 and macd_diff_2_min_ago < -0.20 - r 15663 a"
                        action = "sell"
                        
                        # 31 ott 2023 and deviation_ma39 < 0.02 da <0.01
                        # 31 ott 2023 and deviation_sell < -0.05 da dev_sell < -0.11

                  
                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma50_last <= ma50_2_min_ago
                        
                        and deviation_ma39 < 0.02
                        and deviation_sell < -0.04
                        and ma2_last < ma2_2_min_ago 
                
                        
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        and macd_differenza_2_min_ago < -0.20
                    ):
                        sell = "SELL 4-5-x (60-90 min) EX cond spec r 16047 A1 - con ma50 <= e dev 3-39 < 0.02 e dev_sell < -0.05 and macd_diff_2_min_ago < -0.20 - r 15663 b"
                        action = "sell"
                        
                        # 31 ott 2023 and deviation_ma39 < 0.02 da <0.01
                        # 31 ott 2023 and deviation_sell < -0.05 da dev_sell < -0.11

                    elif (
                        ma8_last < ma8_2_min_ago 
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.02
                        and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                        and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12
                
                        and delta_450_300 < delta_450_300_60_min
                        and ma50_last <= ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.10
                
                        and deviation_ma3_sotto_ma150 > -1.20
                        and ma2_last <= ma2_2_min_ago 
                        and macd_differenza_2_min_ago < -0.25
                    ):
                        sell = "SELL 4-5-x (60-90 min) EX cond. spec 15985 A1 ok 2B - CON ma8_last < ma8_2_min_ago and dev 3-39 < 0.06 e dev sell < 0.02 con ma50 < - r 15664"
                        action = "sell"



                    elif (
                        deviation_sell > 0.80
                        and ma39_last > ma39_15_min_ago
                        
                        and ma5_last < ma5_12_min_ago
                
                        and ma3_last < ma36_last
                
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1.50
                    ):    
                        sell = "SELL 4-5-x (60-80 min) C.S. 3-36 - PMS (ma non troppo !) e dev>0.80 e ma5_12_min_ago - r 15664 xyz"
                        action = "sell"



                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma50_last < ma59_last
                
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.02
                
                        and ma2_last < ma2_2_min_ago 
                
                        and ma50_last < ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 < 0.40
                
                        and deviation_ma5_sotto_ma200 > -0.80
                        
                        and ma2_last < ma10_last
                        and macd < macd_2_min_ago
                        and macd < -1
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.020
                        and macd_differenza_2_min_ago < -1.25
                    ):
                        sell = "SELL 4-5-x (60-90 min) EX cond spec 16047 A1Y CON 50<59 e dev 3-39 < 0.05 e dev_sell < 0.05 con ma50< and macd < macd_2_min_ago - r 15665"
                        action = "sell"
                        
                        #  8 gen 2024 aggiunta and ma2_last < ma10_last
                        #  8 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.020
                        #  8 gen 2024 aggiunta and macd_differenza_2_min_ago < -1.25
                    


              
                    
                    
                    

                     
                    

                  
                    
                        
                        

                ############################################################################################################ sessione 3-4-x ( > 90 min )

                # VENDITA - da 90 minuti in poi = da 5400 secondi in poi

                elif seconds_since_last_trade > 5400:
                    
                    
                    
                    # ################################################################################ RIGHE DEL COMPA DA RADDOPPIARE PER AUMENTARE TOLLERANZA
                    
                    
                    if (    
                        ma50_last > ma50_2_min_ago
                        and ma50_last > ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.28
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x dopo 90 min con ma50> and deviation_ma25 <-0.28 ( no ma3 < ma39 ) - r 15700"
                        action = "sell"
                        
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma50_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma25 < -0.29
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATO dopo 90 min con ma50> and deviation_ma25 <-0.29 ( no ma3 < ma39 ) - r 15713"
                        action = "sell"
                        
                      
                    
                    
                    elif (     
                        ma50_last > ma50_2_min_ago
                        and ma50_last > ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.29
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATO dopo 90 min con ma50> and (deviation_sell < -0.29 and ma3_last < ma50_last) - r 15730"
                        action = "sell"
                        
                        
                        
                        
                    elif (     
                        ma50_last > ma50_2_min_ago
                        and ma50_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.28
                        and ma3_last < ma50_last
                        and ma200_last < ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x dopo 90 min con ma50> and (deviation_sell < -0.28 and ma3_last < ma50_last) - r 15745"
                        action = "sell"
                        
                      
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma59_sopra_ma300 > 0.50
                        and (ma3_prev > ma30_prev and ma3_last < ma30_last)
                        and delta_CM_300_25_last > delta_CM_300_25_2_min_ago
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min (dopo 110 min RCCR) con ma50 > incrocio 3-13 (!) and deviation_sell > 2.71 - r 15763 A"
                        action = "sell"
                        
                        # 23 feb 2023 3-20 da 3-13 se 59 sopra 300 di molto
                        # 22 ott 2025 3-30 da 3-20
                        # 22 ott 2025 aggiunta and delta_CM_300_25_last > delta_CM_300_25_2_min_ago notte
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma59_sopra_ma300 < 0.50
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min (dopo 110 min RCCR) con ma50 > incrocio 3-13 (!) and deviation_sell > 2.71 - r 15763 B"
                        action = "sell"
                        
                        # 23 feb 2023 3-15 da 3-13 se 59 sopra 300 non di molto
                        
                        
                        
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma50_last > ma100_last
                        
                        and deviation_sell < -0.05
                        and deviation_ma25 < -0.31
                        and ma200_last > ma200_60_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATO dopo 90 min con ma50> and deviation_sell < -0.05 and deviation_ma25 < -0.31 - r 15764"
                        action = "sell"
                      
                        # 6 ott 2023 and deviation_sell < -0.05
                        
                        
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma50_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma25 < -0.30
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x dopo 90 min con ma50> and deviation_ma25 < -0.30 TOLLERANTE - r 15777"
                        action = "sell"
                        
                        
                        
                        
                        
                        
                        
                    elif (     
                        ma50_last > ma50_2_min_ago
                        and ma50_last > ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.32
                        
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x RAFFORZATO dopo 90 min con ma50> and (deviation_sell < -0.32 and ma3_last < ma50_last) TOLLERANTE - r 15796"
                        action = "sell"
                        
                        
                        
                    elif (     
                        ma50_last > ma50_2_min_ago
                        and ma50_last < ma100_last
                        
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.31
                        and ma3_last < ma50_last
                        and ma200_last > ma200_60_min_ago
                    ):
                        sell = "SELL 4-5-x dopo 90 min con ma50> and (deviation_sell < -0.31 and ma3_last < ma50_last) TOLLERANTE - r 15810"
                        action = "sell"
                        
                        
                        
                        #############################################################################################################################
                        
                       
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma100_last > ma100_120_min_ago
                        and ma5_last < ma125_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last <= ma2_2_min_ago
                        and macd <= macd_2_min_ago
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and 100 > 100 120 min ago AND 5-125 and dev_sell 0.25-0.56 - FINTA ALLA MARADONA - r 15825 A"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 13 feb 2023 5-100 da 5-59
                        #  5 ott 2023 5-125 da 5-100
                        #  5 ott 2023 and macd <= macd 2 min ago
                    
                        
                    elif (
                        ma50_last >= ma50_2_min_ago
                        and ma100_last < ma100_120_min_ago
                        and ma5_last < ma59_last
                        and deviation_sell > 0.25 and deviation_sell < 0.56
                        
                        and ma2_last < ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -7
                    ):
                        sell = "SELL 4-5-x (12-21 min) con ma50 > and 5-59 and 100 < 100 120 min ago and dev_sell 0.25-0.56 - FINTA MARADONA and ma2_diff_2_min_ago < -7 - r 15825 B"
                        action = "sell"
                        
                        # deviation_sell = ma3_last/last_trade_price
                        # 24 apr 2023 5-59 da 5-25
                        # 18 nov 2023 aggiunta and ma2_differenza_2_min_ago < -7
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and ma4_last < ma125_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x >90 min con ma50 > con 4 < 20 and deviation_sell 0.35 - 0.90 FINTA ALLA RONALDO - r 15839 A"
                        action = "sell"
                        
                        # 29 ott 2022 4-125 da 4-20 con 5-300 > 0.40


                        
                    elif (
                        ma50_last > ma50_2_min_ago

                        and ma450_last > ma450_720_min_ago
                        and deviation_ma39 > 0.40

                        and deviation_ma5_sotto_ma300 < 0.40
                        and ma3_last < ma13_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd_differenza_2_min_ago < -1.25
                    ):
                        sell = "SELL 4-5-x >90 min con ma50> con 4<49 and dev_sell 0.35 - 0.90 FINTA ALLA RONALDO - r 15839 B1 x"
                        action = "sell"
                        
                        # 12 apr 2023 4-49 da 4-20
                        # 24 mar 2025 se 450 sale da 720 min e dev 3-39 se ngricca vendi con 3-13
                        

                            
                    elif (
                        ma50_last > ma50_2_min_ago

                        and ma450_last > ma450_720_min_ago
                        and deviation_ma39 < 0.40

                        and deviation_ma5_sotto_ma300 < 0.40
                        and ma5_last < ma59_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd_differenza_2_min_ago < -1.25
                    ):
                        sell = "SELL 4-5-x >90 min con ma50> con 5<59 and dev_sell 0.35 - 0.90 FINTA ALLA RONALDO - r 15839 B1 y"
                        action = "sell"
                        
                        # 12 apr 2023 4-49 da 4-20
                        # 24 mar 2025 se 450 sale da 720 min e dev 3-39 non se ngricca allora lascia correre
                        # 24 mar 2025 dev sell a 5-59 da 4-49


                    
                    elif (
                        ma50_last > ma50_2_min_ago

                        and ma450_last < ma450_720_min_ago

                        and deviation_ma5_sotto_ma300 < 0.40
                        and ma5_last < ma49_last
                        and deviation_sell > 0.57 and deviation_sell < 0.90
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd_differenza_2_min_ago < -1.25
                    ):
                        sell = "SELL 4-5-x >90 min con ma50> con 5<49 and dev_sell 0.35 - 0.90 FINTA ALLA RONALDO - r 15839 B2"
                        action = "sell"
                        
                        # 12 apr 2023 4-49 da 4-20
                        # 24 mar 2025 5-49 da 4-49
                        
                        
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min con ma50 > incrocio 5-100 con 5-300 in alto and deviation_sell 0.91 - 1.49 - r 15851 A"
                        action = "sell"

                        # ma 3-48 mi evita la ricompra e la rivendita con perdita !
                        # 14 ott 2022 5-50 da 5-30 ma 5-300 in alto
                        # 19 ottobre 2022 5-59 da 5-50
                        # 15 dic 2022 5-90 da 5-59
                        # 10 gen 2023 5-100 da 5-90
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.40
                        and (ma3_prev > ma39_prev and ma3_last < ma39_last)
                        and deviation_sell > 0.91 and deviation_sell < 1.49
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min con ma50 > incrocio 3-39 con 5-300 in basso and deviation_sell 0.91 - 1.49 - r 15851 B"
                        action = "sell"

                        # ma 3-48 mi evita la ricompra e la rivendita con perdita !
                        # 19 ottobre 2022 3-39 da 3-30
                        
                    
                    
                    
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 > 0.40
                        and (ma5_prev > ma59_prev and ma5_last < ma59_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min con ma50 > incrocio 5-59 (!) and deviation_sell 1.50 - 2.70 - r 15866 A"
                        action = "sell"
                        
                        # 5-30 da 3-25 dopo dolomiti
                        # 10 dic 2022 5-59 da 5-30
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.40
                        and (ma5_prev > ma33_prev and ma5_last < ma33_last)
                        and deviation_sell > 1.50 and deviation_sell < 2.70
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min con ma50 > incrocio 5-33 (!) and deviation_sell 1.50 - 2.70 - r 15866 B"
                        action = "sell"
                        
                        # 5-30 da 3-25 dopo dolomiti
                        # 10 dic 2022 5-33 da 5-30
                        
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and (ma3_prev > ma59_prev and ma3_last < ma59_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min con ma50 > incrocio 3-59 (!) and deviation_sell > 2.71 AND 300 > 5 ore ago - r 15879 A"
                        action = "sell"
                        
                        # 21 gen 2023 incrocio 3-59 se 300 > 5 ore ago
                        
                        
                    elif (
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        and (ma3_prev > ma15_prev and ma3_last < ma15_last)
                        and deviation_sell > 2.71
                        and ma2_last < ma2_2_min_ago
                    ):

                        sell = "SELL 4-5-x dopo 90 min con ma50 > incrocio 3-15 (!) and deviation_sell > 2.71 AND 300 < 5 ore ago - r 15879 B"
                        action = "sell"
                        
                        # 21 gen 2023 incrocio 3-15 se 300 < 5 ore ago
                        

                    
                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma100_sopra_ma300 > 0.25
                        and ma100_last > ma100_120_min_ago

                        and deviation_sell > 1.00
                        and deviation_ma25_sotto_ma300 > 0.85
                        and (ma20_prev > ma40_prev and ma20_last < ma40_last)

                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 4-5-x >90 min se dev sell > 1.00 e 25-300 > 0.85 vendi con incr al ribasso 20-40 - r 15890"
                        action = "sell"

                        # 22 mag 2025 aggiunta questa nuova condizione. impennata durante il rialzo ! no 3-39 o 3-50 ma 25-300 !


                    # con 50>
                    elif (    
                        ma50_last > ma50_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 > 0.25
                        and deviation_ma39 < -0.045
                        
                        and ma100_last > ma100_120_min_ago

                        and ma2_last < ma2_2_min_ago
                        
                        and macd_differenza_2_min_ago < -0.50
                    ):
                        sell = "SELL 4-5-x >90 min con ma50< E dev_ma100_sopra_ma300 > 0.25 E 100>100 120 min E dev_ma39 < -0.045 - r 15893 A1X"
                        action = "sell"
                        
                        #  3 dic 2023 aggiunto se 50>
                        #  3 dic 2023 and deviation_ma39 < -0.05 da -0.20
                        #  3 dic 2023 aggiunta and ma2_differenza_ma5 < -7
                        #  8 dic 2023 dev_ma39 a -0.04 da -0.05
                        # 27 dic 2023 aggiunta and macd_differenza_2_min_ago < -0.50
                        # 14 mar 2025 and deviation_ma39 < -0.05 da -0.04
                        # 14 apr 2025 and deviation_ma39 < -0.045 da -0.04

                    
                    ######################################################################################## con 50<
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 > 0.25
                        and deviation_ma39 < -0.20
                        
                        and ma100_last > ma100_120_min_ago
                        and ma2_last < ma2_2_min_ago
                        
                    ):
                        sell = "SELL 4-5-x dopo 90 min con ma50 < E dev_ma100_sopra_ma300 > 0.25 con deviation_ma39 < -0.20 and 100 > 100 120 min ago - r 15893 A1 Y1"
                        action = "sell"
                        
                        # 29 gen 2023 dev_39 -0.239 da -0.235
                        #  1 feb 2023 dev_39 -0.243 da -0.239
                        # 13 nov 2023 se 100 sta sopra 300 allora vende solo dev 3-39



                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last > ma450_120_min_ago
                        and ma100_last > ma100_120_min_ago
                        and ma8_last < ma90_last
                        and deviation_ma100_sopra_ma300 > 0.25

                        and deviation_ma39 < -0.01
                        and deviation_sell < -0.02

                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -2.50
                        and macd < -6
                    ):
                        sell = "SELL 4-5-x >90 min con ma50< E ma100 sopra ma300 > 0.25 E dev_ma39 < -0.01 E 100 > 100 120 min ago - r 15893 A1 Y2 A"
                        action = "sell"

                        #  3 ott 2024 se ma450 > 2 ore vendi con ma8_last < ma90_last - stai calmo
                        # 14 ott 2024 aggiunta and deviation_sell < -0.02 stai molto calmo

                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma450_last < ma450_120_min_ago
                        and ma100_last > ma100_120_min_ago

                        and deviation_ma100_sopra_ma300 > 0.25
                        and deviation_ma39 < -0.01
                        
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -2.50
                        and macd < -6
                    ):
                        sell = "SELL 4-5-x >90 min con ma50< E ma100 sopra ma300 > 0.25 E dev_ma39 < -0.01 E 100 > 100 120 min ago - r 15893 A1 Y2 B"
                        action = "sell"
                        
                        # 29 gen 2023 dev_39 -0.239 da -0.235
                        #  1 feb 2023 dev_39 -0.243 da -0.239
                        # 13 nov 2023 se 100 sta sopra 300 allora vende solo dev 3-39
                        #  7 feb 2024 se MACD < -6 e diff macd <-2.50 vendi prima anche se soltanto con dev 39


                    

                    elif (    
                        ma50_last < ma50_2_min_ago
                        
                        and deviation_ma100_sopra_ma300 < 0.25
                        and deviation_ma39 < 0.05
                        and deviation_sell < 0.04
                        
                        and ma100_last > ma100_120_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                    ):
                        sell = "SELL 4-5-x dopo 90 min con ma50 < E dev_ma100_sopra_ma300 < 0.25 con dev_ma39 < 0.05 and dev_sell < 0.04 and 100 > 100 120 min ago - r 15893 A2"
                        action = "sell"
                        
                        # 29 gen 2023 dev_39 -0.239 da -0.235
                        #  1 feb 2023 dev_39 -0.243 da -0.239
                        # 13 nov 2023 se 100 sta vicina alla 300 allora c'e' anche dev sell

                    
                    

                    
                    


                  
                    
                        
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma100_last < ma100_120_min_ago
                        and ma2_last < ma2_2_min_ago 
                        and deviation_ma39 < -0.225
                    ):
                        sell = "SELL 4-5-x dopo 90 min con ma50 < con deviation_ma39 <-0.225 and 100 < 100 120 min ago - r 15893 B"
                        action = "sell"
                        
                        
                    
                    
                    
                    
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma300_last > ma300_301_min_ago
                        and deviation_ma5_sotto_ma300 > 0.10
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.13 
                        and ma3_last < ma39_last
                    ):
                        sell = "SELL 4-5-x >90 min CON 300 > 301 min ago e con 5-300 > 0.10 E ma50 < and (dev_sell < -0.13 and ma3_last < ma39_last) - r 15906 A1"
                        action = "sell"
                        
                        # 26 set 2022 con 300 > 301 min ago dev sell a -0.11 da -0.13
                        
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        
                        and deviation_sell < 0.05
                        and ma3_last < ma39_last
                        
                        and ma2_last < ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -2
                        and macd_differenza_2_min_ago < -0.40
                    ):
                        sell = "SELL 4-5-x >90 min CON 300 < 301 min ago E ma50 < and dev_sell < 0.05 and ma3_last < ma39_last and ma2_differenza_2_min_ago < -2 - r 15906 A2x"
                        action = "sell"
                        
                        # 11 nov 2023 tolto and deviation_ma5_sotto_ma300 > 0.10
                        # 11 nov 2023 dev sell -0.05 da -0.11
                        # 11 nov 2023 aggiunto and ma2_differenza_2_min_ago < -2
                        # 18 nov 2023 deviation_sell a 0.05 da -0.05
                        # 18 nov 2023 aggiunto ANCHE CON ma50_last > ma50_2_min_ago
                        # 18 nov 2023 aggiunto qui anche and macd_differenza_2_min_ago < -0.40
                        

                    
                    elif (    
                        ma50_last <= ma50_2_min_ago
                        and ma300_last < ma300_301_min_ago
                        
                        and deviation_sell < 0.07
                        and ma3_last < ma39_last
                        
                        and ma2_last <= ma2_2_min_ago
                        and ma2_differenza_2_min_ago < -1
                    ):
                        sell = "SELL 4-5-x >90 min CON 300 < 301 min ago E ma50< e dev_sell < 0.05 and ma3 < ma39 e ma2_diff_2_min_ago < -2 - r 15906 A2y"
                        action = "sell"
                        
                        # 11 nov 2023 tolto and deviation_ma5_sotto_ma300 > 0.10
                        # 11 nov 2023 dev sell -0.05 da -0.11
                        # 11 nov 2023 aggiunto and ma2_differenza_2_min_ago < -2
                        # 18 nov 2023 deviation_sell a 0.05 da -0.05

                        #  3 set 2024 deviation_sell a 0.07 da 0.05

                  

          
                    
                    elif (    
                        ma50_last > ma50_2_min_ago
                        and deviation_ma5_sotto_ma300 < 0.10
                        
                        and deviation_sell < -0.03
                        and ma3_last < ma33_last
                        
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 4-5-x dopo 90 min con 5-300 < 0.10 E ma50 > and (deviation_sell < -0.03 and ma3_last < ma33_last) - r 15906 B1"
                        action = "sell"
                        
                        #  7 feb 2023 -0.23 da -0.21
                        # 17 mar 2023 3-33 da 3-39 vedi 3 mar 2023 ore 14:46 sembra che 3-39 sia arrivata tardi.
                        # 27 mar 2023 dev sell -0.05 da -0.23 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)
                        #  8 nov 2023 dev sell -0.03 da -0.05 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)



                    elif (    
                        ma50_last < ma50_2_min_ago
                        and ma150_last > ma250_last
                        and deviation_ma5_sotto_ma300 < 0.10
                        
                        and deviation_sell < -0.01
                        and ma3_last < ma33_last
                        
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 4-5-x >90 min con 5-300 < 0.10 E ma50 < e dev_sell < -0.01 SE 150>250 - r 15906 B2 x"
                        action = "sell"
                        
                        #  7 feb 2023 -0.23 da -0.21
                        # 17 mar 2023 3-33 da 3-39 vedi 3 mar 2023 ore 14:46 sembra che 3-39 sia arrivata tardi.
                        # 27 mar 2023 dev sell -0.05 da -0.23 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)
                        #  8 nov 2023 dev sell -0.01 da -0.05 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)
                        # 10 mag 2025 se 150>250 ok cosi'


                    elif (    
                        ma50_last < ma50_2_min_ago
                        and delta_1 < delta_2

                        and ma150_last < ma250_last
                        and deviation_ma5_sotto_ma300 < 0.10
                        
                        and (deviation_sell < -0.01 or ma20_last < ma50_last)
                        and ma3_last < ma50_last
                        
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 4-5-x >90 min con 5-300 < 0.10 E ma50 < e dev_sell < -0.01 or 20<50 SE 150<250 - r 15906 B2 Y1"
                        action = "sell"
                        
                        #  7 feb 2023 -0.23 da -0.21
                        # 17 mar 2023 3-33 da 3-39 vedi 3 mar 2023 ore 14:46 sembra che 3-39 sia arrivata tardi.
                        # 27 mar 2023 dev sell -0.05 da -0.23 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)
                        #  8 nov 2023 dev sell -0.01 da -0.05 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)
                        # 10 mag 2025 se 150<250 vende con dev_sell < -0.01 OR 20<50 ! CAZZO.
                        # 17 mag 2025 se GIORNO vende con 3-50 da 3-33


                    elif (    
                        ma50_last < ma50_2_min_ago
                        and delta_1 > delta_2

                        and ma150_last < ma250_last
                        and deviation_ma5_sotto_ma300 < 0.10
                        
                        and (deviation_sell < -0.01 or ma20_last < ma50_last)
                        and ma3_last < ma33_last
                        
                        and ma2_last < ma2_2_min_ago 
                    ):
                        sell = "SELL 4-5-x >90 min con 5-300 < 0.10 E ma50 < e dev_sell < -0.01 or 20<50 SE 150<250 - r 15906 B2 Y2"
                        action = "sell"
                        
                        #  7 feb 2023 -0.23 da -0.21
                        # 17 mar 2023 3-33 da 3-39 vedi 3 mar 2023 ore 14:46 sembra che 3-39 sia arrivata tardi.
                        # 27 mar 2023 dev sell -0.05 da -0.23 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)
                        #  8 nov 2023 dev sell -0.01 da -0.05 (stiamo al sell 4-5-x e pure dopo 90 min ! esci !)
                        # 10 mag 2025 se 150<250 vende con dev_sell < -0.01 OR 20<50 ! CAZZO.
                        # 17 mag 2025 se NOTTE ok cosi'




                  
                  
                    elif (    
                        ma50_last < ma50_2_min_ago
                        and deviation_ma5_sotto_ma200 < 0.10
                        and ma2_last < ma2_2_min_ago 
                        and deviation_sell < -0.225
                        and ma3_last < ma33_last
                    ):
                        sell = "SELL 4-5-x dopo 90 min con 5-300 < 0.10 E ma50 < and (deviation_sell < -0.225 and ma3_last < ma39_last) - r 15906 c"
                        action = "sell"
                        
                        #  7 feb 2023 -0.23 da -0.21
                        # 17 mar 2023 3-33 da 3-39 vedi 3 mar 2023 ore 14:46 sembra che 3-39 sia arrivata tardi. vedi 25 luglio 2023 ore 21:50
                        # 11 ago 2023 5 sotto 200 ma ho lasciato 5 sotto 300 condizione precedente.
                  


                    ################################################################################### CONDIZIONI SPECIALI IMPORTATE RIDOTTE

                    elif (
                        ma5_last < ma69_last
                        and ma300_last > ma450_last
                        and deviation_ma200_sotto_ma300 > 0.10

                        and deviation_sell > 0.80
                        
                        and ma39_last > ma39_15_min_ago
                        and ma5_last < ma5_12_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1.50
                    ):    
                        sell = "SELL 4-5-x (>90 min) C.S. 3-49 - PMS (ma non troppo !) e dev>0.80 e ma5_12_min_ago - r 15908 x1"
                        action = "sell"

                        #  6 ottobre 2024 aggiuta perche' sul BUY 5 E' MEGLIO COMINCIARE A PRENDERE !
                        # 14 mar 2025 se 300>450 sell con 3-49 da 3-36
                        # 24 mar 2025 se deviation_ma200_sotto_ma300 > 0.10 (E 300>450) dev sell con 5-69 da 3-49
                        

                    elif (
                        ma3_last < ma59_last
                        and ma300_last > ma450_last
                        and deviation_ma200_sotto_ma300 < 0.10

                        and deviation_sell > 0.80
                        
                        and ma39_last > ma39_15_min_ago
                        and ma5_last < ma5_12_min_ago
                        
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1.50
                    ):
                        sell = "SELL 4-5-x (>90 min) C.S. 3-59 - PMS (ma non troppo !) e dev>0.80 e ma5_12_min_ago - r 15908 x2"
                        action = "sell"

                        #  6 ottobre 2024 aggiuta perche' sul BUY 5 E' MEGLIO COMINCIARE A PRENDERE !
                        # 14 mar 2025 se 300>450 sell con 3-49 da 3-36
                        # 24 mar 2025 se deviation_ma200_sotto_ma300 < 0.10 (MA 300>450) dev sell con 5-59 da 3-49




                    elif (
                        deviation_sell > 0.80
                        and ma300_last < ma450_last

                        and ma39_last > ma39_15_min_ago
                        and ma5_last < ma5_12_min_ago
                        
                        and ma3_last < ma39_last
                
                        and ma2_last < ma2_2_min_ago
                        and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1.50
                    ):    
                        sell = "SELL 4-5-x (>90 min) C.S. 3-39 - PMS (ma non troppo !) e dev>0.80 e ma5_12_min_ago - r 15908 y"
                        action = "sell"

                        #  6 ottobre 2024 aggiuta perche' sul BUY 5 E' MEGLIO COMINCIARE A PRENDERE !
                        # 14 mar 2025 se 300<450 sell con 3-39 da 3-36






                    elif (
                        ma78_last > ma78_120_min_ago
                        and ma300_last > ma300_120_min_ago

                        and ma50_last <= ma50_2_min_ago
                        and (ma50_last < ma78_last or ma5_last < ma200_last)
                        
                        and deviation_ma39 < 0.09
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.30
                    ):
                        sell = f"SELL 4-5-x CON 50<78 and dev 3-39 < 0.09 e ma50 < - r 15909 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"

                        #  8 ago 2025 con 300> 120 min sell con 50-78 da 50-59
                        # 20 ott 2025 aggiunte pg


                    elif (
                        ma78_last > ma78_120_min_ago
                        and delta_CM_300_25_last < delta_CM_300_25_2_min_ago

                        and ma300_last < ma300_120_min_ago

                        and ma50_last < ma50_2_min_ago
                        and (ma50_last < ma59_last or ma5_last < ma200_last)
                        
                        and deviation_ma39 < 0.07
                        
                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.30
                    ):
                        sell = f"SELL 4-5-x CON 50<59 - SALVAGENTE dev 3-39 < 0.07 e ma50 < - r 15909 b1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"

                        # 12 mag 2025 aggiunta questa per farla vendere prima di una generica CS che era intervenuta troppo tardi.
                        # 26 ott 2025 aggiunte pg 
                        # 26 ott 2025 aggiunte dev39 a 0.07 da 0.08
                        # 26 ott 2025 aggiunta cm giorno ok cosi'


                    elif (
                        ma78_last > ma78_120_min_ago
                        and delta_CM_300_25_last > delta_CM_300_25_2_min_ago

                        and ma300_last < ma300_120_min_ago

                        and ma50_last < ma50_2_min_ago
                        and (ma50_last < ma59_last or ma5_last < ma200_last)
                        
                        and deviation_ma39 < 0.07
                        and ma3_last < ma50_last


                        and ma2_last < ma2_2_min_ago
                        and macd_differenza_2_min_ago < -0.30
                    ):
                        sell = f"SELL 4-5-x CON 50<59 - SALVAGENTE dev 3-39 < 0.07 e ma50 < - r 15909 b2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                        action = "sell"

                        # 12 mag 2025 aggiunta questa per farla vendere prima di una generica CS che era intervenuta troppo tardi.
                        # 26 ott 2025 aggiunte pg 
                        # 26 ott 2025 aggiunte dev39 a 0.07 da 0.08
                        # 26 ott 2025 aggiunta cm notte
                        # 26 ott 2025 se cm notte allora aggiungo and ma3_last < ma50_last




                    elif (
                        deviation_sell > 0.80
                        and ma5_last < ma5_10_min_ago

                        and ma300_last > ma450_last
                        and ma3_last < ma78_last
                
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1
                    ):    
                        sell = "SELL 4-5-x >90 min con 3-78 PMS (ma non troppo se 300>450) con ma5 < ma5_10_min_ago e dev > 0.80 - r 15910 x"
                        action = "sell"
                
                        # 27 set 2023 macd < macd 2 min ago 
                        # 27 set 2023 and macd_differenza_2_min_ago < -1
                        #  6 feb 2025 se 300>450 lascia correre ! vendi con 3-78 da 3-28



                    elif (
                        deviation_sell > 0.80
                        and delta_50_25_last < delta_50_25_30_min_ago
                        and ma5_last < ma5_10_min_ago

                        and ma300_last < ma450_last
                        and ma3_last < ma39_last
                
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1
                    ):    
                        sell = "SELL 4-5-x dopo 90 min PMS con ma5 < ma5_10_min_ago e dev > 0.80 and macd < macd 2 min ago - r 15910 x"
                        action = "sell"
                
                        # 27 set 2023 macd < macd 2 min ago 
                        # 27 set 2023 and macd_differenza_2_min_ago < -1
                        # 16 ott 2025 se 50-25 giorno aumento a 3-39 da 3-28


                    elif (
                        deviation_sell > 0.80
                        and delta_50_25_last > delta_50_25_30_min_ago
                        and ma5_last < ma5_10_min_ago

                        and ma300_last < ma450_last
                        and ma3_last < ma28_last
                
                        and ma2_last < ma2_2_min_ago
                        and macd < macd_2_min_ago
                        and macd_differenza_2_min_ago < -1
                    ):    
                        sell = "SELL 4-5-x dopo 90 min PMS con ma5 < ma5_10_min_ago e dev > 0.80 and macd < macd 2 min ago - r 15910 y"
                        action = "sell"
                
                        # 27 set 2023 macd < macd 2 min ago 
                        # 27 set 2023 and macd_differenza_2_min_ago < -1
                        # 16 ott 2025 se 50-25 notte ok cosi'
              
                    
                    
            #################################################################################################################### VENDITE SPECIALI !
            ####################################################################################
            ####################################################################################
                    
            # ATTENZIONE al conflitto durante il crollo - SELL SOVRAPPOSTO AL BUY

            # NO 3<78 !
            # NO deviation 78 !
            # QUALCHE VOLTA ma3-ma39 NON HANNO INCROCIATO allora per la vendita con il DRIBBLING e il DOPPIO PASSO ALLA RONALDO ho risolto con 3 < 39
            # il CUSCINO DELL' ANGELO CUSTODE e di SANT' ANTONIO mi proteggono ! (vendita con medie lunghe)
                    
          
            
            
            ####################################################################################### SALVAGENTE con deviation_ma5_sotto_ma200 > -1.00
            
            # SENZA and ma2_last < ma2_2_min_ago VENDE mentre ma4 si trova sotto il BUY !
            
            
            
            #  9 set 2024 cancellata r 15942
             
                
            # 1 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 > -1.00
            
            if (
                deviation_ma39 < -0.25
                and deviation_sell < -0.32
                and ma2_last < ma2_2_min_ago
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.40
                
                and deviation_ma5_sotto_ma200 > -1.00
            ):
                sell = "SELL condizione speciale 1 - SALVAGENTE 1 3-39 con ma50 > - con deviation_ma5_sotto_ma200 > -1.00 - r 15943"
                action = "sell"
                
                # 14 giu 2022 deviation_sell -0.32
                

                
                
          
            
            # 3 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 > -1.00   
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.34
                and ma2_last < ma2_2_min_ago 
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
            ):
                sell = "SELL condizione speciale 2 - SALVAGENTE 2 3-39 con ma50 > - con deviation_ma5_sotto_ma200 > -0.90 and deviation < -0.34 - r 15965"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !)
                # 23 feb 2023 dev 5 sotto 200 > -0.90 da > -1.00
                





          
            # 3 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 > -1.00

            elif (
                deviation_ma39 < -0.20
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago > 0.10
                
                and deviation_ma39 < -0.20
                and deviation_sell < -0.308
                and ma2_last <= ma2_2_min_ago 
                and delta_450_300 < delta_450_300_60_min
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                
                and deviation_ma3_sotto_ma150 > -1.20
            ):
                sell = "SELL cond. special 3 - SALVAGENTE 3 3-39 < -0.20 e dev sell < -0.31 and dev_sell< -0.308 con ma50< e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 prova 1"
                action = "sell"



            elif (
                ma8_last > ma8_2_min_ago
                and ma39_last > ma39_15_min_ago
                
                and deviation_ma39 < 0.01
                and deviation_sell < -0.03
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                and delta_450_300 < delta_450_300_60_min
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                
                and deviation_ma3_sotto_ma150 > -1.20
                and ma2_last <= ma2_2_min_ago 
                
            ):
                sell = "SELL C.S. con trend rialzista e ma8_last < ma8_2_min_ago e dev 3-39 < 0.01 e dev sell < -0.03 e ma50 < - r 15985 A1 ok 2A 1"
                action = "sell"
                
                #  6 mar 2024 se 39 > 39 15 min ago allora deviation_sell < -0.03 da -0.025 ( sta salendo da molto tempo )



            elif (
                ma8_last > ma8_2_min_ago
                and ma39_last > ma39_15_min_ago
                
                and deviation_ma39 < 0.01
                and deviation_sell < -0.025
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                and delta_450_300 < delta_450_300_60_min
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                
                and deviation_ma3_sotto_ma150 > -1.20
                and ma2_last <= ma2_2_min_ago 
                
            ):
                sell = "SELL C.S. con trend rialzista e ma8_last < ma8_2_min_ago e dev 3-39 < 0.01 e dev sell < -0.025 e ma50 < - r 15985 A1 ok 2A 2"
                action = "sell"
                
                # 18 set 2023 dev sell -0.02 da -0.01
                # 18 set 2023 dev 39 a 0.01 da -0.01
                # 17 ott 2023 NON METTERE MACD <  MACD 2 MIN AGO

                #  6 mar 2024 vedi che qua 39 < 39 15 min ago quindi meno tolleranza anche se sale da molto tempo

            elif (
                ma8_last < ma8_2_min_ago
                and ma20_last > ma20_2_min_ago
                and deviation_ma100_sopra_ma450 > 1.50
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.05

                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12
                
                and delta_450_300 < delta_450_300_60_min
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma3_sotto_ma150 > -1.20
                and ma2_last <= ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.25
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
            ):
                sell = "SELL C S con ma50 > e ma8_last < ma8_2_min_ago e dev 3-39 < 0.05 e dev sell < -0.04 - r 15985 A1 ok 2B x1 x"
                action = "sell"

                #  7 mar 2024 fatta modifica vedi and deviation_ma100_sopra_ma450 > 1.50


            elif (
                ma8_last < ma8_2_min_ago
                and ma300_last > ma450_last
                and ma20_last > ma20_2_min_ago
                and deviation_ma100_sopra_ma450 < 1.50
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.065

                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12
                
                and delta_450_300 < delta_450_300_60_min
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma3_sotto_ma150 > -1.20
                and ma2_last <= ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.25
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
            ):
                sell = "SELL C S con ma50 > e ma8_last < ma8_2_min_ago e dev 3-39 < 0.05 e dev sell < -0.04 - r 15985 A1 ok 2B x1 yx"
                action = "sell"

                # 14 ott 2024 se ANCHE 300>450 and deviation_sell < -0.065 da < -0.05


            elif (
                ma8_last < ma8_2_min_ago
                and ma300_last < ma450_last

                and ma20_last > ma20_2_min_ago
                and deviation_ma100_sopra_ma450 < 1.50
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.06

                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12
                
                and delta_450_300 < delta_450_300_60_min
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma3_sotto_ma150 > -1.20
                and ma2_last <= ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.25
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
            ):
                sell = "SELL C S con ma50 > e ma8_last < ma8_2_min_ago e dev 3-39 < 0.05 e dev sell < -0.04 - r 15985 A1 ok 2B x1 yy"
                action = "sell"
                
                # 18 set 2023 dev sell -0.02 da -0.01
                # 18 set 2023 dev 39 da 0.01 da -0.01
                # 17 OTT 2023 NON METTERE MACD <  MACD 2 MIN AGO
                # 17 ott 2023 and macd_differenza_2_min_ago < -0.25
                #  9 nov 2023 and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12 da < 0.10
                # 15 nov 2023 dev 39 da 0.05 da 0.01
                # 15 nov 2023 ma50>
                # 13 dic 2023 dev sell a -0.04 da -0.02 SE ma20_last > ma20_2_min_ago
                # 13 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018 = 7 pts

                #  7 mar 2024 fatta modifica vedi and deviation_ma100_sopra_ma450 < 1.50
                # 14 ott 2024 and deviation_sell < -0.06 da < -0.05



            elif (
                ma8_last < ma8_2_min_ago
                and ma300_last > ma450_last

                and ma20_last <= ma20_2_min_ago
                and ma50_last > ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.03
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12
                
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.10
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.30
               
            ):
                sell = "SELL C.S. 3 - con ma50 > e ma8_last < ma8_2_min_ago e dev 3-39 < 0.05 e dev sell < -0.03 - r 15985 A1 ok 2B X2 A"
                action = "sell"

                # 14 ott 2024 SE anche 300>450 and deviation_sell < -0.03 da < -0.01


            elif (
                ma8_last < ma8_2_min_ago
                and ma300_last < ma450_last

                and ma20_last <= ma20_2_min_ago
                and ma50_last > ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.02
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12
                
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.10
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.30
               
            ):
                sell = "SELL C.S. 3 - con ma50 > e ma8_last < ma8_2_min_ago e dev 3-39 < 0.05 e dev sell < -0.02 - r 15985 A1 ok 2B X2 B"
                action = "sell"
                
                # 18 set 2023 dev sell -0.02 da -0.01
                # 18 set 2023 dev 39 da 0.01 da -0.01
                # 17 OTT 2023 NON METTERE MACD <  MACD 2 MIN AGO
                # 17 ott 2023 and macd_differenza_2_min_ago < -0.25
                #  9 nov 2023 and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12 da < 0.10
                # 15 nov 2023 dev 39 da 0.05 da 0.01
                # 15 nov 2023 ma50>
                # 13 dic 2023 dev sell a 0.01 da -0.03 
                
                # 19 dic 2023 and macd_differenza_2_min_ago a -0.30 da -0.25
                # 19 dic 2023 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago a -0.02 da -0.018
                
                #  6 mar 2024 and deviation_sell < -0.01 da 0.01 (ma300 si sta alzando rispetto alla 450 - sta salendo !)
                # 14 ott 2024 and deviation_sell < -0.02 da < -0.01





            elif (
                ma8_last <= ma8_2_min_ago
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.04
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                
                and delta_450_300 < delta_450_300_60_min
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma3_sotto_ma150 > -1.20

                and ma3_last < ma33_last

                
            ):
                sell = "SELL C.S. con ma50 < MA ma100 sopra ma300 > 0.10 e dev 3-39 < 0.05 e dev sell < -0.04 - r 15985 A1 ok 2B Y1"
                action = "sell"

                #  6 apr 2025 aggiunta questa con 50>
                



            
            elif (    
                ma3_last < ma33_last

                and ma50_last <= ma50_2_min_ago
                and ma5_last <= ma5_2_min_ago

                and ma20_last > ma50_last
                

                and deviation_ma39 < 0.07
                and deviation_sell < -0.01
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                and delta_450_300 < delta_450_300_60_min
                
                
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma3_sotto_ma150 > -1.20

            ):
                sell = f"SELL C.S. con ma50 < MA ma100 sopra ma300 > 0.10 e dev 3-39 < 0.05 e dev sell < -0.04 con 20>50 - r 15985 A1 ok 2B Y2x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 18 set 2023 dev sell -0.02 da -0.01
                # 18 set 2023 dev 39 da 0.01 da -0.01
                # 17 OTT 2023 NON METTERE MACD <  MACD 2 MIN AGO
                # 17 ott 2023 and macd_differenza_2_min_ago < -0.25
                #  9 nov 2023 and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.12 da < 0.10
                # 15 nov 2023 dev 39 a 0.05 da 0.01
                # 15 nov 2023 ma50 <

                #  6 mar 2024 and delta_450_300 < delta_450_300_60_min significa che e' GIORNO
                #  6 mar 2024 and deviation_sell < -0.04 da -0.03
                #  9 set 2024 aggiunta 3<33
                # 10 set 2024 and deviation_sell < -0.045 da -0.04
                # 10 set 2024 and macd_differenza_2_min_ago < -1.25 da < -0.25
                # 24 mar 2025 ha fatto -0.81% il giorno 19 mar 2025
                # 24 mar 2025 tolto ma2 < ma2 2 min ago
                # 24 mar 2025 and deviation_sell < -0.043 da -0.045
                #  6 apr 2025 and deviation_sell < -0.04 da -0.043
                # 18 mag 2025 se 20>50 dev sell ok cosi' - per adesso -
                # 20 ott 2025 aggiunte pg
                # 20 ott 2025 anticipata ndecchiecella la vendita



            elif (
                ma8_last <= ma8_2_min_ago
                and ma3_last < ma39_last
                and ma20_last < ma50_last
                and ma50_last <= ma50_2_min_ago

                and deviation_ma39 < 0.05
                and deviation_sell < -0.037
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > 1.50
                
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma3_sotto_ma150 > -1.20

            ):
                sell = "SELL C.S. con ma50< MA ma100 sopra ma300 > 0.10 e dev 3-39 < 0.05 e dev sell < -0.037 con 20<50 - r 15985 A1 ok 2B Y2y"
                action = "sell"
                
                # 18 mag 2025 se anche 20<50 dev sell a -0.037 da -0.04
                # 22 mag 2025 ma3 deve stare sotto ma39 ! da 3<33





            elif (
                deviation_ma39 < -0.20
                and deviation_sell < -0.15
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago > 0.10
                
                and ma2_last <= ma2_2_min_ago 
                and delta_450_300 < delta_450_300_60_min
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                
                and deviation_ma3_sotto_ma150 > -1.20
            ):
                sell = "SELL cond. special 3 - SALVAGENTE 3 3-39 < -0.20 e dev sell < -0.31 and dev_sell< -0.308 con ma50< e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 prova 3"
                action = "sell"
                
          
              
            elif (
                ma50_last >= ma50_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < 0.05
                
                and deviation_ma100_sopra_ma300 > 0.20
                and ma50_last < ma50_2_min_ago
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = "SELL cond. special 3 - SALVAGENTE 3 - con ma50 < e con dev 3-39 < 0.10 e dev sell < 0.05 e dev_ma3_sotto_ma200 > -1.20 and price < ma3 - r 15985 A1 ok 4x"
                action = "sell"



            elif (
                ma50_last < ma50_2_min_ago

                and ma200_last > ma450_last
                and ma28_last > ma100_last
                and ma10_last > ma20_last
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.021
                
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                and deviation_ma3_sotto_ma150 > -1.20
                
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = "SELL CS con dev 3-39 < 0.05 e dev sell < -0.021 con ma50< MA 200>450 e price < ma3 - r 15985 A1 ok 4y 1a X"
                action = "sell"
                
                # 27 dic 2023 con 10>20 deviation_sell a 0.001 da 0.02
                # 11 set 2024 deviation_sell < -0.001 da < 0.001
                # 24 set 2024 con ma28_last > ma100_last dev sell a -0.01 da < -0.001
                #  6 feb 2025 se ma10_last > ma20_last e and ma200_last > ma450_last - deviation_sell a -0.017 da -0.01
                # 18 feb 2025 se ma10_last > ma20_last sell a -0.021 da -0.017


            elif (
                ma50_last > ma50_2_min_ago
                and ma200_last > ma450_last
                and ma10_last > ma20_last

                and ma28_last < ma100_last
                
                
                and deviation_ma39 < 0.02
                and deviation_sell < -0.01
                
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                
                and ma2_last < ma8_last
                and price < ma8_last
            ):
                sell = "SELL CS con dev 3-39 < 0.05 e dev sell < 0.001 con ma50< MA 200>450 e price < ma8 - r 15985 A1 ok 4y 1a Y1"
                action = "sell"
                
                # 27 dic 2023 con 10>20 deviation_sell a 0.001 da 0.02
                # 11 set 2024 deviation_sell < -0.001 da < 0.001
                # 24 set 2024 and ma28_last > ma100_last
                # 12 mar 2025 aggiunta opzione ma50_last > ma50_2_min_ago (ha fatto -0.60)
                # 12 mar 2025 and deviation_sell < 0.001 da < -0.002 (ha fatto -0.60)
                # 23 mar 2025 and deviation_sell a 0.01 da 0.001 togliendo un po' di sovrastrutture  !



            elif (
                ma50_last < ma50_2_min_ago
                and ma200_last > ma450_last
                and ma28_last < ma100_last
                and ma10_last > ma20_last
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.001
                
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                and deviation_ma3_sotto_ma150 > -1.20
                
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = f"SELL CS deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago} con dev 3-39 < 0.05 e dev sell < -0.001 con ma50< MA 200>450 e price < ma3 - r 15985 A1 ok 4y 1a Y2"
                action = "sell"
                
                # 27 dic 2023 con 10>20 deviation_sell a 0.001 da 0.02
                # 11 set 2024 deviation_sell < -0.001 da < 0.001
                # 24 set 2024 and ma28_last > ma100_last
                # 12 mar 2025 and deviation_sell < -0.001 da < -0.002
                # 16 mag 2025 aggiunto parentesi. deve essere riferimento per il BUY.



            elif (
                ma50_last < ma50_2_min_ago
                and ma200_last < ma450_last
                and ma10_last > ma20_last

                and deviation_ma39 < 0.05
                and deviation_sell < -0.001
                
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < 1.50
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago > -1.50
                
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                and deviation_ma3_sotto_ma150 > -1.20
                
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = "SELL CS con dev 3-39<0.05 e dev sell<0.001 con ma50< E 200>450 e price < ma3 - r 15985 A1 ok 4y1b"
                action = "sell"
                
                # 27 dic 2023 con 10>20 deviation_sell a 0.001 da 0.02
                # 11 set 2024 deviation_sell < -0.001 da < 0.001



            elif (
                ma50_last > ma50_2_min_ago
                and ma5_last <= ma110_last

                and delta_50_39 < delta_50_39_30_min
                and ma10_last <= ma20_last
                
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.02
                
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.01
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = "SELL CS con ma50> e 5-110 e dev_ma3_sotto_ma200 > -1.20 and price < ma3 - r 15985 A1 ok 4Y 2Ax"
                action = "sell"

                # 18 feb 2025 se ma50_last > ma50_2_min_ago vende con 5-110

            


            elif (
                ma50_last < ma50_2_min_ago
                and delta_DNA_1 < delta_DNA_2

                and ma5_last <= ma100_last

                and delta_50_39 < delta_50_39_30_min
                and ma10_last <= ma20_last
                
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.01
                
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.01
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = "SELL CS con delta_DNA_1 > delta_DNA_2 E ma50< e 5-100 - r 15985 A1 ok 4Y 2A Y1"
                action = "sell"

                # 18 feb 2025 ha fatto -0.33%
                # 18 feb 2025 se ma50_last < ma50_2_min_ago vende con 5-100
                #  8 apr 2025 and deviation_sell < -0.01 da <-0.02
                # 13 apr 2025 aggiunta and delta_DNA_1 < delta_DNA_2


            elif (
                ma50_last < ma50_2_min_ago
                and delta_DNA_1 > delta_DNA_2

                and ma5_last <= ma100_last

                and delta_50_39 < delta_50_39_30_min
                and ma10_last <= ma20_last
                
                
                and deviation_ma39 < 0.07
                and deviation_sell < 0.01
                
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.01
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = "SELL CS con delta_DNA_1 > delta_DNA_2 E ma50< e 5-100 - r 15985 A1 ok 4Y 2A Y2"
                action = "sell"

                # 18 feb 2025 ha fatto -0.33%
                # 18 feb 2025 se ma50_last < ma50_2_min_ago vende con 5-100
                #  8 apr 2025 and deviation_sell < -0.01 da <-0.02
                # 13 apr 2025 aggiunta and delta_DNA_1 > delta_DNA_2 - vende una ndecchiecella prima !
                # 13 apr 2025 and deviation_sell < 0.01 da -0.01


            elif (
                ma50_last >= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min

                and delta_50_39 > delta_50_39_30_min
                and ma10_last <= ma20_last
                and ma5_last <= ma100_last
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.001
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = "SELL CS SALVAGENTE - con dev sell < -0.001 con ma50 < e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 ok 4Y 2B X1"
                action = "sell"

                # 27 set 2023 dev sell -0.11 da -0.10
                # 25 ott 2023 aggiunta ma2 < ma5
                # 27 ott 2023 dev sell -0.12 da -0.11
                # 27 ott 2023 aggiunto price < ma3 !
                #  9 nov 2023 dev sell -0.115 da -0.12
                #  9 nov 2023 aggiunta and ma2_differenza_2_min_ago < -0.20
                # 20 nov 2023 dev sell a 0.08 da -0.115
                # 20 nov 2023 aggiunta and macd_differenza_2_min_ago < -0.5
                # 12 dic 2023 dev sell a 0.02 da -0.08
                # 12 dic 2023 dev 39 a 0.05 da -0.01
                # 12 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                # 27 dic 2023 con 10<=20
                #  8 feb 2024 aggiunto and ma5_last <= ma100_last
                # 31 gen 2025 and deviation_sell < -0.01 da < 0.02 GIORNO !
                #  8 apr 2025 dev sell < -0.001 da < -0.01
                #  8 apr 2025 attenzione qua 50>
            

            elif (
                ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min

                and delta_50_39 > delta_50_39_30_min
                and ma10_last <= ma20_last
                and (ma5_last <= ma100_last or ma5_last <= ma450_last)
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.001
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
            ):
                sell = f"SELL CS SALVAGENTE - con dev sell < -0.001 con ma50< e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 ok 4Y 2B X2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 27 set 2023 dev sell -0.11 da -0.10
                # 25 ott 2023 aggiunta ma2 < ma5
                # 27 ott 2023 dev sell -0.12 da -0.11
                # 27 ott 2023 aggiunto price < ma3 !
                #  9 nov 2023 dev sell -0.115 da -0.12
                #  9 nov 2023 aggiunta and ma2_differenza_2_min_ago < -0.20
                # 20 nov 2023 dev sell a 0.08 da -0.115
                # 20 nov 2023 aggiunta and macd_differenza_2_min_ago < -0.5
                # 12 dic 2023 dev sell a 0.02 da -0.08
                # 12 dic 2023 dev 39 a 0.05 da -0.01
                # 12 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                # 27 dic 2023 con 10<=20
                #  8 feb 2024 aggiunto and ma5_last <= ma100_last
                # 31 gen 2025 and deviation_sell < -0.01 da < 0.02 GIORNO !
                #  8 apr 2025 dev sell < -0.001 da < -0.01
                #  8 apr 2025 attenzione qua 50<
                #  10 mag 2025 aggiunta or ma5_last <= ma450_last
                # 24 ott 2025 aggiunte pg



            elif (
                ma50_last < ma50_2_min_ago
                and macd < -40
                and ma3_last <= ma200_last

                and ma200_last > ma200_301_min_ago
                and ma300_last > ma300_301_min_ago
                and ma450_last > ma450_300_min_ago

                and delta_50_39 > delta_50_39_30_min
                and ma10_last <= ma20_last
                
                
                and deviation_ma39 < 0.07
                and deviation_sell < 0.02
                
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
                
            ):
                sell = "SELL CS - SALVAGENTE - se MACD < -40 vende con 3-200 E dev 3-39 < 0.05 e dev sell < 0.02 e se ma50 < - r 15985 A1 ok 4Y 2B Y1"
                action = "sell"

                # 19 set 2024 se macd -40 vende con 3-200
                # 15 ott 2024 quando MACD < -40 vende anche con 3-200 

            elif (
                ma50_last < ma50_2_min_ago
                and macd < -40
                and ma3_last <= ma300_last

                and ma200_last > ma200_301_min_ago
                and ma300_last > ma300_301_min_ago
                and ma450_last > ma450_300_min_ago

                and delta_50_39 > delta_50_39_30_min
                and ma10_last <= ma20_last
                
                
                and deviation_ma39 < 0.07
                and deviation_sell < 0.02
                
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.5
                and ma2_last < ma5_last
                and price < ma3_last
                
            ):
                sell = "SELL CS - SALVAGENTE - se MACD < -40 vende con 3-300 E dev 3-39 < 0.05 e dev sell < 0.02 e se ma50 < - r 15985 A1 ok 4Y 2B Y2"
                action = "sell"

                # 19 set 2024 se macd -40 vende con 3-300



                
            elif (
                deviation_ma100_sopra_ma300 > 0.20
                and ma25_last > ma25_2_min_ago

                and deviation_ma39 < -0.01
                and deviation_sell < -0.025
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                and delta_450_300 < delta_450_300_60_min
                and ma50_last < ma50_2_min_ago
                
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago 
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
            ):
                sell = "SELL CS con dev sell < -0.025 con ma50< MA ma25 > ma25 2 min_ago e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 prova 5x"
                action = "sell"
                
                # 19 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                # 19 gen 2024 and deviation_sell a -0.015 da a -0.015
                #  5 feb 2025 se ma25_last > ma25_2_min_ago allora dev sell a < -0.025 da < -0.015





            elif (
                deviation_ma100_sopra_ma300 > 0.20
                and ma5_last > ma39_last

                and ma25_last < ma25_2_min_ago
                and ma50_last < ma50_2_min_ago

                and deviation_ma39 < -0.01
                and deviation_sell < -0.0199
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago 
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
            ):
                sell = "SELL CS con dev sell < -0.019 con ma50< E ma25 < ma25 2 min ago e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 prova 5 y1"
                action = "sell"
                
                # 19 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                
                #  5 feb 2025 se ma25_last < ma25_2_min_ago allora dev sell a < -0.017 da < -0.015
                # 26 apr 2025 con 5>39 dev sell a < -0.0199 da < -0.017



            elif (
                deviation_ma100_sopra_ma300 > 0.20
                and ma5_last < ma39_last

                and ma25_last < ma25_2_min_ago
                and ma50_last < ma50_2_min_ago

                and deviation_ma39 < -0.01
                and deviation_sell < -0.019
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago < 0.10
                
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago 
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
            ):
                sell = "SELL CS con dev sell < -0.019 con ma50< E ma25 < ma25 2 min ago e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 prova 5 y2"
                action = "sell"
                
                # 19 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                
                #  5 feb 2025 se ma25_last < ma25_2_min_ago allora dev sell a < -0.017 da < -0.015
                # 26 apr 2025 con 5<39 dev sell a < -0.019 da < -0.017

          
            elif (
                deviation_ma39 < -0.01
                and deviation_sell < -0.15
                
                and deviation_ma5_sopra_o_sotto_ma5_1080_min_ago < -1.50
                and deviation_ma10_sopra_o_sotto_ma10_30_min_ago > 0.10
                
                and ma2_last <= ma2_2_min_ago 
                and delta_450_300 < delta_450_300_60_min
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                
                and deviation_ma3_sotto_ma150 > -1.20
            ):
                sell = "SELL cond. special 3 - SALVAGENTE 3 3-39 < -0.20 e dev sell < -0.31 and dev_sell< -0.308 con ma50< e dev_ma3_sotto_ma200 > -1.20 - r 15985 A1 prova 6"
                action = "sell"


          
            elif (
                
                ma50_last > ma50_2_min_ago
                
                and deviation_ma39 < -0.03
                and deviation_sell < -0.15
                
                and ma2_last <= ma2_2_min_ago 
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.20
                
                and deviation_ma3_sotto_ma150 > -1.20
            ):
                sell = "SELL CS con ma50_last > ma50_2_min_ago e 3-39 < -0.03 e dev sell < -0.15 con dev_ma3_sotto_ma150 > -1.20 - r 15985 A1x"
                action = "sell"
                
                # aggiunta il 15 nov 2023 con ma50> !
                # 15 nov 2023 deviation_ma39 < -0.10 da < -0.20
                # 15 nov 2023 deviation_sell < -0.20 < -0.31
                #  3 feb 2025 deviation_sell a -0.15 da -0.20 (ha fatto -0.70)


            elif (    
                ma50_last <= ma50_2_min_ago
                and ma10_last > ma20_last
                and deviation_ma100_sopra_ma450 > 1.50
                
                and deviation_ma39 < 0.11
                and deviation_sell < -0.03
                
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -7
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma10_last
            ):
                sell = "SELL CS con ma50 <= ma50_2_min_ago MA CON 10>20 e 3-39 < 0.11 e dev_sell < -0.03 - r 15985 A1 Y1 x"
                action = "sell"

                #  7 mar 2024 con 100 sopra 450 > 1.50 (trend chiaramente rialzista) dev sell a -0.03 da -0.02



            elif (    
                ma50_last <= ma50_2_min_ago
                and ma200_last > ma200_180_min_ago

                and ma10_last > ma20_last
                and deviation_ma100_sopra_ma450 < 1.50
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.05
                
                and delta_450_300 < delta_450_300_60_min
                and delta_300_200 < delta_300_200_60_min

                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago
                and ma2_last <= ma2_3_min_ago
                and ma2_differenza_2_min_ago < -8

                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma10_last
            ):
                sell = "SELL CS con ma50 <= ma50_2_min_ago MA CON 200 che sale da 3 ore e 10>20 e 3-39 < 0.10 e dev_sell < -0.05 - r 15985 A1 Y1 YX"
                action = "sell"
                
                #  8 gen 2024 and deviation_sell < -0.01 da 0.01 se 10>20
                #  8 gen 2024 and deviation_sell < -0.02 da -0.01
                #  7 mar 2024 con 100 sopra 450 < 1.50 dev sell a -0.02
                # 19 set 2024 se ma 200> ma200 180 min ago allora aumento tolleranza dev sell a -0.03 da -0.02 
                # 19 set 2024 se ma 200> ma200 180 min ago aggiungo anche ma2 < ma2 3 min ago
                # 19 set 2024 se ma 200> ma200 180 min ago allora aumento tolleranza dev sell a -0.045 da -0.03
                # 28 gen 2025 dev sell a -0.05 da -0.045
                # 28 gen 2025 aggiunto and delta_300_200 < delta_300_200_60_min per confortare l' aumento del dev sell a -0.05


            elif (
                ma50_last <= ma50_2_min_ago
                and ma200_last < ma200_180_min_ago

                and ma10_last > ma20_last
                and deviation_ma100_sopra_ma450 < 1.50
                
                and deviation_ma39 < 0.11
                and deviation_sell < -0.02
                
                and delta_450_300 < delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -7
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma10_last
            ):
                sell = "SELL CS con ma50 <= ma50_2_min_ago e con 200 che scende da 3 ore e 10>20 e 3-39 < 0.11 e dev_sell < -0.02 - r 15985 A1 Y1 YY"
                action = "sell"
                
                #  8 gen 2024 and deviation_sell < -0.01 da 0.01 se 10>20
                #  8 gen 2024 and deviation_sell < -0.02 da -0.01
                #  7 mar 2024 con 100 sopra 450 < 1.50 dev sell a -0.02
                

            
            elif (    
                ma50_last <= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                and delta_450_300 < delta_450_300_60_min

                and ma10_last < ma20_last

                and deviation_ma39 < 0.10
                and deviation_sell < -0.022

                and deviation_ma3_sotto_ma150 > -1.20
                
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -7
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -2
                
            ):
                sell = "SELL C.S. con ma50_last <= ma50_2_min_ago MA CON 10<20 con 3-39 < 0.10 and dev_sell < -0.022 - r 15985 A1 Y2"
                action = "sell"
                
                # 27 giu 2022 dev sell a 0.305 da 0.31
                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !)
                # 21 giugno 2022 RICORDO TREMENDO 9372 ha venduto a -2.23% !!!
                # COME PRIMA COSA HO NOTATO CHE AVEVA DEVIATION INVECE DI DEVIATON SELL 
                # ma non sapendo se era questo il problema ho creato la prossima condizione speciale.
                
                # > estate dev 39 -0.24 da -0.25 dev sell -0.30 da -0.31 
                # 13 set -3% !!! deviation_ma3_sotto_ma200 > -1.20 da deviation_ma3_sotto_ma200 > -1.20 
                # 21 gen 2023 dev sell -0.303 da -0.30
                # 20 feb 2023 -0.309 da -0.303 con doppio delta 450-300 GIORNO !
                # 22 feb 2023 -0.308 da -0.309 con doppio delta 450-300 GIORNO !
                #  9 lug 2023 deviation_ma39 < -0.20 da < -0.24
                
                # 15 nov 2023 deviation_ma39 < -0.10 da < -0.20
                # 15 nov 2023 deviation_sell < -0.15 da < -0.31
                #  8 dic 2023 deviation_ma39 < 0.01 da < -0.10
                #  8 dic 2023 deviation_sell < -0.05 da < -0.15
                # 13 dic 2023 deviation_ma39 a 0.11 da 0.01
                # 13 dic 2023 deviation_sell a 0.01 da -0.05
                
                #  8 gen 2024 aggiunta and ma2_last < ma10_last se 10>20
                
                #  6 mar 2024 and deviation_sell < -0.01 da 0.01
                #  6 mar 2024 and delta_450_300 < delta_450_300_60_min significa che sta salendo molto - statte calmo - GIORNO !
                #  4 feb 2025 se deviation_ma100_sopra_ma300 > 0.20 dev sell < -0.02 da < -0.01
                # 26 apr 2025 dev sell < -0.022 da < -0.02




            elif (
                ma50_last <= ma50_2_min_ago
                and ma20_last >= ma20_2_min_ago

                and (ma5_last < ma100_last or ma5_last < ma200_last)
                and ma450_last > ma450_180_min_ago
                and ma100_last > ma450_last

                and (ma100_last > ma100_10_min_ago or ma100_last > ma100_5_min_ago)
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma39 < 0.055
                and deviation_sell < -0.036
                
                and ma2_last <= ma2_2_min_ago
                and macd_differenza_2_min_ago < -4
            ):
                sell = "SELL CS - SALVAGENTE 3-39 < 0.055 e dev sell < -0.036 con ma50<= con ma20> - r 15985 A2 X1 x1"
                action = "sell"

                # 11 mag 2025 se ma20 > ma20 2 min ago dev sell a -0.036 da -0.033




            elif (
                ma3_last < ma33_last
                and (ma50_last <= ma50_2_min_ago or ma20_last < ma20_2_min_ago)
                
                and (ma5_last < ma100_last or ma5_last < ma200_last)
                and (ma450_last > ma450_180_min_ago or ma100_last > ma450_last)
                
                and (ma100_last > ma100_10_min_ago or ma100_last > ma100_5_min_ago)
                and deviation_ma100_sopra_ma300 > 0.10
                
                and deviation_ma39 < 0.055
                and deviation_sell < -0.033
                
                and macd_differenza_2_min_ago < -4
            ):
                sell = f"SELL CS - SALVAGENTE 3-39 < 0.055 e dev sell < -0.033 con ma50<= con ma20< - r 15985 A2 X1 x2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  2 feb 2024 se ma 100 sale da 10 min dev sell a 0.05 da 0.05 aspetta un po' prima di vendere se 100 cresce.
                
                #  6 mar 2024 aggiunto and ma450_last > ma450_180_min_ago
                #  6 mar 2024 and deviation_sell < -0.02 da 0.005
                # 12 set 2024 and deviation_sell < -0.025 da and deviation_sell < -0.02
                # 27 feb 2025 and deviation_sell < -0.035 da -0.025
                # 15 apr 2025 and deviation_sell < -0.033 da -0.035 ha fatto -0.75 ma e' andata bene.
                # 15 apr 2025 questa entra in azione durante un crollo improvviso mentre and ma450>ma450_180_min e 100>450 !
                # 11 mag 2025 se ma20 < ma20 2 min ago ok cosi'
                # 25 ott 2025 aggiunte pg
                # 25 ott 2025 anticipata ndecchiecella



            elif (
                ma50_last <= ma50_2_min_ago
                and ma450_last > ma450_180_min_ago
                and ma100_last < ma450_last

                and ma100_last > ma100_10_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.03
                
                and delta_450_300 > delta_450_300_60_min
                
                and ma2_last <= ma2_2_min_ago
                and macd_differenza_2_min_ago < -4
            ):
                sell = "SELL CS - SALVAGENTE 3-39 < 0.05 e dev sell < -0.03 con ma50 <= e dev_ma3_sotto_ma200 > -1.20 - r 15985 A2 X1y"
                action = "sell"
                
                #  2 feb 2024 se ma 100 sale da 10 min dev sell a 0.05 da 0.05 aspetta un po' prima di vendere se 100 cresce.
                
                #  6 mar 2024 aggiunto and ma450_last > ma450_180_min_ago
                #  6 mar 2024 and deviation_sell < -0.02 da 0.005
                # 12 set 2024 and deviation_sell < -0.025 da and deviation_sell < -0.02
                # 27 feb 2025 and deviation_sell < -0.03 da -0.025




            elif (
                ma50_last <= ma50_2_min_ago
                and ma450_last < ma450_180_min_ago
                
                and ma100_last > ma100_10_min_ago
                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20
                
                and deviation_ma39 < 0.05
                and deviation_sell < 0.005
                
                and delta_450_300 > delta_450_300_60_min
               
                and ma2_last <= ma2_2_min_ago 
                and macd_differenza_2_min_ago < -4
            ):
                sell = "SELL cond. special 3 - SALVAGENTE 3 3-39 < 0.05 e dev sell < 0.005 con ma50 <= e dev_ma3_sotto_ma200 > -1.20 - r 15985 A2 X2"
                action = "sell"
                
                #  2 feb 2024 se ma 100 sale da 10 min dev sell a 0.05 da 0.05 aspetta un po' prima di vendere se 100 cresce.
                
                #  6 mar 2024 aggiunto and ma450_last < ma450_180_min_ago
                #  6 mar 2024 and deviation_sell < -0.005




            elif (
                ma50_last <= ma50_2_min_ago
                and ma5_last > ma5_5_min_ago
                and price < last_trade_price

                and ma100_last <= ma100_10_min_ago
                and macd_differenza_2_min_ago < -4

                and deviation_ma39 < 0.05
                and deviation_sell < 0.03

                and ma2_last <= ma2_2_min_ago 
                and delta_450_300 > delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20
                
            ):
                sell = "SELL CS - SALVAGENTE 3-39 < 0.05 e dev sell < 0.03 con ma50 <= e dev_ma3_sotto_ma200 > -1.20 - r 15985 A2yx"
                action = "sell"

                # 23 set 2024 se ma5 sale da 5 min PER VENDERE il prezzo deve essere < dell' ultimo trade (che e' il buy)
                # 23 set 2024 ha venduto mentre stava risalendo bello bello. statte fermo !
                #  8 apr 2025 and deviation_sell < 0.03 da < 0.05



            elif (
                ma39_last <= ma100_last

                and ma3_last < ma39_last

                and ma200_last > ma200_60_min_ago

                and deviation_ma39 < 0.08
                and deviation_sell < 0.04
                
                and delta_450_300 > delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20

                and ma2_last <= ma2_2_min_ago
                and macd_differenza_2_min_ago < -1
            ):
                sell = f"SELL CS - SALVAGENTE 3-39 < 0.05 e dev sell < 0.05 con m39<100 e dev_ma3_sotto_ma200 > -1.20 - r 15985 A2yy1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                #  5 ott 2024 se mentre 200 sale ma crolla allora stai piu' attento !
                #  5 ott 2024 3-39 < 0.08 da <0.05
                # 19 gen 2025 39<100 invece di ma50_last <= ma50_2_min_ago
                # 27 mar 2025 aggiunta 3<39
                # 20 ott 2025 aggiunte pg




            elif (
                ma50_last <= ma50_2_min_ago
                and ma5_last <= ma5_5_min_ago
                and ma100_last <= ma100_10_min_ago
                and ma200_last <= ma200_60_min_ago

                and macd_differenza_2_min_ago < -4
                and deviation_ma39 < 0.05
                and deviation_sell < 0.05
                and ma2_last <= ma2_2_min_ago 
                and delta_450_300 > delta_450_300_60_min
                
                and deviation_ma100_sopra_ma300 > 0.20
                and deviation_ma3_sotto_ma150 > -1.20
                
            ):
                sell = "SELL cond. special 3 - SALVAGENTE 3 3-39 < 0.05 e dev sell < 0.05 con ma50 <= e dev_ma3_sotto_ma200 > -1.20 - r 15985 A2yy2"
                action = "sell"
                
                # 27 giu 2022 dev sell a 0.305 da 0.31
                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !)
                # 21 giugno 2022 RICORDO TREMENDO 9372 ha venduto a -2.23% !!!
                # COME PRIMA COSA HO NOTATO CHE AVEVA DEVIATION INVECE DI DEVIATON SELL 
                # ma non sapendo se era questo il problema ho creato la prossima condizione speciale.
                
                
                # > estate dev 39 -0.24 da -0.25 dev sell -0.30 da -0.31 
                # 13 set -3% !!! deviation_ma3_sotto_ma200 > -1.20 da deviation_ma3_sotto_ma200 > -1.20 
                # 21 gen 2023 dev sell -0.303 da -0.30
                # 20 feb 2023 -0.304 da -0.303 con doppio delta 450-300 NOTTE !
                
                
                
                
                
                
            # 4 - SELL ricordo terribile del 21 giugno 2022

            elif (
                
                ma3_last < ma100_last
                and delta_1 < delta_2
                and deviation_sell < -0.60
                and deviation_ma100_sopra_ma300 > 0.10
                and ma2_last < ma2_2_min_ago 
             
            ):
                sell = "SELL CS GIORNO - 21 giugno 2022 - deviation_sell < -0.60 - r 16010 BA X"
                action = "sell"   
             
                # 21 giugno 2022 RICORDO TERRIBILE del 21 giugno 2022 !  9372 A ha venduto a -2.23% !!!
                # 22 gen 2025 ha fatto -0.98
                # 22 gen 2025 se GIORNO -0.60 DA -0.69


            elif (
                
                ma3_last < ma100_last
                and delta_1 > delta_2
                and deviation_sell < -0.50
                and deviation_ma100_sopra_ma300 > 0.10
                and ma2_last <= ma2_2_min_ago 
             
            ):
                sell = "SELL CS NOTTE - 21 giugno 2022 - deviation_sell < -0.50 - r 16010 BA Y"
                action = "sell"   
             
                # 21 giugno 2022 RICORDO TERRIBILE del 21 giugno 2022 !  9372 A ha venduto a -2.23% !!!
                # 22 gen 2025 ha fatto -0.98
                # 22 gen 2025 se NOTTE -0.50 DA -0.69
                
                
            
            # 4 - SELL ricordo terribile del 21 giugno 2022
            
            elif (    
                ma39_last < ma100_last
                and deviation_sell < -0.67
                and deviation_ma100_sopra_ma300 < 0.20
                and ma2_last < ma2_2_min_ago 
             
            ):
                sell = "SELL condizione speciale 5 - 21 giugno 2022 - deviation_sell < -0.67 - r 16027 BB"
                action = "sell"   
             
                # 21 giugno 2022 RICORDO TERRIBILE del 21 giugno 2022 !  9372 A ha venduto a -2.23% !!!
                # 17 mar 2021 dev sell -0.67 da -0.68
                #  2 dic 2024 ho messo 39<100 al posto di 3<100 perche' ha venduto STUPIDAMENTE mentre stava salendo
                #  2 dic 2024 39<100 significa che entra in azione ma solo in una condizione di ribasso
            
                
            # 5 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 > -0.50
            
            elif (
                ma78_last > ma78_120_min_ago
                and ma3_last >= ma20_last
                and ma50_last <= ma50_2_min_ago
                
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.12
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and ma2_differenza_2_min_ago < -8
            ):
                sell = "SELL cond spec 6 GIORNO con ma300 < 5 ore MA CON 10>=20 and dev 3-39 < 0.07 and dev_sell < -0.12 e con ma50 < e con ma78 > and diff ma2 < -7 - r 16045 AX"
                action = "sell"
                
                # 26 dic 2023 con 10>=20 vendi dopo a -0.09 da -0.10
                #  8 gen 2024 dev sell a -0.12 da -0.09
                #  9 gen 2024 3>20 sostituisce 10>20 ! (CHE E' ARRIVATO TARDI)




            elif (
                ma5_last < ma100_last
                and ma300_last > ma450_last
                
                and delta_150_100 <= delta_150_100_60_min
                and ma78_last > ma78_120_min_ago

                and ma3_last < ma20_last
                and ma50_last <= ma50_2_min_ago
                
                and ma2_last < ma2_2_min_ago 
                
                
                and ma300_last < ma300_301_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell > 0.25
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
            ):
                sell = f"SELL CS GIORNO con 5-100 e 300>450 e 10<20 e dev 3-39 < 0.10 e dev_sell > 0.25 e ma50 < MA ma78 > - r 16045 AYx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 20 nov 2023 aggiunta and diff ma2 < -5 
                # 10 dic 2023 and deviation_sell a -0.10 da -0.0107
                # 26 dic 2023 con 10<20 vendi prima a -0.03 da -0.10
                #  9 gen 2024 questa ha fatto -0.86 ! ALLORA FACCIO LA PROSSIMA r 16045 AZ1 e AZ2
                #  9 gen 2024 3<20 sostituisce 10<20 ! (CHE E' ARRIVATO TARDI)
                # 20 set 2024 dev_sell < 0.03 da < -0.03
                # 13 apr 2025 se ma300_last > ma450_last and deviation_sell > 0.25 da < -0.03 LASCIALO STARE ! LASCIALO CORRERE !
                # 30 apr 2025 aggiunta 5-100 perche' vendeva male mentre saliva. lascialo stare !
                # 15 ott 2025 aggiunte pg



            elif (
                ma78_last > ma78_120_min_ago
                and delta_150_100 <= delta_150_100_60_min

                and ma300_last < ma450_last
                and ma300_last < ma300_301_min_ago

                and ma3_last < ma20_last
                and ma50_last <= ma50_2_min_ago
                
                and ma2_last < ma2_2_min_ago 
                and ma2_differenza_2_min_ago < -7
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.033
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
            ):
                sell = "SELL CS GIORNO MA CON 300<450 e 10<20 e dev 3-39 < 0.10 e dev_sell < -0.033 e ma50 < MA ma78 > - r 16045 AYy"
                action = "sell"
                
                # 20 nov 2023 aggiunta and diff ma2 < -5 
                # 10 dic 2023 and deviation_sell a -0.10 da -0.0107
                # 26 dic 2023 con 10<20 vendi prima a -0.03 da -0.10
                #  9 gen 2024 questa ha fatto -0.86 ! ALLORA FACCIO LA PROSSIMA r 16045 AZ1 e AZ2
                #  9 gen 2024 3<20 sostituisce 10<20 ! (CHE E' ARRIVATO TARDI)
                # 20 set 2024 dev_sell < 0.03 da < -0.03
                # 13 apr 2025 se ma300_last < ma450_last and deviation_sell < -0.033 da < -0.03
                



            
            elif (
                ma78_last > ma78_120_min_ago
                and ma3_last < ma20_last
                and ma50_last < ma50_2_min_ago
                
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.03
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                
            ):
                sell = "SELL cond spec 6 GIORNO con ma300 < 5 ore e con 10<20 and dev 3-39 < 0.07 and dev_sell < -0.03 e con ma50 < e con ma78 > and diff ma2 < -7 - r 16045 AZ1"
                action = "sell"
                
                # 20 nov 2023 aggiunta and diff ma2 < -5 
                # 10 dic 2023 and deviation_sell a -0.10 da -0.0107
                # 26 dic 2023 con 10<20 vendi prima a -0.03 da -0.10
                #  9 gen 2024 questa ha fatto -0.86 !
                #  9 gen 2024 3<20 sostituisce 10<20 ! (CHE E' ARRIVATO TARDI)


          
            elif (
                ma78_last > ma78_120_min_ago
                and (ma3_last < ma20_last or ma3_last < ma50_last)
                and ma50_last >= ma50_2_min_ago
                
                and (ma300_last < ma300_301_min_ago or delta_150_100 <= delta_150_100_60_min)
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.01
                
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last <= ma2_2_min_ago
                
                and macd_differenza_2_min_ago < -0.5
            ):
                sell = f"SELL CS GIORNO con ma300 < 5 ore e con 10<20 and dev 3-39 < 0.07 and dev_sell < -0.03 e con ma50> - r 16045 AZ 2A - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 20 nov 2023 aggiunta and diff ma2 < -5 
                # 10 dic 2023 and deviation_sell a -0.10 da -0.0107
                # 26 dic 2023 con 10<20 vendi prima a -0.03 da -0.10
                #  9 gen 2024 questa ha fatto -0.86 !
                #  9 gen 2024 3<20 sostituisce 10<20 ! (CHE E' ARRIVATO TARDI)
                # 11 gen 2024 and ma2_differenza_2_min_ago < -8 da -7
                # 11 gen 2024 and macd_differenza_2_min_ago < -0.5 (sperando che non faccia arrivare tardi il sell)
                # 28 apr 2025 questa e' stata ritoccata di una nullita'. attenzione ! vedi le note relative al 9 gen 2024
                # 20 ott 2025 modificata per anticipare di una ndecchiecella la vendita.

            
            elif (
                ma78_last > ma78_120_min_ago
                and ma3_last < ma20_last
                and ma50_last >= ma50_2_min_ago
                
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.07
                and deviation_sell < 0.03
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and ma2_differenza_2_min_ago < -7
                and macd_differenza_2_min_ago < -8
            ):
                sell = "SELL cond spec 6 GIORNO con ma300 < 5 ore e con 10<20 and dev 3-39 < 0.07 and dev_sell < -0.03 e con ma50 < e con ma78 > and diff macd < -6 - r 16045 AZ 2B"
                action = "sell"
                
                # 20 nov 2023 aggiunta and diff ma2 < -5 
                # 10 dic 2023 and deviation_sell a -0.10 da -0.0107
                # 26 dic 2023 con 10<20 vendi prima a -0.03 da -0.10
                #  9 gen 2024 questa ha fatto -0.86 !
                #  9 gen 2024 3<20 sostituisce 10<20 ! (CHE E' ARRIVATO TARDI)
                #  9 gen 2024 se il macd da' una grande botta al ribaso allora anticipo il buy
          
          
            elif (
                ma78_last < ma78_120_min_ago
                and ma450_last > ma450_180_min_ago

                and ma40_last > ma50_last
                and ma50_last > ma50_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.03
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL C S 6 GIORNO con ma450 > e ma300 < 5 ore e ma50 > E 40>50 e dev 3-39 < 0.10 e dev_sell < -0.03 e ma78 < - r 16045 B1 x1"
                action = "sell"
                
                # 28 dic 2023 se anche 40>50 dev sell a 0.01 da 0.03
                # 28 dic 2023 se anche 40>50 dev sell a 0.02 da 0.01
                
                #  5 mar 2024 se anche 40>50 dev sell a -0.02 da 0.02
                #  6 mar 2024 aggiunta and ma450_last > ma450_180_min_ago
                #  6 mar 2024 dev sell a -0.025 da -0.02
                # 19 gen 2025 dev sell a -0.03 da -0.025

                
                
            elif (
                ma78_last < ma78_120_min_ago
                and ma450_last < ma450_180_min_ago
                and ma3_last < ma100_last

                and (ma20_last > ma50_last or ma40_last > ma50_last)
                and ma50_last > ma50_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.15
                and deviation_sell < -0.027
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50

                and ma2_last < ma2_2_min_ago
              
            ):
                sell = "SELL C S GIORNO con ma450< e ma300< 5 ore e ma50> E 20>50 OR 40>50 e dev_sell < -0.027 e ma78 < - r 16045 B1 x2"
                action = "sell"
                
                # 28 dic 2023 se anche 40>50 dev sell a 0.01 da 0.03
                # 28 dic 2023 se anche 40>50 dev sell a 0.02 da 0.01
                
                #  5 mar 2024 se anche 40>50 dev sell a -0.02 da 0.02
                #  6 mar 2024 aggiunta and ma450_last < ma450_180_min_ago
                # 15 set 2024 and deviation_ma39 < 0.15 da  < 0.13
                # 14 set 2024 tolta and macd_differenza_2_min_ago < -0.35 (il macd saliva!) e aggiunta and ma3_last < ma100_last
                # 13 apr 2025 and deviation_sell a < -0.025 da < -0.02

                # 13 apr 2025 and deviation_sell a < -0.027 da < -0.025
                # 13 apr 2025 aggiunta and (ma20_last > ma50_last or ma40_last > ma50_last)



            elif (
                ma78_last < ma78_120_min_ago
                and ma39_last > ma100_last
                and ma300_last < ma300_301_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.70
                and ma40_last <= ma50_last
                and ma50_last > ma50_2_min_ago
                
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
            
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL CS GIORNO con ma300 <5 ore con ma50 > e dev_sell < -0.01 e dev 3-39 < 0.13 e ma78 < - r 16045 B1 Y1"
                action = "sell"

                # 16 set 2024 and deviation_sell < 0.01 da 0.03
                #  5 gen 2025 se 39>100 allora deviation_sell < -0.01 da 0.01

            elif (
                ma78_last < ma78_120_min_ago
                and ma39_last < ma100_last
                and ma300_last < ma300_301_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.70
                and ma40_last <= ma50_last
                and ma50_last > ma50_2_min_ago
                
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < 0.01
            
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL CS GIORNO con ma300 <5 ore con ma50 > e dev_sell < 0.01 e dev 3-39 < 0.13 e ma78 < - r 16045 B1 Y2"
                action = "sell"

                # 16 set 2024 and deviation_sell < 0.01 da 0.03


            elif (
                ma78_last < ma78_120_min_ago
                
                and deviation_ma250_sopra_ma300 > 0.12
                
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and ma2_differenza_ma5 < -8
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.02
                
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL cond spec 6 GIORNO con ma300 < 5 ore con ma50 <= e dev 3-39 < 0.13 and dev_sell < -0.01 e con ma78 < and macd_differenza_2_min_ago < -0.35 - r 16045 B2 X1"
                action = "sell"
                
                #  9 gen 2024 and deviation_sell < -0.02 SE deviation_ma250_sopra_ma300 > 0.12
          
            
            elif (
                ma78_last < ma78_120_min_ago
                
                and deviation_ma250_sopra_ma300 < 0.12
                and deviation_ma250_sopra_ma300 > -0.12
                
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                
                and ma2_differenza_ma5 < -8
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.06
               
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL cond spec 6 GIORNO con ma300 < 5 ore con ma50 <= e dev 3-39 < 0.13 and dev_sell < -0.06 e con ma78 < and macd_differenza_2_min_ago < -0.35 - r 16045 B2 X2"
                action = "sell"
                
                # 17 dic 2023 mario se ma20>ma20 2 min ago dev sell a 0.005 da 0.03 vedi 17 di 2023 ore 9:33
                # 17 dic 2023 mario se ma20>ma20 and ma2_differenza_ma5 < -8
                # 24 dic 2023 mario se ma20>ma20 deviation_sell < -0.01 da > 0.005
                
                #  9 gen 2024 and deviation_sell < -0.05 SE ANDAMENTO LATERALE CONSOLIDATO
                # 12 gen 2024 and deviation_sell < -0.06 da -0.05 SE ANDAMENTO LATERALE CONSOLIDATO

            
            elif (
                ma78_last < ma78_120_min_ago
                and ma5_last > ma100_last
                and deviation_ma250_sopra_ma300 < -0.12
                
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and ma2_differenza_ma5 < -8
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.03
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL C.S. GIORNO con ma300 < 5 ore con ma50 <= e dev 3-39 < 0.13 and dev_sell < -0.01 e con ma78 < and macd_differenza_2_min_ago < -0.35 - r 16045 B2 X3 x"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se ma5_last > ma100_last stai piu' tranquillo
            
            
            elif (
                ma78_last < ma78_120_min_ago
                and ma5_last < ma100_last
                and deviation_ma250_sopra_ma300 < -0.12
                
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and ma2_differenza_ma5 < -8
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL C.S. 6 GIORNO con ma300 < 5 ore con ma50 <= e dev 3-39 < 0.13 and dev_sell < -0.01 e con ma78 < and macd_differenza_2_min_ago < -0.35 - r 16045 B2 X3 y"
                action = "sell"
                
                # 17 dic 2023 mario se ma20>ma20 2 min ago dev sell a 0.005 da 0.03 vedi 17 di 2023 ore 9:33
                # 17 dic 2023 mario se ma20>ma20 and ma2_differenza_ma5 < -8
                # 24 dic 2023 mario se ma20>ma20 deviation_sell < -0.01 da > 0.005
                
                #  9 gen 2024 and deviation_sell < -0.01 SE deviation_ma250_sopra_ma300 < -0.12


            elif (
                ma78_last < ma78_120_min_ago

                and delta_450_200 < delta_450_200_60_min
                and delta_150_100 <= delta_150_100_60_min

                and ma30_last > ma50_last
                and ma20_last <= ma20_2_min_ago
                and ma20_last > ma20_10_min_ago
                
                and ma50_last <= ma50_2_min_ago
                
                and ma300_last < ma300_301_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.05
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and macd_differenza_2_min_ago < -0.35
                and deviation_ma2_sopra_o_sotto_ma5 < -0.064
            ):
                sell = "SELL C.S. GIORNO-GIORNO con ma300 < 5 ore e 30>50 e ma50 <= e dev 3-39 < 0.10 e dev_sell < -0.05 e ma78 < - r 16045 B2 Y1 x1"
                action = "sell"

                #  3 ott 2023 se e' GIORNO- GIORNO dev sell a -0.05 da -0.01 
                #  3 ott 2023 se e' GIORNO- GIORNO dev_ma39 < 0.10 da -0.13

            elif (
                ma78_last < ma78_120_min_ago

                and delta_450_200 > delta_450_200_60_min
                and delta_150_100 <= delta_150_100_60_min

                and ma30_last > ma50_last
                and ma20_last <= ma20_2_min_ago
                and ma20_last > ma20_10_min_ago
                
                and ma50_last <= ma50_2_min_ago
                
                and ma300_last < ma300_301_min_ago

                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and macd_differenza_2_min_ago < -0.35
                and deviation_ma2_sopra_o_sotto_ma5 < -0.064
            ):
                sell = "SELL C.S. GIORNO-NOTTE con ma300 < 5 ore e 30>50 e ma50 <= e dev 3-39 < 0.13 e dev_sell < -0.01 e ma78 < - r 16045 B2 Y1 x2"
                action = "sell"
                
                # 23 dic 2023 dev_sell < 0.01 se ma20 cresce da 10 min
                # 18 gen 2024 dev_sell < a -0.01 da 0.01 (ma30 e' andata sopra ma50 sembra una chiara inversione di tendenza !)
                # 18 gen 2024 ho aggiunto and deviation_ma2_sopra_o_sotto_ma5 < -0.064 MA SOLO QUI


            
            elif (
                ma78_last < ma78_120_min_ago
                and ma30_last < ma50_last
                and ma20_last <= ma20_2_min_ago
                and ma20_last > ma20_10_min_ago
                
                and ma50_last <= ma50_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < 0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.35
                
            ):
                sell = "SELL C.S. GIORNO con ma300 < 5 ore e 30>50 e ma50 <= e dev 3-39 < 0.13 and dev_sell < 0.01 e con ma78 < e macd_differenza_2_min_ago < -0.35 - r 16045 B2 Y1 y"
                action = "sell"
                
                # 23 dic 2023 dev_sell < 0.01 se ma20 cresce da 10 min




            elif (
                ma3_last < ma15_last
                
                and deviation_sell < 0.40

                and deviation_ma39 < 0.068
                and deviation_ma3_sotto_ma50 < 0.069

                and (ma5_prev > ma22_prev and ma5_last < ma22_last)
                and (ma5_last < ma200_last or ma5_last < ma300_last)
                
                and (ma300_last < ma300_301_min_ago or ma300_last < ma300_120_min_ago)
                and ma78_last < ma78_120_min_ago
                
                and ma100_last < ma200_last
                and ma200_last < ma300_last

                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.03
                
            ):
                sell = f"SELL CS guadagno durante un forte ribasso del 15 ott 2025 - r 16045 B2 Y2 X1 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 30 ott 2024 se 30 > 78 statte calmo
                #  8 apr 2025 dev sell a -0.02 da -0.03
                #  7 ago 2025 dev sell a -0.01 da -0.02
                #  1 ott 2025 se deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.03 allora dev sell a -0.02 da -0.01
                #  1 ott 2025 aggiunta parentesi graffa sulla stessa linea.
                # 15 ott 2025 aggiunta guadagno durante un forte ribasso
                # 16 ott 2025 modificata perche' ha fatto -0.48

                # 20 ott 2025 aggiunta and deviation_ma39 < 0.068 (ho conosciuto la deviation grazie alla pg)
                # 20 ott 2025 aggiunta and deviation_ma3_sotto_ma50 < 0.069 (ho conosciuto la deviation grazie alla pg)
                # 20 ott 2025 5-22 da 5-20




            elif (
                ma3_last < ma50_last
                and (ma5_prev > ma20_prev and ma5_last < ma20_last)

                and (ma5_last < ma100_last or ma5_last < ma200_last or ma5_last < ma300_last)
                
                and (ma300_last < ma300_301_min_ago or ma300_last < ma300_120_min_ago)
                and ma78_last < ma78_120_min_ago
                
                and deviation_ma5_sopra_o_sotto_ma5_120_min_ago < -0.50
                and deviation_ma5_sotto_ma200 > -0.50

                and ma100_last < ma200_last
                and ma200_last < ma300_last

                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.02
                
                and ma30_last > ma78_last
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < 0.02
                
                and ma2_last <= ma2_2_min_ago 
               
            ):
                sell = f"SELL CS GIORNO e dev_ma100_sopra_o_sotto_ma100_10_min > -0.02 con ma300 < 5 ore MA 30>78 e dev 3-39 < 0.13 E dev_sell < -0.02 - r 16045 B2 Y2 X1 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 30 ott 2024 se 30 > 78 statte calmo
                #  8 apr 2025 dev sell a -0.02 da -0.03
                #  7 ago 2025 dev sell a -0.01 da -0.02
                #  1 ott 2025 se deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.03 allora dev sell a -0.02 da -0.01
                #  1 ott 2025 aggiunta parentesi graffa sulla stessa linea.
                # 15 ott 2025 modificata per cercare di vendere con un piccolo guadagno durante un forte ribasso










            elif (
                ma300_last < ma300_301_min_ago
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.03

                and ma78_last < ma78_120_min_ago
                and ma30_last > ma78_last

                and ma20_last <= ma20_2_min_ago
                
                and ma50_last <= ma50_2_min_ago
                
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.001
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last <= ma2_2_min_ago 
               
            ):
                sell = "SELL CS GIORNO e dev_ma100_sopra_o_sotto_ma100_10_min < -0.03 con ma300 < 5 ore MA 30>78 e dev 3-39 < 0.13 E dev_sell < -0.01 - r 16045 B2 Y2 X2 deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                action = "sell"

                # 30 ott 2024 se 30 > 78 statte calmo
                #  8 apr 2025 dev sell a -0.02 da -0.03
                #  7 ago 2025 dev sell a -0.01 da -0.02
                #  1 ott 2025 se deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.03 allora dev sell a -0.01
                #  1 ott 2025 aggiunta parentesi graffa sulla stessa linea.


            elif (
                ma78_last < ma78_120_min_ago
                and ma30_last < ma78_last

                and ma20_last <= ma20_2_min_ago
                and ma20_last <= ma20_10_min_ago
                
                and ma50_last <= ma50_2_min_ago
                and ma2_differenza_2_min_ago < -15
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.13
                and deviation_sell < 0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -1.35
                
            ):
                sell = "SELL CS GIORNO con ma300 < 5 ore E ma50 <= E 30<78 e dev 3-39 < 0.13 E dev_sell < 0.01 - r 16045 B2 Y2 Y1x"
                action = "sell"


            
            elif (    
                ma3_last < ma39_last
                
                and ma300_last < ma300_301_min_ago
                and ma25_last < ma300_last
                and deviation_sell > 0.70
                
                and ma20_last <= ma20_2_min_ago
                
                and ma2_last < ma2_2_min_ago 
                
                
            ):
                sell = "SELL CS con ma300 < 5 ore prenditi i soldi se sta guadagnando almeno 0.70 - r 16045 B2 Y2 Y1y"
                action = "sell"

                # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                # 15 set 2023 quando GIORNO a -0.11 da -0.07
                #  2 ott 2023 DOPO UN ALTRO -1 HO FATTO QUESTA and deviation_ma5_sotto_ma200 > -0.50
                #  2 ott 2023 TOLTO and macd < macd_2_min_ago ARRIVATO TARDI ! VEDI 2 OTTOBRE 2023 ORE 20 e 40 - r 16047 B2
                # 13 nov 2023 aggiunto and macd_differenza_2_min_ago < -0.25
                
                # 27 nov 2023 and deviation_ma39 a 0.13 da 0.07
                # 27 nov 2023 and deviation_sell < 0.03 da < -0.105
                # 29 nov 2023 and macd_differenza_2_min_ago < -0.35 da -0.25
                #  5 dic 2023 aggiunta and ma2_differenza_2_min_ago < -7
                #  6 dic 2023 diff ma2 da -7 a -15
                # 23 dic 2023 dev_sell < 0.03 se ma20 scende da 10 min
                # 16 set 2024 macd_differenza_2_min_ago < -1.35 da -0.35
                #  6 gen 2025 se e' giorno dev_sell < 0.01 da < 0.03








            elif (
                ma78_last < ma78_120_min_ago
                and delta_150_100 <= delta_150_100_60_min

                and ma10_last < ma100_last

                and ma20_last <= ma20_10_min_ago
                and ma50_last <= ma50_2_min_ago
                
                and ma300_last < ma300_301_min_ago
                
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.50
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -1.35
                
            ):
                sell = f"""SELL CS GIORNO con ma300 < 5 ore E ma50 <= E 30<78 e dev 3-39 < 0.13 E dev_sell < -0.01 - r 16046
                
                deviation_ma39 {deviation_ma39:.2f}
                deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                """

                action = "sell"

                #  4 nov 2024 aggiunta. se 10<100 vende !
                # 27 gen 2025 dev_sell < -0.01 da < 0.03
                # 28 mag 2025 aggiunta parentesi graffe

            

            # 5 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 > -1.00
                
            elif (
                ma78_last > ma78_120_min_ago
                and ma10_last > ma30_last

                and ma100_last > ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.045
                and ma2_last < ma2_2_min_ago 
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL CS CON 50>59 and ma50< - dev 3-39 < 0.07 e dev_sell < -0.045 and macd_diff_2_min_ago < -0.20 - r 16047 A1 x1 a1 X"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se 100 >125 stai piu' tranquillo
                # 24 feb 2024 se 10>30 stai ancora piu' tranquillo cazzo !
                # 24 feb 2024 dev sell a -0.045 da -0.03






            elif (

                ma78_last > ma78_120_min_ago
                and ma100_last > ma450_last

                and ma10_last < ma30_last
                and ma5_last < ma150_last

                and ma100_last > ma125_last
                
                and (ma50_last < ma50_2_min_ago or delta_CM_300_25_last > delta_CM_300_25_2_min_ago)
                
                and deviation_ma39 < 0.08
                and deviation_sell < 0.01
                
                and deviation_ma100_sopra_ma300 < 0.50
                and deviation_ma5_sotto_ma200 > -0.80
                
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = f"SELL CS con 100>450 e CON 50>59 and ma50< - SALVAGENTE dev 3-39 < 0.08 e dev_sell < -0.01 - r 16047 A1 x1 a1 Yx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se 100>125 stai piu' tranquillo
                #  6 ott 2024 ma se 5 e' andata sotto 150 anticipa ndecchiecella
                #  6 ott 2024 and deviation_ma39 < 0.08 da 0.07
                #  6 ott 2024 and deviation_sell < -0.01 da -0.03
                #  6 ago 2025 aggiunto 100>450
                # 25 ott 2025 aggiunte pg
                # 25 ott 2025 aggiunto or delta_CM_300_25_last > delta_CM_300_25_2_min_ago
                # 25 ott 2025 deviation_sell a 0.01 da -0.01


            elif (
                ma78_last > ma78_120_min_ago
                and ma100_last < ma450_last

                and ma10_last < ma30_last
                and ma5_last < ma150_last

                and ma100_last > ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < 0.01

                and ma2_last < ma2_2_min_ago 
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL CS con 100<450 e CON 50>59 and ma50< - SALVAGENTE dev 3-39 < 0.08 e dev_sell < 0.01 - r 16047 A1 x1 a1 Yy"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se 100>125 stai piu' tranquillo
                #  6 ott 2024 ma se 5 e' andata sotto 150 anticipa ndecchiecella
                #  6 ott 2024 and deviation_ma39 < 0.08 da 0.07
                #  6 ott 2024 and deviation_sell < -0.01 da -0.03
                #  6 ago 2025 se 100<450 and deviation_sell < 0.01 da -0.01




            elif (
                ma78_last > ma78_120_min_ago
                and ma450_last > ma450_480_min_ago

                and ma200_last > ma300_last
                and ma3_last > ma200_last

                and ma10_last < ma30_last
                
                and ma100_last > ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.052
                
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80

                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL CS con 450 > 8 ore and ma50< - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.052 - r 16047 A1 x1 a1 Y1 X1"
                action = "sell"



            elif (
                ma78_last > ma78_120_min_ago
                and ma450_last < ma450_480_min_ago

                and ma200_last > ma300_last
                and ma3_last > ma200_last

                and ma10_last < ma30_last
                
                and ma100_last > ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.05
                
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80

                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL CS con con 450 > 8 ore and ma50< - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.05 - r 16047 A1 x1 a1 Y1 X2"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se 100>125 stai piu' tranquillo
                # 15 ott 2024 se 200>300 and deviation_sell < -0.05 da < -0.03
                # 14 mar 2025 con 3 che sta ancora sopra 200 ok cosi'
                # 14 mar 2025 deviation_sell < -0.052 da -0.045


            

            
            elif (
                ma78_last > ma78_120_min_ago
                and ma200_last > ma300_last
                and ma3_last < ma200_last

                and ma10_last < ma30_last
                
                and ma100_last > ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.04
                
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80

                and ma2_last <= ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL CS CON 50>59 and ma50< - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.04 - r 16047 A1 x1 a1 Y1 Y"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se 100>125 stai piu' tranquillo
                # 15 ott 2024 se 200>300 and deviation_sell < -0.05 da < -0.03
                # 14 mar 2025 con 3 che e' andato sotto 200 anticipo vendita di una ndecchiecella -0.04 da -0.05





            elif (
                ma78_last > ma78_120_min_ago
                and ma200_last < ma300_last

                and ma10_last < ma30_last
                and ma5_last > ma150_last

                and ma100_last > ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.04
                
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80

                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL CS CON 50>59 and ma50< - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.04 - r 16047 A1 x1 a1 Y2"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se 100>125 stai piu' tranquillo
                # 15 ott 2024 deviation_sell < -0.04 da < -0.03



            






            elif (
                ma78_last > ma78_120_min_ago
                and ma100_last > ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < 0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma5_last < ma5_5_min_ago
                
                and ma2_last < ma2_2_min_ago
                and macd_differenza_2_min_ago < -7
                and macd < -27
            ):
                sell = "SELL condizione speciale CON 50>59 and ma50< - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.03 and macd_diff_2_min_ago < -0.20 - r 16047 A1 x1 a2"
                action = "sell"
                
                # 15 gen 2024 and deviation_sell < -0.03 da -0.01 se 100 >125 stai piu' tranquillo
                # 15 gen 2024 se macd accelera spaventosamente al ribasso sia come differenza che come valore assoluto vendi un po' prima della precedente !




            elif (
                ma78_last > ma78_120_min_ago
                and ma50_last > ma50_2_min_ago

                and ma450_last > ma450_120_min_ago
                and ma50_last > ma59_last
                
                
                and ma100_last < ma125_last
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.019
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last <= ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = f"SELL CS con 50>59 and ma50> - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.01 - r 16047 A1 X1 B1x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 28 apr 2025 anticipato ma di una ndecchiecella proprio.
                # 28 apr 2025 aggiunto and ma50_last > ma50_2_min_ago
                # 20 ott 2025 aggiunte pg



            elif (
                ma78_last > ma78_120_min_ago
                and ma50_last <= ma50_2_min_ago

                and ma450_last > ma450_120_min_ago
                and ma50_last > ma59_last
                
                
                and ma100_last < ma125_last
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.019
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last <= ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL CS con 50>59 and ma50< - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.01 - r 16047 A1 X1 B1y"
                action = "sell"

                # 28 apr 2025 anticipato ma di una ndecchiecella proprio.
                # 28 apr 2025 aggiunto and ma50_last <= ma50_2_min_ago


            
            elif (
                ma78_last > ma78_120_min_ago
                and ma450_last < ma450_120_min_ago
                and ma100_last < ma125_last
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -0.20
            ):
                sell = "SELL condizione speciale CON 50>59 and ma50< - SALVAGENTE dev 3-39 < 0.07 e dev_sell < -0.01 and macd_diff_2_min_ago < -0.20 - r 16047 A1 X1 B2"
                action = "sell"
                
                # 14 nov 2023 se ma50_last > ma59_last
                # 27 nov 2023 dev_sell < -0.02 da -0.10
                # 18 dic 2023 dev_sell a -0.01 da -0.02
                # 18 dic 2023 dev_39 a 0.07 da 0.02



          

            
            elif (
                ma78_last > ma78_120_min_ago
                and ma50_last > ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < 0.02
                
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.80
                and ma2_last < ma2_2_min_ago 
                and macd_differenza_2_min_ago < -5.00
                and macd < -28
            ):
                sell = "SELL condizione speciale SALVAGENTE  CON 50 > 59 - MA macd < -28 and macd_diff_2_min_ago < -5.00 e dev 3-39 < 0.10 e dev_sell < 0.02 con ma50 > - r 16047 A1x2"
                action = "sell"
                
                # 14 nov 2023 se ma50_last > ma59_last
                # 27 nov 2023 dev_sell < -0.02 da -0.10
                # 12 dic 2023 MA SE and macd < -28 AND and macd_differenza_2_min_ago < -5.00 vendi un po' prima !
                # 12 dic 2023 dev 3-39 a 0.10 da 0.05
                # 12 dic 2023 dev_sell a 0.02 da -0.02
          

            elif (
                ma78_last > ma78_120_min_ago
                and ma10_last > ma10_2_min_ago
                
                and ma50_last < ma59_last
                and ma20_last > ma20_2_min_ago
               
                and deviation_ma39 < 0.08
                and deviation_sell < -0.06
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -9
                and macd_differenza_2_min_ago < -0.30
            ):
                sell = f"SELL cond spec 6 CON 50<59 - SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.06 e ma50< - r 16047 A1 Y1 X1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.01 da 0.01
                # oggi 13 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.03 da -0.01
                
                # oggi 12 gen 2024 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.04 da -0.03
                # 17 gen 2024 SE ma10_last > ma10_2_min_ago DEV SELL a -0.05 da -0.04
                # 22 mag 2025 SE ma10_last > ma10_2_min_ago DEV SELL a -0.06 da -0.05
                # 20 ott 2025 aggiunte pg

            
            elif (
                ma78_last > ma78_120_min_ago
                and ma200_last > ma200_120_min_ago
                and ma10_last < ma10_2_min_ago
                
                and ma20_last > ma20_2_min_ago
                and ma50_last < ma59_last
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.05
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -11
                
                and macd_differenza_2_min_ago < -0.30
            ):
                sell = "SELL CS SALVAGENTE con 50<59 MA ma200 > 120 min ago e dev 3-39 < 0.05 e dev_sell < -0.05 e ma50 < - r 16047 A1 Y1 X2a"
                action = "sell"

                #  6 ott 2024 con 200 > 120 min ago



            elif (
                ma78_last > ma78_120_min_ago
                and ma200_last < ma200_120_min_ago
                and ma10_last < ma10_2_min_ago
                
                and ma20_last > ma20_2_min_ago
                and ma50_last < ma59_last
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.045
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -11
                
                and macd_differenza_2_min_ago < -0.30
            ):
                sell = "SELL CS SALVAGENTE CON 50<59 E ma200 < 120 min ago - dev 3-39 < 0.05 e dev_sell < -0.045 e ma50 < - r 16047 A1 Y1 X2b"
                action = "sell"
                
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.01 da 0.01
                # oggi 13 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.03 da -0.01
                
                # oggi 12 gen 2024 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.04 da -0.03
                # oggi  9 feb 2024 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.044 da -0.04
                # oggi  9 feb 2024 ascolta mario and ma2_differenza_2_min_ago < -10 da -9
                # oggi  6 ott 2024 ascolta mario and ma2_differenza_2_min_ago < -11 da -10
                # oggi 13 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.05 da -0.04
                #  6 ott 2024 con 200 < 120 min ago


            elif (
                ma78_last > ma78_120_min_ago
                and ma10_last > ma10_2_min_ago
                and ma39_last > ma100_last
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                and ma2_differenza_2_min_ago < -4
                and macd_differenza_2_min_ago < -0.50
                and ma2_last < ma2_2_min_ago
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.05
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.80
                
            ):
                sell = "SELL CS CON 50<59 - SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.05 e ma50 < MA ma39 > ma100 - r 16047 A1 Y1 Y1 X"
                action = "sell"

                # 15 gen 2024 se ma10_last > ma10_2_min_ago aumentato dev sell a -0.03 da -0.01
                # 21 feb 2024 dev_sell a -0.04 da -0.03
                # 15 nov 2024 se 39>100 allora dev sell a -0.05 da -0.04



            elif (
                ma78_last > ma78_120_min_ago
                and ma10_last > ma10_2_min_ago
                and ma39_last < ma100_last
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                and ma2_differenza_2_min_ago < -4
                and macd_differenza_2_min_ago < -0.50
                and ma2_last < ma2_2_min_ago
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.04
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.80
                
            ):
                sell = "SELL CS CON 50<59 - SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.04 e ma50 < e ma39 < ma100 - r 16047 A1 Y1 Y1 Y"
                action = "sell"

                # 15 gen 2024 se ma10_last > ma10_2_min_ago aumentato dev sell a -0.03 da -0.01
                # 21 feb 2024 dev_sell a -0.04 da -0.03



            elif (
                ma78_last > ma78_120_min_ago
                and ma100_last > ma200_last
                and ma5_last > ma150_last

                and ma450_last > ma450_360_min_ago
                

                and ma10_last < ma10_2_min_ago
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.018
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                
                and macd_differenza_2_min_ago < -1.30
                
            ):
                sell = f"SELL SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.018 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 AX 1 x1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                #  9 nov 2024 se deviation_ma50_sopra_o_sotto_ma300 > 0.02 allora dev sell a < -0.02 da -0.015
                # 27 mar 2025 se ma100_last > ma200_last allora deviation_sell < -0.018
                # 27 mar 2025 se ma5_last > ma150_last and deviation_sell < -0.018
                # 24 ott 2025 aggiunte pg



            elif (
                ma78_last > ma78_120_min_ago
                and ma100_last > ma200_last
                and ma5_last < ma150_last

                and ma450_last > ma450_360_min_ago
                

                and ma10_last < ma10_2_min_ago
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.0185
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                
                and macd_differenza_2_min_ago < -1.30
                
            ):
                sell = f"SELL SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.0185 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 AX 1 x2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                #  9 nov 2024 se deviation_ma50_sopra_o_sotto_ma300 > 0.02 allora dev sell a < -0.02 da -0.015
                # 27 mar 2025 se ma100_last > ma200_last allora deviation_sell < -0.018
                # 27 mar 2025 se ma5_last < ma150_last and deviation_sell < -0.017
                # 30 mar 2025 and deviation_sell a -0.0185 da -0.017
                # 24 ott 2025 aggiunte pg


                
            elif (
                ma78_last > ma78_120_min_ago
                and ma100_last < ma200_last
                and ma5_last > ma150_last

                and ma450_last > ma450_360_min_ago
                

                and ma10_last < ma10_2_min_ago
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.017
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                
                and macd_differenza_2_min_ago < -1.30
                
            ):
                sell = f"SELL SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.017 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 AX 1 y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                #  9 nov 2024 se deviation_ma50_sopra_o_sotto_ma300 > 0.02 allora dev sell a < -0.02 da -0.015
                # 27 mar 2025 se ma100_last < ma200_last allora deviation_sell < -0.017
                # 27 mar 2025 se ma5_last > ma150_last and deviation_sell < -0.017
                # 24 ott 2025 aggiunte pg

                

            elif (
                ma78_last > ma78_120_min_ago 
                and ma450_last > ma450_360_min_ago

                and (ma100_last < ma200_last or ma5_last < ma150_last)
                
                and (ma10_last < ma10_2_min_ago or ma20_last <= ma20_2_min_ago)
                and ma50_last < ma59_last
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.016
                
                and deviation_ma5_sotto_ma200 > -0.80
                
                and macd_differenza_2_min_ago < -0.50
                
            ):
                sell = f"SELL SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.016 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 AX 1 y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                #  9 nov 2024 se deviation_ma50_sopra_o_sotto_ma300 > 0.02 allora dev sell a < -0.02 da -0.015
                # 27 mar 2025 se ma100_last < ma200_last allora deviation_sell < -0.017
                # 27 mar 2025 se ma5_last < ma150_last and dev_sell < -0.016
                # 24 ott 2025 aggiunte pg
                # 24 ott 2025 ha fatto -0.42 e allora ho modificato come ho potuto per farla vendere prima.




            elif (
                ma78_last > ma78_120_min_ago
                and deviation_ma50_sopra_o_sotto_ma300 < 0.02
                and ma450_last > ma450_360_min_ago
                and ma100_last > ma200_last

                and ma10_last < ma10_2_min_ago
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.015
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and ma2_differenza_2_min_ago < -8
                and macd_differenza_2_min_ago < -1.30
                
            ):
                sell = f"SELL CS - SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.015 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 ax 2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 24 ott 2025 aggiunte pg




            elif (
                ma78_last > ma78_120_min_ago
                and ma450_last > ma450_360_min_ago
                and ma100_last < ma200_last

                and ma10_last < ma10_2_min_ago
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.011
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                
                and macd_differenza_2_min_ago < -1.30
                
            ):
                sell = f"SELL CS - SALVAGENTE dev 3-39 < 0.08 e dev_sell < -0.011 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 ay - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  8 mar 2024 se ma450_last > ma450_360_min_ago dev_sell a -0.015 da -0.005
                #  7 ott 2024 se 100<200 anticipato di una ndecchiecella
                # 7 ott 2024 and deviation_ma39 < 0.08 da < 0.05
                # 7 ott 2024 and deviation_sell < -0.011 da < -0.015
                # 24 ott 2025 aggiunte pg



                
            elif (
                ma78_last > ma78_120_min_ago
                and ma450_last < ma450_360_min_ago
                and ma300_last > ma450_last

                and ma10_last < ma10_2_min_ago
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.03
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and ma2_differenza_2_min_ago < -8
                and macd_differenza_2_min_ago < -1.30
                
            ):
                sell = f"SELL CS - SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.03 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 bx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 30 dic 2024 and deviation_sell < -0.03 da < -0.02 se 300 > 450
                # 24 ott 2025 aggiunte pg




            elif (
                ma78_last > ma78_120_min_ago
                and ma450_last < ma450_360_min_ago
                and ma300_last < ma450_last

                and ma10_last < ma10_2_min_ago
                and ma50_last < ma59_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.005
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and ma2_differenza_2_min_ago < -8
                and macd_differenza_2_min_ago < -1.30
                
            ):
                sell = f"SELL CS - SALVAGENTE dev 3-39 < 0.05 e dev_sell < -0.005 e ma50 < e macd_diff_2_min_ago < -0.20 - r 16047 A1 Y1 Y2 by - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last <= ma20_2_min_ago DEV SELL a 0.01
                # 11 dic 2023 diff macd < -0.50 da -0.30
                # 11 dic 2023 and deviation_sell < -0.01
                # 11 dic 2023 and ma2_differenza_2_min_ago a -4 da -3
                # 15 gen 2024 and macd_differenza_2_min_ago < -1.30
                # 25 gen 2024 deviation_sell a -0.005 da -0.01
                # 25 gen 2024 aggiunto and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                
                #  8 mar 2024 se ma450_last < ma450_360_min_ago dev_sell a -0.005
                # 24 ott 2025 aggiunte pg




            elif (
                ma78_last > ma78_120_min_ago
                and deviation_ma300_sopra_ma450 > -0.085

                and ma10_last > ma10_2_min_ago
                and ma2_last < ma8_last
                
                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.06
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and ma2_differenza_2_min_ago < -8
                
                and macd_differenza_3_min_ago < -1.25
            ):
                sell = f"SELL CS con ma10>ma10 2 min ago CON 50<59 e dev 3-39 < 0.08 e dev_sell < -0.06 e ma50< e diff macd < -1.25 - r 16047 A1 Y2 XX - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 22 dic 2023 aggiunta and ma10_last > ma10_2_min_ago (precedentemente ha venduto mentre saliva)
                #  8 gen 2024 deviation_sell a -0.04 da 0.02
                # 31 gen 2025 sopra il limite inferiore del corridoio 300-450 aumenta la tolleranza !
                # 31 gen 2025 and deviation_sell < -0.05 da -0.04
                # 31 gen 2025 and deviation_sell < -0.06 da -0.05
                # 31 gen 2025 in futuro potrai mettere se ma100>ma300 vende quando ma100 comincia a curvare verso il basso 
                # 24 ott 2025 aggiunte pg



            elif (
                ma78_last > ma78_120_min_ago
                and deviation_ma300_sopra_ma450 < -0.085

                and ma10_last > ma10_2_min_ago
                and ma2_last < ma8_last
                
                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.09
                and deviation_sell < -0.04
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and ma2_differenza_2_min_ago < -8
                
                and macd_differenza_3_min_ago < -1.25
            ):
                sell = f"SELL CS con ma10>ma10 2 min ago CON 50<59 e dev 3-39 < 0.09 e dev_sell < -0.04 e ma50< e diff macd < -1.25 - r 16047 A1 Y2 XY - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 22 dic 2023 aggiunta and ma10_last > ma10_2_min_ago (precedentemente ha venduto mentre saliva)
                #  8 gen 2024 deviation_sell a -0.04 da 0.02
                # 31 gen 2025 sotto il limite inferiore del corridoio 300-450 la tolleranza per adesso resta uguale
                # 24 ott 2025 aggiunte pg

            

            elif (
                ma78_last > ma78_120_min_ago
                and ma10_last <= ma10_2_min_ago
                and ma20_last >= ma20_2_min_ago

                and ma39_last > ma69_last

                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and ma2_differenza_2_min_ago < -8
                and macd_differenza_3_min_ago < 0.10
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.03
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
            ):
                sell = f"SELL CS con ma10<ma10 2 min ago e 50<59 e dev 3-39 < 0.08 e dev_sell < -0.03 e ma50< MA 39>69 ! - r 16047 A1 Y2 YA1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 30 gen 2024 se ma20> aumento sell a -0.02 da -0.01
                # 30 gen 2024 se ma20> and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02 da -0.018
                #  2 ott 2024 se 39>69 deviation_ma39 < 0.08 da < 0.09 and deviation_sell < -0.03 da -0.02
                # 24 ott 2025 aggiunte pg




            elif (
                ma78_last > ma78_120_min_ago
                and ma100_last > ma200_last
                and ma200_last > ma300_last

                and ma10_last <= ma10_2_min_ago
                and ma20_last >= ma20_2_min_ago

                and ma39_last < ma69_last

                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.09
                and deviation_sell < -0.035
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80

                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_3_min_ago < -6.00
            ):
                sell = f"SELL CS con ma10<ma10 2 min e dev 3-39 < 0.09 e dev_sell < -0.04 e diff macd 3 min a -6.00 da 0.10 ! - r 16047 A1 Y2 YA2 Xx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 15 ott 2024 dev_sell < -0.03 da < -0.02
                # 19 feb 2025 macd_differenza_3_min_ago (dico 3 min) a -6.00 da 0.10 se ma100_last > ma200_last
                # 19 feb 2025 dev_sell < -0.04 da < -0.03
                # 24 ott 2025 aggiunte pg




            elif (
                ma78_last > ma78_120_min_ago
                and ma100_last < ma200_last
                and ma200_last > ma300_last

                and ma10_last <= ma10_2_min_ago
                and ma20_last >= ma20_2_min_ago

                and ma39_last < ma69_last

                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and deviation_ma39 < 0.09
                and deviation_sell < -0.035
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80

                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -2.60
            ):
                sell = f"SELL CS con ma10<ma10 2 min e dev 3-39 < 0.09 e dev_sell < -0.035 e diff macd 2 min a -2.60 da 0.10 ! - r 16047 A1 Y2 YA2 Xy - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 15 ott 2024 dev_sell < -0.03 da < -0.02
                # 19 feb 2025 macd_differenza_2_min_ago (dico 2 min) a -2.60 da 0.10 se ma100_last < ma200_last
                # 19 feb 2025 dev_sell < -0.035 da < -0.03
                # 24 ott 2025 aggiunte pg





            elif (
                ma78_last > ma78_120_min_ago
                and ma200_last < ma300_last

                and ma10_last <= ma10_2_min_ago
                and ma20_last >= ma20_2_min_ago

                and ma39_last < ma69_last

                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and ma2_differenza_2_min_ago < -8
                and macd_differenza_3_min_ago < 0.10
                
                and deviation_ma39 < 0.09
                and deviation_sell < -0.03
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
            ):
                sell = f"SELL CS con ma10<ma10 2 min ago e 50<59 e dev 3-39 < 0.09 e dev_sell < -0.03 e ma50< E 39<69 ! - r 16047 A1 Y2 YA2 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 30 gen 2024 se ma20> aumento sell a -0.02 da -0.01
                # 30 gen 2024 se ma20> and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02 da -0.018
                # 30 dic 2024 se ma20> aumento sell a -0.03 da -0.02
                # 24 ott 2025 aggiunte pg




            elif (
                ma78_last > ma78_120_min_ago
                and delta_100_200_last < delta_100_200_120_min_ago
                
                and ma10_last <= ma10_2_min_ago
                and ma20_last < ma20_2_min_ago
                
                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and ma2_differenza_2_min_ago < -8
                and macd_differenza_3_min_ago < 0.10
                
                and deviation_ma39 < 0.09
                and deviation_sell < -0.02
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
            ):
                sell = f"SELL CS con ma10<ma10 2 min ago e 50<59 e dev 3-39 < 0.09 e dev_sell < -0.02 e ma50< e macd_diff_3_min_ago < -0.20 e diff macd <-0.30 - r 16047 A1 Y2 YB1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 25 feb 2024 giorno !
                # 24 ott 2025 aggiunte pg




            elif (
                ma78_last > ma78_120_min_ago
                and delta_100_200_last > delta_100_200_120_min_ago
                
                and ma10_last <= ma10_2_min_ago
                and ma20_last < ma20_2_min_ago
                
                and ma50_last < ma59_last
                and ma50_last < ma50_2_min_ago
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and ma2_differenza_2_min_ago < -8
                and macd_differenza_3_min_ago < 0.10
                
                and deviation_ma39 < 0.09
                and deviation_sell < -0.01
                
                and deviation_ma100_sopra_ma300 < 0.40
                and deviation_ma5_sotto_ma200 > -0.80
                
            ):
                sell = f"SELL CS con ma10<ma10 2 min ago e 50<59 e dev 3-39 < 0.09 e dev_sell < 0.005 e ma50< e macd_diff_3_min_ago < -0.20 e diff macd <-0.30 - r 16047 A1 Y2 YB2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #   9 GIU 2023 dev 3-39 a -0.17 da -0.25
                #   9 GIU 2023 dev sell a -0.35 da -0.36
                #  15 GIU 2023 dev_39 a -0.15 da -0.17 dopo che ha fatto -1.15% il 14 giu 2023 ore 22:06
                #  15 GIU 2023 dev sell a -0.349 da -0.35
                #   7 lug 2023 dev sell a -0.348 da -0.349
                #   7 lug 2023 deviation 3-39 < -0.10 da < -0.15
                #  1 set 2023 and deviation_ma5_sotto_ma200 > -0.80 da -0.90
                #  1 set 2023 and deviation_ma39 < -0.01 da -0.10 aveva fatto -0.66
                #  1 set 2023 dev sell a -0.24 da -0.348
                # 29 ott 2023 dev sell a -0.12 da -0.24
                # 30 ott 2023 dev sell a -0.11 da -0.12
                # 30 ott 2023 a 0.01 da -0.01
                # 30 ott 2023 dev 39 a 0.02 da 0.01
                # 30 ott 2023 dev sell a -0.10 da -0.11
                
                # 14 nov 2023 se ma50_last < ma59_last
                # 14 nov 2023 dev sell a 0.05 da -0.10
                # 14 nov 2023 dev 39 a 0.05 da 0.02
                # 14 nov 2023 dev sell a 0.02 da 0.05
                # 20 nov 2023 non ha preso and macd_differenza_2_min_ago < -0.20 allora l' ho messa in alto e portata a -0.30
                # 20 nov 2023 dev sell a 0.01 da 0.02
                # 27 nov 2023 aggiunta and ma2_differenza_2_min_ago < -3
                # 10 dic 2023 and macd_differenza_3_min_ago < 0.30 significa che se macd non cresce abbastanza vuol dire che non ha forza quindi puoi vendere
                # 22 dic 2023 aggiunta and ma10_last <= ma10_2_min_ago
                #  8 gen 2024 and deviation_sell < 0.005 da 0.02
                
                # 14 gen 2024 and deviation_sell < 0.01 da 0.005
                # 14 gen 2024 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                # 25 feb 2024 notte
                # 24 ott 2025 aggiunte pg




            elif (
                
                ma50_last > ma50_2_min_ago
                and ma39_last > ma100_last
                and ma20_last > ma20_2_min_ago
                and ma100_last > ma100_60_min_ago
                and ma3_last < ma28_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.025
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma5_last
                and ma2_differenza_2_min_ago < -3
            ):
                sell = f"SELL CS - se 100> vende con 3-28 dev 3-39 < 0.13 e dev_sell < -0.025 e ma50 > con ma5 sotto ma200 > -0.60 - r 16047 A2 X1 xx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 18 gen 2024 se ma20 > ma20 2 min ago dev sell a -0.01 da 0.02
                # 15 ott 2024 se 39>100 dev_sell < -0.025 da < -0.01
                # 24 ott 2025 aggiunte pg




            elif (
                
                ma50_last > ma50_2_min_ago
                and ma39_last > ma100_last
                and ma20_last > ma20_2_min_ago
                and ma100_last > ma100_60_min_ago
                and ma3_last < ma28_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.02
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma5_last
                and ma2_differenza_2_min_ago < -3
            ):
                sell = f"SELL CS - se 100> vende con 3-28 dev 3-39 < 0.13 e dev_sell < 0.02 e ma50 > con ma5 sotto ma200 > -0.60 - r 16047 A2 X1 xy - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 18 gen 2024 se ma20 > ma20 2 min ago dev sell a -0.01 da 0.02
                # 15 ott 2024 dev_sell < -0.02 da < -0.01
                # 24 ott 2025 aggiunte pg


                
            
            elif (    
                ma50_last > ma50_2_min_ago
                and ma450_last > ma450_180_min_ago

                and ma20_last < ma20_2_min_ago
                and ma100_last > ma100_60_min_ago
                and ma3_last < ma28_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.03
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                
                and macd < 20
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma5_last
                
            ):
                sell = f"SELL N C S - con 450 > 3 ore e dev 3-39 < 0.13 e dev_sell < -0.03 e ma50 > e ma5 sotto ma200 > -0.60 - r 16047 A2 X1 Y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  7 feb 2024 and deviation_sell < -0.01 da 0.02
                #  6 mar 2024 aggiunto and ma450_last > ma450_180_min_ago
                #  6 mar 2024 and deviation_sell < -0.02 da -0.01
                # 28 gen 2025 and deviation_sell < -0.03 da < -0.02
                # 24 ott 2025 aggiunte pg




            elif (    
                ma50_last > ma50_2_min_ago
                and ma450_last < ma450_180_min_ago
                and ma100_last > ma200_last

                and ma100_last > ma100_60_min_ago

                and ma20_last < ma20_2_min_ago
                and ma3_last < ma28_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.02
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma5_last
                and ma2_differenza_2_min_ago < -3
            ):
                sell = f"SELL N C S - con 450 > 3 ore e dev 3-39 < 0.13 e dev_sell < -0.02 e ma50 > E con 100>200 - r 16047 A2 X1 Y2 X - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  7 feb 2024 and deviation_sell < -0.01 da 0.02
                #  6 mar 2024 aggiunto and ma450_last < ma450_180_min_ago
                #  7 mar 2025 con 100 che e' andata sopra 200 aumento tolleranza
                #  7 mar 2025 and deviation_sell < -0.02 da -0.01
                # 24 ott 2025 aggiunte pg




            elif (    
                ma50_last > ma50_2_min_ago
                and ma450_last < ma450_180_min_ago
                and ma100_last < ma200_last

                and ma100_last > ma100_60_min_ago

                and ma20_last < ma20_2_min_ago
                and ma3_last < ma28_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.015
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
                and ma2_last < ma5_last
                and ma2_differenza_2_min_ago < -3
            ):
                sell = f"SELL N C S - con 450 > 3 ore e dev 3-39 < 0.13 e dev_sell < -0.015 e ma50 > MA con 100>200 - r 16047 A2 X1 Y2 Y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  7 feb 2024 and deviation_sell < -0.01 da 0.02
                #  6 mar 2024 aggiunto and ma450_last < ma450_180_min_ago
                #  7 mar 2025 and deviation_sell < -0.015 da -0.01
                # 24 ott 2025 aggiunte pg


          
            elif (    
                ma50_last > ma50_2_min_ago
                and ma100_last > ma100_60_min_ago
                
                and ma3_last < ma28_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.027
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma5_last
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < 15
                and macd > 0
                and macd_differenza_2_min_ago < 1.00
            ):
                sell = f"SELL NCS se 100> vende con 3-28 E dev_sell < -0.027 e CON MACD IN TERRITORIO POSITIVO - r 16047 A2 X2 X - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 30 dic 2023 situazione MACD in territorio positivo
                #  2 feb 2024 and deviation_sell < -0.02 da 0.02
                # 30 apr 2025 and deviation_sell < -0.027 da < -0.02
                # 24 ott 2025 aggiunte pg

          

            elif (    
                ma50_last > ma50_2_min_ago
                and deviation_ma50_sopra_o_sotto_ma300 > 0.10

                and ma100_last > ma100_60_min_ago
                and ma3_last < ma39_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.026
                
                and deviation_ma5_sotto_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma5_last
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                
                and macd < 1
                and macd_differenza_2_min_ago < -1.00
            ):
                sell = f"SELL CS se 100> vende con 3-39 e dev 3-39 < 0.13 and dev_sell < -0.026 e ma50 > con DIFF MACD < -1 - r 16047 A2 X2 Y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                #  9 nov 2024 se deviation_ma50_sopra_o_sotto_ma300 > 0.10 allora and deviation_sell < -0.02 da < 0.01
                #  9 mag 2025 deviation_sell a -0.026 da < 0.02
                #  7 ago 2025 deviation_sell a 3-39 da 3-28
                # 24 ott 2025 aggiunte pg




            elif (    
                ma50_last > ma50_2_min_ago
                and ma39_last > ma100_last

                and deviation_ma50_sopra_o_sotto_ma300 < 0.10
                and ma100_last > ma100_60_min_ago
                and ma3_last < ma39_last
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.02
                
                and deviation_ma5_sotto_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma5_last
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                
                and macd < 1
                and macd_differenza_2_min_ago < -1.00
            ):
                sell = f"SELL CS se 39>100 vende con 3-39 e dev 3-39 < 0.10 and dev_sell < -0.02 e ma50 > con DIFF MACD < -1 - r 16047 A2 X2 Y2 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 29 nov 2023 vende con 3-28 se ma 100 > 100 60 min
                #  5 dic 2023 aggiunto and ma2_last < ma5_last
                #  5 dic 2023 aggiunto and ma2_differenza_2_min_ago < -3
                
                # 29 dic 2023 tolto macd < macd 2 min ago che faceva arrivare in ritardo la vendita
                # 29 dic 2023 ATTENZIONE ! macd diff < -1 significa CHE HA PIU' FORZA mentre scende ! scende piu' con vigore !
                # 30 dic 2023 situazione MACD in territorio negativo
                # 16 set 2024 and dev_sell < 0.01 da < 0.02
                #  9 nov 2024 dev sell a -0.01 da 0.01
                #  4 feb 2025 se ma39_last > ma100_last sell con ma3_last < ma39_last
                #  4 feb 2025 dev_sell < -0.02 da < -0.01
                # 24 ott 2025 aggiunte pg




            elif (    
                ma50_last > ma50_2_min_ago
                and ma39_last < ma100_last

                and deviation_ma50_sopra_o_sotto_ma300 < 0.10
                and ma100_last > ma100_60_min_ago
                and ma3_last < ma28_last
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
                
                and deviation_ma5_sotto_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma5_last
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                
                and macd < 1
                and macd_differenza_2_min_ago < -1.00
            ):
                sell = f"SELL CS se 100> vende con 3-28 e dev 3-39 < 0.13 and dev_sell < -0.01 e ma50 > con DIFF MACD < -1 - r 16047 A2 X2 Y2 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 29 nov 2023 vende con 3-28 se ma 100 > 100 60 min
                #  5 dic 2023 aggiunto and ma2_last < ma5_last
                #  5 dic 2023 aggiunto and ma2_differenza_2_min_ago < -3
                
                # 29 dic 2023 tolto macd < macd 2 min ago che faceva arrivare in ritardo la vendita
                # 29 dic 2023 ATTENZIONE ! macd diff < -1 significa CHE HA PIU' FORZA mentre scende ! scende piu' con vigore !
                # 30 dic 2023 situazione MACD in territorio negativo
                # 16 set 2024 and dev_sell < 0.01 da < 0.02
                #  9 nov 2024 dev sell a -0.01 da 0.01
                # 24 ott 2025 aggiunte pg



            
            elif (    
                ma50_last > ma50_2_min_ago
                and ma10_last > ma30_last
                and ma20_last > ma20_2_min_ago
                and ma20_last > ma40_last
                
                and ma13_last > ma50_last
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.10
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -3
                
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
                and ma2_differenza_ma5 < -8
                
            ):
                sell = f"SELL NCS - dev 3-39 < 0.13 E dev_sell < -0.10 con ma50 > e con ma5 sotto ma200 > -0.60 and MACD < - r 16047 A2 Y1 X1a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 21 feb 2024 se ANCHE 10>30 dev sell a -0.07 da -0.05
                # 21 feb 2024 se ANCHE 10>30 dev sell a -0.08 da -0.07
                # 21 feb 2024 se ANCHE 10>30 dev sell a -0.09 da -0.08
                # 22 mag 2024 se ANCHE 10>30 dev sell a -0.10 da -0.09
                # 24 ott 2025 aggiunte pg



                
            
            elif (    
                ma50_last > ma50_2_min_ago
                and ma10_last < ma30_last
                and ma20_last > ma20_2_min_ago
                and ma20_last > ma40_last
                
                and ma13_last > ma50_last
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.05
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -3
                
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
                and ma2_differenza_ma5 < -8
                
            ):
                sell = f"SELL nuova condizione speciale - dev 3-39 < 0.13 and dev_sell < -0.05 con ma50 > e con ma5 sotto ma200 > -0.60 and MACD < and macd < 15 - r 16047 A2 Y1 X1b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 24 ott 2025 aggiunte pg



            
            elif (
                
                ma50_last > ma50_2_min_ago
                and ma20_last > ma20_2_min_ago
                and ma20_last < ma40_last
                
                and ma13_last > ma50_last
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.03
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -3
                
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
                and ma2_differenza_ma5 < -7
                
            ):
                sell = f"SELL nuova condizione speciale - dev 3-39 < 0.13 and dev_sell < -0.03 con ma50 > e con ma5 sotto ma200 > -0.60 and MACD < and macd < 15 - r 16047 A2 Y1 X2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.02 da -0.01
                # oggi 18 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago aggiunta and ma2_differenza_ma5 < -7
                # oggi 18 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago aggiunta and ma2_differenza_2_min_ago < -2
                # oggi 30 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.03 da -0.02
                # 24 ott 2025 aggiunte pg



            
            elif (
                
                ma50_last > ma50_2_min_ago
                and ma13_last > ma50_last
                and ma5_last > ma10_last
                and ma20_last <= ma20_2_min_ago
                and ma2_differenza_2_min_ago < -3
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.02
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = f"SELL nuova cond spec CON 5 > 10 e dev 3-39 < 0.13 and dev_sell < -0.02 con ma50 > e con ma5 sotto ma200 > -0.60 and MACD < and macd < 15 - r 16047 A2 Y1 Y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  8 gen 2024 dev sell a -0.02 da 0.01 ! con 5>10
                # 24 ott 2025 aggiunte pg


          
            
            elif (    
                ma50_last > ma50_2_min_ago
                and ma13_last > ma50_last
                and ma100_last > ma100_10_min_ago
                
                and deviation_ma250_sopra_ma300 > 0.12
                
                
                and ma5_last < ma10_last
                and ma20_last <= ma20_2_min_ago
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.03
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                and ma2_differenza_2_min_ago < -5
                
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = f"SELL NCS con 5 < 10 e dev 3-39 < 0.13 e dev_sell < -0.03 con ma50 > con ma5 sotto ma200 > -0.60 and MACD < e macd < 15 - r 16047 A2 Y1 Y2 X1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 12 feb 2023 and dev_sell a -0.03 da -0.02
                # 24 ott 2025 aggiunte pg





            elif (    
                ma50_last > ma50_2_min_ago
                and ma450_last > ma450_180_min_ago

                and ma13_last > ma50_last
                and ma100_last > ma100_10_min_ago
                
                and deviation_ma250_sopra_ma300 < 0.12
                and deviation_ma250_sopra_ma300 > -0.12
                
                and ma5_last < ma10_last
                and ma20_last <= ma20_2_min_ago
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.04
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                and ma2_differenza_2_min_ago < -5
                
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = f"SELL NCS con 5 < 10 e dev 3-39 < 0.13 e dev_sell < -0.03 e ma50 > e MACD < e macd < 15 - r 16047 A2 Y1 Y2 X2 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 12 feb 2023 and dev_sell a -0.03 da -0.02
                #  6 mar 2024 se ma450_last > ma450_180_min_ago and deviation_sell < -0.04 da -0.03
                # 24 ott 2025 aggiunte pg




            elif (    
                ma50_last > ma50_2_min_ago
                and ma450_last < ma450_180_min_ago

                and ma13_last > ma50_last
                and ma100_last > ma100_10_min_ago
                
                and deviation_ma250_sopra_ma300 < 0.12
                and deviation_ma250_sopra_ma300 > -0.12
                
                and ma5_last < ma10_last
                and ma20_last <= ma20_2_min_ago
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.03
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                and ma2_differenza_2_min_ago < -5
                
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = f"SELL NCS con 5 < 10 e dev 3-39 < 0.13 e dev_sell < -0.03 e ma50 > e MACD < e macd < 15 - r 16047 A2 Y1 Y2 X2 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 12 feb 2023 and dev_sell a -0.03 da -0.02
                #  6 mar 2024 se ma450_last < ma450_180_min_ago and deviation_sell < -0.03
                # 24 ott 2025 aggiunte pg


            
            elif (    
                ma50_last > ma50_2_min_ago
                and ma13_last > ma50_last
                and ma100_last > ma100_10_min_ago
                
                and deviation_ma250_sopra_ma300 < -0.12
                
                
                and ma5_last < ma10_last
                and ma20_last <= ma20_2_min_ago
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.03
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.017
                and ma2_differenza_2_min_ago < -5
                
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = f"SELL NCS con 5 < 10 e dev 3-39 < 0.13 e dev_sell < -0.03 con ma50 > con ma5 sotto ma200 > -0.60 and MACD < e macd < 15 - r 16047 A2 Y1 Y2 X3 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 12 feb 2023 and dev_sell a -0.03 da -0.02
                # 24 ott 2025 aggiunte pg





          
            elif (    
                ma50_last > ma50_2_min_ago
                and deviation_ma300_sopra_ma450 > 0.50

                and ma100_last < ma100_10_min_ago
                and ma13_last > ma50_last
                
                and ma5_last < ma10_last
                and ma20_last <= ma20_2_min_ago
                
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.02
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -3
                and macd < macd_2_min_ago
                and macd < macd_3_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = "SELL nuova C S con 5 < 10 e dev 3-39 < 0.13 and dev_sell < -0.02 e ma50 > e ma5 sotto ma200 > -0.60 - r 16047 A2 Y1 Y2 Y1"
                action = "sell"

                #  6 mar 2024 se deviation_ma300_sopra_ma450 > 0.50 ( sta salendo parecchio !) and deviation_sell < -0.02 da 0.02


            elif (    
                ma50_last > ma50_2_min_ago
                and ma13_last > ma50_last
                and ma39_last > ma100_last

                and deviation_ma300_sopra_ma450 < 0.50

                and ma100_last < ma100_10_min_ago
                
                
                and ma5_last < ma10_last
                and ma20_last <= ma20_2_min_ago
                
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.04
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -3
                and macd < macd_2_min_ago
                and macd < macd_3_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = "SELL NCS con 39>100 e dev 3-39 < 0.13 and dev_sell < -0.03 e ma50 > e ma5 sotto ma200 > -0.60 - r 16047 A2 Y1 Y2 Y2 x"
                action = "sell"

                #  5 nov 2024 con 39>100 statte calmo !
                #  7 apr 2025 dev sell da -0.04 da -0.03



            elif (    
                ma50_last > ma50_2_min_ago
                and ma13_last > ma50_last
                and ma39_last < ma100_last

                and deviation_ma300_sopra_ma450 < 0.50

                and ma100_last < ma100_10_min_ago
                
                
                and ma5_last < ma10_last
                and ma20_last <= ma20_2_min_ago
                
                
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.02
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago
                and ma2_differenza_2_min_ago < -3
                and macd < macd_2_min_ago
                and macd < macd_3_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -1.5
            ):
                sell = "SELL NCS con 39 < 100 e dev 3-39 < 0.13 and dev_sell < -0.02 e ma50 > e ma5 sotto ma200 > -0.60 - r 16047 A2 Y1 Y2 Y2 y"
                action = "sell"
                
                # 25 nov 2023 and deviation_sell < -0.10 da < -0.14
                # 25 nov 2023 and macd < -13 da -16
                
                # 27 nov 2023 and macd a 15 da -13 !
                # 27 nov 2023 and deviation_ma39 < 0.13 !
                # 27 nov 2023 and deviation_sell < 0.02  !
                # 27 nov 2023 nonno mario
                #  1 dic 2023 and deviation_sell < -0.01 da 0.02  !
                #  5 dic 2023 aggiunta and ma2_differenza_2_min_ago < -3
                
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last <= ma20_2_min_ago DEV SELL a -0.01
                # 29 dic 2023 dev sell a 0.01 da -0.01
                # 29 dic 2023 diff macd a -1.5 da -2
                #  8 gen 2024 dev sell a -0.01 da 0.01 ! con 5<10
                #  8 gen 2024 dev sell a -0.02 da -0.01 !
                # 19 feb 2023 aggiunto and macd < macd_3_min_ago

                #  6 mar 2024 se deviation_ma300_sopra_ma450 < 0.50 and deviation_sell < -0.01 da 0.02



            elif (
                
                ma50_last > ma50_2_min_ago
                and ma100_last > ma100_10_min_ago
                and ma13_last < ma50_last
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
            ):
                sell = "SELL nuova condizione speciale - devi 3-39 < 0.13 and dev_sell < -0.01 con ma50 > e con ma5 sotto ma200 > -0.60 and MACD < and macd < 15 - r 16047 A2 Y2 x"
                action = "sell"
                
                # 25 nov 2023 and deviation_sell < -0.10 da < -0.14
                # 25 nov 2023 and macd < -13 da -16
                
                # 27 nov 2023 and macd a 15 da -13 !
                # 27 nov 2023 and deviation_ma39 < 0.13 !
                # 27 nov 2023 and deviation_sell < 0.02  !
                # 27 nov 2023 nonno mario
                #  1 dic 2023 and deviation_sell < -0.01 da 0.02  !



            
            elif (    
                ma50_last > ma50_2_min_ago
                and delta_1 < delta_2
                and ma100_last < ma100_10_min_ago
                
                and ma13_last < ma50_last
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.01
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
            ):
                sell = "SELL NCS GIORNO - 3-39 < 0.10 and dev_sell < -0.01 con ma50 > e con ma5 sotto ma200 > -0.60 - r 16047 A2 Y2 Y1"
                action = "sell"

                #  6 feb 2025 se GIORNO dev_sell a -0.01 da 0.01
                #  6 feb 2025 se GIORNO dev_ma39 a 0.10 da 0.13




            elif (    
                ma50_last > ma50_2_min_ago
                and ma39_last > ma100_last

                and delta_1 > delta_2
                and ma100_last < ma100_10_min_ago
                
                and ma13_last < ma50_last
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
            ):
                sell = "SELL NCS NOTTE - 3-39 < 0.13 and dev_sell < -0.01 con ma50 > e con ma5 sotto ma200 > -0.60 - r 16047 A2 Y2 Y2x"
                action = "sell"
                
                #  8 mag 2025 aggiunto and ma39_last > ma100_last
                #  8 mag 2025 and deviation_sell a -0.01 da 0.01


            elif (
                ma50_last > ma50_2_min_ago
                and ma39_last < ma100_last

                and delta_1 > delta_2
                and ma100_last < ma100_10_min_ago
                
                and ma13_last < ma50_last
                and ma100_last < ma100_60_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < 0.01
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < 15
                and macd_differenza_2_min_ago < -2
            ):
                sell = "SELL NCS NOTTE - 3-39 < 0.13 and dev_sell < 0.01 con ma50 > e con ma5 sotto ma200 > -0.60 - r 16047 A2 Y2 Y2y"
                action = "sell"
                
                # 25 nov 2023 and deviation_sell < -0.10 da < -0.14
                # 25 nov 2023 and macd < -13 da -16
                
                # 27 nov 2023 and macd a 15 da -13 !
                # 27 nov 2023 and deviation_ma39 < 0.13 !
                # 27 nov 2023 and deviation_sell < 0.02  !
                # 27 nov 2023 nonno mario
                #  1 dic 2023 and deviation_sell < -0.01 da 0.02  !
                # 14 gen 2024 con 100 < 100 10 min ago dev_sell a 0.01 da -0.01 
                #  8 mag 2025 dev_sell a 0.01
          

            # nuova condizione AUDI RUBATA

            elif (    
                ma50_last < ma50_2_min_ago
                and ma20_last > ma20_2_min_ago
                and ma5_last >= ma5_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.01
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < -16
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL nuova condizione speciale CON ma20 > ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.01 - con ma50 > e ma5 sotto ma200 > -0.60 and MACD < - r 16047 A3x1"
                action = "sell"
                
                # 22 gen 2024 se ma5 > ma5 2 min ago dev sell a -0.01 da 0.01
            
            
            elif (    
                ma50_last < ma50_2_min_ago
                and ma39_last > ma100_last
                and ma20_last > ma20_2_min_ago
                and ma5_last < ma5_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.02
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < -16
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL NCS CON ma20>ma20 2 min ago e ma39 > ma100 e dev_sell < -0.02 E ma50 > e ma5 sotto ma200 > -0.60 - r 16047 A3x2A"
                action = "sell"
                
                # 30 nov 2023 dev 39 a 0.10 da 0.03
                # 30 nov 2023 dev sell a -0.05 da -0.14
                #  5 dic 2023 dev sell a 0.05 da -0.05
                # 14 ott 2024 se 39>100 statte un po' piu' tranquillo ! cazzo.
                # 14 ott 2024 se 39>100 dev_sell < -0.02 da < 0.01


            elif (    
                ma50_last < ma50_2_min_ago
                and ma5_last > ma5_22_min_ago 

                and ma39_last < ma50_last
                and ma20_last > ma20_2_min_ago
                and ma5_last < ma5_2_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.03
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < -16
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL NCS CON ma20 > ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < 0.01 E ma50 > e ma5 sotto ma200 > -0.60 - r 16047 A3 x2 B1"
                action = "sell"
                
                # 30 nov 2023 dev 39 a 0.10 da 0.03
                # 30 nov 2023 dev sell a -0.05 da -0.14
                #  5 dic 2023 dev sell a 0.05 da -0.05
                # 19 gen 2025 dev sell a -0.01 da 0.01
                # 31 gen 2025 se ma5 > ma5 di 22 min ago allora aumento la tolleranza
                # 31 gen 2025 dev sell a -0.03 da -0.01


            elif (    
                ma50_last < ma50_2_min_ago
                and ma5_last < ma5_22_min_ago 

                and ma39_last < ma50_last
                and ma20_last > ma20_2_min_ago
                and ma5_last < ma5_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.01
                
                
                and deviation_ma5_sotto_ma200 > -0.60
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd < -16
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL NCS CON ma20 > ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < 0.01 E ma50 > e ma5 sotto ma200 > -0.60 - r 16047 A3 x2 B2"
                action = "sell"
                
                # 30 nov 2023 dev 39 a 0.10 da 0.03
                # 30 nov 2023 dev sell a -0.05 da -0.14
                #  5 dic 2023 dev sell a 0.05 da -0.05
                # 19 gen 2025 dev sell a -0.01 da 0.01



            elif (    
                ma50_last < ma50_2_min_ago

                and deviation_ma300_sopra_ma450 > -0.085

                and deviation_ma5_sopra_o_sotto_ma100 > -0.25
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.01
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < 13
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.08 e dev_sell < -0.02 e ma50 < e diff macd - r 16047 A3 Y1 A"
                action = "sell"

                # 31 gen 2025 sopra il limite inferiore del corridoio 300-450 aumenta la tolleranza !
                # 31 gen 2025 and deviation_sell < -0.02 da -0.01



            elif (    
                ma50_last < ma50_2_min_ago

                and deviation_ma300_sopra_ma450 < -0.085

                and deviation_ma5_sopra_o_sotto_ma100 > -0.25
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.01
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < 13
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.01 e ma50 < e diff macd - r 16047 A3 Y1 B"
                action = "sell"
                
                # 30 nov 2023 dev 39 a 0.10 da 0.03
                # 30 nov 2023 dev sell a -0.05 da -0.14
                #  5 dic 2023 dev sell a 0.05 da -0.05
                # MINGHIA il 26 dic ha fatto -0.73 ! e ho fatto delle modifiche meravigliose
                # 29 dic 2023 and macd a 13 da 7
                # 19 gen 2025 dev sell a -0.01 da 0.05
                # 31 gen 2025 stiamo sotto al limite inferiore del corridoio 300-450 per adesso il dev sell va bene cosi'.


            
            elif (    
                ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.12
                and deviation_ma5_sopra_o_sotto_ma100 < -0.21
                and ma20_last > ma20_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.03
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < 13
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL NCS con ma20 > ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.03 e ma50 < e diff macd - r 16047 A3 Y2 AX"
                action = "sell"

                #  2 mar 2025 se ma100 comincia a scendere di meno allora and deviation_sell < -0.02 da -0.01
                # 25 mar 2025 deviation_sell < -0.03 da -0.02

            
            elif (    
                ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.12
                and deviation_ma5_sopra_o_sotto_ma100 < -0.21
                and ma20_last > ma20_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.01
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < 13
                and macd_differenza_2_min_ago < -3
            ):
                sell = "SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.01 e ma50 < e diff ma2 e diff macd - r 16047 A3 Y2aY"
                action = "sell"
                
                # 30 nov 2023 dev 39 a 0.10 da 0.03
                # 30 nov 2023 dev sell a -0.05 da -0.14
                #  5 dic 2023 dev sell a 0.05 da -0.05
                # MINGHIA il 26 dic ha fatto -0.73 ! e ho fatto delle modifiche meravigliose
                # 29 dic 2023 and macd a 13 da 7
                # 19 gen 2024 ha fatto -0.60 HO NOTATO CHE ma20 era in crescita ! e ho aggiunto questa
                #  2 mar 2025 se ma100 continua a scendere pesantemente allora ok cosi'



            




            elif (    
                ma50_last < ma50_2_min_ago
                and ma450_last > ma450_360_min_ago

                and deviation_ma50_sopra_o_sotto_ma300 > -0.70
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.12
                and deviation_sell < -0.016
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                
                and macd < 20
                and macd_differenza_2_min_ago < -1.30
            ):
                sell = f"SELL NCS {deviation_ma39} {deviation_ma3_sotto_ma50} {deviation_ma5_sopra_o_sotto_ma100} {deviation_ma25_sotto_ma300} {deviation_ma100_sopra_o_sotto_ma100_10_min_ago} con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.016 and diff ma2 e diff macd - r 16047 A3 Y2 b1 x"
                action = "sell"

                # 10 apr 2025 modificata
                






            elif (    
                ma50_last < ma50_2_min_ago
                and ma450_last < ma450_360_min_ago
                and ma100_last > ma100_60_min_ago

                and deviation_ma50_sopra_o_sotto_ma300 > -0.70
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.12
                and deviation_sell < -0.016
                
                and deviation_ma5_sopra_ma200 < -0.20
                and deviation_ma5_sotto_ma300 < -0.20
                and deviation_ma5_sotto_ma450 < -0.10
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                
                and macd < 20
                and macd_differenza_2_min_ago < -1.30
            ):
                sell = "SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.016 and diff ma2 e diff macd - r 16047 A3 Y2 b1 y1"
                action = "sell"

                # 10 apr 2025 modificata



            elif (    
                ma50_last < ma50_2_min_ago
                and ma450_last < ma450_360_min_ago
                and ma100_last < ma100_60_min_ago

                and deviation_ma50_sopra_o_sotto_ma300 > -0.70
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.12
                and deviation_sell < -0.016
                
                and deviation_ma5_sotto_ma450 < -0.10
                
                and ma20_last < ma50_last
                
                and ma2_last < ma2_2_min_ago 
                
                and macd < 40
                and macd_differenza_2_min_ago < -0.30
            ):
                sell = f"SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.016 and diff ma2 e diff macd - r 16047 A3 Y2 b1 y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 30 nov 2023 dev 39 a 0.10 da 0.03
                # 30 nov 2023 dev sell a -0.05 da -0.14
                #  5 dic 2023 dev sell a 0.05 da -0.05
                # MINGHIA il 26 dic ha fatto -0.73 ! e ho fatto delle modifiche meravigliose
                # 29 dic 2023 macd a 13 da 7
                #  7 mar 2024 dev sell a -0.017 da -0.01
                #  3 ott 2024 and deviation_ma39 < 0.12 da 0.10
                #  3 ott 2024 and deviation_sell < -0.015 da -0.017
                #  3 ott 2024 anticipata vendita (ha fatto -0.62)
                #  5 nov 2024 se deviation_ma50_sopra_o_sotto_ma300 > -0.70
                # 10 apr 2025 modificata
                # 21 ott 2025 aggiunte pg


            elif (    
                ma3_last < ma9_last
                and ma8_last > ma8_2_min_ago

                and (ma10_last < ma20_last or ma3_last < ma100_last)
                and deviation_ma300_sopra_ma450 > -0.22

                and deviation_ma50_sopra_o_sotto_ma300 < -0.50
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                
                and deviation_ma39 < 0.12
                and deviation_sell < 0.019
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and macd < 100
                
            ):
                sell = f"SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.019 and diff ma2 e diff macd - r 16047 A3 Y2 b2 x1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 16 ott 2025 anticipato ndecchiecella (ha fatto -0.50%)
                # 23 ott 2025 se ma8_last > ma8_2_min_ago vende con 3-9 ha venduto mentre saliva
                # 23 ott 2025 aggiunte pg


            elif (    
                ma3_last < ma9_last
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04

                and ma8_last <= ma8_2_min_ago


                and (ma10_last < ma20_last or ma3_last < ma100_last)
                and deviation_ma300_sopra_ma450 > -0.22

                and deviation_ma50_sopra_o_sotto_ma300 < -0.50
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                
                and deviation_ma39 < 0.12
                and deviation_sell < 0.018
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
            ):
                sell = f"SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.019 and diff ma2 e diff macd - r 16047 A3 Y2 b2 x2 x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 16 ott 2025 anticipato ndecchiecella (ha fatto -0.50%)
                # 23 ott 2025 se ma8_last <= ma8_2_min_ago ok cosi'
                # 23 ott 2025 aggiunte pg
                # 23 ott 2025 sell con 3-9 da 3-8 se deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04 (cioe' comincia a risalire)



            elif (    
                ma3_last < ma8_last
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.04

                and ma8_last <= ma8_2_min_ago


                and (ma10_last < ma20_last or ma3_last < ma100_last)
                and deviation_ma300_sopra_ma450 > -0.22

                and deviation_ma50_sopra_o_sotto_ma300 < -0.50
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                
                and deviation_ma39 < 0.12
                and deviation_sell < 0.018
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
            ):
                sell = f"SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.019 and diff ma2 e diff macd - r 16047 A3 Y2 b2 x2 y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 16 ott 2025 anticipato ndecchiecella (ha fatto -0.50%)
                # 23 ott 2025 se ma8_last <= ma8_2_min_ago ok cosi'
                # 23 ott 2025 aggiunte pg
                # 23 ott 2025 sell con 3-9 da 3-8 se deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.04




            elif (    
                ma50_last < ma50_2_min_ago
                and deviation_ma300_sopra_ma450 < -0.22
                and ma28_last > ma100_last

                and deviation_ma50_sopra_o_sotto_ma300 < -0.70
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.12
                and deviation_sell < -0.021
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                
                and macd < 20
                and macd_differenza_2_min_ago < -1.30
            ):
                sell = "SELL NCS con ma20 <= ma20 2 min ago MA 28 >100 e dev 3-39 < 0.10 e dev_sell < -0.021 - r 16047 A3 Y2 b2 Y1"
                action = "sell"

                # 17 feb 2025 se deviation_ma300_sopra_ma450 < -0.22 MA ma28_last > ma100_last ALLORA dev sell a -0.021 da -0.019
                # 17 feb 2025 deviation_ma300_sopra_ma450 < -0.22 significa che siamo in presenza di un forte ribasso



            elif (    
                ma50_last < ma50_2_min_ago
                and deviation_ma300_sopra_ma450 < -0.22
                and ma28_last < ma100_last

                and deviation_ma50_sopra_o_sotto_ma300 < -0.70
                and deviation_ma5_sopra_o_sotto_ma100 < -0.10
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma39 < 0.12
                and deviation_sell < -0.019
                
                and deviation_ma5_sopra_ma200 < -0.30
                and deviation_ma5_sotto_ma300 < -0.30
                and deviation_ma5_sotto_ma450 < -0.30
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and ma2_last < ma2_2_min_ago 
                
                and macd < 20
                and macd_differenza_2_min_ago < -1.30
            ):
                sell = f"SELL NCS con ma20 <= ma20 2 min ago e dev 3-39 < 0.10 e dev_sell < -0.019 and diff ma2 e diff macd - r 16047 A3 Y2 b2 Y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 30 nov 2023 dev 39 a 0.10 da 0.03
                # 30 nov 2023 dev sell a -0.05 da -0.14
                #  5 dic 2023 dev sell a 0.05 da -0.05
                # MINGHIA il 26 dic ha fatto -0.73 ! e ho fatto delle modifiche meravigliose
                # 29 dic 2023 macd a 13 da 7
                #  7 mar 2024 dev sell a -0.017 da -0.01
                #  3 ott 2024 and deviation_ma39 < 0.12 da 0.10
                #  3 ott 2024 and deviation_sell < -0.015 da -0.017
                #  3 ott 2024 anticipata vendita (ha fatto -0.62)
                #  5 nov 2024 se deviation_ma50_sopra_o_sotto_ma300 < -0.70 sta crollando e cerca di stare calmo !
                # 21 ott 2025 aggiunte pg



            elif (
                ma78_last < ma78_120_min_ago
                and ma300_last > ma300_301_min_ago
                and ma50_last > ma50_2_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.08
                
                and deviation_ma5_sotto_ma200 > -0.64
                
                and ma2_last <= ma2_2_min_ago 
                and macd < 5
                and macd_differenza_2_min_ago < -3
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
            ):
                sell = "SELL cond spec SALVAGENTE 4 con ma 50 > ma 50 2 min ago con ma300 > 5 ore - dev 3-39 < 0.08 and dev_sell < -0.08 e ma5 sotto ma200 > -0.64 - r 16047 B1X"
                action = "sell"
                
                # dev_sell < -0.12 da < -0.107 ( portata con -0.119 nel sell 2 )
                # 12 dic 203 and dev_sell < -0.08 da -0.12
                # 12 dic 203 aaggiunta nd macd_differenza_2_min_ago < -2
                # 12 dic 203 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018 = 7 pts

            
            elif (
                ma78_last < ma78_120_min_ago
                and ma300_last > ma300_301_min_ago
                and deviation_ma5_sotto_ma300 > -1.80
                
                and ma20_last >= ma40_last
                and ma20_last > ma20_2_min_ago

                and ma50_last <= ma50_2_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.055
                
                and ma2_last < ma5_last
                
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -8
                
                and macd_differenza_2_min_ago < -1.0
                and macd < 28
            
            ):
                sell = "SELL CS con ma20>ma20 2 min ago e con ma 50<= ma 50 2 min ago con dev 3-39 < 0.08 and dev_sell < -0.055 - r 16047 B1 Y1 X1"
                action = "sell"
                
                # 11 feb 2024 dev sell a -0.045 da -0.03
                # 28 gen 2025 and deviation_sell < -0.055 da dev_sell < -0.045


            
            elif (
                ma78_last < ma78_120_min_ago
                and ma300_last > ma300_301_min_ago
                and deviation_ma5_sotto_ma300 < -1.80
                
                and ma20_last >= ma40_last
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                
                and deviation_ma39 < 0.12
                and deviation_sell < -0.005
                
                and ma2_last < ma5_last
                
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -8
                
                and macd_differenza_2_min_ago < -1.0
                and macd < 28
            
            ):
                sell = "SELL cond spec con ma20>ma20 2 min ago e con ma 50<= ma 50 2 min ago con ma300 > 5 ore - SALVAGENTE 4 dev 3-39 < 0.08 and dev_sell < -0.03 - r 16047 B1 Y1 x2"
                action = "sell"
              
            elif (
                ma78_last < ma78_120_min_ago
                and ma10_last > ma20_last
                and ma5_last > ma10_last
                and ma20_last < ma40_last
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                
                and ma300_last > ma300_301_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.035

                and ma2_last < ma5_last
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -10
                
                and macd_differenza_2_min_ago < -1.0
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd < 20
            
            ):
                sell = "SELL cond spec con ma20 > ma20 2 min ago ! e con ma 50<= ma 50 2 min ago con ma300 > 5 ore e dev 3-39 < 0.08 and dev_sell < -0.035 - r 16047 B1 Y1 Y1 a"
                action = "sell"
                
                # 30 dic 2023 5 > 10 and macd < 20 da < 15
                #  9 gen 2023 and deviation_sell a -0.02 da 0.01
                #  9 gen 2023 and ma2_differenza_2_min_ago a -10 da -8
                #  8 feb 2024 se 10>20 deviation_sell a -0.035 da -0.02
          
            elif (
                ma78_last < ma78_120_min_ago
                and ma10_last <= ma20_last
                and ma5_last > ma10_last
                and ma20_last < ma40_last
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                
                
                and ma300_last > ma300_301_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.02

                and ma2_last < ma5_last
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -10
                
                and macd_differenza_2_min_ago < -1.0
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd < 20
            
            ):
                sell = "SELL cond spec con ma20 > ma20 2 min ago ! e con ma 50<= ma 50 2 min ago con ma300 > 5 ore e dev 3-39 < 0.08 and dev_sell < -0.02 - r 16047 B1 Y1 Y1 b"
                action = "sell"
                
                # 30 dic 2023 5 > 10 and macd < 20 da < 15
                #  9 gen 2023 and deviation_sell a -0.02 da 0.01
                #  9 gen 2023 and ma2_differenza_2_min_ago a -10 da -8
     
          

            elif (
                ma78_last < ma78_120_min_ago
                and ma10_last > ma10_2_min_ago
                and ma5_last < ma10_last
                and ma20_last < ma40_last
                and ma20_last > ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                
                
                and ma300_last > ma300_301_min_ago
                
                and deviation_ma39 < 0.13
                and deviation_sell < -0.01
                
                and ma2_last <= ma2_2_min_ago
                and ma2_differenza_2_min_ago < -8
                and ma2_last < ma5_last
                
                and macd_differenza_2_min_ago < -1.0
                and macd < 25
            
            ):
                sell = "SELL cond spec con ma20>ma20 2 min ago e con ma 50<= ma 50 2 min ago con ma300 > 5 ore - SALVAGENTE 4 dev 3-39 < 0.08 and dev_sell < -0.01 - r 16047 B1 Y1 Y2x"
                action = "sell"
                
                # 17 gen 2024 con 10>10 2 min ago aumento la tolleranza a -0.01 da 0.02


            elif (
                ma78_last < ma78_120_min_ago
                and deviation_ma25_sotto_ma300 > -0.70

                and ma50_last <= ma50_2_min_ago

                and ma20_last > ma20_2_min_ago
                and ma300_last > ma300_301_min_ago

                and ma10_last < ma10_2_min_ago
                and ma5_last < ma10_last
                and ma20_last < ma40_last
                
                
                and ma2_differenza_2_min_ago < -8
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.027
                
                and ma2_last <= ma2_2_min_ago
                and ma2_last < ma5_last
                
                and macd_differenza_2_min_ago < -1.0
                and macd < 25
            
            ):
                sell = f"SELL CS con ma20>ma20 2 min e ma50<= ma50 2 min E ma300 > 5 ore e dev 3-39 <0.10 e dev_sell < -0.027 - r 16047 B1 Y1 Y2yx - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                #  5 feb 2025 and deviation_sell a -0.027 da -0.025 se ci troviamo ancora nella parte alta
                #  5 feb 2025 and deviation_ma25_sotto_ma300 > -0.70 significa che non ci troviamo durante un crollo ! stai piu' tranquillo.
                # 25 ott 2025 aggiunte pg




            elif (
                ma78_last < ma78_120_min_ago
                and deviation_ma25_sotto_ma300 < -0.70

                and ma50_last <= ma50_2_min_ago

                and ma20_last > ma20_2_min_ago
                and ma300_last > ma300_301_min_ago

                and ma10_last < ma10_2_min_ago
                and ma5_last < ma10_last
                and ma20_last < ma40_last
                
                
                and ma2_differenza_2_min_ago < -8
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.025
                
                and ma2_last <= ma2_2_min_ago
                and ma2_last < ma5_last
                
                and macd_differenza_2_min_ago < -1.0
                and macd < 25
            
            ):
                sell = "SELL CS con ma20>ma20 2 min e ma50<= ma50 2 min E ma300 > 5 ore e dev 3-39 <0.10 e dev_sell < -0.025 - r 16047 B1 Y1 Y2yy"
                action = "sell"
                
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a 0.02 da 0.05
                # oggi 13 dicembre 2023 tolto ma5 sotto ma200 > -0.64
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago and deviation_sell 0.01 da 0.02
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago and ma2_differenza_2_min_ago a -6 da -5
                # 19 dic 2023 deviation_sell a -0.03 da 0.01 con ma20 che sta salendo !
                # 19 dic 2023 se 20 e' ancora sotto 40 esci prima cazzo ! and deviation_sell < 0.01 da < -0.03
                # 30 dic 2023 5 < 10 and macd < 25 da < 15 !
                #  1 dic 2024 and deviation_sell -0.02 da 0.01
                #  5 feb 2025 and deviation_sell a -0.025 da -0.02

            

            elif (
                ma78_last < ma78_120_min_ago
                and ma10_last > ma20_last
                and ma20_last <= ma20_2_min_ago
                and ma50_last > ma50_2_min_ago
                
                
                and ma300_last > ma300_301_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < 0.013
                
                and deviation_ma5_sotto_ma200 > -0.64
                
                and ma2_last <= ma2_2_min_ago
                and ma2_last < ma5_last
                and ma2_last < ma6_last
                and ma2_differenza_2_min_ago < -5
                and macd_differenza_2_min_ago < -1.0
                
                and macd < 30
                
            ):
                sell = f"SELL CS con ma50 <= ma50 2 min ago E ma300 > 5 ore E dev 3-39 < 0.08 E dev_sell < 0.01 - r 16047 B1 Y2x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 24 dic 2023 se 10>20 dev sell a 0.02 da 0.04
                # 22 set 2024 aggiunta and ma2_last < ma6_last 
                # 22 set 2024 and deviation_sell < 0.01 da < 0.02
                # 27 mar 2025 aggiunto anche se 50>
                # 27 mar 2025 anticipato ma proprio di una ndecchiecella
                # 24 ott 2025 aggiunte pg


            elif (
                ma78_last < ma78_120_min_ago
                and ma10_last > ma20_last


                and ma20_last <= ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                and (ma5_prev > ma25_prev and ma5_last < ma25_last)
                
                and ma300_last > ma300_301_min_ago
                
                
                and deviation_sell > 0.001
                
                and deviation_ma5_sotto_ma200 > -0.64
                
                and ma2_last <= ma2_2_min_ago
                and ma2_last < ma5_last
                and ma2_last < ma6_last
                and ma2_differenza_2_min_ago < -5
                and macd_differenza_2_min_ago < -1.0
                
                and macd < 30
                
            ):
                sell = "SELL CS con ma50 <= ma50 2 min ago E ma300 > 5 ore E dev_sell > 0.001 - r 16047 B1 Y2y"
                action = "sell"
                
                # 24 dic 2023 se 10>20 dev sell a 0.02 da 0.04
                # 22 set 2024 aggiunta and ma2_last < ma6_last 
                # 22 set 2024 and deviation_sell < 0.01 da < 0.02
                # 27 mar 2025 anticipato ma proprio di una ndecchiecella
                # 28 mar 2025 and deviation_sell < 0.001 da < 0.012
                #  8 ago 2025 aggiunto and (ma5_prev > ma25_prev and ma5_last < ma25_last) ha venduto mentre saliva

          
            elif (
                ma78_last < ma78_120_min_ago
                and ma5_differenza_2_min_ago > -6
                and ma10_last < ma20_last
                and ma20_last <= ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                and ma2_differenza_2_min_ago < -5
                
                and ma300_last > ma300_301_min_ago
                
                
                
                and deviation_ma5_sotto_ma200 > -0.64
                
                and ma2_last <= ma2_2_min_ago
                and ma2_last < ma5_last
                and ma2_differenza_2_min_ago < -10
                
                and macd < 16
                and macd_differenza_2_min_ago < -0.5
                and macd_differenza_2_min_ago > -2.2
                and deviation_ma39 < 0.08
                and deviation_sell < -0.02
             
            ):
                sell = "SELL cond spec con ma 50 <= ma 50 2 min ago  con ma300 > 5 ore - SALVAGENTE 4 dev 3-39 < 0.06 e dev_sell < -0.01 e ma5 sotto ma200 > -0.64 - r 16047 B1 Y2 Y2 x"
                action = "sell"
                
                # 11 feb 2024 and macd_differenza_2_min_ago > -4.2
          
            elif (
                ma78_last < ma78_120_min_ago
                and ma5_differenza_2_min_ago > -6
                and ma10_last < ma20_last
                and ma20_last <= ma20_2_min_ago
                and ma50_last <= ma50_2_min_ago
                and ma2_differenza_2_min_ago < -5
                
                and ma300_last > ma300_301_min_ago
                
                
                
                and deviation_ma5_sotto_ma200 > -0.64
                
                and ma2_last <= ma2_2_min_ago
                and ma2_last < ma5_last
                and ma2_differenza_2_min_ago < -10
                
                and macd < 16
                and macd_differenza_2_min_ago < -2.2
                and macd_differenza_2_min_ago > -4.2
                and deviation_ma39 < 0.08
                and deviation_sell < -0.01
            ):
                sell = "SELL cond spec con ma 50 <= ma 50 2 min ago  con ma300 > 5 ore - SALVAGENTE 4 dev 3-39 < 0.06 e dev_sell < 0.01 e ma5 sotto ma200 > -0.64 - r 16047 B1 Y2 Y2 y"
                action = "sell"

            



            elif (
                ma300_last > ma300_301_min_ago
                and ma78_last < ma78_120_min_ago
                
                and ma10_last < ma20_last
                and ma39_last < ma100_last
                and ma20_last <= ma20_2_min_ago
                
                and deviation_ma5_sotto_ma200 > -0.64
                
                and deviation_ma39 < 0.08
                and deviation_sell < 0.01

                and ma2_last < ma5_last
                
                and ma2_last <= ma2_2_min_ago
                and macd_differenza_2_min_ago < -3.20
            ):
                sell = f"SELL CS con 39<100 E ma300 > 5 ore e dev 3-39 < 0.06 e dev_sell < 0.01 - r 16047 B1 Y2 Y2 z - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300}"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                # modifica solo devation.
                # > estate -0.37 da -0.33
                # 18 set HA FATTO -0.84 ! dev 39 -0.255 da 0.26 E dev sell -0.362 da -0.37
                # 25 gen 2023 HA FATTO -0.95 ! dev 39 -0.253 da 0.255 E dev sell -0.36 da -0.362
                #  1 feb 2023 dev 39 -0.251 da -0.253 ha fatto -1.31 (RCCR -1.98% !) ( sta migliorando ! )
                #  1 feb 2023 deviation_ma5_sotto_ma200 > -0.90 da > 1.00 se vado a vedere sell 30 gen 2023 oe 20:12 5-200 = -1.02 !
                # 17 mar 2023 dev39 a -0.25 da -0.251
                # 27 mag 2023 dev39 a -0.20 da -0.25
                # 30 mag 2023 dev39 a -0.195 da -0.20
                # 30 mag 2023 dev sell a -0.325 da -0.33
                
                #  1 giu 2023 ha fatto -1.23% !
                #  1 giu 2023 dev39 a -0.192 da -0.195
                #  1 giu 2023 dev sell a -0.323 da -0.325
                #  8 giu 2023 and deviation_sell < -0.34
                # 15 giu 2023 and deviation_sell < -0.335 da -0.34
                # 31 lug 2023 and deviation_sell < -0.32 da -0.335
                # 11 ago 2023 and deviation_sell < -0.30 da -0.32
                # 16 ago 2023 aggiunto macd < macd 2 min ago
                # 24 ago 2023 and deviation_ma39 < 0.05 ! il 22 ago ha fatto -1.20 !
                # 12 set 2023 and dev sell < -0.05 da -0.30
                #  2 ott 2023 -1% tolto macd < 2 min ago era < 5 !
                # 19 ott 2023 tolto and deviation_ma100_sopra_ma300 < 0.40 ! ha fatto -0.85 !
                # 19 ott 2023 and deviation_ma5_sotto_ma200 > -0.64
                # 19 ott 2023 and dev sell < -0.107 da -0.102
                # 29 ott 2023 and deviation_sell -0.109 da -0.107
                # 31 ott 2023 and deviation_sell -0.112 da -0.109
          
                # 20 nov 2023 aggiunta and macd_differenza_2_min_ago < -1.5
                # 20 nov 2023 and deviation_sell a -0.10 da -0.112
                # 20 nov 2023 aggiunta and ma2_differenza_2_min_ago < 5 ! non cambiare - 
                #  5 dic 2023 and deviation_sell a -0.09 da -0.11
                # 20 nov 2023 macd_differenza_2_min_ago < -1 da -1.5 ! era -1.4 quando ha fatto -0.80% !  4 dic 2023 ore 16:33
                #  6 dic 2023 dev_sell < 0.05 da -0.06
                
                # oggi 10 dicembre 2023 ascolta mario ! SE ma20_last <= ma20_2_min_ago DEV SELL a 0.05
                #  5 nov 2024 ho sostituito ma50<ma50 2min ago (che e' arrivata tardi) con 39<100
                #  7 ott 2025 aggiunte parentesi graffe sulla stessa riga ! ma dopo il trattino - (speriamo che funzioni)


            
            elif (
                ma78_last < ma78_120_min_ago
                and ma20_last > ma20_2_min_ago
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.109
                
                and ma50_last <= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and ma2_last <= ma2_2_min_ago 
                and macd < macd_2_min_ago
            ):
                sell = "SELL condizione speciale 6 GIORNO con ma300> 5 ore - dev 3-39 < 0.05 and dev_sell < -0.109 - con ma50 < e con ma5 sotto ma200 > -0.90 - r 16047 B2x"
                action = "sell"
                
                # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                # 15 set 2023 quando GIORNO a -0.11 da -0.07
                # oggi 18 dicembre 2023 ascolta mario ! SE ma20_last > ma20_2_min_ago DEV SELL a -0.105



            elif (
                ma78_last < ma78_120_min_ago
                and ma100_last > ma300_last
                and ma20_last <= ma20_2_min_ago
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.045
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and ma2_last <= ma2_2_min_ago 
                and macd < macd_2_min_ago
            ):
                sell = "SELL CS GIORNO con ma300< 5 ore MA 50> - dev 3-39 < 0.10 and dev_sell < -0.01 E ma5 sotto ma200 > -0.90 - r 16047 B2 Y1 A"
                action = "sell"
                
                # 10 gen 2024 ha fatto -0.40 ho notato che ma50 era > quindi ho aggiunto questa !
                # 15 set 2024 and deviation_sell < -0.045 da < -0.03 se ma100_last > ma300_last

            elif (
                ma78_last < ma78_120_min_ago
                and ma100_last < ma300_last

                and ma20_last <= ma20_2_min_ago
                and ma300_last < ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.03
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and ma2_last <= ma2_2_min_ago 
                and macd < macd_2_min_ago
            ):
                sell = "SELL CS GIORNO con ma300< 5 ore MA 50> - dev 3-39 < 0.10 and dev_sell < -0.01 E ma5 sotto ma200 > -0.90 - r 16047 B2 Y1 B"
                action = "sell"
                
                # 10 gen 2024 ha fatto -0.40 ho notato che ma50 era > quindi ho aggiunto questa !

          
           

            elif (
                ma78_last < ma78_120_min_ago
                and ma300_last < ma300_301_min_ago
                and ma10_last <= ma10_2_min_ago

                and ma30_last > ma50_last
                
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.015
                
                and ma50_last <= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and ma2_last <= ma2_2_min_ago 
                
            ):
                sell = "SELL CS GIORNO MA ma300 < 5 ore e 50 < E dev 3-39 < 0.10 and dev_sell < -0.015 con ma5 sotto ma200 > -0.90 - r 16047 B2 Y2 A"
                action = "sell"
                
                # 19 feb 2024 dev sell a -0.03 da -0.02 con ma30_last > ma50_last. 
                # 28 gen 2025 and deviation_sell a -0.045 da < 0.03
                #  6 ago 2025 and deviation_sell a -0.015 da -0.045 


            
            elif (
                ma78_last < ma78_120_min_ago

                and delta_450_200 < delta_450_200_60_min
                and delta_150_100 <= delta_150_100_60_min

                and ma30_last < ma50_last
                and ma20_last <= ma20_2_min_ago
                and ma300_last < ma300_301_min_ago
                
                and deviation_ma39 < 0.08
                and deviation_sell < -0.05
                
                and ma50_last <= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and ma2_last <= ma2_2_min_ago 
                and macd < macd_2_min_ago
            ):
                sell = "SELL CS GIORNO-GIORNO con ma300< 5 ore e 50< E dev 3-39 < 0.08 E dev_sell< -0.05 con ma50< - r 16047 B2 Y2 Bx"
                action = "sell"

                #  3 ott 2024 se GIORNO-GIORNO aumenta la dev sell !
                #  3 ott 2024 se GIORNO-GIORNO and deviation_sell < -0.05 da -0.03
                #  3 ott 2024 se GIORNO-GIORNO and deviation_ma39 < 0.08 da 0.10


            elif (
                ma78_last < ma78_120_min_ago

                and delta_450_200 > delta_450_200_60_min
                and delta_150_100 <= delta_150_100_60_min

                and ma30_last < ma50_last
                and ma20_last <= ma20_2_min_ago
                and ma300_last < ma300_301_min_ago
                
                and deviation_ma39 < 0.10
                and deviation_sell < -0.03
                
                and ma50_last <= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90

                and ma5_last <= ma5_2_min_ago 
                and ma2_last <= ma2_2_min_ago 
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -0.50
            ):
                sell = "SELL CS con ma300< 5 ore e 50< E dev 3-39< 0.10 E dev_sell< -0.03 E ma50< E ma5 <= ma5_2_min_ago - r 16047 B2 Y2 BY"
                action = "sell"
                
                # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                # 15 set 2023 quando GIORNO a -0.11 da -0.07
                # oggi 18 dicembre 2023 ascolta mario ! SE ma20_last <= ma20_2_min_ago DEV SELL a -0.01 da -0.109
                # oggi 18 dicembre 2023 ascolta mario ! SE ma20_last <= ma20_2_min_ago DEV 39 a 0.10 da 0.05
                # 31 gen 2024 dev sell a -0.03 da -0.02
                # 11 nov 2024 aggiunta and ma5_last <= ma5_2_min_ago 
                # 11 nov 2024 aggiunta and macd_differenza_2_min_ago < -0.50



            elif (
                ma78_last < ma78_120_min_ago
                and ma10_last > ma20_last
                and ma2_differenza_2_min_ago < -8
                
                and ma300_last > ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.07
                and deviation_sell < -0.05
                
                and ma50_last <= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and ma2_last <= ma2_2_min_ago 
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd_differenza_2_min_ago < -0.50
            ):
                sell = "SELL condizione speciale 6 NOTTE con ma300> 5 ore - SALVAGENTE 4 dev 3-39 < 0.07 and dev_sell < -0.05 con ma50 < e con ma5 sotto ma200 > -0.90 - r 16047 B3 X"
                action = "sell"
                
                # 27 dic 2023 se 10 va sopra 20 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                # 27 dic 2023 se 10 va sopra 20 and macd_differenza_2_min_ago < -0.50
                # 27 dic 2023 se 10 va sopra 20 deviation_sell a -0.09 da 0.083
                # 13 gen 2024 se 10 va sopra 20 and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02 da -0.018
                # 13 gen 2024 se 10 va sopra 20 and deviation_sell < -0.10
                # 19 gen 2024 deviation_sell < -0.10 ha fatto -0.40 !
                # 19 gen 2024 deviation_sell a -0.05 da -0.10



            elif (
                ma78_last < ma78_120_min_ago

                and ma5_last > ma100_last
                and ma10_last <= ma20_last
                
                
                and ma300_last > ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.083
                
                and ma50_last <= ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                and macd_differenza_2_min_ago < -1.0
                
            ):
                sell = "SELL CS 6 NOTTE con ma300> 5 ore - dev 3-39 < 0.05 e dev_sell < -0.083 e ma50 < e e ma5 > ma 100 - r 16047 B3 y1"
                action = "sell"

                # 22 feb 2025 ti ricordo che ma5 sotto ma200 > -0.90 significa che non e' una situazione crollo !


            elif (
                ma3_last <= ma8_last
                and ma10_last <= ma20_last
                and ma5_last <= ma100_last
                and (ma78_last < ma78_120_min_ago or ma50_last <= ma50_2_min_ago)

                
                and (ma300_last > ma300_301_min_ago or delta_150_100 <= delta_150_100_60_min)
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.022
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and macd_differenza_2_min_ago < -1.0
                
            ):
                sell = f"SELL CS 6 NOTTE con ma300> 5 ore - dev 3-39 < 0.05 e dev_sell < -0.023 e ma50 < e ma5 < ma 100 - r 16047 B3 y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 15 set 2023 quando 300 scende da 5 ore non devi vendere in perdita ! a ricomprare ci penseranno altre condizioni !
                # 17 nov 203 aggiunto and ma2_differenza_2_min_ago < -5
                # 24 nov 203 ma2_differenza_2_min_ago < -7 da -5 VENDE MENTRE MA2 E' IN CRESCITA ! credo che sia una questione di CANDELE.
                # 24 nov 203 dev sell 0.083 da -0.079
                # 22 feb 2025 se 5 e' andata sotto 100 allora deviation_sell a -0.023 da -0.083
                # 22 feb 2025 ti ricordo che ma5 sotto ma200 > -0.90 significa che non e' una situazione crollo !
                # 17 apr 2025 tolto ma2 < ma2 2 min ago
                # 17 apr 2025 aggiunto and macd_differenza_2_min_ago < -1.0
                # 17 apr 2025 and deviation_sell < -0.022 da -0.023
                # 16 mag 2025 aggiunto parentesi. deve essere riferimento per il BUY.
                # 24 ott 2025 piccole modifiche

                

            elif (
                ma300_last > ma300_301_min_ago
                
                and (ma100_prev > ma300_prev and ma100_last < ma300_last)
                and (ma3_prev > ma20_prev and ma3_last < ma20_last)

                and ma5_last <= ma5_3_min_ago
                and ma8_last <= ma8_2_min_ago
                
                and ma2_last < ma5_last
               
            ):
                sell = "SELL CS 27 giu 2025 - r 16048 a"
                action = "sell"

                # 27 giu 2025 aggiunta questa semplice condizione
                #  9 lug 2025 aggiunto ma5_last <= ma5_3_min_ago
                #  9 lug 2025 aggiunto incrocio al ribasso 100-300 invece di 100<300
                #  7 ago 2025 incrocio al ribasso a 3-20 da 3-10



            
            elif (
                ma300_last > ma300_301_min_ago
                
                and (ma100_prev > ma450_prev and ma100_last < ma450_last)
                and (ma3_prev > ma16_prev and ma3_last < ma16_last)

                and ma5_last <= ma5_3_min_ago
                and ma8_last <= ma8_2_min_ago
                
                and ma2_last < ma5_last
               
            ):
                sell = "SELL CS 27 giu 2025 - r 16048 b"
                action = "sell"

                # 27 giu 2025 aggiunta questa semplice condizione
                #  9 lug 2025 aggiunto ma5_last <= ma5_3_min_ago
                #  9 lug 2025 aggiunto incrocio al ribasso 100-450 invece di 100<450
                #  7 ago 2025 incrocio al ribasso a 3-16 da 3-10











            elif (
                ma5_last <= ma100_last

                and ma78_last < ma78_120_min_ago
                and ma100_last < ma200_last
                and ma200_last < ma300_last
                
                
                and ma20_last > ma50_last
                and ma50_last > ma50_2_min_ago

                and ma300_last > ma300_301_min_ago
                and delta_150_100 <= delta_150_100_60_min
                
                and deviation_ma39 < 0.05
                and deviation_sell < -0.021
                
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 > -0.90
                
                and macd_differenza_2_min_ago < -1.0
                
            ):
                sell = "SELL CS con ma300> 5 ore MA 78< 78 2 ore e dev 3-39 < 0.05 e dev_sell < -0.023  CON 5<100 - r 16050"
                action = "sell"
                
                # 17 apr 2025 aggiunta questa nuova condizione di vendita
                # 17 apr 2025 mentre 78 scende da 2 ore 5 e' andata sotto 100. statte accorto. vendi. MA VA TUTTO BENE.
                # 17 apr 2025 da notare che ma20 sta ancora sopra ma50 e ma50 e' > a ma50 di 2 min ago



                #########################################################################################################################
                
                
              
            
            ############################################ SALVAGENTE con deviation_ma5_sotto_ma200 < -1.00 and > -1.50
            
            
            
            # 6 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.00 and > -1.50
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.40
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.40
                
                and deviation_ma5_sotto_ma200 < -1.00
                and deviation_ma5_sotto_ma200 > -1.50
                
                and ma2_last < ma2_2_min_ago 
            ):
                sell = "SELL condizione speciale 7 - SALVAGENTE 1 3-39 con ma50 > - con deviation_ma5_sotto_ma200 < -1.00 and > -1.50 - r 16084"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                
          
            
            # 7 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.00 and > -1.50   
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.40
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 < -1.00
                and deviation_ma5_sotto_ma200 > -1.50
                
                and ma2_last < ma2_2_min_ago 
            ):
                sell = "SELL condizione speciale 8 - SALVAGENTE 2 3-39 con ma50 > - con deviation_ma5_sotto_ma200 < -1.00 and > -1.50 - r 16106"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                
         
            
            # 8 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.00 and > -1.50
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.40
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.40
                
                and deviation_ma5_sotto_ma200 < -1.00
                and deviation_ma5_sotto_ma200 > -1.50
                
                and ma2_last < ma2_2_min_ago 
                
            ):
                sell = "SELL condizione speciale 9 - SALVAGENTE 3 3-39 con ma50 < - con deviation_ma5_sotto_ma200 < -1.00 and > -1.50 - r 16129"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                
                
                
                
                
            
            # 9 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.50 CROLLO !
            
            elif (
                
                deviation_sell < -0.50
                and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 < -1.50
                
            ):
                sell = "SELL condizione speciale 10 - SALVAGENTE 4C 3-39 con ma50 < - con deviation_ma5_sotto_ma200 < -1.50 CROLLO ! - r 16153 A"
                action = "sell"   
                

                # DEVIATION 3-39 FACEVA USCIRE PUNTO ROSSO SOVRAPPOSTO AL PUNTO VERDE PERCHE' NEL CROLLO 3 ERA SOTTO 39 ( E NON POTEVANO NEANCHE INCROCIARE)
                # 
                
                
                
                
            # 10 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.00 and > -1.50 GRANDE RIBASSO !
            
            elif (
                ma2_last < ma2_2_min_ago
                and deviation_sell < -0.36
                and (ma3_prev > ma13_prev and ma3_last < ma13_last)
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 < -1.00
                and deviation_ma5_sotto_ma200 > -1.50
                
                
                
            ):
                sell = "SELL condizione speciale 10 - SALVAGENTE 4 3-13 con ma50 < e con dev_ma5_sotto_ma200 < -1.00 and > -1.50 GRANDE RIBASSO ! - r 16179 B"
                action = "sell"
                
                # co deviation 3-39 NELLA PRESENTE SITUAZIONE CROLLO 3 SOTTO 39 E PARTIVA IL PUNTO ROSSO SOVRAPPOSTO AL PUNTO VERDE
                

                
                
                
            ##################################################################################### SALVAGENTE con deviation_ma5_sotto_ma200 < -1.50
            
            
            
            # 11 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.50
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.50
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.40
                
                and deviation_ma5_sotto_ma200 < -1.50
            ):
                sell = "SELL condizione speciale 11 - SALVAGENTE 1C 3-39 con ma50 > - con deviation_ma5_sotto_ma200 < -1.50 - r 16207"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                
                
          
            
            # 12 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.50   
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.50
                
                and ma50_last > ma50_2_min_ago
                and deviation_ma100_sopra_ma300 < 0.40
                
                and deviation_ma5_sotto_ma200 < -1.50
                
            ):
                sell = "SELL condizione speciale 12 - SALVAGENTE 2C 3-39 con ma50 > - con deviation_ma5_sotto_ma200 < -1.50 - r 16228"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                
         
            
            
            # 13 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.50
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.53
                and ma100_last > ma100_60_min_ago
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.40
                
                and deviation_ma5_sotto_ma200 < -1.50
                
            ):
                sell = "SELL condizione speciale 13 - SALVAGENTE 3C 3-39 con ma50 < - con deviation_ma5_sotto_ma200 < -1.50 - r 16253 a"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                # 14 giu 2022 -0.52 da 0.50
                # 15 giu 2022 -0.53 da 0.52
                
                
                
                
            # 14 - SELL condizione speciale ro cano VENDE CON UN SALVAGENTE con deviation_ma5_sotto_ma200 < -1.50
            
            elif (
                deviation_ma39 < -0.25
                and deviation_sell < -0.52
                and ma100_last < ma100_60_min_ago
                
                and ma50_last < ma50_2_min_ago
                and deviation_ma100_sopra_ma300 > 0.40
                
                and deviation_ma5_sotto_ma200 < -1.50
                
            ):
                sell = "SELL condizione speciale 14 - SALVAGENTE 3C 3-39 con ma50 < - con deviation_ma5_sotto_ma200 < -1.50 - r 16277 b"
                action = "sell"   
                

                # deviation_ma39 = ma4_last / ma39_last QUESTA HA VENDUTO NEL CROLLO IMPROVVISO DI 1 MINUTO (con -2.06% !!!)!
                # 14 giu 2022 -0.52 da 0.50
              
                
                ##################################################################################################################### fine salvagente
                
                
            
            ################################################################################################################## CROLLO IMPROVVISO !
            
            
            
            # 15 - SELL condizione speciale ro cano VENDE DURANTE UN CROLLO IMPROVVISO ! and deviation_ma5_sotto_ma200 > -1.00
            
            elif (
                ma2_last < ma4_last
                and ma2_last < ma6_last
                and deviation_sell < -0.575
                
                and deviation_ma5_sotto_ma200 > -0.90
            ):
                  
                sell = "SELL condizione speciale 15 - CROLLO IMPROVVISO - and deviation_ma5_sotto_ma200 > -0.90 - r 16311"
                action = "sell"
            
                # con -0.59 il 6 feb 2022 ha fatto -0.85
                # con -0.62 il 4 feb 2022 ha fatto -0.89%
                # deviation = ma4_last / last_trade_price

                # FORSE E' L' UNICA DEVIATION CHE MI POTRA' SALVARE DA UN CROLLO IMPROVVISO COME QUELLO DEL 3 NOVEMBRE 2021
                # 17 mar 2023 dev sel -0.575 da -0.58
                
                
                
                
                
            # 16 - SELL condizione speciale ro cano VENDE DURANTE UN CROLLO IMPROVVISO ! and deviation_ma5_sotto_ma200 < -1.00
            
            elif (
                ma2_last < ma4_last
                and ma2_last < ma6_last
                and deviation_sell < -0.60
                
                and deviation_ma5_sotto_ma200 < -1.00
            ):
                  
                sell = "SELL condizione speciale 16 - CROLLO IMPROVVISO - and deviation_ma5_sotto_ma200 < -1.00 - r 16335"
                action = "sell"
            
                # con -0.59 il 6 feb 2022 ha fatto -0.85
                # con -0.62 il 4 feb 2022 ha fatto -0.89%
                # deviation = ma4_last / last_trade_price

                # FORSE E' L' UNICA DEVIATION CHE MI POTRA' SALVARE DA UN CROLLO IMPROVVISO COME QUELLO DEL 3 NOVEMBRE 2021
                
                
                
                
                ##################################################################################################################### fine crollo improvviso
                
                
                
                
                
            
            
            
            
            elif (    
                ma2_last < ma4_last
                and ma2_last < ma6_last
                and deviation_sell > 0.75

                and ma33_last > ma78_last
                
                and delta_1_200_30 < delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.22
                
                and deviation_ma5_sotto_ma200 > -1.00
            ): 
                
                sell = "SELL nuova condizione 3 apr 2025 dopo un rialzo improvviso e caduta improvvisa - PRENDI I SOLDI ! - r 16350"
                action = "sell"

                #  3 apr 2025 aggiunta questa nuova condizione




            ################################################################################# dopo crollo improvviso del 24 aprile 2022

            # 17 - SELL condizione speciale dopo crollo improvviso del 24 aprile 2022 ! and deviation_ma5_sotto_ma200 > -1.00


            elif (    
                ma2_last < ma4_last
                and ma2_last < ma6_last
                and ma3_last > ma39_last

                and ma33_last > ma78_last
                
                and delta_1_200_30 < delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.225
                
                and deviation_ma5_sotto_ma200 > -1.00
            ): 
                
                sell = "SELL CS - DOPO CROLLO IMPROVVISO del 24 aprile 2022 con 3>39 and dev_ma5_sotto_ma200 > -1.00 - giorno - r 16369 A1x"
                action = "sell"

                # ho aggiunto anche questa vendita speciale dopo il 24 aprile -1%
                # deviation_crollo_24_aprile = ma2_last / last_trade_price        
                # -0.58 ha generato perdita -0.82 il 10 maggio 2022 cosi' ho ridotto a -0.575
                # -0.575 ha generato perdita -1.12 il 10 maggio 2022 cosi' ho ridotto a -0.57
                # -0.57 ha generato perdita -1.37 il 12 maggio 2022 cosi' ho ridotto a -0.56
                # -0.56 ha generato perdita -1.19 il 13 maggio 2022 cosi' ho ridotto a -0.55
                
                # con delta_1_200_30 < delta_2_200_30_30_min ho aumentato a -0.56
                # -0.56 HA GENERATO PERDITA DI -1.42 il 22 luglio 2022 ! cazzo !
                
                # 21 giu 2022 a -0.56 da -0.57
                # 22 lug 2022 a -0.55 da -0.56 dopo grande perdita !
                # ATTENZIONE ! 22 lug 2022 questa condizione ha fatto -1.42 % !!! per fortuna RCCR ha fatto -0.52 e l' ho portata in MADDOG
                # 25 GEN 2023 a -0.54 da -0.55 dopo grande perdita -1.43 % ore 16:00 del 23 gennaio 2023 !
                # 10 gen 2024 and deviation_crollo_24_aprile < -0.24 da -0.54 dopo che ha fatto -1.13% il giorno 10 genn 2024 alle ore 22:17
                # 11 feb 2024 and deviation_crollo_24_aprile < -0.23 da -0.24 va tutto bene
                # 12 nov 2024 and deviation_crollo_24_aprile < -0.22 da -0.23
                #  7 apr 2025 SE 3>39 OPPURE SE 3<39

                

            elif (    
                ma2_last < ma4_last
                and ma2_last < ma6_last
                and ma3_last < ma39_last

                and ma33_last > ma78_last
                
                and delta_1_200_30 < delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.22
                
                and deviation_ma5_sotto_ma200 > -1.00
            ): 
                
                sell = "SELL CS - DOPO CROLLO IMPROVVISO del 24 aprile 2022 con 3<39 and dev_ma5_sotto_ma200 > -1.00 - giorno - r 16369 A1x"
                action = "sell"
                        
                # ho aggiunto anche questa vendita speciale dopo il 24 aprile -1%
                # deviation_crollo_24_aprile = ma2_last / last_trade_price        
                # -0.58 ha generato perdita -0.82 il 10 maggio 2022 cosi' ho ridotto a -0.575
                # -0.575 ha generato perdita -1.12 il 10 maggio 2022 cosi' ho ridotto a -0.57
                # -0.57 ha generato perdita -1.37 il 12 maggio 2022 cosi' ho ridotto a -0.56
                # -0.56 ha generato perdita -1.19 il 13 maggio 2022 cosi' ho ridotto a -0.55
                
                # con delta_1_200_30 < delta_2_200_30_30_min ho aumentato a -0.56
                # -0.56 HA GENERATO PERDITA DI -1.42 il 22 luglio 2022 ! cazzo !
                
                # 21 giu 2022 a -0.56 da -0.57
                # 22 lug 2022 a -0.55 da -0.56 dopo grande perdita !
                # ATTENZIONE ! 22 lug 2022 questa condizione ha fatto -1.42 % !!! per fortuna RCCR ha fatto -0.52 e l' ho portata in MADDOG
                # 25 GEN 2023 a -0.54 da -0.55 dopo grande perdita -1.43 % ore 16:00 del 23 gennaio 2023 !
                # 10 gen 2024 and deviation_crollo_24_aprile < -0.24 da -0.54 dopo che ha fatto -1.13% il giorno 10 genn 2024 alle ore 22:17
                # 11 feb 2024 and deviation_crollo_24_aprile < -0.23 da -0.24 va tutto bene
                # 12 nov 2024 and deviation_crollo_24_aprile < -0.22 da -0.23
                #  7 apr 2025 SE 3>39 OPPURE SE 3<39







                
            # 18 - SELL condizione speciale dopo crollo improvviso del 24 aprile 2022 ! and deviation_ma5_sotto_ma200 > -1.00
                    
            elif (
                ma2_last <= ma3_last
                and ma2_last <= ma4_last
                and ma2_last <= ma6_last
                and ma28_last < ma78_last
                
                and delta_1_200_30 < delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile <= -0.55
                
                and deviation_ma5_sotto_ma200 > -0.95
            ): 
                
                sell = "SELL cond. special 18 - DOPO CROLLO IMPROVVISO del 24 aprile 2022 - and dev_ma5_sotto_ma200 > -1.00 - (-0.56) giorno MA 33<78 - r 16369 A2"
                action = "sell"
                        
                # ho aggiunto anche questa vendita speciale dopo il 24 aprile -1%
                # deviation_crollo_24_aprile = ma2_last / last_trade_price        
                # -0.58 ha generato perdita -0.82 il 10 maggio 2022 cosi' ho ridotto a -0.575
                # -0.575 ha generato perdita -1.12 il 10 maggio 2022 cosi' ho ridotto a -0.57
                # -0.57 ha generato perdita -1.37 il 12 maggio 2022 cosi' ho ridotto a -0.56
                # -0.56 ha generato perdita -1.19 il 13 maggio 2022 cosi' ho ridotto a -0.55
                # MA VA BENE !
                # con delta_1_200_30 < delta_2_200_30_30_min ho aumentato a -0.56
                
                # alt fermi tutti
                # 18 marzo 2023 ore 17:31 ha fatto -2% ! allora ho messo -0.55 da -0.56
                #  6 apr 2023 -0.55 da -0.56
                
                
                





                



            # 19 - SELL condizione speciale dopo il crollo improvviso del 24 aprile 2022 !

            elif (    
                ma2_last < ma4_last
                
                and ma2_last < ma6_last
                and delta_1_200_30 < delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.30
                
                and deviation_ma5_sotto_ma200 > -0.70
            ): 
                
                sell = f"SELL CS - NOTTE - DOPO IL CROLLO IMPROVVISO del 24 aprile 2022 - and deviation_ma5_sotto_ma200 > -0.90 - r 16380 a - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                action = "sell"

                #  6 apr 2025 aggiunta anche questa
                # 13 ott 2025 aggiunte parentesi graffe



            elif (    
                ma2_last < ma4_last
                
                and ma2_last < ma6_last
                and delta_1_200_30 < delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.30
                
                and deviation_ma5_sotto_ma200 > -0.90
            ): 
                
                sell = "SELL CS - NOTTE - DOPO IL CROLLO IMPROVVISO del 24 aprile 2022 - and deviation_ma5_sotto_ma200 > -0.90 - r 16380 b"
                action = "sell"

                #  6 apr 2025 aggiunta anche questa


                

            elif (    
                ma2_last < ma4_last
                
                and ma2_last < ma6_last
                and delta_1_200_30 > delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.30
                
                and deviation_ma5_sotto_ma200 > -0.70
            ): 
                
                sell = "SELL CS - NOTTE - DOPO IL CROLLO IMPROVVISO del 24 aprile 2022 - and deviation_ma5_sotto_ma200 > -0.90 - r 16427 A"
                action = "sell"

                #  6 apr 2025 HA FATTO -1.06 e ho aggiunto questa con deviation_ma5_sotto_ma200 > -0.70
                


            elif (    
                ma2_last < ma4_last
                and ma2_last < ma6_last

                and ma8_last > ma8_2_min_ago
                
                
                and delta_1_200_30 > delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.29
                
                and deviation_ma5_sotto_ma200 > -0.90
            ): 
                
                sell = f"SELL CS - NOTTE - DOPO IL CROLLO IMPROVVISO del 24 aprile 2022 - and deviation_ma5_sotto_ma200 > -0.90 - r 16427 B1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                        
                # ho aggiunto anche questa vendita speciale dopo il 24 aprile -1%
                # deviation_crollo_24_aprile = ma2_last / last_trade_price        
                # -0.58 ha generato perdita -0.82 il 10 maggio 2022 cosi' ho ridotto a -0.575
                # -0.575 ha generato perdita -1.12 il 10 maggio 2022 cosi' ho ridotto a -0.57
                # -0.57 ha generato perdita -1.37 il 12 maggio 2022 cosi' ho ridotto a -0.56
                # -0.56 ha generato perdita -1.19 il 13 maggio 2022 cosi' ho ridotto a -0.55
                # MA VA BENE !
                # 0.55 ha generato una perdita di -1.00 % il 7 ott 2022 cosi' ho ridotto a -0.548
                #  5 nov 2023 dev crollo 24 apr a -0.45 da -0.548 (su RCCR ha generato perdita di -0.79) (io ho voluto cambiare anche su maddog)
                #  5 dic 2023 dev crollo 24 apr a -0.35 da -0.45 ( su MADDOG ha generato perdita di -0.81) VEDI 4 DICEMBRE 2023

                #  5 dic 2023 aggiunta and ma2_differenza_2_min_ago < -21 ! 
                #  6 apr 2025 HA FATTO -1.06 - tolto immediatamente and ma2_differenza_2_min_ago < -21
                #  6 apr 2025 dev crollo 24 apr a -0.30 da -0.35
                # 23 ott 2025 se ma8 > ma8 2 min ago -0.29 da -0.30
                # 23 ott 2025 aggiunte pg per conoscere i prossimi BUY !




            elif (    
                ma2_last < ma4_last
                and ma2_last < ma6_last

                and ma8_last < ma8_2_min_ago

                and delta_1_200_30 > delta_2_200_30_30_min
                
                and deviation_crollo_24_aprile < -0.28
                
                and deviation_ma5_sotto_ma200 > -0.90
            ): 
                
                sell = f"SELL CS - NOTTE - DOPO IL CROLLO IMPROVVISO del 24 aprile 2022 - and deviation_ma5_sotto_ma200 > -0.90 - r 16427 B2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                        
                # ho aggiunto anche questa vendita speciale dopo il 24 aprile -1%
                # deviation_crollo_24_aprile = ma2_last / last_trade_price        
                # -0.58 ha generato perdita -0.82 il 10 maggio 2022 cosi' ho ridotto a -0.575
                # -0.575 ha generato perdita -1.12 il 10 maggio 2022 cosi' ho ridotto a -0.57
                # -0.57 ha generato perdita -1.37 il 12 maggio 2022 cosi' ho ridotto a -0.56
                # -0.56 ha generato perdita -1.19 il 13 maggio 2022 cosi' ho ridotto a -0.55
                # MA VA BENE !
                # 0.55 ha generato una perdita di -1.00 % il 7 ott 2022 cosi' ho ridotto a -0.548
                #  5 nov 2023 dev crollo 24 apr a -0.45 da -0.548 (su RCCR ha generato perdita di -0.79) (io ho voluto cambiare anche su maddog)
                #  5 dic 2023 dev crollo 24 apr a -0.35 da -0.45 ( su MADDOG ha generato perdita di -0.81) VEDI 4 DICEMBRE 2023

                #  5 dic 2023 aggiunta and ma2_differenza_2_min_ago < -21 ! 
                #  6 apr 2025 HA FATTO -1.06 - tolto immediatamente and ma2_differenza_2_min_ago < -21
                #  6 apr 2025 dev crollo 24 apr a -0.30 da -0.35
                # 23 ott 2025 se ma8 < ma8 2 min ago -0.28 da -0.30
                # 23 ott 2025 aggiunte pg per conoscere i prossimi BUY !






            
            # 20 - SELL condizione speciale dopo il crollo improvviso del 24 aprile 2022 ! and deviation_ma5_sotto_ma200 < -1.00
                    
            elif (    
                ma2_last < ma4_last
                and ma2_last < ma6_last
                and deviation_crollo_24_aprile < -0.587
                
                and delta_1 < delta_2
                and deviation_ma5_sotto_ma200 < -1.00
            ): 
                
                sell = "SELL cond. special 20 - DOPO IL CROLLO IMPROVVISO del 24 aprile 2022 - and delta_1 < delta_2 and dev_ma5_sotto_ma200 < -1.00 - r 16456 A"
                action = "sell"
                        
                # ho aggiunto anche questa vendita speciale dopo il 24 aprile -1%
                # deviation_crollo_24_aprile = ma2_last / last_trade_price        
                # -0.58 ha generato perdita -0.82 il 10 maggio 2022 cosi' ho ridotto a -0.575
                # -0.575 ha generato perdita -1.12 il 10 maggio 2022 cosi' ho ridotto a -0.57
                
                # -0.60 ha generato perdita -0.84 il 13 maggio 2022 cosi' ho ridotto a -0.59
                # MA VA BENE !
                # 13 ott 2022 -0.60 ha generato perdita di -1.43 % ! quindi -0.587 da 0.60
                
                
                
                
            # 21 - SELL condizione special 21 Bocelli - core 'ngrato - > CROLLO IMPROVVISO - and deviation_ma5_sotto_ma200 < -0.70
            
            
            elif (    
                ma2_last <= ma4_last
                and ma300_last > ma300_301_min_ago
                and ma2_last <= ma6_last
                and deviation_crollo_24_aprile < -0.37
                
                and delta_1 > delta_2
                and deviation_ma5_sotto_ma200 < -0.70
            ): 
                
                sell = "SELL cond special 21 Bocelli - core 'ngrato - > CROLLO IMPROVVISO - and delta_1 > delta_2 e dev_ma5_sotto_ma200 < -0.70 < dev sell -0.37 - r 16480 Bx"
                action = "sell"
                
                # 11 gen 2024 -0.37 da -0.57



            elif (    
                ma2_last <= ma4_last
                and ma10_last > ma30_last
                and ma20_last > ma50_last

                and ma300_last < ma300_301_min_ago
                and ma2_last <= ma5_last
                and deviation_crollo_24_aprile < -0.15
                
                and delta_1 > delta_2
                and deviation_ma5_sotto_ma200 < -0.40
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago <= -0.015
                and macd_differenza_2_min_ago < -0.50
                
                and macd > 1
            ): 
                
                sell = "SELL CS Bocelli - CROLLO IMPROVVISO E delta_1 > delta_2 e dev_crollo_24_aprile < -0.15 MA ma10 > ma30 - r 16480 BYaA1"
                action = "sell"

                #  8 mar 2024 con macd > 1 deviation_crollo_24_aprile < -0.13
                #  2 ott 2024 CON ma10_last > ma30_last and deviation_crollo_24_aprile < -0.14 da < -0.13
                # 27 feb 2025 aggiunto se anche 20>50
                # 27 feb 2025 se anche 20>50 deviation_crollo_24_aprile < -0.15 da < -0.14


            elif (    
                ma2_last <= ma4_last
                and ma10_last > ma30_last
                and ma20_last < ma50_last

                and ma300_last < ma300_301_min_ago
                and ma2_last <= ma5_last
                and deviation_crollo_24_aprile < -0.145
                
                and delta_1 > delta_2
                and deviation_ma5_sotto_ma200 < -0.40
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago <= -0.015
                and macd_differenza_2_min_ago < -0.50
                
                and macd > 1
            ): 
                
                sell = "SELL CS Bocelli - CROLLO IMPROVVISO E delta_1 > delta_2 e dev_crollo_24_aprile < -0.145 MA ma10 > ma30 - r 16480 BYaA2"
                action = "sell"

                #  8 mar 2024 con macd > 1 deviation_crollo_24_aprile < -0.13
                #  2 ott 2024 CON ma10_last > ma30_last and deviation_crollo_24_aprile < -0.14 da < -0.13
                # 27 feb 2025 aggiunto se 20<50
                # 27 feb 2025 CON 20<50 and deviation_crollo_24_aprile < -0.145 da < -0.14



            




            elif (    
                ma2_last <= ma4_last

                and ma3_last > ma39_last
                and ma2_last < ma6_last

                and ma2_last < ma8_last
                and deviation_sell > 0.02

                and ma300_last < ma300_301_min_ago
                and ma2_last <= ma5_last
                and deviation_crollo_24_aprile < -0.13
                
                and delta_1 > delta_2
                
                and ma39_last < ma100_last
                and deviation_ma5_sotto_ma200 < -1.50
                and deviation_ma100_sopra_ma300 < -1.20
                and deviation_ma25_sotto_ma300 < -1.80

                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago <= -0.015
                and macd_differenza_2_min_ago < -0.50
                
                and macd > 1
            ): 
                
                sell = "SELL CROLLO IMPROVVISO dev_crollo_24_aprile < -0.13 con 2<6 SE 3>39 - r 16480 BY AB 1xx"
                action = "sell"

                #  8 mar 2024 con macd > 1 deviation_crollo_24_aprile < -0.13
                #  3 feb 2025 questa e' andata benissimo su RCCR -0.29 mentre MADDOG HA FATTO -1.40 !
                #  3 feb 2025 io ho imposto che deve entrare in azione solo quando la situazione si sta facendo critica.
                # 10 apr 2025 and ma3_last > ma39_last
                # 13 apr 2023 se deviation_sell > 0.02 sell con ma2_last < ma8_last SEMPRE CON 3>39



            elif (    
                ma2_last <= ma4_last

                and ma3_last > ma39_last
                and ma2_last < ma6_last
                and deviation_sell < 0.02

                and ma300_last < ma300_301_min_ago
                and ma2_last <= ma5_last
                and deviation_crollo_24_aprile < -0.13
                
                and delta_1 > delta_2
                
                and ma39_last < ma100_last
                and deviation_ma5_sotto_ma200 < -1.50
                and deviation_ma100_sopra_ma300 < -1.20
                and deviation_ma25_sotto_ma300 < -1.80

                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago <= -0.015
                and macd_differenza_2_min_ago < -0.50
                
                and macd > 1
            ): 
                
                sell = "SELL CROLLO IMPROVVISO dev_crollo_24_aprile < -0.13 con 2<6 SE 3>39 - r 16480 BY AB 1xy"
                action = "sell"

                #  8 mar 2024 con macd > 1 deviation_crollo_24_aprile < -0.13
                #  3 feb 2025 questa e' andata benissimo su RCCR -0.29 mentre MADDOG HA FATTO -1.40 !
                #  3 feb 2025 io ho imposto che deve entrare in azione solo quando la situazione si sta facendo critica.
                # 10 apr 2025 and ma3_last > ma39_last
                # 13 apr 2023 se deviation_sell < 0.02 sell con ma2_last < ma6_last SEMPRE CON 3>39


            
            elif (      
                ma2_last <= ma4_last

                and ma3_last < ma39_last

                and ma300_last < ma300_301_min_ago
                and ma2_last <= ma5_last
                and deviation_crollo_24_aprile < -0.13
                
                and delta_1 > delta_2
                
                and ma39_last < ma100_last
                and deviation_ma5_sotto_ma200 < -1.50
                and deviation_ma100_sopra_ma300 < -1.20
                and deviation_ma25_sotto_ma300 < -1.80

                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago <= -0.015
                and macd_differenza_2_min_ago < -0.50
                
                and macd > 1
            ): 
                
                sell = "SELL CROLLO IMPROVVISO dev_crollo_24_aprile < -0.13 con 2<4 SE 3<39 - r 16480 BY AB 1y"
                action = "sell"

                #  8 mar 2024 con macd > 1 deviation_crollo_24_aprile < -0.13
                #  3 feb 2025 questa e' andata benissimo su RCCR -0.29 mentre MADDOG HA FATTO -1.40 !
                #  3 feb 2025 io ho imposto che deve entrare in azione solo quando la situazione si sta facendo critica.
                # 10 apr 2025 and ma3_last > ma39_last




            elif (    
                ma78_last < ma300_last
                and (ma3_prev > ma10_prev and ma3_last < ma10_last)
                and deviation_crollo_24_aprile < -0.13

                and ma10_last < ma30_last
                
                and deviation_ma39 < -1.00
                and deviation_buy_crollo_1 < -1.61
                and deviation_ma25_sotto_ma300 < -2.00
                
                and delta_1 > delta_2
                
    
            ): 
                
                sell = "SELL DURANTE RIBASSO FERRARI con INCROCIO 3-10 E delta_1 > delta_2 e dev_crollo_24_aprile < -0.13 - r 16480 BY AB2"
                action = "sell"

                #  8 mar 2024 con macd > 1 deviation_crollo_24_aprile < -0.13
                #  3 feb 2025 deviation_crollo_24_aprile = ma2_last / last_trade_price !
                #  3 feb 2025 si attiva se deviation_ma39 < -1.00
                #  3 feb 2025 si attiva se deviation_buy_crollo_1 < -1.61
                #  3 feb 2025 si attiva se deviation_ma25_sotto_ma300 < -2.00
                #  3 feb 2025 SELL r 16480 BYa de RCCR E' ANDATA BENISSIMO -0.29% maddog ha fatto -1.40 !









            elif (    
                ma2_last <= ma4_last
                
                and ma2_last <= ma5_last
                and ma3_last > ma10_last

                and deviation_crollo_24_aprile < -0.155
                and ma300_last < ma300_301_min_ago

                and delta_1 > delta_2
                and deviation_ma5_sotto_ma200 < -0.40
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago <= -0.015
                and macd_differenza_2_min_ago < -0.50
                and macd > -40
                and macd < 1
            ): 
                
                sell = "SELL CS 21 Bocelli - core 'ngrato - CROLLO IMPROVVISO con dev_crollo_24_aprile < -0.155 MA 3>10 - r 16480 BYbX"
                action = "sell"

                # 18 apr 2025 MA se ma3_last > ma10_last allora deviation_crollo_24_aprile < -0.155 da < -0.15



            elif (    
                ma2_last <= ma4_last

                and ma2_last <= ma5_last
                and ma3_last < ma10_last

                and deviation_crollo_24_aprile < -0.15
                and ma300_last < ma300_301_min_ago
                
                and delta_1 > delta_2
                and deviation_ma5_sotto_ma200 < -0.40
                
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago <= -0.015
                and macd_differenza_2_min_ago < -0.50
                and macd > -40
                and macd < 1
            ): 
                
                sell = "SELL CS 21 Bocelli - core 'ngrato - CROLLO IMPROVVISO con dev_crollo_24_aprile < -0.13 E 3<10 - r 16480 BYbY"
                action = "sell"
                        
                # ho aggiunto anche questa vendita speciale dopo il 24 aprile -1%
                # deviation_crollo_24_aprile = ma2_last / last_trade_price        
                # -0.58 ha generato perdita -0.82 il 10 maggio 2022 cosi' ho ridotto a -0.575
                # -0.575 ha generato perdita -1.12 il 10 maggio 2022 cosi' ho ridotto a -0.57
                
                # -0.60 ha generato perdita -0.84 il 13 maggio 2022 cosi' ho ridotto a -0.59
                # MA VA BENE !
                # 27 giu 2022 a -0.58 da -0.59
                #  2 lug 2022 a -0.57 da -0.58 dopo che ha fatto -0.96 durante un crollo
                # 10 mar 2023 5 sotto 200 a <-0.90 da <-1.00
                # 10 mar 2023 a -0.572 da -0.57
                #  6 apr 2023 dev crollo -0.571 da -0.572
                #  6 apr 2023 dev 5 sotto 200 < -0.70 da < -0.90
                
                # 16 nov 2023 ha fatto -0.59
                # 16 nov 2023 and deviation_crollo_24_aprile < -0.30 da -0.50
                # 16 nov 2023 and deviation_ma5_sotto_ma200 < -0.50 da -0.70
                
                # 11 dic 2023 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.015 significa che ma2 deve scendere di 6 pts
                # 11 dic 2023 and deviation_crollo_24_aprile a -0.28 da -0.30
                # 26 dic 2023 and deviation_crollo_24_aprile a -0.24 da -0.28
                
                # 12 gen 2024 and deviation_crollo_24_aprile a -0.15 da -0.20 - 12 gen 2024 con -0.20 ha fatto -0.99 % ! ore 17:54
                # 19 gen 2024 and deviation_crollo_24_aprile a -0.14 da -0.15 - con -0.15 ha fatto -0.54 % 
                # 19 gen 2024 and deviation_crollo_24_aprile a -0.13 da -0.14
                
                #  8 mar 2024 con macd tra -40 e 1 deviation_crollo_24_aprile a -0.135 da -0.13

                ######################################################################################### fine dopo il crollo improvviso del 24 aprile 2022
                
                
                
            
            
            
            # 22 - SELL condizione speciale RIBASSO IMPROVVISO con deviation_sell < -0.60
            
            elif (
                ma78_last > ma78_2_min_ago
                and deviation_ribasso_improvviso < -0.63
                and deviation_evita_ribasso_improvviso_crollo_ferrari > -0.62
                and deviation_sell < -0.60
            ):
                sell = "SELL condizione speciale 22 RIBASSO IMPROVVISO - r 16509"
                action = "sell"
                    
                # IMPORTANTISSIMO ! PREZZO / ma30 FACEVA VENDERE IMMEDIATAMENTE DURANTE IL CROLLO FERRARI !
                # perche' il prezzo era OVVIAMENTE molto distante dalla ma30
                # cosi' ho aggiunto la deviation che dice che se ma3 e' piu' giu' della ma30 IL RIBASSO IMPROVVISO NON E' GIA' PIU' !
                # INTERVERRANNO ALTRE CONDIZIONI
                # ho dovuto mettere and deviation_sell < -0.30 (ha fatto vendita strana con -0.20 ore 00:10 del 9 maggio 2022)
                
                
                
            
            
            # 23 - SELL condizione speciale RIBASSO IMPROVVISO con deviation_sell < -0.60
            
            elif (
                ma78_last < ma78_2_min_ago
                and deviation_ribasso_improvviso < -0.63
                and deviation_evita_ribasso_improvviso_crollo_ferrari > -0.62
                and deviation_sell < -0.60
            ):
                sell = "SELL condizione speciale 23 RIBASSO IMPROVVISO - r 16530"
                action = "sell"
                
                # IMPORTANTISSIMO ! PREZZO / ma30 FACEVA VENDERE IMMEDIATAMENTE DURANTE IL CROLLO FERRARI !
                # prezzo molto distante dalla ma30
                # cosi' ho aggiunto la deviation che dice che se ma3 e' piu' giu' della ma30 IL RIBASSO IMPROVVISO NON E' GIA' PIU' !
                # INTERVERRANNO ALTRE CONDIZIONI    
                # anche qua ho dovuto mettere and deviation_sell < -0.18    
            
            
            
            
            
            
            # 24 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma100 > e ma13 >
           
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma2_differenza_2_min_ago < -5
                and deviation_sell < -0.25
                and ma2_last < last_trade_price
                
                and ma100_last > ma100_30_min_ago
                and ma13_last > ma13_2_min_ago
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 24 - DOLCE ATTESA con ma100 > e ma13 > and deviation_sell < -0.25 and ma2_differenza_2_min_ago < -5 - r 16556"
                action = "sell"
                
                #  5 dic 2023 aggiunto and ma2_differenza_2_min_ago < -5
                #  5 dic 2023 dev sell a -0.25 da -0.35 
            
            
            # 25 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma100 > e ma13 <
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_sell < -0.37
                and ma2_last < last_trade_price
                
                and ma100_last > ma100_30_min_ago
                and ma13_last > ma13_2_min_ago
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 25 - DOLCE ATTESA con ma100 > e ma13 < and deviation < -0.37 - r 16574"
                action = "sell"
                
            
            
            
            # 26 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma100 < e con ma13 > 
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_sell < -0.41
                and ma2_last < last_trade_price
                
                and ma100_last < ma100_30_min_ago
                and ma13_last > ma13_2_min_ago
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 26 - DOLCE ATTESA con ma100 < e con ma13 > and deviation < -0.41 - r 16592"
                action = "sell"
                
            
            
            
            
            
            # 27 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma100 < e con ma13 < ( and 20 > 100 )
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_sell < -0.355
                
                and ma20_last > ma100_last
                
                and ma100_last < ma100_30_min_ago
                and ma13_last > ma13_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 27 - DOLCE ATTESA con ma100 < e con ma13 < and dev_sell < -0.355 ( and 20 > 100 ! ) - r 16614"
                action = "sell"
                
            
            
            
            
            
            
            # 28 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma100 < e con ma13 < ( and 20 < 100 )
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_sell < -0.39
                
                
                and (ma20_prev > ma100_prev and ma20_last < ma100_last)
                and ma300_last > ma300_120_min_ago
                
                and ma100_last < ma100_30_min_ago
                and ma13_last > ma13_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 28 - DOLCE ATTESA 300 > con ma100 < e con ma13 < and deviation < -0.39 ( and 20 < 100 ) - r 16638 a"
                action = "sell"

                # il fattore tempo - la dolce attesa - solo con trend ribassista
                # deviation = ma2_last / last_trade_price
                # max_hold_time_in_seconds = 360 = 6 min (con 8 min perdita di 0.70 %)
                # max_hold_time_in_seconds = 300 = 5 min (con 6 min perdita di 0.90 %)
                
                # IMPORTANTE ! HO deviation < -0.355 MA VENDE CON SOLI - 0.25 cosi' ovviamente e' impossibile !
                # allora ho provato con un rafforzativo and ma20_last < ma100_last
                # per distinguerla da quella precedente che aveva dato il problema. ( e che ha and ma20_last < ma100_last )
                
                
                
                
                
                
            # 29 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma100 < e con ma13 < ( and 20 < 100 )
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_sell < -0.42
                
                
                and (ma20_prev > ma100_prev and ma20_last < ma100_last)
                and ma300_last < ma300_120_min_ago
                
                and ma100_last < ma100_30_min_ago
                and ma13_last > ma13_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 29 - DOLCE ATTESA 300 < con ma100 < e con ma13 < and deviation < -0.42 ( and 20 < 100 ) - r 16670 b"
                action = "sell"

                
                
                
                
                
             
            # 30 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma13 <
            
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_sell < -0.36
                
                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 > 0.50
               
                and ma13_last < ma13_2_min_ago
                
                and ma2_last < last_trade_price
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL cond. special 30 A - DOLCE ATTESA 270 sec con ma13 < and deviation < -0.36 CON 100 sopra 300 > 0.50 statt' accorto ! - r 16694 A"
                action = "sell"
                
                # 4 feb 2022 con <-0.26 ha fatto -0.88% (dopo +4.29%)
                # 7 feb 2022 con <-0.345 e 270 sec ha fatto -0.38% - aumenta a 0.355 ! - eventualmente ci pensa la condizione CROLLO IMPROVVISO CHE FUNZIONA !
                # 30 ago 2023 and deviation_sell -0.36 da -0.43
                
                
                
                
                
                
                
            # 30 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma13 <

            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma450_last > ma450_10_min_ago
                and ma39_last > ma100_last

                and deviation_sell < -0.035

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
               
            ):
          
                sell = "SELL CS - DOLCE ATTESA 270 sec con ma13 < and con 450 > E 100<100 30 min ago E dev sell -0.035 - r 16694 B1 X"
                action = "sell"

                # 15 ott 2024 se 39>100 deviation_sell < -0.03 da < -0.02
                # 22 mag 2025 se 39>100 deviation_sell < -0.035 da < -0.03
            

            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma10_last > ma39_last

                and ma450_last > ma450_10_min_ago
                and ma39_last < ma100_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
                and macd_differenza_2_min_ago < -1.50
                
                and deviation_sell < -0.025
            ):    
            
                sell = "SELL CS - DOLCE ATTESA 270 sec con ma13 < and con 450 > E 100<100 30 min ago and ma10_last > ma39_last - r 16694 B1 yx"
                action = "sell"

                # 15 apr 2025 aggiunta and ma10_last > ma39_last 
                # 15 apr 2025 forse qua dovro' mettere sell con 3<39 !




            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma10_last < ma39_last

                and ma450_last > ma450_10_min_ago
                and ma39_last < ma100_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
                and ma3_last <= ma3_2_min_ago
                and macd_differenza_2_min_ago < -1.50
                
                and deviation_sell < -0.027
            ):    
            
                sell = "SELL CS - DOLCE ATTESA 270 sec con ma13 < and con 450 > E 100<100 30 min ago and ma10_last < ma39_last - r 16694 B1 yy"
                action = "sell"
             
                # 4 feb 2022 con < -0.26 ha fatto -0.88% (dopo +4.29%)
                # 7 feb 2022 con < -0.345 e 270 sec ha fatto -0.38% - aumenta a 0.355 !
                # 7 feb 2022 eventualmente ci pensa la condizione CROLLO IMPROVVISO CHE FUNZIONA !
                # 17 set -0.57 da -0.47

                #  7 set 2004 ro cano e' tornato ! questa condizione interviene solo quando ma100 < ma100 30 min ago
                #  8 set 2024 aggiunta ma3 < ma3 2 min ago and ma2_last < ma2_2_min_ago
                # 22 feb 2025 aggiunta and macd_differenza_2_min_ago < -1.50
                # 16 apr 2025 ha fatto +0.15
                # 15 apr 2025 aggiunta and ma10_last < ma39_last
                # 13 ott 2025 and deviation_sell a -0.027 da -0.025






            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma450_last < ma450_10_min_ago
                and ma100_last > ma300_last
                and ma200_last > ma300_last
                and ma300_last > ma450_last

                and deviation_sell < -0.04

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):

                sell = "SELL CS - DOLCE ATTESA 270 sec and ma13 < and con 450 < E 100<100 30 min ago e 100 sopra 300 < 0.50 - r 16694 B2x"
                action = "sell"
             
                # 4 feb 2022 con <-0.26 ha fatto -0.88% (dopo +4.29%)
                # 7 feb 2022 con <-0.345 e 270 sec ha fatto -0.38% - aumenta a 0.355 ! - eventualmente ci pensa la condizione CROLLO IMPROVVISO CHE FUNZIONA !
                # 17 set -0.57 da -0.47

                #  7 set 2004 ro cano e' tornato ! questa condizione interviene solo quando ma100 < ma100 30 min ago
                #  8 set 2024 aggiunta ma3 < ma3 2 min ago and ma2_last < ma2_2_min_ago
                # 17 set 2024 aggiunto and deviation_sell < -0.03 CON 100 > 300 
                # 17 set 2024 and deviation_sell < -0.04 da < -0.03



            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma100_last > ma200_last
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07
                and deviation_sell < -0.01

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                
                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < ma5_last
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):

                sell = "SELL CS - DA 270 sec E ma13< E 450< E 100<100 30 min ago MA 100>200 E 100-100 10 min ago > -0.07 - r 16694 B2y1 y1"
                action = "sell"

                # 19 set 2024 con 100>200 aggiunto and ma2_last < ma5_last cioe' aspetta ancora un pochino
                # 19 set 2024 forse in futuro dovrai mettere and ma2_last < ma6_last cioe' aspetta un pochino di piu'
                # 12 mag 2025 se 100 non scende di molto allora aggiungo deviation_sell < -0.01
                # DA = DOLCE ATTESA


            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma100_last > ma200_last
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.07

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                
                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < ma5_last
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):

                sell = f"SELL CS - DA 270 sec and ma13< E 450< E 100<100 30 min ago E 100-100 10 min ago < -0.07 MA 100>200 - r 16694 B2y1 y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 19 set 2024 con 100>200 aggiunto and ma2_last < ma5_last cioe' aspetta ancora un pochino
                # 19 set 2024 forse in futuro dovrai mettere and ma2_last < ma6_last cioe' aspetta un pochino di piu'
                # 12 mag 2025 aggiunto and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.07
                # 18 ott 2025 aggiunte parentesi graffe




            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma20_last > ma50_last

                and deviation_ma25_sotto_ma200 > -2.00

                and delta_1_69_39 < delta_2_69_39
                and deviation_sell < -0.06
                and ma3_last < ma10_last

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago
                and ma3_last < ma3_2_min_ago
                and ma5_last < ma5_3_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            ):

                sell = f"SELL CS - DOLCE ATTESA 270 sec E dev sell < -0.06 and ma13 < and con 450 < MA GIORNO ! - r 16694 B2 Y2 Ax1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 20 mar 2025 deviation_sell a -0.055 da -0.05
                # 29 apr 2025 deviation_sell a -0.06 da -0.055
                # 16 ott 2025 aggiunte parentesi graffe (se ci sono le virgolette all' inizio ci devono essere le virgolette alla fine !)



            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma20_last < ma50_last
                and ma8_last <= ma8_2_min_ago

                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07

                and deviation_sell < -0.001

                and delta_1_69_39 < delta_2_69_39

                and deviation_ma25_sotto_ma200 > -2.00

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last < ma10_last
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            ):

                sell = f"SELL CS - D.A. 270 sec E dev sell < -0.001 e ma13 < and con 450 < MA GIORNO e ma100 non scende molto e 8 <= ma8 2 min ago - r 16694 B2 Y2 Ax 2x - deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago}"
                action = "sell"
                
                # 20 mar 2025 deviation_sell a -0.055 da -0.05
                # 14 apr 2025 se 20<50 and deviation_sell < 0.01 da -0.055
                # 12 mag 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.07
                # 12 mag 2025 se ma100 non scende molto dev sell a -0.001 da 0.01
                # 27 giu 2025 and ma8_last <= ma8_2_min_ago
                # 13 ott 2025 aggiunte parentesi graffe



            elif (
                ma3_last < ma20_last
                and deviation_sell < 0.01
                and delta_1_69_39 < delta_2_69_39

                and seconds_since_last_trade > max_hold_time_in_seconds
                
                and ma20_last < ma50_last
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.07

                

                and deviation_ma25_sotto_ma200 > -2.00

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last < ma10_last
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            ):

                sell = f"""SELL CS - DOLCE ATTESA 270 sec E dev sell < 0.01 and ma13 < and con 450 < MA GIORNO ! - r 16694 B2 Y2 Ax 2y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}

                deviation_ma39 {deviation_ma39:.2f} 
                deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                """
                action = "sell"

                # 20 mar 2025 deviation_sell a -0.055 da -0.05
                # 14 apr 2025 se 20<50 and deviation_sell < 0.01 da -0.055
                # 12 mag 2025 aggiunta and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.07
                # 12 mag 2025 se ma100 scende molto dev sell ok cosi'
                # 24 set 2025 messo ordine parentesi graffe e 2 numeri dopo la virgola
                # 16 ott 2025 aggiunte parentesi graffe sulla stessa riga
                # 16 ott 2025 se ci sono le 3 virgolette iniziali NON E' NECESSARIO AGGIUNGERE LE VIRGOLETTE FINALI !
                # 16 ott 2025 aggiunto 3<20 (ha venduto non appena ha comprato)



            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_ma25_sotto_ma200 < -2.00

                and delta_1_69_39 < delta_2_69_39
                and deviation_sell < -0.06
                and ma3_last < ma10_last

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago
                and ma3_last < ma3_2_min_ago
                and ma5_last < ma5_3_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            ):

                sell = f"""SELL CS - DOLCE ATTESA 270 sec E dev sell < -0.06 and ma13 < and con 450 < MA GIORNO ! - r 16694 B2 Y2 Ay
                deviation_ma25_sotto_ma200 {deviation_ma25_sotto_ma200:.2f}
                deviation_ma39 {deviation_ma39:.2f} 
                deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.2f} 
                deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.2f} 
                deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.2f} 
                deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.2f} 
                """
                action = "sell"
                

                # 4 feb 2022 con <-0.26 ha fatto -0.88% (dopo +4.29%)
                # 7 feb 2022 con <-0.345 e 270 sec ha fatto -0.38% - aumenta a 0.355 ! - eventualmente ci pensa la condizione CROLLO IMPROVVISO CHE FUNZIONA !
                # 17 set -0.57 da -0.47

                #  7 set 2004 ro cano e' tornato ! questa condizione interviene solo quando ma100 < ma100 30 min ago
                #  8 set 2024 aggiunta ma3 < ma3 2 min ago and ma2_last < ma2_2_min_ago
                # 17 set 2024  questa e' SENZA dev_sell CAZZO con 100<300 !

                #  2 ott 2024 SE e SOLTANTO SE delta_1_69_39 < delta_2_69_39 aggiungo deviation_sell < -0.05
                #  2 ott 2024 delta_1_69_39 < delta_2_69_39 significa che e' GIORNO
                #  3 ott 2024 aggiunta 3<10 ma bene cosi' !
                # 17 feb 2025 aggiunta and ma5_last < ma5_3_min_ago
                # 20 mar 2025 deviation_sell a -0.06 da -0.05 se deviation_ma25_sotto_ma200 < -2.00
                # 24 set 2025 messe parentesi graffe


            

            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma450_last > ma450_480_min_ago

                and ma200_last > ma200_120_min_ago

                and delta_1_69_39 > delta_2_69_39

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):
                sell = f"SELL CS - DOLCE ATTESA 270 sec and ma13 < and con 450 < E 100<100 30 min ago e 100 sopra 300 < 0.50 - r 16694 B2 Y2 Bax - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  3 mar 2025 aggiunta and ma450_last > ma450_480_min_ago
                # 18 ott 2025 aggiunte parentesi graffe 





            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma3_last > ma20_last
                and deviation_sell < -0.02

                and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
                and deviation_ma39 < -0.005

                and ma200_last > ma200_120_min_ago

                and delta_1_69_39 > delta_2_69_39

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):
                sell = f"SELL CS {ma3_last} {ma20_last} DOLCE ATTESA 270 sec and ma13< con 450< E 100<100 30 min MA 3>20 - r 16694 B2 Y2 Bayx"
                action = "sell"
                
                #  3 mar 2025 aggiunta and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
                #  3 mar 2025 aggiunta and deviation_ma39 < -0.005
                # 17 apr 2025 se ma3_last > ma20_last aggiungo deviation_sell < -0.02 ! (se 3 sta ancora sopra 20 statte calmo !)
                # 17 apr 2025 riprto ! se 3 sta ancora sopra 20 statte calmo !
                

            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma13_last <= ma13_2_min_ago
                and ma8_last <= ma8_2_min_ago

                and ma3_last < ma20_last

                and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
                and deviation_ma39 < -0.005

                and ma200_last > ma200_120_min_ago

                and delta_1_69_39 > delta_2_69_39

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                
                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):
                sell = "SELL CS - DOLCE ATTESA 270 sec and ma13 < and con 450 < E 100<100 30 min E 3<20 - r 16694 B2 Y2 Bayy"
                action = "sell"
                
                #  3 mar 2025 aggiunta and (ma450_last < ma450_480_min_ago or ma450_last < ma450_720_min_ago)
                #  3 mar 2025 aggiunta and deviation_ma39 < -0.005
                # 17 apr 2025 se ma3_last < ma20_last
                # 28 giu 2025 aggiunta and ma8_last <= ma8_2_min_ago








            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma200_last < ma200_120_min_ago
                and ma25_last > ma25_2_min_ago
                and deviation_sell < -0.0942

                and delta_1_69_39 > delta_2_69_39

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):

                sell = "SELL CS ZIA AMALIA ! - DOLCE ATTESA 270 sec and ma13 < MA ma25> and con 450< E dev_sell < -0.0942 - r 16694 B2 Y2 Bbx"
                action = "sell"

                #  8 ott 2024 se ma200_last < ma200_120_min_ago MA ma25_last > ma25_2_min_ago and deviation_sell < -0.09 ! statti calmo
                #  8 ott 2024 durante il crollo aggiunto dev sell < -0.0942 che prima non c' era.

            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and ma8_last <= ma8_2_min_ago

                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14
                and deviation_sell < -0.025
                and ma3_last < ma6_last
                and ma5_last < ma39_last
                
                and ma200_last < ma200_120_min_ago
                
                and delta_1_69_39 > delta_2_69_39

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):

                sell = f"SELL CS deviation_ma39 {deviation_ma39} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago} - DOLCE ATTESA 270 sec and ma13 < con 450 < and dev_sell < -0.025 - r 16694 B2 Y2 BB Yx"
                action = "sell"

                #  4 feb 2022 con <-0.26 ha fatto -0.88% (dopo +4.29%)
                #  7 feb 2022 con <-0.345 e 270 sec ha fatto -0.38% - aumenta a 0.355 ! 
                #  7 feb 2022 eventualmente ci pensa la condizione CROLLO IMPROVVISO CHE FUNZIONA !
                # 17 set -0.57 da -0.47

                #  7 set 2004 ro cano e' tornato ! questa condizione interviene solo quando ma100 < ma100 30 min ago
                #  8 set 2024 aggiunta ma3 < ma3 2 min ago and ma2_last < ma2_2_min_ago
                # 17 set 2024  questa e' SENZA dev_sell CAZZO con 100<300 ! 
                # 20 gen 2025 aggiunta 5<39
                
                # 20 gen 2025 tolta and ma25_last <= ma25_2_min_ago
                #  2 mar 2025 se deviation_ma100_sopra_o_sotto_ma100_10_min_ago > -0.14 cioe' ma100 comincia a perdere di meno allora
                #  2 mar 2025 aggiunta and deviation_sell < -0.02
                #  9 mar 2025 aggiunto 3 < 6 (e' fondamentale !)
                #  7 mag 2025 deviation_sell a -0.025 da -0.02
                # 15 mag 2025 aggiunte parentesi graffe per capire meglio.

                # 27 giu 2025 CHE BELLI I VALORI NELLE PARENTESI GRAFFE ! grazie compa caro !
                # 27 giu 2025 aggiunta and ma8_last <= ma8_2_min_ago perche' ha venduto mentre risaliva





            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.14
                and ma5_last < ma39_last
                
                and ma200_last < ma200_120_min_ago
                
                and delta_1_69_39 > delta_2_69_39

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma100_last < ma100_30_min_ago
                and ma13_last <= ma13_2_min_ago

                and deviation_ma100_sopra_ma200 > -0.70
                and deviation_ma100_sopra_ma300 < 0.50

                and ma3_last <= ma3_2_min_ago
                and ma2_last < last_trade_price
                and ma2_last <= ma2_2_min_ago
            
            ):

                sell = "SELL CS - DOLCE ATTESA 270 sec and ma13< con 450< - r 16694 B2 Y2 BB Yy"
                action = "sell"
                
                #  4 feb 2022 con <-0.26 ha fatto -0.88% (dopo +4.29%)
                #  7 feb 2022 con <-0.345 e 270 sec ha fatto -0.38% - aumenta a 0.355 ! 
                #  7 feb 2022 eventualmente ci pensa la condizione CROLLO IMPROVVISO CHE FUNZIONA !
                # 17 set -0.57 da -0.47

                #  7 set 2004 ro cano e' tornato ! questa condizione interviene solo quando ma100 < ma100 30 min ago
                #  8 set 2024 aggiunta ma3 < ma3 2 min ago and ma2_last < ma2_2_min_ago
                # 17 set 2024  questa e' SENZA dev_sell CAZZO con 100<300 ! 
                # 20 gen 2025 aggiunta 5<39
                
                # 20 gen 2025 tolta and ma25_last <= ma25_2_min_ago
                #  2 mar 2025 se deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.14 cioe' ma100 continua a perdere pesantemente allora
                #  2 mar 2025 ok cosi' - senza dev sell !
                # 15 ott 2025 crollo del 10 ottobre 2025 ! e' intervenuta questa e ha fatto -2.33


                

            elif (
                ma3_last < ma25_last
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.13
                
                and (delta_1_69_39 > delta_2_69_39 or ma100_last < ma100_30_min_ago or ma200_last < ma200_120_min_ago)

                and ma450_last < ma450_10_min_ago
                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and deviation_ma100_sopra_ma200 > -0.80
                
                and ma2_last < last_trade_price
                and deviation_sell < -0.50
            
            ):

                sell = "SELL crollo 1 - dopo crollo del 10 ottobre 2025 - r 16700"
                action = "sell"

                # 25 ott 2025 aggiunta dopo il crollo del 10 ottobre 2025 !



            elif (
                ma3_last < ma15_last
                
                and delta_1_69_39 > delta_2_69_39

                and ma100_last < ma300_last
                and ma100_last < ma200_last

                and ma2_last < last_trade_price
                and deviation_sell < -0.60
            
            ):

                sell = "SELL crollo 2 - dopo crollo del 10 ottobre 2025 - r 16701"
                action = "sell"

                # 25 ott 2025 aggiunta dopo il crollo del 10 ottobre 2025 !





            # 31 - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " "max hold time" - DOLCE ATTESA con ma13 <
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_ma100_sopra_ma200 < -0.70
                
                and deviation_sell < -0.50
                and ma13_last < ma13_2_min_ago
                
                and ma2_last < last_trade_price
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 31 - DOLCE ATTESA 270 sec con ma13 < and deviation < -0.50 con 100 sotto di molto 200 durante crollo ! - r 16719"
                action = "sell"
                
                # durante il crollo sono un po' piu' tollerante - paradossalmente ! HO ATTESO MOLTO QUESTO MOMENTO !

                
                        
            
            
            
            
            
            
            # 32 A - SELL condizione speciale ro cano VENDE " DOPO x MINUTI " and...
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds
                and deviation_sell < -0.49
                and ma8_last < ma50_last
                
                and ma2_last < ma2_2_min_ago
            ):

                sell = "SELL condizione speciale 32 - TEMPO e se ma8 < ma50 and deviation_sell < -0.49 - r 16720"
                action = "sell"
                        
                # ma13 troppo lenta !
                # max_hold_time_in_seconds = 360 = 6 min (con 8 min perdita di 0.70 %)
                
                
                
                
                
                
                
                
                
                
                
                
            # dopo 150 min fino a 240 min
            # dopo 240 min
            
            
            # 32 B1a - SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 14400 sec = 240 min con 5-90
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and deviation_sell > 0.80
                
                and (ma5_prev > ma50_prev and ma5_last < ma50_last)
                and deviation_ma5_sotto_ma300 > 0.25
                and deviation_ma5_sotto_ma300 < 0.40
                and ma300_last > ma300_120_min_ago
                and ma2_last < ma2_2_min_ago
          
            ):
                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 14400 sec = 240 min con 5-50 - r 16721"
                action = "sell"
                
                # 24 set 2022 ore 17:23
                
                
                
                
            # 32 B1a - SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 14400 sec = 240 min con 5-90
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and deviation_sell < 0.80
              
                and deviation_ma5_sotto_ma300 > 0.25
                and deviation_ma5_sotto_ma300 < 0.40
                and ma300_last > ma300_120_min_ago
                
                and (ma5_prev > ma150_prev and ma5_last < ma150_last)
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 14400 sec = 240 min con 5-150 - r 16722"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                #  3 nov 2022 5-125 da 5-100
                # 15 gen 2023 5-150 da 5-125
                
                
                
                
                
                
                
            # 32 B2b - SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 5-90
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and delta_1 < delta_2
                and deviation_sell < 0.01
                and deviation_ma5_sotto_ma300 < 0.25
                and ma300_last > ma300_120_min_ago
                
                and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                and ma2_last < ma2_2_min_ago
           
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 5-90 - r 16723"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 21 ott 2022 dev sell 0.11 da 0.10
                #  3 lug 2023 5-100 da 5-90
                
                
                
                
                
            # 32 B2b - SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 5-90
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and ma300_last > ma300_720_min_ago
                and delta_1 > delta_2
                and deviation_sell < -0.11
                and deviation_ma5_sotto_ma300 < 0.25
                and ma300_last > ma300_120_min_ago
                
                and (ma5_prev > ma100_prev and ma5_last < ma100_last)
                
                and ma2_last < ma2_2_min_ago
           
            ):

                sell = "SELL condizione speciale 32 ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 5-100 - r 16724"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 21 ott 2022 dev sell >0.11 da >0.10
                #  2 gen 2023 dev sell <0.05 da >0.11
                #  3 gen 2023 dev sell <-0.09 da <0.05
                # 1 lug 2023 5-100 da 5-90
                # 1 lug 2023 dev sell <-0.11 da <0.09
                
                
                
            # 32 SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 5-90
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and ma300_last < ma300_720_min_ago
                and delta_1 > delta_2
                and deviation_sell > 0.15
                and deviation_ma5_sotto_ma300 < 0.25
                and ma300_last > ma300_120_min_ago
                
                and (ma4_prev > ma86_prev and ma4_last < ma86_last)
                and ma18_last < ma18_2_min_ago
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -0.25
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 4-86 and macd_differenza_2_min_ago < -0.25 - r 16725 X"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 21 ott 2022 dev sell 0.11 da 0.10
                # 20 feb 2023 18 < 18 2 min ago
                # 21 ott 2023 and macd_differenza_2_min_ago < -0.25


                
            # 32 SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 5-90
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and ma300_last < ma300_720_min_ago
                and delta_1 > delta_2
                
                and deviation_ma5_sotto_ma300 < 0.30
                and ma300_last > ma300_120_min_ago
                
                and (ma3_prev > ma300_prev and ma3_last < ma300_last)
                and ma18_last <= ma18_2_min_ago
                and ma2_last <= ma2_2_min_ago
                
            ):

                sell = "SELL CS 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min e fino a 240 min con 3-300 - r 16725 Y"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 21 ott 2022 dev sell 0.11 da 0.10
                # 20 feb 2023 18 < 18 2 min ago
                #  8 OTT 2025 piccolissima modifica
                
               
                
                
            # 32 SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 240 min con 22-300
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and deviation_sell < -0.10
                
                and deviation_ma5_sotto_ma300 < 0.25
                and ma300_last > ma300_120_min_ago
                
                and (ma20_prev > ma300_prev and ma20_last < ma300_last)
                and ma2_last < ma2_2_min_ago
             
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 240 min con 20-300 ! and dev_sell < -0.10 - stai calmo - r 16729"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 12 ott 2022 10-300 da 5-125
                # 12 ott 2022 22-300 !
                # 27 ott 2022 dev sell -0.12 da < 0.10 
                # dopo 150 min faccio cominciare i binari !
                # 29 mag 2023 20-300 da 22-300 !
                # 29 mag 2023 dev_sell < -0.10 da < -0.12
                
                
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                and deviation_ma100_sopra_ma300 > 0.20
                
                and ma300_last < ma300_120_min_ago
                
                and (ma8_prev > ma300_prev and ma8_last < ma300_last)
                and ma2_last < ma2_2_min_ago
           
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 240 min con 8-300 - r 16730"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                #  3 nov 2022 5-300 da 5-90
                # 24 apr 2023 8-300 da 5-300
                
                
                
            # SELL condizione speciale 32 B ROOT DOWN DEEP - maddog VENDE dopo 150 min = 9000 sec e fino a 240 min con 5-300 GIORNO ! cazzo
          
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                
                and delta_300_100 < delta_300_100_60_min
                and deviation_ma100_sopra_ma300 < 0.20
                and ma300_last > ma300_120_min_ago
                
                and (ma5_prev > ma300_prev and ma5_last < ma300_last)
                and deviation_sell < -0.12
                and ma2_last < ma2_2_min_ago
                and macd > -10
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - maddog VENDE dopo 150 min = 9000 sec e fino a 240 min con 5-300 GIORNO ! cazzo con macd > -10 - r 16731 a"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                #  3 nov 2022 5-300 da 5-200
                
                # 27 set 2023 se macd > -10 vende con 5-300 !
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                
                and delta_300_100 < delta_300_100_60_min
                and deviation_ma100_sopra_ma300 < 0.20
                and ma300_last > ma300_120_min_ago
                
                and (ma5_prev > ma200_prev and ma5_last < ma200_last)
                and deviation_sell < -0.05
                
                and ma2_last < ma2_2_min_ago
                and macd < -10
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - maddog VENDE dopo 150 min = 9000 sec e fino a 240 min con 5-200 GIORNO ! cazzo con macd < -10 - r 16731 b"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                #  3 nov 2022 5-300 da 5-200
                
                # 27 set 2023 se macd < -10 vende con 5-200 !
                
                
                
                
                
            # SELL condizione speciale 32 B ROOT DOWN DEEP - maddog VENDE dopo 150 min = 9000 sec e fino a 240 min con 5-200 NOTTE !
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                
                and delta_300_100 > delta_300_100_60_min
                and deviation_ma100_sopra_ma300 < 0.20
                and ma300_last > ma300_120_min_ago
                and ma54_last > ma54_15_min_ago
                and ma13_last < ma78_last
                and (ma5_prev > ma300_prev and ma5_last < ma300_last)
                and ma5_last < ma20_last
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - maddog VENDE dopo 150 min = 9000 sec e fino a 240 min con 5-300 NOTTE ! - r 16732"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                #  3 nov 2022 5-300 da 5-200
                # 17 nov 2022 deve essere anche 10<78
                # 18 nov 2022 13-78
                # 31 lug 2023 5-300 da 5-200
                # 11 ago 2022 aggiunta macd <
            
            
            # SELL condizione speciale 32 B ROOT DOWN DEEP - SELL> 150 min = 9000 sec SE GUADAGNA > 0.50 e fino a 240 min con 5-200 NOTTE !
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                
                and delta_300_100 > delta_300_100_60_min
                and deviation_ma100_sopra_ma300 < 0.20
                and ma300_last > ma300_120_min_ago
                and ma54_last < ma54_15_min_ago
                and ma10_last < ma78_last
                
                and (ma5_prev > ma200_prev and ma5_last < ma200_last)
                and ma2_last < ma2_2_min_ago
                and deviation_sell > 0.50
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - SELL> 150 min = 9000 sec SE GUADAGNA > 0.50 e fino a 240 min con 5-200 NOTTE ! - r 16733 A"
                action = "sell"
                        
                # vedi RCCR 19 GEN 2023 ore 8:35
                
                
                
                
            # SELL condizione speciale 32 B ROOT DOWN DEEP - maddog VENDE dopo 150 min = 9000 sec e fino a 240 min con 8-300 NOTTE !
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                
                and delta_300_100 > delta_300_100_60_min
                and deviation_ma100_sopra_ma300 < 0.20
                and ma300_last > ma300_120_min_ago
                and ma54_last < ma54_15_min_ago
                and ma10_last < ma78_last
                and (ma8_prev > ma300_prev and ma8_last < ma300_last)
                and ma2_last < ma2_2_min_ago
                and deviation_sell < -0.12
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - maddog VENDE dopo 150 min = 9000 sec e fino a 240 min con 8-300 NOTTE ! - r 16733 B"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                #  3 nov 2022 5-300 da 5-200
                # 17 nov 2022 deve essere anche 10<78
                # 11 dic 2022 8-225 da 5-200
                # 26 dic 2022 8-250 da 8-225
                #  4 gen 2023 aggiunta dev sell < -0.10 vedi 4 gen 2023 ore 1:16
                # 21 mag 2023 8-300 da 8-250
                # 31 lug 2023 -0.12 da -0.10
                
                
            # SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 240 min con 5-90
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                
                and deviation_ma100_sopra_ma300 < 0.20
                and deviation_sell < -0.15
                and ma300_last < ma300_120_min_ago
              
                and (ma5_prev > ma300_prev and ma5_last < ma300_last)
                
                and ma2_last < ma2_2_min_ago
           
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 240 min con 5-90 - r 16734 A"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 26 ottobre 2022 dev sell -0.15 da -0.10 vedi 15:40 del 25 ottobre !
                
                
                
                
            
            # SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 240 min
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_90
                and seconds_since_last_trade < max_hold_time_in_seconds_sell_5_180
                
                and deviation_ma100_sopra_ma300 < 0.20
                and deviation_sell < -0.15
                
                and (ma3_prev > ma150_prev and ma3_last < ma150_last)
                
                and ma2_last < ma2_2_min_ago
           
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 150 min = 9000 sec e fino a 240 min - r 16734 B"
                action = "sell"
                
                
                
                
                
            ############ attenzione ! vedi giorno 7 novembre 2022 ore 21:34 MADDOG NON HA VENDUTO CON UN GUADAGNO DELL 1% MENTRE ma300 scendeva da 6 ore
            
            # 32 SELL condizione speciale ROOT DOWN DEEP - ro cano VENDE dopo 240 min = 9000 sec con 5-180
            
            elif (
                
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_180
                and ma300_last > ma300_301_min_ago
                
                and deviation_sell < -0.09
                and deviation_ma5_sotto_ma300 < 0.25
                and ma300_last > ma300_120_min_ago
                
                and (ma8_prev > ma300_prev and ma8_last < ma300_last)
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 240 min con 8-300 and macd < macd 2 min ago - r 16735"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 21 ott 2022 dev sell 0.11 da 0.10
                # 29 dic 2022 8-225 da 5-180
                # 29 gen 2023 8-250 da 8-225
                # 24 ago 2023 8-300 da 8-250
                # 24 ago 2023 macd < macd 2 min ago
                # forse in futuro aggiungere macd < -5 deve avere una certa forza ( al contrario ) per vendere
                
            # 32 A
            
            elif (
                
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_180
                and ma300_last < ma300_301_min_ago
                and deviation_sell > 0.80
                
                and (ma3_prev > ma69_prev and ma3_last < ma69_last)
                and ma300_last > ma300_120_min_ago
                
                and ma2_last < ma2_2_min_ago
           
            ):

                sell = "SELL condizione speciale - ro cano VENDE dopo 240 min con 3-69 SE ma300 scende da 5 ore e se guadagna almeno 0.80 - r 16736"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 21 ott 2022 dev sell 0.11 da 0.10
                # prendi e porta a casa cazzo se 300 scende da 5 ore ! e stai guadagnando > 0.80 % - potrebbe essere un rimbalzo.
                
                
                
            # 32 B 
            
            elif (
                
                seconds_since_last_trade > max_hold_time_in_seconds_sell_5_180
                and deviation_sell < -0.10
                and deviation_ma5_sotto_ma300 < 0.25
                and ma300_last > ma300_120_min_ago
                
                and (ma5_prev > ma240_prev and ma5_last < ma240_last)
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd < -6
            ):

                sell = "SELL condizione speciale 32 B ROOT DOWN DEEP - ro cano VENDE dopo 240 min con 5-240 con macd < and macd < -6 - r 16737"
                action = "sell"
                        
                # 24 set 2022 ore 17:23
                # 11 ott 2022 dev sell 0.10 da 0.15
                # 21 ott 2022 dev sell 0.11 da 0.10
                #  1 ago 2023 dev sell -0.10 da +0.10
                # 11 ago 2023 macd < 2 min ago
                # 11 ago macd < -6
                
                
            
            
            
            ################################################################################################################################## POCHI MALEDETTI E SUBITO
            
            # OGGI 25 MAGGIO 2023 - IMPORTANTE !
            
            # nelle prime 2 ore media bassa
            # POCHI MALEDETTI E SUBITO tra 0.70 e 1.05 di guadagno INTANTO TE LI PRENDI. con 3-13
             
            # dopo 2 ore 
            # POCHI MALEDETTI E SUBITO tra 0.80 e 1.05 di guadagno INTANTO TE LI PRENDI. con 3-15
            
            
            # 1
            
            elif (
                seconds_since_last_trade > 0 and seconds_since_last_trade < 7200
                and ma100_last > ma100_301_min_ago
                and deviation_ma10__diviso_ma10_5_ore_ago > 1.50
                
                and ma3_last < ma49_last
                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.40
                
                and deviation_sell > 0.70
                and deviation_sell < 1.50
                
                and ma2_last <= ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -2
            ):    
                sell = "SELL cond PMS da 0 a 120 min con ma100> 5 ore e 3-49 E con dev_sell 0.70 - 1.50 e macd <  - PRENDILI ! - r 16750 A1X"
                action = "sell"
                
                # 24 ago 2023 and macd < -5
                # 10 set 2024 AGGIUNTA and macd_differenza_2_min_ago < -2 AL POSTO DI MACD deve essere <-5
                # 19 gen 2025 3-39 da 3-30
                # 11 mar 2025 3-49 da 3-39 ( ma100 cresce da 5 ore! - non e' SUBITO !)

            
            elif (
                seconds_since_last_trade > 0 and seconds_since_last_trade < 7200
                and ma100_last < ma100_301_min_ago
                and deviation_ma10__diviso_ma10_5_ore_ago > 1.50
                and ma3_last < ma20_last
                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30
                
                and deviation_sell > 0.70
                and deviation_sell < 1.05
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd < -5
            ):    
                sell = "SELL condizione POCHI MALEDETTI E SUBITO da 0 a 120 min con ma100 < 5 ore e 3-20 E dev_sell 0.70 - 1.05 e macd < and macd < -5 - PRENDILI ! - r 16750 A1y"
                action = "sell"
                
                # 24 ago 2023 and macd < -5
          
          
            # 2

            elif (
                seconds_since_last_trade > 0 and seconds_since_last_trade < 3600
                and deviation_ma10__diviso_ma10_5_ore_ago < 1.50

                and ma3_last < ma39_last
                and ma100_last > ma200_last

                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30
                
                and deviation_sell > 0.70
                and deviation_sell < 1.05
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and ma2_differenza_2_min_ago < -3
            ):    
                sell = "SELL PMS con 3-39 da 0 a 60 min se 100>200 E con dev_sell 0.70 - 1.05 and macd < - INTANTO TE LI PRENDI - r 16750 A2Xx"
                action = "sell"

                #  3 feb 2025 3-39 da 3-28 se 100>200



            elif (
                seconds_since_last_trade > 0 and seconds_since_last_trade < 3600
                and deviation_ma10__diviso_ma10_5_ore_ago < 1.50

                and ma3_last < ma39_last
                and ma100_last < ma200_last

                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30
                
                and deviation_sell > 0.70
                and deviation_sell < 1.05
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and ma2_differenza_2_min_ago < -3
            ):    
                sell = "SELL PMS (0-60 min) con 3-39 se 100<200 E con dev_sell 0.70 - 1.05 and macd < - INTANTO TE LI PRENDI - r 16750 A2Xy"
                action = "sell"
                
                # pochi 0.80 - 1.20
                # maledetti 
                # subito da 0 a 120 minuti - dopo intervengono le medie piu' lunghe ! non piu' ma13 !
                
                # importante
                # con aggiunta deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago <1.30 che cosa fa ?
                # compra pochi maledetti e subito la prima volta
                # ma se continua a salire dopo che ha fatto il primo PMS non interviene piu' ed entrano in azione altre medie piu' lunghe
                # altrimenti e' un continuo 3-10
                # 15 mag 2023 3-13 da 3-11 
                # 15 mag 2023 0.80 - 1.05 da 0.80 - 1.20
                # 15 mag 2023 0.70 - 1.05 da 0.80 - 1.05
                #  7 lug 2023 0.75 - 1.05 da 0.70 - 1.05
                #  7 lug 2023 0.75 - 1.05 da 0.70 - 1.05
                #  7 lug 2023 3-28 da 3-13
                # 10 ago 2023 aggiunta and ma2_differenza_2_min_ago < -3
                # 20 nov 2023 and deviation_sell > 0.70 da > 0.75
                # 11 mar 2025 3-33 da 3-28
                # 15 ott 2025 3-39 da 3-33


            

            elif (
                seconds_since_last_trade > 3601 and seconds_since_last_trade < 7200
                and delta_1 < delta_2

                and deviation_ma10__diviso_ma10_5_ore_ago < 1.50
                and ma3_last < ma69_last
                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30
                
                and deviation_sell > 0.75
                and deviation_sell < 1.05
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -0.75
            ):    
                sell = "SELL PMS ma non troppo (60-120 min) con 3-59 E dev_sell 0.75 - 1.05 e macd < - INTANTO TE LI PRENDI - r 16750 A2 Y1"
                action = "sell"

                #  9 set 2024 aggiunta diff macd < -0.75
                # 24 mar 2025 3-49 da 3-39 
                # 14 apr 2025 3-59 da 3-49 se delta_1 < delta_2
                # 18 ott 2025 3-69 da 3-59


            elif (
                seconds_since_last_trade > 3601 and seconds_since_last_trade < 7200
                and delta_1 > delta_2

                and deviation_ma10__diviso_ma10_5_ore_ago < 1.50
                and ma3_last < ma49_last
                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30
                
                and deviation_sell > 0.75
                and deviation_sell < 1.05
                
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -0.75
            ):    
                sell = "SELL PMS ma non troppo (60-120 min) con 3-39 E dev_sell 0.75 - 1.05 e macd < - INTANTO TE LI PRENDI - r 16750 A2 Y2"
                action = "sell"

                #  9 set 2024 aggiunta diff macd < -0.75
                # 24 mar 2025 3-49 da 3-39
                # 14 apr 2025 se delta_1 > delta_2 ok cosi'. sempre per adesso.

          
            
            elif (
                seconds_since_last_trade > 7200
                and ma300_last > ma450_last
                and ma5_last < ma59_last

                and ma2_differenza_ma4 < -10
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd < -12
              
                
                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30
                and ma450_last < ma450_720_min_ago
                
                and deviation_sell > 0.75
                and deviation_sell < 1.10
                
            ):    
                sell = "SELL PMS >120 min con 300>450 e con 5-59 E con dev_sell 0.75 - 1.10 and macd < - INTANTO TE LI PRENDI - r 16750 B1"
                action = "sell"

                # 28 apr 2025 se ma300_last > ma450_last lascia correre ! stai tranquillo
                # 28 apr 2025 se ma300_last > ma450_last dev sell a 5-59 da 3-39



            elif (
                seconds_since_last_trade > 7200
                and ma300_last < ma450_last
                and ma3_last < ma59_last

                and ma2_differenza_ma4 < -10
                and ma2_last < ma2_2_min_ago
                and macd < macd_2_min_ago
                and macd < -12
              
                
                and deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30
                and ma450_last < ma450_720_min_ago
                
                and deviation_sell > 0.75
                and deviation_sell < 1.10
                
            ):    
                sell = "SELL PMS >120 min con 300<450 e con 3-59 E con dev_sell 0.75 - 1.10 and macd < - INTANTO TE LI PRENDI - r 16750 B2"
                action = "sell"
                
                # pochi 0.80 - 1.20
                # maledetti 
                # subito da 0 a 120 minuti - dopo intervengono le medie piu' lunghe ! non piu' ma13 !
                
                # importante
                # con aggiunta deviation_ma3_di_adesso_diviso_ma3_di_90_min_ago < 1.30 che cosa fa ?
                # compra pochi maledetti e subito la prima volta
                # se continua a salire dopo entrano in azione altre medie piu' lunghe
                # altrimenti e' un continuo 3-10
                # 15 mag 2023 3-13 da 3-11 
                # 15 mag 2023 0.80 - 1.05 da 0.70 - 1.20
                #  1 giu 2023 0.70 - 1.10 da 0.80 - 1.05
                
                # 17 mag 2023 ATTENZIONE ! dopo 10860 pochi maledetti e subito vende SOLO SE il trend di lungo periodo e' ribassista. 
                # 17 mag 2023 se e' rialzista lascia correre !
                #  6 giu 2023 0.75 - 1.10 da 0.70 - 1.05
                #  6 giu 2023 3-20 da 3-13
                #  8 lug 2023 aggiunto and macd < -12
                #  11 ago 2023 3-28 da 3-20 dopo 3 ore cazzo (non e' piu' subito)
                #  17 nov 2023 aggiunta and ma2_differenza_ma4 < -10
                # 31 gen 2025  3-39 da 3-28
                # 28 apr 2025 se anche ma300_last < ma450_last ok cosi'.
                # 14 mag 2025 3-59 da 3-39 dopo 120 min non e' subito !
                
                
                
            # 5 - SELL condizione speciale POCHI MALEDETTI E SUBITO QUANDO SALE FORTE ( cerca di inibirlo ) - dedicated to comparo meo
            elif (
                ma3_last < ma33_last
                and ma450_last > ma450_360_min_ago
                
                and deviation_ma100_sopra_ma200 > 0.40    
                and ma200_last > ma200_60_min_ago
                    
                and deviation_sell > 0.70
                and deviation_trend_ma100 < 1.00
                and deviation_pochi_maledetti > 0.25
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = "SELL CS - PMS QUANDO SALE FORTE 3-28 ( cerca di inibirlo ) con ma200> e con dev_sell > 0.70 - r 16767 a"
                action = "sell"

                #  7 mar 2024 aggiunto and ma450_last > ma450_360_min_ago
                #  7 mar 2024 3-33 da 3-28 LASCIA CORRERE ! vattene a pescare.

            elif (
                ma3_last < ma28_last
                and ma450_last < ma450_360_min_ago
                
                and deviation_ma100_sopra_ma200 > 0.40    
                and ma200_last > ma200_60_min_ago
                    
                and deviation_sell > 0.70
                and deviation_trend_ma100 < 1.00
                and deviation_pochi_maledetti > 0.25
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = "SELL CS - POCHI MALEDETTI E SUBITO QUANDO SALE FORTE 3-28 ( cerca di inibirlo ) con ma200> e con dev_sell > 0.70 - r 16767 b"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                # incredibile questa and deviation_trend_ma100 < 1.00 - se ma100 sale "forte" da 60 min non deve intervenire sell 3-9

                #  7 mar 2024 aggiunto and ma450_last < ma450_360_min_ago

                
                
            # 6 - SELL condizione speciale POCHI MALEDETTI E SUBITO QUANDO SALE PIANO con ma200 > MA ma100 NON DEVE SALIRE TROPPO ! - dedicated to comparo meo
            
            elif (
                ma3_last < ma39_last
                and deviation_ma100_sopra_ma200 < 0.40      
                and ma200_last > ma200_60_min_ago
                    
                and deviation_sell > 0.70
                and deviation_sell < 0.99
                and deviation_trend_ma100 < 1.00
                and deviation_pochi_maledetti > 0.25
                and ma2_last > ma100_last
                
            ):    
                sell = "SELL condizione speciale 34 b - POCHI MALEDETTI E SUBITO 3-39 QUANDO SALE PIANO quando ma200 > e con dev_sell > 0.70 and < 0.99 - r 16789"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                # incredibile questa and deviation_trend_ma100 < 1.00 - se ma100 sale "forte" da 60 min non deve intervenire sell 3-9
                # > estate 3-39 da 3-25    
                
                
            
            # 7 SELL condizione speciale POCHI MALEDETTI E SUBITO con ma200 < - dedicated to comparo meo
            
            elif (
                ma3_last < ma20_last 
                and ma200_last < ma200_60_min_ago
                and deviation_sell > 0.90
                and deviation_sell < 1.30
                and deviation_pochi_maledetti > 0.70
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = "SELL cond. special 35 - POCHI MALEDETTI E SUBITO 3-20 quando ma200 < e con dev_sell > 0.90 and < 1.30 - dedicated to comparo meo - r 16809"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                
                
                
                
            # 8 SELL condizione speciale POCHI MALEDETTI E SUBITO ma non troppo ! 3-18 quando ma200 < e con deviation_sell > 1.31 and < 2.50
            
            elif (
                ma3_last < ma18_last 
                and ma200_last < ma200_60_min_ago
                and deviation_sell > 1.31
                and deviation_sell < 2.50
                and deviation_pochi_maledetti > 0.70
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = "SELL condizione speciale 36 - POCHI MALEDETTI E SUBITO ma non troppo ! 3-18 quando ma200 < e con dev_sell > 1.31 and < 2.50 - r 16828"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                # 14 giu 2022 3-18 da 3-9
                
                
            
            
            
            
            
            # 9 POCHI MALEDETTI E SUBITO ma non troppo 3-28 mentre sale
            
            elif (
                ma3_last < ma28_last 
                and ma200_last < ma200_60_min_ago
                and deviation_ma100_sopra_ma300 > 0.30
                
                and deviation_sell > 2.51
                and deviation_pochi_maledetti > 0.70
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = f"SELL condizione speciale 37 - POCHI MALEDETTI E SUBITO ma non troppo mentre sale 3-28 quando ma200 < e con deviation > 2.51 - r 16852 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                # 23 ott 2025 aggiunte pg
                
                
                
            # 10 POCHI MALEDETTI E SUBITO ma non troppo mentre scende
            
            elif (
                ma3_last < ma18_last
                and delta_150_100 < delta_150_100_60_min
                and ma200_last < ma200_60_min_ago
                and deviation_ma100_sopra_ma300 < 0.30
                
                and deviation_sell > 2.51
                and deviation_pochi_maledetti > 0.70
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = f"SELL condizione speciale 38 - POCHI MALEDETTI E SUBITO 3-18 quando ma200 < e con deviation > 2.51 - dedicated to comparo meo - r 16872 b1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                # 12 gen 2023 3-18 da 3-8 con dppio delta 150-100 giorno
                # 23 ott 2025 aggiunte pg


                
                
                
            # 11 POCHI MALEDETTI E SUBITO ma non troppo mentre scende
            
            elif (
                ma3_last < ma10_last
                and delta_150_100 > delta_150_100_60_min
                and ma200_last < ma200_60_min_ago
                and deviation_ma100_sopra_ma300 < 0.30
                
                and deviation_sell > 2.51
                and deviation_pochi_maledetti > 0.70
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = f"SELL condizione speciale 38 - P M e S con 3-10 quando ma200 < e con deviation > 2.51 - dedicated to comparo meo - r 16872 B2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)

                #  8 mar 2024 che spettacolo ! faccio comunque una piccolissima variazione : vende con 3-10 da 3-8 
                # 23 ott 2025 aggiunte pg
                
            
            
            
            # 12 POCHI MALEDETTI E SUBITO ma non troppo mentre scende > ESTATE 
            
            elif (
                ma5_last < ma39_last
                and ma300_last > ma300_120_min_ago
                
                and (ma3_prev > ma300_prev and ma3_last < ma300_last)
                and deviation_sell > 0.90
                
                and ma2_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = f"SELL condizione speciale 39 5-39 - POCHI MALEDETTI E SUBITO ma non troppo mentre scende > ESTATE  e con deviation > 0.90 - r 16873 A - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                    
                # and ma2_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                # 23 ott 2025 aggiunte pg



                
                
            # 13 POCHI MALEDETTI E SUBITO ma non troppo mentre scende > ESTATE 2022
            
            elif (
                ma5_last < ma39_last
                and ma300_last < ma300_120_min_ago
                
                and (ma3_prev > ma300_prev and ma3_last < ma300_last)
                
                and deviation_sell > 0.90
                
                and ma3_last > ma100_last
                and ma2_last < ma2_2_min_ago
            ):    
                sell = f"SELL condizione speciale 39 5-39 - POCHI MALEDETTI E SUBITO ma non troppo mentre scende > ESTATE 2022 e con deviation > 0.90 - r 16873 B - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                    
                # and ma3_last > ma100_last (altrimenti vende durante il crollo con la ma3-ma9)
                # 27 mag 2025 5-39 da 5-33
                # 23 ott 2025 aggiunte pg


          


            # 14 POCHI MALEDETTI E SUBITO ma non troppo mentre scende > ESTATE 2023

            elif (
                deviation_sell > 0.80
                and ma300_last > ma300_120_min_ago
                and ma5_last < ma200_last

                and ma39_last > ma39_15_min_ago
                and seconds_since_last_trade > 7200
                and ma5_last < ma5_12_min_ago
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -1.50
            ):    
                sell = f"SELL C.S. PMS (ma non troppo!) con 300>300 120 min ago e dev>0.80 E macd_diff_2_min_ago < -1.50 - r 16873 C1 X1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 21 gen 2025 lascia correre perdio se 300>300 120 min ago !
                # 23 ott 2025 aggiunte pg



            elif (
                deviation_sell > 0.80
                and ma300_last < ma300_120_min_ago
                and ma3_last < ma36_last

                and ma39_last > ma39_15_min_ago
                and seconds_since_last_trade > 7200
                and ma5_last < ma5_12_min_ago
                
                
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -1.50
            ):    
                sell = f"SELL C.S. PMS con 300 < 300 120 min ago e dev > 0.80 E macd_diff_2_min_ago < -1.50 - r 16873 C1 X2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 27 set 2023 macd < macd 2 min ago 
                # 27 set 2023 and macd_differenza_2_min_ago < -1
                #  1 nov 2023 ma5_11_min_ago da ma5_12_min_ago
                # 11 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                # 11 gen 2024 3-36 da 3-33 dopo 2 ore di rialzo non e' proprio un pochi maledetti e SUBITO !
                
                #  6 mar 2024 se ma39_last > ma39_15_min_ago allora vende con ma5_last < ma5_12_min_ago ( dico 12 min invece di 11 )
                #  3 ott 2024 and macd_differenza_2_min_ago < -1.50 da <-1.00
                # 23 ott 2025 aggiunte pg









            elif (
                deviation_sell > 0.80
                and ma300_last > ma450_last
                and ma4_last < ma59_last

                and ma39_last < ma39_15_min_ago
                and seconds_since_last_trade > 7200
                and ma5_last < ma5_11_min_ago
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -1
            ):    
                sell = f"SELL P M e S (ma non troppo !) con 4-59 (> 120 min ) e con dev > 0.80 e ma5_11_min_ago - r 16873 C1 Y1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 27 set 2023 macd < macd 2 min ago 
                # 27 set 2023 and macd_differenza_2_min_ago < -1
                #  1 nov 2023 ma5_11_min_ago da ma5_12_min_ago
                # 11 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                # 11 gen 2024 3-36 da 3-33 dopo 2 ore di rialzo non e' proprio un pochi maledetti e SUBITO !

                #  6 mar 2024 se ma39_last < ma39_15_min_ago allora vende con ma5_last < ma5_11_min_ago ( dico 11 min )
                # 27 gen 2025 sell con 3-49 da 3-36 se ma300_last > ma450_last
                # 14 apr 2025 ok cosi'. sempre per adesso. ma forse sarebbe meglio 3-59
                # 14 apr 2025 in ogni caso modificato, sempre per adesso, a 4-49 da 3-39
                # 11 ago 2025 a 4-59 da 4-49
                # 23 ott 2025 aggiunte pg



            elif (
                deviation_sell > 0.80
                and ma300_last < ma450_last
                and ma3_last < ma39_last

                and ma39_last < ma39_15_min_ago
                and seconds_since_last_trade > 7200
                and ma5_last < ma5_11_min_ago
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -1
            ):    
                sell = f"SELL P M e S (ma non troppo !) con 3-39 (> 120 min ) e con dev > 0.80 e ma5_11_min_ago - r 16873 C1 Y2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 27 set 2023 macd < macd 2 min ago 
                # 27 set 2023 and macd_differenza_2_min_ago < -1
                #  1 nov 2023 ma5_11_min_ago da ma5_12_min_ago
                # 11 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.018
                # 11 gen 2024 3-36 da 3-33 dopo 2 ore di rialzo non e' proprio un pochi maledetti e SUBITO !

                #  6 mar 2024 se ma39_last < ma39_15_min_ago allora vende con ma5_last < ma5_11_min_ago ( dico 11 min )
                # 27 gen 2025 sell con 3-39 da 3-36 se ma300_last < ma450_last
                # 23 ott 2025 aggiunte pg




            
            elif (
                deviation_sell > 0.80
                and ma3_last < ma78_last

                and seconds_since_last_trade < 7200
                and ma5_last < ma5_11_min_ago

                and ma100_last > ma300_last

                
                and ma2_last < ma2_2_min_ago
                
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -1
            ):    
                sell = f"SELL CS PMS (ma non troppo !) con 3-78 se 100>300 e con dev > 0.80 e con ma5_11_min_ago - r 16873 C2 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 27 set 2023 macd < macd 2 min ago 
                # 27 set 2023 and macd_differenza_2_min_ago < -1
                #  1 nov 2023 ma5_11_min_ago da ma5_12_min_ago
                
                #  8 mar 2024 3-39 da 3-28
                #  3 feb 2025 3-50 da 3-39 se 100<300
                # 30 mag  2025 3-78 da 3-50
                # 23 ott 2025 aggiunte pg




            elif (
                deviation_sell > 0.80
                and seconds_since_last_trade < 7200
                and ma5_last < ma5_11_min_ago

                and ma100_last < ma300_last

                and ma3_last < ma39_last
                and ma2_last < ma2_2_min_ago
                
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -1
            ):    
                sell = f"SELL CS PMS (ma non troppo !) con 3-39 se 100<300 e con dev > 0.80 e con ma5_11_min_ago - r 16873 C2 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 27 set 2023 macd < macd 2 min ago 
                # 27 set 2023 and macd_differenza_2_min_ago < -1
                #  1 nov 2023 ma5_11_min_ago da ma5_12_min_ago
                
                #  8 mar 2024 3-39 da 3-28
                #  3 feb 2025 confermo 3-39 se 100<300
                # 23 ott 2025 aggiunte pg

          
            
            # 15 - POCHI MALEDETTI E SUBITO con deviation > 5.01 e macd < -35
            
            elif (
                deviation_sell > 5.01
                
                and ma4_last < ma20_last
                and ma2_last < ma2_2_min_ago
                
                and macd < macd_2_min_ago
                and macd < -35
            ):    
                sell = f"SELL condizione speciale 41 4-20 - POCHI MALEDETTI E SUBITO se con deviation > 5.01 e macd < -35 ! - r 16874 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 23 ott 2025 aggiunte pg

          

          
            # 16 POCHI MALEDETTI E SUBITO con deviation > 1.01 e macd < -10 e MACD DIFFERENZA < -25


            elif (
                deviation_sell > 0.81
                and deviation_sell < 1.25

                and ma300_last > ma450_last
                and ma300_last > ma300_301_min_ago
                and delta_1 > delta_2

                and ma3_last < ma50_last
                and ma3_last < ma18_last
                and ma2_last < ma5_last
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and ma2_differenza_2_min_ago < -5
                and macd < macd_2_min_ago
                and macd < 20
                and macd_differenza_3_min_ago < -7
                
            ):    
                sell = f"SELL CS - PMS + NOTTE con 3-50 e ma300 > 5 ore e dev 0.81 - 1.25 e macd < 16 e MACD diff_5_min_ago < -9 - r 16875 A1X - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  7 mar 2024 fatta modifica
                #  8 mar 2024 tolto dev 3-18 < -0.056 solo tra dev sell > 0.81 e dev sell < 1.25 e aggiunto sell con 3-39
                #  9 set 2024 modificato da 3-39 a 3-50
                #  6 feb 2025 aggiunta NOTTE ! 
                #  6 feb 2025 se 300 sale da 5 ore vendi quando la ma100 comincia a curvare verso il basso ! lasciala correre !
                # 23 ott 2025 aggiunte pg





            elif (
                deviation_sell > 1.25
                and ma300_last > ma300_301_min_ago
                and deviation_ma100_sopra_ma450 > 1.75
                and ma3_last < ma39_last
                
                and deviation_ma3_sopra_ma18 < -0.056
                and ma3_last < ma30_last
                and ma2_last < ma5_last
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and ma2_differenza_2_min_ago < -5
                and macd < macd_2_min_ago
                and macd < 20
                and macd_differenza_3_min_ago < -7
                
            ):    
                sell = f"SELL CS - PMS con ma300 > 5 ore 3-30 e dev > 1.25 e macd < 16 e MACD diff_5_min_ago < -9 e dev 3-18 < -0.056 - r 16875 A2x - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  7 mar 2024 fatta modifica vedi and deviation_ma100_sopra_ma450 > 1.75
                #  4 apr 2025 and ma3_last < ma39_last da 3-30 ( ma dopo 5 ore di rialzo NON E' SUBITO)  - stai tranquillo.
                #  4 apr 2025 le altre cose vanno bene
                # 23 ott 2025 aggiunte pg




            elif (
                deviation_sell > 1.25
                and ma300_last > ma300_301_min_ago
                and deviation_ma100_sopra_ma450 < 1.75
                and ma5_last < ma100_last
                
                and deviation_ma3_sopra_ma18 < -0.056
                
                and ma2_last < ma5_last
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and ma2_differenza_2_min_ago < -5
                and macd < macd_2_min_ago
                and macd < 20
                and macd_differenza_3_min_ago < -7
                
            ):    
                sell = f"SELL CS - PMS ma se ma300>5 ore non troppo ! e con 5-100 e dev > 1.25 e macd < 16 e MACD diff_5_min_ago < -9 - r 16875 A2 Y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  1 set 2023 se per es macd passa da 18 a -11 vendi     
                # 12 set 2023 macd < -9 da -10
                # 12 set 2023 macd DIFFERENZA -24 da -25
                #  8 nov 2023 macd DIFFERENZA -11 da -24
                # 15 nov 2023 3-18 da 5-20 
                # 25 nov 2023 and macd < -6 da -11
                # 25 nov 2023 and macd_differenza_5_min_ago < -10 da < -11
                #  1 dic 2023 -0.81 da -0.91
                #  1 dic 2023 and macd_differenza_5_min_ago < -9 da < -10
                #  1 dic 2023 and macd < 10 da -6
                #  3 dic 2023 and macd < 16 da 10
                #  3 dic 2023 aggiunta and ma2_differenza_2_min_ago < -5
                # 27 gen 2024 aggiunta and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                # 27 gen 2024 aggiunta and ma2_last < ma5_last
                # 30 gen 2024 aggiunta and deviation_ma3_sopra_ma18 < -0.049
                #  2 feb 2024 aggiunta deviation_ma3_sopra_ma18 a -0.055 da -0.049
                 
                #  5 mar 2024 deviation_ma3_sopra_ma18 a -0.06 da -0.055
                #  6 mar 2024 and macd_differenza_3_min_ago < -7 invece di MACD diff_5_min_ago < -9
                #  6 mar 2024 and macd < 20 da -16
                #  6 mar 2024 and deviation_ma3_sopra_ma18 a -0.056 da -0.06 
                #  6 mar 2024 vediamo come va una volta e' arrivata in anticipo un' altra volta in ritardo
                #  7 mar 2024 fatta modifica vedi and deviation_ma100_sopra_ma450 < 1.75
                #  7 ott 2024 vendita con 3-48 da 3-30 statte tranquillo
                # 27 feb 2025 5-100 da 3-48 dopo 5 ore NON E' PIU' pochi maledetti e SUBITO !
                # 27 feb 2025 5-100 e vaffanculo !
                # 23 ott 2025 aggiunte pg

            

            elif (
                deviation_sell > 0.81
                and ma300_last < ma300_301_min_ago
                and ma300_last > ma450_last
                and ma3_last < ma59_last

                and macd < macd_2_min_ago
                and macd < -9
                and macd_differenza_5_min_ago < -24
                
                and ma2_last < ma2_2_min_ago
                and ma3_last < ma10_last
                and ma2_last < ma18_last
            ):    
                sell = f"SELL CS - PMS CON ma300 < 5 ore ! MA 300>450 e con dev > 1.01 e macd < -10 e MACD DIFF_5_min_ago < -25 - r 16875 B1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  1 set 2023 se per es macd passa da 18 a -11 vendi     
                # 12 set 2023 macd < -9 da -10
                # 12 set 2023 macd DIFFERENZA -24 da -25
                # 18 dic 2023 aggiunto and ma3_last < ma10_last (almeno un minimo la media deve esserci) (le medie sono piu' forti del MACD)
                # 19 gen 2024 deviation_sell a 0.81 da 0.91
                # 21 feb 2024 aggunta 2-18
                # 12 nov 2024 se 300>450 aggiunto and ma3_last < ma50_last - stai calmo
                # 23 set 2025 3-59 da 3-50 (ma avrei potuto mettere 3<100)
                # 23 ott 2025 aggiunte pg



            elif (
                ma5_last < ma59_last
                and ma100_last > ma100_120_min_ago

                and delta_1 < delta_2
                and deviation_sell > 0.81
                and ma300_last < ma300_301_min_ago
                and ma300_last < ma450_last

                and macd < macd_2_min_ago
                and macd < -9
                and macd_differenza_5_min_ago < -24
                
                and ma2_last < ma2_2_min_ago
                and ma3_last < ma10_last
                and ma2_last < ma18_last

            ):    
                sell = f"SELL CS - PMS 3-59 CON ma300< 5 ore ma 100 > 120 min ago E 300<450 e con dev > 0.81  - r 16875 B2 X1 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 28 gen 2025 se GIORNO ma5_last < ma39_last
                # 10 mag 2025 sell con 5-59 da 3-39 se 100> 100 120 min ago
                # 23 ott 2025 aggiunte pg


                
                    
            elif (
                ma5_last < ma39_last
                and ma100_last < ma100_120_min_ago

                and delta_1 < delta_2
                and deviation_sell > 0.81
                and ma300_last < ma300_301_min_ago
                and ma300_last < ma450_last

                and macd < macd_2_min_ago
                and macd < -9
                and macd_differenza_5_min_ago < -24
                
                and ma2_last < ma2_2_min_ago
                and ma3_last < ma10_last
                and ma2_last < ma18_last

            ):    
                sell = f"SELL CS - PMS 3-39 CON ma300 < 5 ore e 100 < 120 min ago E 300<450 e con dev > 0.81 - r 16875 B2 X2 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"

                # 28 gen 2025 se GIORNO ma5_last < ma39_last
                # 10 mag 2025 sell con 5-59 da 3-39 se 100> 100 120 min ago
                # 23 ott 2025 aggiunte pg



            elif (
                ma3_last < ma39_last
                and delta_1 > delta_2
                and deviation_sell > 0.81
                and ma300_last < ma300_301_min_ago
                and ma300_last < ma450_last

                and macd < macd_2_min_ago
                and macd < -9
                and macd_differenza_5_min_ago < -24
                
                and ma2_last < ma2_2_min_ago
                and ma3_last < ma10_last
                and ma2_last < ma18_last

            ):    
                sell = f"SELL CS - PMS 3-39 CON ma300 < 5 ore ! E 300<450 e con dev > 1.01 e macd < -10 e MACD DIFF_5_min_ago < -25 - r 16875 B2 Y - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                #  1 set 2023 se per es macd passa da 18 a -11 vendi     
                # 12 set 2023 macd < -9 da -10
                # 12 set 2023 macd DIFFERENZA -24 da -25
                # 18 dic 2023 aggiunto and ma3_last < ma10_last (almeno un minimo la media deve esserci) (le medie sono piu' forti del MACD)
                # 19 gen 2024 deviation_sell a 0.81 da 0.91
                # 21 feb 2024 aggunta 2-18
                # 28 gen 2025 aggunta 3-39
                # 28 gen 2025 se NOTTE ma3_last < ma39_last
                # 23 ott 2025 aggiunte pg


            
            elif (
                seconds_since_last_trade > 0 and seconds_since_last_trade < 3000
                and ma5_last > ma100_last
                and ma300_last < ma300_180_min_ago
                and ma3_last < ma33_last
                
                and deviation_sell > 0.60
                and deviation_sell < 1.05
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -0.40
                and macd < -20
                
            ):    
                sell = f"SELL condizione PMS da 0 a 50 min con 3-33 se sta sopra ma100 E con dev_sell 0.60 - 1.05 e macd < -20 - INTANTO TE LI PRENDI - r 16888 a - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 24 ago 2023 and macd < -5
                # 18 dic 203 3-20 da 3-25
                # 15 gen 2024 con 3-28 se sta sopra ma100 ! stai piu' tranquillo
                # 15 ott 2025 3-33 da 3-28
                # 23 ott 2025 aggiunte pg


               
            elif (
                seconds_since_last_trade > 0 and seconds_since_last_trade < 3000
                and ma5_last < ma100_last
                and ma300_last < ma300_180_min_ago
                and ma3_last < ma20_last
                
                and deviation_sell > 0.60
                and deviation_sell < 1.05
                
                and ma2_last < ma2_2_min_ago
                and deviation_ma2_sopra_o_sotto_ma2_2_min_ago < -0.02
                and macd < macd_2_min_ago
                and macd_differenza_2_min_ago < -0.40
                and macd < -20
                
            ):    
                sell = f"SELL condizione POCHI MALEDETTI E SUBITO da 0 a 50 min con 3-20 se sta sotto ma100 E con dev_sell 0.60 - 1.05 e macd < -20 - INTANTO TE LI PRENDI - r 16888 b - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # 24 ago 2023 and macd < -5
                # 18 dic 203 3-20 da 3-25
                # 23 ott 2025 aggiunte pg
            
          
                
            # 45 SELL condizione speciale da RCCR ! IPOTESI PEGGIORE con ma50< con dev_ma39 < -0.225 and deviation_sell < -0.22 MA DOPPIO DELTA RIALZO 
                     
            elif (
                ma50_last < ma50_2_min_ago
                and ma300_last > ma300_301_min_ago
                
                and (ma3_prev > ma300_prev and ma3_last < ma300_last)
                
                and ma200_last < ma300_last
                and deviation_trend_ma200 < -0.10
                        
                and deviation_ma39 < -0.225
                and deviation_sell < -0.228
                        
                and rapporto_delta_1_delta_2 < 1
                        
                and ma2_last < ma2_2_min_ago
            ):
                sell = f"SELL condizione speciale 43 da RCCR ! IPOTESI PEGGIORE con dev_ma39 < -0.225 and dev_sell < -0.227 MA DOPPIO DELTA RIALZO - r 16936 A - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                        
                # 19 SET r 10546 la condizione precedente ha fatto -1.65 ed e' partita insieme ad altre 2 condizioni speciali !
                
                # quindi, ho aggiunto questa condizione importata da RCCR SIA QUA CHE NELLE CONDIZIONI SPECIALI ( nuova condizione speciale )
                # 19 set 2022 IMPORTATO DA RCCR > sell 4:18 del 19 set -1.65 % !
                # 19 set 2022 deviation_ma39 < -0.22 AND and deviation_sell < -0.22
                # 20 set 2022 ho aumentato SOLO LA dev sell a -0.23 !
                # 23 ott 2025 aggiunte pg

                
                
                
            # 46 SELL condizione speciale da RCCR ! IPOTESI PEGGIORE con ma50< con dev_ma39 < -0.225 and deviation_sell < -0.22 MA DOPPIO DELTA RIALZO 
                     
            elif (
                ma50_last < ma50_2_min_ago
                and ma300_last < ma300_301_min_ago
                
                and (ma3_prev > ma300_prev and ma3_last < ma300_last)
                and ma200_last < ma300_last
                and deviation_trend_ma200 < -0.10
                        
                and deviation_ma39 < -0.225
                and deviation_sell < -0.26
                        
                and rapporto_delta_1_delta_2 < 1
                        
                and ma2_last < ma2_2_min_ago
            ):
                sell = f"SELL condizione speciale 43 da RCCR ! IPOTESI PEGGIORE con dev_ma39 < -0.225 and dev_sell < -0.26 MA DOPPIO DELTA RIALZO - r 16936 B - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                        
                # 19 SET r 10546 la condizione precedente ha fatto -1.65 ed e' partita insieme ad altre 2 condizioni speciali !
                
                # quindi, ho aggiunto questa condizione importata da RCCR SIA QUA CHE NELLE CONDIZIONI SPECIALI ( nuova condizione speciale )
                # 19 set 2022 IMPORTATO DA RCCR > sell 4:18 del 19 set -1.65 % !
                # 19 set 2022 deviation_ma39 < -0.22 AND and deviation_sell < -0.22
                # 20 set 2022 ho aumentato SOLO LA dev sell a -0.23 !
                # 15 nov 2022 dev sell -0.24 da -0.23
                # 18 nov 2022 dev sell -0.26 da -0.24
                # 23 ott 2025 aggiunte pg


                
            # 47 SELL condizione speciale RIMBALZO CHE ARRIVA FINO ALLA ma300 MA LA 100 E' MOLTO DISTANTE quindi non vende mentre si riavvicinano 
                     
            elif (
                ma300_last < ma300_301_min_ago
                and deviation_sell > 0.55
                
                and (ma3_prev > ma285_prev and ma3_last < ma285_last)
                and deviation_ma100_sopra_ma300 < -0.30
                and ma5_last < ma39_last
                and ma200_last < ma300_last
        
            ):
                sell = f"SELL condizione speciale 44 RIMBALZO CHE ARRIVA FINO ALLA ma300 MA ma100 E' MOLTO DISTANTE quindi non vende mentre si riavvicinano - r 16938 - deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # questa condizione e' un capolavoro
                # prima era incrocio verso l' alto 3-300 durante un ribasso
                # 14 ottobre 2022 incrocio verso il basso 3-285 e ma3 < ma8
                # 16 mar 2023 5-39 da 3-8  
                # 23 ott 2025 aggiunte pg



            # 48 SELL papa GP II 18 mag 2025 - condizione speciale vendita dopo 5 min con guadagno durante consolidato trend ribassista
            # max_hold_time_in_seconds_papa = 300

            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_papa

                and ma20_last < ma50_last
                and (ma5_prev > ma20_prev and ma5_last < ma20_last)
                and deviation_sell < 0.10
                and (delta_GPII_1 > delta_GPII_2 or delta_MC_1 > delta_MC_2)

                and ma300_last < ma300_120_min_ago
                and deviation_ma5_sopra_o_sotto_ma5_120_min_ago < -0.50
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.03
                and ma5_last < ma100_last
                and ma5_last < ma200_last
                and ma5_last < ma300_last
                and ma100_last < ma200_last
                and ma200_last < ma300_last

            ):
                sell = f"SELL papa GP II 18 mag 2025 > 5 min con guadagno durante trend ribassista SE 20 STA ANCORA SOTTO 50 e incrocio al ribasso 5-20 - r 16937 A - delta_GPII_1 {delta_GPII_1:.3f} delta_GPII_2 {delta_GPII_2:.3f} delta_MC_1 {delta_MC_1:.3f} delta_MC_2 {delta_MC_2:.3f} deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # questa condizione e' un capolavoro
                # 18 mag 2025 papa GP II
                # interviene dopo 300 secondi (5 min)
                # 19 mag 2025 5-18 da 5-20
                # 19 mag 2025 aggiunta and delta_GPII_1 > delta_GPII_2 notte - 10 min -
                # 19 mag 2025 aggiunta and delta_MC_1 > delta_MC_2 notte - 10 min -
                # 19 mag 2025 DEVE ESSERE NOTTE ! se e' giorno statte fermo !
                # 19 mag 2025 vedi r 1160 r
                # 19 mag 2025 aggiungo parentesi graffe !

                # 20 maggio spezzata la riga lunga - grazie compa !
                #  8 ott 2025 (ma5_prev > ma20_prev and ma5_last < ma20_last) da (ma5_prev > ma18_prev and ma5_last < ma18_last)
                # 23 ott 2025 aggiunte pg



            # 49 SELL papa RATZINGER 18 mag 2025 - condizione speciale vendita dopo 5 min con guadagno durante consolidato trend ribassista
            # max_hold_time_in_seconds_papa = 300
            
            elif (
                seconds_since_last_trade > max_hold_time_in_seconds_papa

                and (ma20_prev > ma50_prev and ma20_last < ma50_last)
                and deviation_sell < 0.10

                and ma300_last < ma300_120_min_ago
                and deviation_ma5_sopra_o_sotto_ma5_120_min_ago < -0.50
                and deviation_ma100_sopra_o_sotto_ma100_10_min_ago < -0.03
                and ma5_last < ma100_last
                and ma5_last < ma200_last
                and ma5_last < ma300_last
                and ma100_last < ma200_last
                and ma200_last < ma300_last

            ):
                sell = f"SELL papa RATZINGER 18 mag 2025 > 5 min con guadagno trend ribassista SE 20 INCROCIA AL RIBASSO 50  - r 16937 B - ma20_last {ma20_last:.3f} ma50_last {ma50_last:.3f} deviation_ma39 {deviation_ma39:.3f} deviation_ma3_sotto_ma50 {deviation_ma3_sotto_ma50:.3f} deviation_ma5_sopra_o_sotto_ma100 {deviation_ma5_sopra_o_sotto_ma100:.3f} deviation_ma25_sotto_ma300 {deviation_ma25_sotto_ma300:.3f} deviation_ma100_sopra_o_sotto_ma100_10_min_ago {deviation_ma100_sopra_o_sotto_ma100_10_min_ago:.3f}"
                action = "sell"
                
                # questa condizione e' un capolavoro
                # 18 mag 2025 papa RATZINGER
                # interviene dopo 300 secondi (5 min)

                # 20 maggio spezzata la riga lunga - grazie compa !
                # 23 ott 2025 aggiunte pg
                
               
                    
                
                
                

        self.algo_helper.info("action {}".format(action))
        self.algo_helper.info("percentage {}".format(percentage))

        if action == "sell":
            self.algo_helper.info("action sell {}".format(sell))
            self.session += 1

        elif action == "buy":
            self.algo_helper.info("action buy {}".format(buy))

        return action, percentage

        ############### FINE ALGORITH ###################
        
        # viva ro combaro meo.
        # questi miei sacrifici io li dedico a te.
        # grazie.
        # niente altro.
        
        # roma 5 maggio 2022
        
        # 15 giugno 2022 INGRESSO DELLE 2 SORELLE 3-10 and 5-28
        
        # in futuro
            # MACD e RSI
            # TOGLIERE TUTTI GLI INCROCI AL BUY ! se 13 > 100 NON INCROCERA' MAI ! INCROCIO 13-100 DIVENTA 13>100 !
            # analisi dei dati !
            
            
            # 5 luglio 2022 fine ordine e progresso.
            # combaro meo, grazie di tutto !
            
            
            # i know how to speak- manchester orchestra 
            # core 'ngrato - enrico caruso
            # not dark yet (nyc)(bd) 
            # ti voglio bene, compa.
            # non siamo non siamo non siamo !
            
            # con il mio affetto piu' grande.
            # penso sempre a te.
            # grazie sempre.
            # grazie.
            # compa
            # compa torna !
            # ave compa caro
            #
